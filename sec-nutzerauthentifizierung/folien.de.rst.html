<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta content="Michael Eichberg" name="author" />
<meta content="Nutzerauthentifizierung, Challenge-Response-Authentifizierung, Fiat-Shamir-Transformation" name="keywords" />
<meta content="User Authentification" lang="en" name="description" xml:lang="en" />
<meta content="Nutzerauthentifizierung" lang="de" name="description" xml:lang="de" />
<meta content="vorlesung-it-sicherheit-nutzer-authentifizierung" name="id" />
<meta content="last-viewed" name="first-slide" />
<meta name="version" content="LD2 RENAISSANCE" />
<meta name="exercises-passwords" content="MTAwMDAw:755FM7tz4RKG+/eh/paUOaWkU9C46bomF4sScxGhLnU=:x3WLbUikPLAoICJ9:XKy4FzW2YE8OY7ipIv0qQ2WhBhVzkXqBBxCj/EXlH7vkM+qqn6RjqnpvC/rlQg04eR1A9jA/Wb3qZkWm+niePrI6ZfDC4IMGlhI3d4LLWov4dQBnfxzpo8vsMs1lfTGFrA8/IKYFcdzmRLrOBWlN84+oFNLGpcS2ifvI66jrPddm5fdQj75Dt+2bLfGmuHSgQ+aOpQsHFle7bHgDbw/y8O6QVhddG0jF4w41r3lVo0GEpAIvxmbhNJJjjw0ayqLmyC+xYf2L5p/9+Ltmxp6NbUbp4XiiorOJY5rI8pnUtnLaZcJNqm6CKpt9a6IvtSaWeQ8iv0EdwBVm+bFf4AJtdBy0NJ/AoB57Azx4XX33HUpjdtP4ylD6du0cloRZd35EJkHkia76ulIZ1ht3DFg5K1saznhDdfOmZYZzJRHyITFqTHDYHQOXpkTOygX7FlbwjDuiRj6iO7q8eKUUnUC0XF5WNJjBcP/NCruVjxosqz4Yv9lr8uAK0GKcVtBalf7PI5UajfKKzmC83l9udvkK08jE3mTu67zhJHdfhlGoc9KoWhFGNslYIK/qI4MbqEGDz07rrvd88So6GN3qEm4EVsvCSbcrmyie" />
<title>Nutzerauthentifizierung</title>
<script>
    window.MathJax = {
        tex: { tags: 'ams' },
        chtml: { displayAlign: 'center' /*left or center*/ }
    };
</script>
<script type="text/javascript" src="../LectureDoc2/ext/mathjax/es5/tex-chtml-full.js?config=TeX-AMS_CHTML"></script>

    <script src="../LectureDoc2/src/ld.js" type="module"></script>

    <link rel="stylesheet" href="../LectureDoc2/src/ld.css" />

    
    <!-- As of 2024 it is not yet possible to use "layer" with linked stylesheets
         <link rel="stylesheet" href="../LectureDoc2/src/css/themes/dhbw.css" layer="theme" />
 -->
         <style>@import url("../LectureDoc2/src/css/themes/dhbw.css") layer(theme);</style>
    
</head>
<body>
<template>
<ld-topic id="nutzerauthentifizierung">
<h1 class="title">Nutzerauthentifizierung</h1>
<dl class="docinfo">
<dt class="dozent">Dozent<span class="colon">:</span></dt>
<dd class="dozent"><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt class="contact">Kontakt<span class="colon">:</span></dt>
<dd class="contact"><a class="reference external" href="mailto:michael.eichberg&#64;dhbw.de">michael.eichberg&#64;dhbw.de</a></dd>
<dt class="version">Version<span class="colon">:</span></dt>
<dd class="version">1.3.7</dd>
</dl>
<div class="supplemental docutils container">
<dl class="field-list">
<dt>Folien<span class="colon">:</span></dt>
<dd><p>[HTML] <a class="reference external" href="https://delors.github.io/sec-nutzerauthentifizierung/folien.de.rst.html">https://delors.github.io/sec-nutzerauthentifizierung/folien.de.rst.html</a></p>
<p>[PDF] <a class="reference external" href="https://delors.github.io/sec-nutzerauthentifizierung/folien.de.rst.html.pdf">https://delors.github.io/sec-nutzerauthentifizierung/folien.de.rst.html.pdf</a></p>
</dd>
<dt>Fehler melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div>
</ld-topic>
<ld-topic class="new-section" id="grundlagen">
<h2>Grundlagen</h2>
</ld-topic>
<ld-topic id="challenge-response-authentifizierung">
<h2>Challenge-Response Authentifizierung</h2>
<ld-deck>
<ld-card>
<aside class="admonition observation">
<p class="admonition-title">Beobachtung</p>
<p>Die Verwendung einer (kryptographischen) Hashfunktion alleine ist nicht ausreichend zur sicheren <em>Benutzerauthentifizierung über eine nicht-sichere Verbindung</em>.</p>
<p>Eine einfache Replay-Attacke ist möglich.</p>
</aside>
</ld-card><ld-card class="incremental">
<p>Ein einfaches Protokoll basierend auf einer Hashfunktion <span class="math-i">f</span> wäre:</p>
<div class="supplemental docutils container">
<p>Challenge-Response Protokoll ≘ <span class="ger">Herausforderung- und Antwortprotokoll</span></p>
</div>
<table class="compact borderless incremental-table-rows highlight-cell-on-hover zebra-columns" style="width: 100%;">
<colgroup>
<col style="width: 36.4%" />
<col style="width: 27.3%" />
<col style="width: 36.4%" />
</colgroup>
<thead>
<tr><th class="head"><p>Alice</p></th>
<th class="head"><p>unsicherer Kanal</p></th>
<th class="head"><p>Bob</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Gibt Benutzerkennung <span class="math-i">ID</span> ein</p></td>
<td><p>→ sendet <span class="math-i">ID</span></p></td>
<td><p>sucht zu <span class="math-i">ID</span> Schlüssel <span class="math-i">K</span> in der Datenbank</p></td>
</tr>
<tr><td></td>
<td></td>
<td><p>↓</p></td>
</tr>
<tr><td><p>Gibt Passwort <span class="math-i">K'</span> ein</p></td>
<td><p>sendet <span class="math-i">r</span> ←</p></td>
<td><p>wählt zufällige Zahl <span class="math-i">r</span></p></td>
</tr>
<tr><td></td>
<td></td>
<td><p>↓</p></td>
</tr>
<tr><td><p>berechnet: <span class="math">\(Res'=f(K',r)\)</span></p></td>
<td><p>→ sendet <span class="math-i">Res'</span></p></td>
<td><p><span class="math">\(f(K,r) ?= Res'\)</span></p></td>
</tr>
</tbody>
</table>
<aside class="admonition incremental question">
<p class="admonition-title">Frage</p>
<p>Wie bewerten Sie die Sicherheit genau dieses Protokolls/Ansatzes?</p>
</aside>
<ld-presenter-note data-encrypted="true">
MTAwMDAw:rUjfcf25kabGWXj9Pm2lA6IOdAesZPf8iHDuBdePqlA=:ycFD+alYmit5rD+6:BCsJsKmGc98Z2EYTk9JD6TzFH040x40WihuFmIiiGH5zipdBxv3P6aynEtDtDVFMKEjQBiPqS7n32tZIjC5uVmvvQGyNDXj+ajjfaYeypOfgSRy0zmRJTKjZOC9xjA99aBjyboxdtwb2cZJxaE3ASNBPa6TeNgE2E1+gDA+kZrQitM8S3ebh0bn3wD1L1NC63PhZfu5QkiqMpZnmL+bCluE3HHA1ma1sxaJmXjuuq1GtwFbLEswQo90/j5dPSafnYasgnwFvnvDZaS3V2cQsS4RgHNzDCON3TWJMl3h8B9tp4Y9kLdbwcCXSPHN6ITE54Xqru7N9lywF6Fwld1+3msTX2GTL1CBG8SpQAoU3IFMng+05vlG1r84xyqMe3qjZcvYX2sGQFIusMrbF7V+N8Xq3LsBBc2XrCyy7uy8iGXc8yPGdwF9tbaEBfc9ztANIwCXiFHGvx7aM6Skj6sRY66kBAvclo0hiiSx6S00wmPkBs5Pl3/5ZRDa2eY47Tj8n0+DOe4/SDJS7zyWKEMV9vrRaznKQtpANI8aIbfVMudYrQfI2l/80TW2/mM9FALMoqlGMQDVsm+0uD/bmhKnr3GmYEatvdTwBW7eHMPH+X8WLeKU3Q53VwsipAUpcIclpcqynPJI1ysRZ8zA33p37LZhc4TaV8k3Ykdrg1LkEJ4eywicsP66FrZppeF2+iZ/EDR+dd2skwTVb3CMZANDj5SBSKJaP2+dioO5yUIc92Ms29dfNQ5Pah/jz9mZTBSgZ7IAW5UlHXXxFof5MgmjXkq0=</ld-presenter-note>
</ld-card></ld-deck></ld-topic>
<ld-topic id="zero-knowledge-protokolle">
<h2>Zero-Knowledge Protokolle</h2>
<ld-deck>
<ld-card>
<div class="accentuate docutils container">
<p>Die Idee ist, dass man jemanden davon überzeugen möchte, dass man eine bestimmte Information hat, ohne diese Information zu offenbaren.</p>
</div>
</ld-card><ld-card class="incremental">
<aside class="admonition example">
<p class="admonition-title">Beispiel</p>
<p class="rubric">Der geheimnisvolle Geheimgang</p>
<p>Peggy möchte Victor überzeugen, dass Sie den Code zur Tür kennt, ohne ihn zu offenbaren.</p>
<ld-grid class="default-layout">
<ld-cell class="width-70" style="align-self:auto;">
<ul class="incremental-list simple">
<li><p>Peggy wählt einen der Wege zur Tür, während Victor an der Stelle A steht und darauf wartet, dass Sie bei der Tür ist.</p></li>
<li><p>Sobald Peggy Bescheid gibt, dass Sie an der Tür angekommen ist, geht Victor zu Punkt B und sagt Peggy auf welchem Weg sie zurückkommen soll.</p></li>
<li><p>Kommt sie auf dem falschen Weg zurück, dann kennt sie den Code der Tür (offensichtlich) nicht. Kommt sie auf dem richtigen Weg zurück, könnte es noch immer Zufall gewesen sein mit Wahrscheinlichkeit <span class="math">\(\frac{1}{2}\)</span>.</p></li>
</ul>
</ld-cell><ld-cell class="width-30" style="align-self:auto;">
<object class="align-center" data="images/zkp-geheimgang.svg" role="img" type="image/svg+xml">
</object><div class="incremental docutils container">
<p>Bei n Spielen ist die Wahrscheinlichkeit, dass Peggy immer zufällig den korrekt Weg gewählt hat <span class="math">\(\frac{1}{2^n}\)</span>.</p>
</div>
</ld-cell></ld-grid></aside>
</ld-card><ld-card class="incremental">
<p>Viele Zero-Knowledge Protokolle basieren darauf, dass man im Prinzip ein Spiel spielt, das man auch zufällig gewinnen kann. Durch die Wiederholung des Spiels wird die Wahrscheinlichkeit jedoch für permanentes zufälliges Gewinnen sehr schnell sehr klein (exponentiell). Somit kann man für praktische Zwecke hinreichend sicher sein, dass der Beweisführende (im Beispiel Peggy) über das Wissen verfügt, das er vorgibt zu besitzen, wenn er immer gewinnt.</p>
<p>Nach <span class="math-r">20</span> Runden ist die Wahreinschlichkeit nur noch <span class="math">\(1/2^{20} = 1/1 048 576\)</span>.</p>
<p>Mit <span class="math-r">128</span> Runden erreicht man ein Sicherheitsniveau, das vergleichbar ist mit anderen kryptographischen Verfahren (AES-128, SHA-256, ...).</p>
</ld-card></ld-deck></ld-topic>
<ld-topic id="fiat-shamir-protokoll">
<h2>Fiat-Shamir Protokoll</h2>
<p class="rubric">Voraussetzungen</p>
<ul class="simple">
<li><p>gegeben zwei zufällige Primzahlen <span class="math-i">p</span> und <span class="math-i">q</span> und <span class="math">\(n = p \cdot q\)</span></p></li>
<li><p>Peggys geheimer Schlüssel <span class="math-i">s</span> wird dann zufällig bestimmt; <span class="math">\(s \in \mathbb{Z}_n^*\)</span> und <span class="math-i">s</span> coprimal zu <span class="math-i">n</span>.</p></li>
<li><p>Der öffentliche Schlüssel wird dann wie folgt berechnet: <span class="math">\(v = s^{-2} \bmod n\)</span>. Der öffentlichen Schlüssel besteht dann aus den zwei Zahlen <span class="math">\(v\)</span> und <span class="math">\(n\)</span>.</p></li>
</ul>
<p class="rubric">Protokoll</p>
<ld-story>
<ol class="arabic incremental-list">
<li><p>Peggy berechnet <span class="math">\(x\)</span> unter Verwendung einer beliebigen Zufallszahlen <span class="math">\(r \in \mathbb{Z}_n^*\)</span>:</p>
<p><span class="math">\(x = r^2 \bmod n\)</span></p>
<ld-presenter-note data-encrypted="true">
MTAwMDAw:/JVAyIXkKlwcDNoZy3Li0PdUuiO3Fe1EZSv5lzVH5M8=:rMSE5ZGe5rLT/EKH:edRGUHtQkmgC0W2HeCYDqf1UeleCvsalJRWeuVSDDoatsA6huCUOPimoN9MxDrzAA/0feqpIzwc0ED3zEzXQsGyxVd0P9lAwEFTijqwiN4C11O+TUX8N0GBYs9GuhDw6feHOvL113xse5rXTSRrJmfW5V0VTZlFwMwFdGOslrQQFTmKq7aAGy7i16H92cB7yXbwnsrjyD22B77Cq+H6QRSqgdyHbRCpvUScaIcYWBv4vKXZN8hCf5OARueaNcEFRb1vFBpMJmwfEzFSjj1VZ3vr5NrKv3oq04O02XN7HabKFkLHW3aYKQMc1W2zn/dqBLHrDAoGlw8wsUU1EAttAGb/hzzWL1pJTd8q42G57C8VC4OKGOGZbYEmkGaral3bGFMXLN/OcPdLQXEc5K4T47KKW8RtioUi8xqhC7GFYfsbP4TXqsrMaY9OKkhPJbOQnbRA=</ld-presenter-note>
</li>
<li><p>Peggy sendet die Zahl an Victor.</p></li>
<li><p>Victor wählt zufällig ein Bit <span class="math">\(b \in \{0, 1\}\)</span></p></li>
<li><p>Peggy berechnet <span class="math">\(y = r \cdot s^b \bmod n\)</span></p></li>
<li><p>Peggy sendet <span class="math-i">y</span> an Victor.</p></li>
<li><p>Victor testet:  <span class="math">\(x \cdot v^{-b} \bmod n \stackrel{?}{=} y^2 \bmod n\)</span></p></li>
</ol>
</ld-story></ld-topic>
<ld-topic class="exercises" id="ubung-klassisches-fiat-shamir-protokoll">
<h2>Übung: klassisches Fiat-Shamir-Protokoll</h2>
<div class="ld-exercise" data-exercise-id="1" data-exercise-title="1 - Beispiel: Fiat-Shamir-Protokoll mit kleinen Zahlen" id="ld-exercise-1">
<p class="ld-exercise-title rubric">Beispiel: Fiat-Shamir-Protokoll mit kleinen Zahlen</p>
<p>Zwei Parteien, Peggy (die sich authentifizieren möchte) und Victor (der Prüfer), führen das Fiat-Shamir-Protokoll durch. Verwenden Sie die folgenden Werte:</p>
<ul class="simple">
<li><p><span class="math">\(p = 3\)</span>, <span class="math">\(q = 7\)</span> → <span class="math">\(n = p \cdot q = 21\)</span></p></li>
<li><p>Peggys geheimer Schlüssel ist <span class="math">\(s = 2\)</span></p></li>
<li><p>Peggy wählt die Zufallszahl <span class="math">\(r = 4\)</span></p></li>
<li><p>Victor wählt die Herausforderung <span class="math">\(b = 1\)</span></p></li>
</ul>
<p>Beantworten Sie folgende Fragen:</p>
<ol class="arabic simple">
<li><p>Berechnen Sie den öffentlichen Schlüssel <span class="math-i">v</span>.</p></li>
<li><p>Berechnen Sie den Wert <span class="math-i">x</span>, den Peggy an Victor sendet.</p></li>
<li><p>Berechnen Sie die Antwort <span class="math-i">y</span>, die Peggy an Victor sendet.</p></li>
<li><p>Führen Sie die Verifikation als Victor durch</p></li>
</ol>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:1kMuSxYmm15oIA2HcZNlCGqU29HIelCrhoCBs+1igrY=:F2FMa8tHGwz7wfPi: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</div>
</div>
</ld-topic>
<ld-topic class="new-section transition-fade" id="einmalpasswortsysteme">
<h2>Einmalpasswortsysteme</h2>
</ld-topic>
<ld-topic id="password-sniffing">
<h2>Password Sniffing</h2>
<dl class="incremental-list field-list">
<dt>In der Anfangszeit<span class="colon">:</span></dt>
<dd><p>unverschlüsselte Übertragung von Passwörtern (telnet, ftp, ...)</p>
</dd>
<dt>In der Übergangszeit<span class="colon">:</span></dt>
<dd><p>Verwendung von Einmal-Passwörtern (S/Key, ...)</p>
</dd>
<dt>Heute<span class="colon">:</span></dt>
<dd><p>Passwörter werden verschlüsselt übertragen (ssh, https, ...)</p>
<p>Zusätzliche Absicherung durch Zwei-Faktor-Authentifizierung (basierend auf Einmalpassworten: TOTP, ...)</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Unverschlüsselte Passworte können leicht mittels eines Sniffers, der den Netzwerkverkehr mitschneidet (z. B. Wireshark), abgefangen werden.</p>
</div>
</ld-topic>
<ld-topic id="einmal-passworter">
<h2>Einmal-Passwörter</h2>
<p>Die Idee ist, dass Passwörter nur genau einmal gültig sind und nicht wiederverwendbar sind.</p>
<ul class="simple">
<li><p>Tokens (z. B. RSA SecurID)</p></li>
<li><p>Codebuch: Liste von Einmal-Passwörtern, die das gemeinsame Geheimnis sind.</p></li>
<li><p>S/Key: Passwort „wird mit einem Zähler kombiniert“ und dann gehasht.</p></li>
</ul>
</ld-topic>
<ld-topic id="das-s-key-verfahren">
<h2>Das S/Key Verfahren</h2>
<p>Einmal-Passwort-System nach Codebuch-Verfahren.</p>
<ld-deck>
<ld-card>
<p><strong>Initialisierung</strong></p>
<ol class="arabic incremental-list list-with-explanations">
<li><p>Der Nutzer gibt sein Passwort <span class="math">\(W\)</span> ein; dies ist der geheime Schlüssel.</p>
<p>(Sollte <span class="math">\(W\)</span> bekannt werden, dann ist die Sicherheit des Verfahrens nicht mehr gewährleistet.)</p>
</li>
<li><p>Eine kryptografische Hash-Funktion <span class="math">\(H\)</span> wird n-mal auf <span class="math">\(W\)</span> angewandt, wodurch eine Hash-Kette von n einmaligen Passwörtern entsteht. <span class="math">\(H(W), H(H(W)), \dots, H^{n}(W)\)</span></p></li>
<li><p>Das initiale Passwort wird verworfen.</p></li>
<li><p>Der Benutzer erhält die <span class="math">\(n\)</span> Passwörter, die in umgekehrter Reihenfolge ausgedruckt werden: <span class="math">\(H^n(W), H^{n-1}(W), ..., H(H(W)), H(W)\)</span>.</p></li>
<li><p>Nur das Passwort <span class="math">\(H^n(W)\)</span>, das an erster Stelle der Liste des Benutzers steht, der Wert von <span class="math">\(n\)</span> und ggf. ein Salt, wird auf dem Server gespeichert.</p></li>
</ol>
</ld-card><ld-card class="incremental">
<p><strong>Anmeldung</strong></p>
<p>Identifiziere das letzte verwendete Passwort <span class="math">\(n\)</span>.</p>
<ul class="incremental-list simple">
<li><p>Der Server fragt den Nutzer nach dem Passwort <span class="math">\(n-1\)</span> (d. h. <span class="math">\(H^{n-1}(W)\)</span>) und übermittelt ggf. auch den Salt.</p></li>
<li><p>Der Server hasht das Passwort und vergleicht es dann mit dem gespeicherten Passwort <span class="math">\(H^n(W)\)</span>.</p></li>
<li><p>Ist das Passwort korrekt, dann wird der Nutzer angemeldet und der Server speichert das Passwort <span class="math">\(H^{n-1}(W)\)</span> als neues Passwort <span class="math">\(H^n(W)\)</span> und dekrementiert n.</p></li>
</ul>
</ld-card></ld-deck><div class="supplemental docutils container">
<p>Im Original basiert S/Key auf der kryptographischen Hashfunktion MD4. Ein Austausch wäre aber selbstverständlich möglich!</p>
<p>Intern verwendet S/KEY 64-bit Zahlen. Für die Benutzbarkeit werden diese Zahlen auf sechs kurze Wörter, von ein bis vier Zeichen, aus einem öffentlich zugänglichen 2048-Wörter-Wörterbuch (<span class="math">\(2048 = 2^{11}\)</span>) abgebildet. Zum Beispiel wird eine 64-Bit-Zahl auf &quot;ROY HURT SKI FAIL GRIM KNEE&quot; abgebildet.</p>
</div>
</ld-topic>
<ld-topic id="hmac-based-one-time-password-hotp">
<h2>HMAC-based one-time password (HOTP)<a class="brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></h2>
<ul class="simple">
<li><p>ermöglicht die Erzeugung von Einmal-Passwörtern auf Basis eines geheimen Schlüssels und eines Zählers; Parameter:</p>
<ul class="incremental-list">
<li><p>Ein kryptografisches Hash-Verfahren <span class="math">\(H\)</span> (Standard ist SHA-1 mit 160 Bit)</p></li>
<li><p>einen geheimen Schlüssel <span class="math">\(K\)</span>, der eine beliebige Bytefolge ist</p></li>
<li><p>Ein Zähler <span class="math">\(C\)</span>, der die Anzahl der Iterationen zählt</p></li>
<li><p>Länge des Passworts: <span class="math">\(d\)</span> (6-10, Standardwert ist 6, empfohlen werden 6-8)</p></li>
</ul>
</li>
</ul>
<ul class="incremental">
<li><p>Zur Authentifizierung berechnen beide das Einmalpasswort (HOTP) und dann vergleicht der Server den Wert mit dem vom Client übermittelten Wert.</p>
<p>Berechnung aus dem Schlüssel <span class="math">\(K\)</span> und dem Zähler <span class="math">\(C\)</span>:</p>
<div class="incremental docutils container">
<p><span class="math">\(HOTP(K, C) = truncate(HMAC_H(K, C))\)</span></p>
<div class="incremental docutils container">
<p><span class="math">\(truncate(MAC) = extract31(MAC, MAC[(19 \times  8 + 4):(19 \times  8 + 7)])\)</span></p>
</div>
<div class="incremental docutils container">
<p><span class="math">\(HOTP\; value = HOTP(K, C)\; mod\; 10^d\qquad\)</span> (führende Nullen werden nicht abgeschnitten)</p>
</div>
</div>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.rfc-editor.org/rfc/rfc4226">https://www.rfc-editor.org/rfc/rfc4226</a></p>
</aside>
</aside>
<div class="supplemental docutils container">
<p><span class="math">\(truncate\)</span> verwendet die 4 niederwertigsten Bits des MAC als Byte-Offset <span class="math">\(i\)</span> in den MAC.
Der Wert <span class="math">\(19\)</span> kommt daher, dass ein SHA-1 <span class="math">\(160\)</span> Bit hat und <span class="math">\(160/8 = 20\)</span> Byte.</p>
<p><span class="math">\(extract31\)</span> extrahiert 31 Bit aus dem MAC. Das höchstwertig Bit wird (wenn es nicht 0 ist) entsprechend maskiert.
Eine Schwäche des Algorithmus ist, dass beide Seiten den Zähler erhöhen müssen und, falls die Zähler aus dem Tritt geraten, ggf. eine Resynchronisation notwendig ist.</p>
</div>
</ld-topic>
<ld-topic id="time-based-one-time-password-totp">
<h2>Time-based one-time password (TOTP)<a class="brackets" href="#footnote-2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></h2>
<ul class="simple">
<li><p>Erzeugung von zeitlich limitierten Einmal-Passwörtern (z. B. 30 Sekunden)</p></li>
</ul>
<ul class="incremental-list list-with-explanations">
<li><p>Basierend auf einem vorher ausgetauschten geheimen Schlüssel und der aktuellen Zeit</p>
<p>Z. B. Unix-Zeit in Sekunden (ganzzahlig) und danach gerundet auf 30 Sekunden.</p>
</li>
<li><p>Es wird das HOTP Verfahren mit der Zeit als Zähler verwendet und entweder SHA-256 oder SHA-512 als Hashverfahren, d. h. TOTP <span class="math">\(value(K)\)</span> = HOTP <span class="math">\(value(K, C_T)\)</span>, wobei <span class="math">\(T\)</span> die „aktuelle Zeit“ ist.</p>
<p><span class="math">\(C_T = \lfloor { T - T_0 \over T_X } \rfloor\)</span></p>
<ul class="simple">
<li><p><span class="math">\(T_X\)</span> ist die Länge eines Zeitintervalls (z. B. 30 Sekunden)</p></li>
<li><p><span class="math">\(T\)</span> ist die aktuelle Zeit in Sekunden seit einer bestimmten Epoche</p></li>
<li><p><span class="math">\(T_0\)</span> ist bei Verwendung der Unix-Zeit <span class="math">\(0\)</span></p></li>
<li><p><span class="math">\(C_T\)</span> ist somit die Anzahl der Dauern <span class="math">\(T_X\)</span> zwischen <span class="math">\(T_0\)</span> und <span class="math">\(T\)</span></p></li>
</ul>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.rfc-editor.org/rfc/rfc6238">https://www.rfc-editor.org/rfc/rfc6238</a></p>
</aside>
</aside>
<div class="supplemental docutils container">
<p>Das Verfahren verlangt somit, dass die Uhren von Server und Client (hinreichend) synchronisiert sind.</p>
</div>
</ld-topic>
<ld-topic class="exercises transition-move-left" id="ubung">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="2" data-exercise-title="2 - S/Key" id="ld-exercise-2">
<p class="ld-exercise-title rubric">S/Key</p>
<ol class="arabic simple">
<li><p>Welche Vorteile bieten Einmalpasswortsysteme gegenüber Systemen mit mehrfach zu verwendenden Passworten?</p></li>
<li><p>Welchen Angriffen sind Einmalpasswortsysteme weiterhin ausgesetzt?</p></li>
<li><p>Generieren Sie eine Liste von Einmalpassworten mit Initialwert <span class="math">\(r = 769\)</span>. Generieren Sie <span class="math">\(H(r)\)</span> bis <span class="math">\(H^6(r)\)</span> wenn die Einwegfunktion hier der Einfachheit halber <span class="math">\(H(x) = x^2\; mod\; 1000\)</span> ist.</p></li>
<li><p>Wie oft kann sich der Benutzer anmelden? Wie sieht seine Liste aus?</p></li>
<li><p>Welchen Wert speichert der Server vor dem ersten Anmeldevorgang?</p></li>
<li><p>Spielen Sie zwei Anmeldevorgänge durch.</p></li>
<li><p>Wenn ein Passwort <span class="math">\(H^L(W), 1 &lt; L &lt; N\)</span> bekannt ist, welche Auswirkungen hat dies auf die Sicherheit des Verfahrens?</p></li>
</ol>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:fN4Z4Cs5byh7a0JNgFjv9HxgyVLEcvwbXVgFJmYgVkw=:BlirQwsirAJfOrrv:C6M/dYStAccUZ+uxkEHmhjzwDZh4xKxFd5+zEtF1FZ7q1hIlUoZv1MLZ9F5WOC8II+30jRtQQUWMMlyykePFTWgvV6V+IY7T72px6weaaY9KBehC8rc3IKhcRL529Rk0ntKw2uTZBleqmKFxRJ9H+P0BpvlBzTsAvbLKtcOrKa2DnzMixkjsCQpfVQSGAjhLIsO2TpO7wLZQViGPxEdiRClPnidmLIMDCptHl60VIWvtRlTUgFTUqw7ytt/VSRC2quVMpPSGd3OLcuCGU06V+A0JIRw5ClpCHsn8MrXuXPjsT90lrHQpAfWSucCkeOlopBDbGXcfHBNlc4ZrPhGgkDcgfSMthdnz2m32Qew9GFUTAeIXGZ2NYy8/9aMlIaVrle0ebomLZb+Mu6SEi8T5tN6dM7oGG8bunAR7rlG1T2/6MIS2FOaGo1CNltcuR+Hk6yK6NtGPbNeT0oUqyjJbwhVVEfgMZVvTfdnKfmFbxc7WTvBKqX+epQxYTfggiSt96s3CufWskIlACbrwPQRqgeJmg1M1YZtgCbWR5Pd1SzoJPmeL8UY16vwkBji01MdcSXAIE6K/pSNQXAiQqPba7JGhA7HRY5KMKwaYL8/rLo9ENA6lFLtRtjAfUdF3vy4KNGfxbzvVfECNyaBzbsvCsAaRNbJ2+qS1mcmYFfeZmJcjmqKGeNa7FospfRYiN+3sVrLBSXoFBvgw/X2PDSO0XsGv8HfTaKz5JKuAMSs+3vXtDRUJ2Y3jAVOyf9XzlkDqDZhh77LwS5e/fmBAoxu1p44i26U4dDe6IHMBerm/YN/CG/blK4/Jh21A4lRWJtVxhRtBlH60xuSfnZmifoxUPBonHy10NU16PKjAEyRBdRBlBUXYxsKeyye694ZbnJd6/HD6GmDItr3ZuWERf7tnGn1k1PwvfbWTwo1DQjG9gQELJDVVvQDwrTcxDI+3KwCAV0Z6VKuGQwUQrIQCRNPtxgd+nZk1rLbSAB0Epf4xuvVECJ+5qFsMgoROobg8lKUeywX3CwKDwOe5dWgL4agJnXr4cKWp2hqWpNWluK07VnEvs7hx//lM6NX2tjDQpxsaFhB5WGUdl714OlA0OkbpWi7WHO3lYN2TLRK0URFPl3K6/pcH+5EM2vpQgGVLuxP0FGKFhvc2PVdUgVYWwPr9IDOn5C4SLVvRKYmk+zRn+YK25rDGOkq6gjWZoKC/jTw9wl/sEhMymkf7UMWVyp1nKrKvuJ34y0j3Eo8K75DJBDYch3VY8sKlIHF7e0W7kEtYA1sHeMqLPX3J15FWqJt3Dvm6jKaWmEObpDotAv+UuE4Z4CQfVjHVw2YukAiHJ5zBW0Z7fwkYXVcyuXq7M5djn+JJ+nvLnr05dXf+sqe485Ns7afmrBl0whk5KBB3s34Nr46VT+iYk/IREEDBDzZ8xBwgi4C2KtDer5xpz+nGeji9YbAMi/2cEdpIV7CEhFvJES+tfYAR8qUAJXnUVV9IyrjHx9vWfG9xW4lCZSpnGiSlDRNQLsKXUPi2MNsUaDmZxwu40IYgI8rq5Rr/uCRymolviuqZDnAhqIa+mtXbKgAirMLnvGsNcRsvI7fWHEnlX/aOjtR+KYpuLLFyZKuD7I0V3IUXdBu1DGWFgwYJ9fks/HGUiss2yKBFvCgOvD5ymbhU7KQonMaf5oO9SrsLZ4ZrfUno9QPCIbi3oozShGmEYldc2q8ujT2oxIXyFZ/7VhbxGLLbNjQ0m2G23fBc3WXoj/A6r9/WOWjQT+KOvxZCTuCCWkMLO9aBmXFFl2AhFw==</div>
</div>
</ld-topic>
<ld-topic class="exercises transition-move-left" id="ubung-1">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="3" data-exercise-title="3 - HOTP" id="ld-exercise-3">
<p class="ld-exercise-title rubric">HOTP</p>
<p>Gegeben sei der folgende MAC:</p>
<table class="compact table-data-monospaced" style="width: 100%;">
<tbody>
<tr><th class="stub"><p>Offset</p></th>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>5</p></td>
<td><p>6</p></td>
<td><p>7</p></td>
<td><p>8</p></td>
<td><p>9</p></td>
<td><p>10</p></td>
<td><p>11</p></td>
<td><p>12</p></td>
<td><p>13</p></td>
<td><p>14</p></td>
<td><p>15</p></td>
<td><p>16</p></td>
<td><p>17</p></td>
<td><p>18</p></td>
<td><p>19</p></td>
</tr>
<tr><th class="stub"><p>Mac</p></th>
<td><p>bc</p></td>
<td><p>9f</p></td>
<td><p>aa</p></td>
<td><p>ae</p></td>
<td><p>1e</p></td>
<td><p>35</p></td>
<td><p>d5</p></td>
<td><p>2f</p></td>
<td><p>3d</p></td>
<td><p>ea</p></td>
<td><p>96</p></td>
<td><p>51</p></td>
<td><p>da</p></td>
<td><p>12</p></td>
<td><p>cd</p></td>
<td><p>36</p></td>
<td><p>62</p></td>
<td><p>7b</p></td>
<td><p>84</p></td>
<td><p>03</p></td>
</tr>
</tbody>
</table>
<p>Berechnen Sie den HOTP Wert für <span class="math">\(d = 6\)</span>.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:h68LVYZWNev+6iwuqM7UR+CFqjufgsZEJeWlPO1jz5s=:5Tdi/T+Ry/RzJhjz:P68T2utJ0P7MGPLxZbQseMLJbjFD13g+Ly5cGSIqlVNuYurqtmjR1yOW0/8qJ5PY2MkBtHW42yiUpDQtnAlI5h4DtF3FamMrkLPrM3FKzIuhCwm4POD2U4cdi3WUJR/JeOqdbCFbwEx2gn0fld160YLqqWz8Wq50DCpHY3yxkwnk1esIXb3mNmlrhLvdU+TDP4jllDr8w97RifrLi2rfL1MjnlSFvMBl1rIaJ6sd8aGGHNFylPB0kRaV9+LwnAhdkBnRObj1MG5l13/7VcUKL76Vtosq7JnPu/VWdSPb/iT7MDhzoCwOdfa5v0WGRj5X1MGQ9oC8AIbTXnks/IGa+suEftjLZc8w2U+JVQtlMPUStnAgronMudidpOx0Ir8pjb5jFE4KLF1+AfVzGuUpZw9zIMmp6jAA4h6D6JhZLdZ+B9oQ2dxwZhtOcNJdz787A7iOECzUbVA7YvIlNDkqGE4DLMx+V2Xg9teb4xwgEhFtCnWR94gNpizLJWmCzBIUrkORn3mx0vN8PTY3ke4YhLL0vg040UcfF4klYXwYqG0ahmGBxiAxRkFibGFFSrt2veZi9JwaH4PHQ5JRFWWZdfht8vV8l6969Wjb1Aj6lFCO5Y/migITrC4fjpGls3OiDrXjQVwGON/olDHlteBMooA5kdMi5QGdJpUamaDAEK5QJxHqNCDCP4dug1DSal43rUdB2o0rx0LN79dF9TXDazjNbJo/E4rq/SFXFe5iRR2Zp1Fh/UZ15ZxBxKckyJCpS/koEeyrXTTRPzJ7XXfnZRxljrrFUKEgrB5ZULR8NI2+I/Lo2Bzi4ED85A==</div>
</div>
</ld-topic>
<ld-topic class="exercises transition-move-left" id="ubung-2">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="4" data-exercise-title="4 - TOTP" id="ld-exercise-4">
<p class="ld-exercise-title rubric">TOTP</p>
<p>Identifizieren Sie die Vor- und Nachteile von TOTP gegenüber S/Key und fragen Sie sich an welcher Stelle es (aus Sicherheitsperspektive) mögliche Schwächen gibt?</p>
<p>Die Standardzeitspanne ist 30 Sekunden. Welcher Konsequenzen hätte eine deutliche Verlängerung bzg. Verkürzung der Zeitspanne?</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:EgLTFwgniGG5k0f0wBLuxZQ7is8+Qu5RBjE4IsSbi3c=:7dEGEDaXqqHHMrr8:NVQ/wygBNjgIzyyU5AD1dBMR3qdvI5+YIddZa732V1CONZNi0SPoCnwN9O8C4hWGjPUruIbAbYGW+uGNB6ovlORZ2S9YEo9C2O/nicw5zRIHdKSFWIZ2CMIXOU+RcfgjTUMrpL3NKZAif0RygB/f7cIGkzr+9I//Ld3lerCJY84HmsLuWGA+GTcrqX79lZxDBEG1F7O4xlGHSF6vdieycnQppFMG3cx2I2gSf/x0UTgqY8/X+BtcW/fPyKzlEAwxA2a+0LwVYtoQQ5xN1wh2Gr+6JkaobolDorpclEOmGnneyi3ku5HEDK1amZgWkLzhIWL6HidDj+vevFFBRvfcbvXhxqLO1gi/BWygCHUPQNa6u+D0LgIx+UuH53JSvRxwyiCfoN/eW+Xu/5ISEPYnQyvxUkDUNlOSqgE+PlvIckexQ4MtmxQed9Gtl/Kz0s1CP8JXu90f9gyXZ4fPMG9y03FXpWotxO7PbBvSz7/8vyo/h/Ojm0Ku/bV/YkCPyG2E+RRuBC/yqcC1x6hrBlVNN0Aj+hct2VAdx5pH3x2Ka2I0mKvgKVVbe7RwZKoj0qR4jwpUvtDOMyV4idOEJxZ3480tAaeA0lsTjGut2PaYs1VoI3/RxKDUcMYJmJ967ONXmjcViAAfKIVznE+/fdMr2Ln7RvUJwFtV6gIGD8xcWfif6tFWlPQ+dUBAlEQluz1s/wwSP9Uu5DH30LqefsOQi4+sHENMQFEjWcBmGuZmM4IB6SuXlfJwY2gE7G8IUy1Ed/IYbXRSBkEJBg/gJTMfjFd3QwRFVulB0k3Us1x5I4LozLvnn4ld0cwXJnZXF58pYfb4AAFXUabfFvb7MBopzFgQzmlOHf0nJAw10bYB2Dz849qb3YneIyFmFMnZ9d9UAckR2QHR/IF6YIOxtlHRkQNPuH0Hljkwxe0NLGfq9bqdIp8SeQIpi5pRTI0ODlpyFrOS90u6jcHnV8n/lo3YB6Hm/Xwofnemyku8QlmJfvvoNHdUcuDm7Yod1oh8VHnKz8R72PuLA2yh4GjQs05ZgXlzcLnYGrdlItNR+AgsGguEEnAm6+SohsQNb9eVgEFUD0B5MPgUMo5x9MVUhpyrWOlnC6H3CsJ+HiQAzv4HDA1Q9yON6hrCb7jrUA/cCj36PB/mx+CDApmB3cE5ZIbJ/ELifSYa/xWKSO/LPItFBaOzzCbYTIFZXkd5+6eMUVc+pzBVYNGyAFnMETJennFp0W8S/KHe9q2ySY2+GiSn+lSKiwOBaeenBVKVguZMoX3BzVIm2DUC85HUg5ajEDMjSNDE9eWhFYVV3PSNYnBljmLOzDx51ZgU4jPxsKdiElaZVW7QjuYbggA1D5zd2QfWJIWpB0P1bTOlfmYaQdYIa/j1y3w+X0SN6iDvdwRSET0Et4jM5CId+q8UYrKTM8bAoIBA/MqMJTXFQyq4FN2EEfBbEtlrZ2t21BUPfvPmQfZqADoeJD77VVrfmZbLJ2K9NivlqT+cEAPqu8ENAJ0BPwzzh4rx/zupGTw2kh1u0j/iXmlIFOzdtfbvYxHuen+NiAAhOVwhZ7ATetUq07EVAVe+vmm9oIWAvZ9YI5S8ZYqSwQvU1Dw=</div>
</div>
</ld-topic>
</template>
</body>
</html>
