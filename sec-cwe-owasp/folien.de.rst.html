<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;CWE&quot;, &quot;OWASP&quot;" name="keywords" />
<meta content="Verteilte Systeme" lang="de" name="description" xml:lang="de" />
<meta content="lecture-security-cwe-owasp" name="id" />
<meta content="last-viewed" name="first-slide" />
<meta name="version" content="LD2 RENAISSANCE" />
<meta name="exercises-passwords" content="MTAwMDAw:t2ciWfbXDyvjJR8l/+lNc4immPayWn5AkCwhwwURIH0=:7cr64M9C0QDguv8y:wyYtecSIIRszSmyjg0C2Ztm6tNVeWSXYoqzcoBsbUeiiNXh4X/XtROnnn3pMzdqeQt4yjMC9xckv3WBmUuOCi8LXHafjJmLl8K7jfyNYlrKfzYvHm8Ko14bSsD3i5MTIKk92rfHzWKVf+m6Ovn0JxsmdJ6UYUer7KGT+1g8I0xTs4qGBxkIV3z0jCVhcxsRP/8WsSG6HzMgUYwgOIwuty5WeQjEZkg74kxKm263hF/DPaN6OxOEwKb4V1OlVPShQSJouSsPPtyLhaDAtAjJ2RumjIbIERnfkmFwgGAHQBD0pL0H6nOLq37n4DElB/bRMjhPaunx07iJp+s+aqs+NSnoqJe6FhDDgbnM/5kkb7scqb95guejryQ0INGnvk83HwxtEp3iLk79EozH33RQ3jywV7QlPYQOk0CVWve9qG3hh9CSeaDejjFtRiFRXkVIHhftN1wwB1wLfpvxVtMSjGiGOGCzziQ2t1zBwQKdsuwGCXMJFRnX89JRpYAHlzLxt9KL/F8iRONA3/PTli8jAdoiau6z0yQvmLEruy4JQEkjoX2DuCDuUZ+8qODMVwugpcpbxjA+BbRS5bJI5+8Z2JN1DwwjpE/FXns5a9dZQ1D6yStK4yDbFXt2sK4/siMCFN9p9UMLLC87DfAFR/QaQrcjCo0LzyoRmP+8RjzD6RkAhp5I+jYvecphTh71HKtPbeNfJuS2m+uEp5gqsg4gVlsmdl+DGRRhVKB6E9MgKWHv31VlIQLDnA/1nzwj3MVhwDWe5XXIwDgrDJnPXuGZn5cJVIr6ZiQ2Fw8wtIOQx/zLgq1m9lGNEwjurAczOxaPrYsfMw3rKCZ90/Sle1lDFzqBWA76YowqLMM9vM12ILFvC8rYEUB5u7mW5qN4TXs9OCplPXC1FocymKJliDFJVUM4rG3cNZiexBr4Qvrb05zIlJRFkk9oR8C77MReZG/HnBpoNso7Qg2ArdXcDJmJ6CdVXpz4KjEwBdu9Zov/2Qam1UFiRhbDCTvuu/E4Pqf1icSvdVIhHaM96gcewRNU/JD6Oz0051oVe8S66PLGD/2TtuaauxzoHFh8WIFVDnKtzHJDkXvl4GIOldSPkgVgVLlyrM3ngSh0DtFMNc6NKmPXJobmqkp7oelxxaPyQjyAOsuUuWfr3QPfdWfgPuKUEQf1W1U3IfJ24ubAvPhzOEJ2WJTFFCNFp4ShCrmsAsTIsp8yAkfZu4ni29uNc7X7/xMCywPqa0/LyQ10Gbujqtz2aRTIJP5XlVgPpDrFWpFacpK221xsBaAWAMhBA5HfkOnhAmpBj3k9xE1NNbCqt7mgPbUhRGQP/v/TplYAG7cDJzpOGwpnWOTSUDngrVcdriStu1ShD2+XCpylhGK7tjibxSgIPGm+SYxcR0vkJfcCp1UDSZR9qR1vkYzXb77AuETyNy/+PoFp1r9yZBXsuDI1N7xoh6NurGTk+ic9PxaqxoSyPzja/GFDpK0sXQvF8JoBp+ICTL7Pyxc34fD9TAU1OrnqaR5KQkvu8sFHd/d7rkEy8IU+ceqX8RNAK3X7gkChEY7eAamoMNDvZDFVKvtifWSfgrIgxcfkG0Sh/YLpmUX2tVl5GYpD6VR9u2EccmdqGfitXgVy6TL3CF/mq5g6yjgWJ9BF3ArKwybBHtT3GS/mXqjJ/7Kev8K3hPMCGlAh8qmcRLcQpAVajCs3typJcy/a+/Z2O/Jwr8bAhHbDrWEkYp06Vln1YPmT6B2hpoWltIntqwIN5zlatGC8MZal06hjWs5z/wBEdaZ51Vt8DuQbgZIEUmXN1XZHhEa4ySuwnyh1EyuIqcW9fjsTqSWR1b878jFUl6j6IrMN5kD/pks/Y+OjC+2oqZP+j2lsMFR+gs5HgsULGPK9+H0hc1r2mROwbBNwCU3rsrBPmLRi/top+S9G3Tw4B7ImgCN9aLQNFC0PRuDkpzqXvkfjUebioDv2K+e0LEhKFx+NJ3KpHJI90kV13rvv7rfwUIRbWZJaz0HfqouXLEPdXyJ1yo2unTszK9ChlE/z8xLoyz7qOwe5oQRpRwB/5gpNXfv18YpgX0EVSVC0GuYOrvNG015jiuDigPLV+5wmoVEytY0+iRTIMRiTkCNRZwQQnivcffTRSOe2HpMccqJuYjCpDIhoef8z1UgXnZtEqDH8COuOoKt8TkwJFFeU2mQQIpYI4PWw4DkzXozrJ1OEAEZrkTLpLNVFJ3cgBzil99fBDKzEkH26wO3TkLJ+1t4DSy/5nC7sZpFDLu3XcIGxFfpdtx6ujB9fq8NgqytHmj+89tJfuKrn8R3Gwl01+jsaqqYsZNoc6uKUdyXgkoY9dqlWVsfszv3rqy7BZ/Vb33/vJ6K4NlGWP0WfdcgvRiJmCnC/Lgcd+X1OVPeX83yokdJkLlbF0qBFZnG8SQj3bKliOFS6RrRzcS+PzaXtTNACPTO+jcAmUOx8yZm2kjL5CVUr1A4ZUo3A0dLFNIXGvqtoQxZ3l75X/cstzxMjjxAhnuHejgfon6TInqI2rtDsAdCv9MtPJuttrWLa9FdQgL1OM5YMdhjC2ozaBPupFYAnBDMYU6mwjOwRlhUJyF+titxYRi3u53U2ByPbwDE8cDWvKmUiKjzBpGSl56y9LrpKJq5d3y87HaNSw4EZWLmnXxzF3FTAMTpjBQ4hWzIfXM2cIFInKbTauojyEo+QxKktqOo8pED7KQa+485o6XrWcSgqwV1qd5RI8tsjeqe4Rq6CKV0VPG424I+aUuk0rQu36u05jqGw9DKs/YLS3eVhrzeF94wTlcAp9erNYgttaDxkvYo83QW8mG8JwzQE11q5cMUlC2Q/26v7hMCfM7QeKpxI=" />
<title>CWE/OWASP</title>

    <script src="../LectureDoc2/src/ld.js" type="module"></script>

    <link rel="stylesheet" href="../LectureDoc2/src/ld.css" />

    
    <!-- As of 2024 it is not yet possible to use "layer" with linked stylesheets
         <link rel="stylesheet" href="../LectureDoc2/src/css/themes/dhbw.css" layer="theme" />
 -->
         <style>@import url("../LectureDoc2/src/css/themes/dhbw.css") layer(theme)</style>
    
</head>
<body>
<template>
<ld-topic id="cwe-owasp">
<h1 class="title">CWE/OWASP</h1>
<dl class="docinfo">
<dt class="dozent">Dozent<span class="colon">:</span></dt>
<dd class="dozent"><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt class="contact">Kontakt<span class="colon">:</span></dt>
<dd class="contact"><a class="reference external" href="mailto:michael.eichberg&#64;dhbw.de">michael.eichberg&#64;dhbw.de</a></dd>
<dt class="version">Version<span class="colon">:</span></dt>
<dd class="version">1.1.2</dd>
</dl>
<div class="supplemental docutils container">
<dl class="field-list">
<dt>Folien<span class="colon">:</span></dt>
<dd><p>[HTML] <a class="reference external" href="https://delors.github.io/sec-cwe-owasp/folien.de.rst.html">https://delors.github.io/sec-cwe-owasp/folien.de.rst.html</a></p>
<p>[PDF] <a class="reference external" href="https://delors.github.io/sec-cwe-owasp/folien.de.rst.html.pdf">https://delors.github.io/sec-cwe-owasp/folien.de.rst.html.pdf</a></p>
</dd>
<dt>Fehler melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div>
</ld-topic>
<ld-topic class="new-section transition-fade" id="relevante-schwachstellen-cwes">
<h2>Relevante Schwachstellen (<a class="reference external" href="https://cwe.mitre.org">CWEs</a>)</h2>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-787-out-of-bounds-write-memory-corruption">
<h2>CWE-787: Out-of-bounds Write (Memory Corruption)</h2>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write">
<h2>CWE-787: Out-of-bounds Write</h2>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Es werden Daten hinter oder vor den Bereich des Puffers geschrieben.</p>
</dd>
<dt>Programmiersprachen<span class="colon">:</span></dt>
<dd><p>C /C++</p>
</dd>
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Technische Auswirkungen<span class="colon">:</span></dt>
<dd><p>Speichermodifikation; DoS: Crash, Beendigung oder Neustart; Ausf√ºhren von nicht autorisiertem Code oder Befehlen</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-beispiel-1">
<h2>CWE-787: Out-of-bounds Write - Beispiel 1</h2>
<pre class="code c literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="comment multiline">/* Populate the id array. */</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">123</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">234</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">345</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">8 </small><code data-lineno="8 "><span class="whitespace"></span><span class="name">id_sequence</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">456</span><span class="punctuation">;</span></code></pre>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-beispiel-2">
<h2>CWE-787: Out-of-bounds Write - Beispiel 2</h2>
<div class="ld-exercise" data-exercise-id="1" data-exercise-title="1" id="ld-exercise-1">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">returnChunkSize</span><span class="punctuation">(</span><span class="keyword type">void</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="comment multiline">/* if chunk info is valid, return the size of usable memory,
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="comment multiline">     * else, return -1 to indicate an error
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment multiline">     */</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">()</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">memcpy</span><span class="punctuation">(</span><span class="name">destBuf</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">srcBuf</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">returnChunkSize</span><span class="punctuation">(</span><span class="name">destBuf</span><span class="punctuation">)</span><span class="literal number integer">-1</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:oyzhMXxBMknnPBqS06PATMp5JLtZrEdqW3tgNZ+H4b4=:ptpkGlJ1sdufE/jP:cQMi/HnvJuIlFVfSDbdtykHM3FtCjDCQr1/7L4iVxcfvMq+SiTk2cxreEdrhbMCZIJ3JBcx9GPTFu9v77p2l+DWLYrRFLYfOiKa024i3YCrnQZM1pdcaxyZ1CMGVCqHWZdpyMDVcImSx5yw4rhdfgm8CkBZ4ILNLJ9B/9ew6zyFv/XZQohddv8pEWLhjNp58JShT/L5GgPuwq0HhWTXMov3TZRxpUjaiOEynUbt6fwg3P0s7YSPW7tFjH3f3tt2hNUJxymuZV+RO8DFe3Jzx938VFebg/VeWaiSdsfR76434Dw==</div>
</div>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-beispiel-3">
<h2>CWE-787: Out-of-bounds Write - Beispiel 3</h2>
<div class="ld-exercise" data-exercise-id="2" data-exercise-title="2" id="ld-exercise-2">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">void</span><span class="whitespace"> </span><span class="name function">host_lookup</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">user_supplied_addr</span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">hostent</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">hp</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="name">in_addr_t</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">addr</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">hostname</span><span class="punctuation">[</span><span class="literal number integer">64</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">in_addr_t</span><span class="whitespace"> </span><span class="name">inet_addr</span><span class="punctuation">(</span><span class="keyword">const</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">cp</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="comment single">// function prototype
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="comment single"></span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="comment multiline">/* routine that ensures user_supplied_addr is in the right format for
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="comment multiline">       conversion */</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="name">validate_addr_form</span><span class="punctuation">(</span><span class="name">user_supplied_addr</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">addr</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">inet_addr</span><span class="punctuation">(</span><span class="name">user_supplied_addr</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="name">hp</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">gethostbyaddr</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">addr</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">in_addr</span><span class="punctuation">),</span><span class="whitespace"> </span><span class="name">AF_INET</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">    </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">hostname</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">hp</span><span class="operator">-&gt;</span><span class="name">h_name</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:v14Vz2AlMdTscngD4vxrRmRIY5tzh9EkPN7RytpVu08=:7qinA0LmmOAw/tT2:uicWn5OHGhHtneJjU9SF6Ff6c4LDh3CQ7urGQQ+/4tLysYXx863BMCYAE2ucjzIoJgLJAZ9q8nTHz83K/Mo25ZvIr7bIn0MVNLw6kOz0dn8UFx541/t7kE3nprTZ2l3dp1UJOleVsDG2fLoiipA5ShLFRh2xbtI97at2n/lto0qCi0sZvaUqdYN78kgG1jq24zV4dz2/JcUQYKmI/QKg9bVbFhWo61wXGVfBH30zlK1rCcX5DFOpr//+zoFnIiwFOi0ZIbu1F8kNEKssQlI/v86GJpf11BBBM73GXkAkiSE2NSaQ2eAgzcY5eMNj0S78KDTlf53wDF8tXxBfDp4MlWnBQO8IEvR4RaaEbeB7XbU7njHDdagZ8VV28E6tEpGiX1ddzH6l77gELKsNSYAoh6YqBlvEkKZatfsDicxmbqxqIlSpOxeQJ1gtaLDJhna4rCRMKgBcApDjBqfkG0VpYQ/PBw0I3HSx+pcXn+rf9/6IUSZt6MWFQP8E1YM8NisyS3dmggpH1PlPuHpOx3fX3z97Jdy2rlCXfCvI/A==</div>
</div>
<div class="supplemental docutils container">
<p class="rubric">Auszug aus der Dokumentation von gethostbyaddr</p>
<blockquote class="epigraph">
<p><strong>Return Value</strong></p>
<p>The <code class="c"><span class="name">gethostbyaddr</span><span class="punctuation">()</span></code> function return the <code class="c"><span class="name">hostent</span></code> structure or a NULL pointer if an error occurs.</p>
<p class="attribution">‚Äî<a class="reference external" href="https://linux.die.net/man/3/gethostbyaddr">https://linux.die.net/man/3/gethostbyaddr</a></p>
</blockquote>
</div>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-beispiel-4">
<h2>CWE-787: Out-of-bounds Write - Beispiel 4</h2>
<div class="ld-exercise" data-exercise-id="3" data-exercise-title="3" id="ld-exercise-3">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="name function">copy_input</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">user_supplied_string</span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">i</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">dst_index</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">dst_buf</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="punctuation">(</span><span class="literal number integer">4</span><span class="operator">*</span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="name">MAX_SIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">MAX_SIZE</span><span class="whitespace"> </span><span class="operator">&lt;=</span><span class="whitespace"> </span><span class="name">strlen</span><span class="punctuation">(</span><span class="name">user_supplied_string</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;string too long&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">dst_index</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="keyword">for</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">i</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">i</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="name">strlen</span><span class="punctuation">(</span><span class="name">user_supplied_string</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="name">i</span><span class="operator">++</span><span class="whitespace"> </span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">        </span><span class="keyword">if</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="literal string char">'&amp;'</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">user_supplied_string</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="punctuation">){</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'&amp;'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'a'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'m'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'p'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">            </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">';'</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">        </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">        </span><span class="keyword">else</span><span class="whitespace"> </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="literal string char">'&lt;'</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">user_supplied_string</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="punctuation">){</span><span class="whitespace"> </span><span class="comment multiline">/* encode to &amp;lt; */</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">        </span><span class="keyword">else</span><span class="whitespace"> </span><span class="name">dst_buf</span><span class="punctuation">[</span><span class="name">dst_index</span><span class="operator">++</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">user_supplied_string</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">17 </small><code data-lineno="17 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">dst_buf</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">18 </small><code data-lineno="18 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:EHjmucgtHzH29OXM+SG5bS4HTSK4ymvZorEsywEBfg0=:Kq5pcM7HsyjJh8S1:1UP4OcwkKfCKG1yzEp3us7dhBguZxTjJHW17/gmd+Sc8BWm/XUV0wrLkwaJplIENSDswsKrOElniLaBAdY/pJl4myCXXaAjwgK35dafLhZs75qa6J9HXp4aTNPZdu1Ud8z036NJ/t7dNH7s/Q5V2wMjvJFNsysnO463/edqZaOuaT5DThiC8crHu8HuIeZR0uyQ4TDXBgPURjRdE/YqHenYoLiQdQJSTEF9RwqvcRC24n+ZwqwZ9lBYxnyZrm0uDlAokc/Ki5hHjy3PnNbfuAV1kncw32cYkYTDhDW3Yo1PPRf4+Ij1cvG0bqPGkBTLbl5GbP1lA864GLpkOqOOPmxRU+f7co9MUI3Zz/SK506oDOjdVjnhJGqbn1Di1WIZzchYUwAY2Cetw9KbD</div>
</div>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-beispiel-5">
<h2>CWE-787: Out-of-bounds Write - Beispiel 5</h2>
<div class="ld-exercise" data-exercise-id="4" data-exercise-title="4" id="ld-exercise-4">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">char</span><span class="operator">*</span><span class="whitespace"> </span><span class="name function">trimTrailingWhitespace</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">strMessage</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">length</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">retMessage</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="name">message</span><span class="punctuation">[</span><span class="name">length</span><span class="operator">+</span><span class="literal number integer">1</span><span class="punctuation">];</span><span class="whitespace">                    </span><span class="comment single">// copy input string to a
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">index</span><span class="punctuation">;</span><span class="whitespace">                                 </span><span class="comment single">//      temporary string
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">for</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">index</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">index</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="name">length</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">index</span><span class="operator">++</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">//
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">message</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">strMessage</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">];</span><span class="whitespace">    </span><span class="comment single">//
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="comment single"></span><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">                                          </span><span class="comment single">//
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="comment single"></span><span class="whitespace">    </span><span class="name">message</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'\0'</span><span class="punctuation">;</span><span class="whitespace">                     </span><span class="comment single">//
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="comment single"></span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">len</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">index</span><span class="literal number integer">-1</span><span class="punctuation">;</span><span class="whitespace">                         </span><span class="comment single">// trim trailing whitespace
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">while</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">isspace</span><span class="punctuation">(</span><span class="name">message</span><span class="punctuation">[</span><span class="name">len</span><span class="punctuation">]))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">            </span><span class="comment single">//
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">message</span><span class="punctuation">[</span><span class="name">len</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string char">'\0'</span><span class="punctuation">;</span><span class="whitespace">                   </span><span class="comment single">//
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">len</span><span class="operator">--</span><span class="punctuation">;</span><span class="whitespace">                                 </span><span class="comment single">//
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="comment single"></span><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">                                          </span><span class="comment single">//
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="comment single"></span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace">    </span><span class="name">retMessage</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">message</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">17 </small><code data-lineno="17 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">retMessage</span><span class="punctuation">;</span><span class="whitespace">                         </span><span class="comment single">// return trimmed string
</span></code><small class="ln">18 </small><code data-lineno="18 "><span class="comment single"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:7FwPO/nfry5zz34+rOdYCoMVMZRi+xzx8oFndsP70pg=:XQAYbwTH73Eg3ARu:Kg/NsSkIuVc4QBV5RprNGWNqrkp3RyVuyQ30mPDzDPV0Ae9rFmeeomXQKt5od8Ml7ftRTvToQhE3l3Kc8IGw/+LM0SrxYV7roG2hIqb1BuLcGNoy+xY01qSJeXFtuMLu2xNOuyy80Ip/X5PkbuIcnLxjICI72/Z49i3fgqCG0r6gxc061lpCsgl5zF7+EbIt4DzNiQk+zVQrEluc1ZAwErYdAA1aO2AcI6yImTqmisZSLjV+mLgRQjKmKLotrmwBHaXvk1MLWHfoGq1dhDbOlEhGUBQwSMAedFs+tI7oFonbPs5CK6nzGAZtxMko6FRyMEhHKKE=</div>
</div>
<div class="supplemental docutils container">
<p class="rubric">Auszug aus der Dokumentation von isspace</p>
<blockquote class="epigraph">
<p>If an argument (character) passed to the isspace() function is a white-space character, it returns non-zero integer. If not, it returns 0.</p>
</blockquote>
</div>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-beispiel-6">
<h2>CWE-787: Out-of-bounds Write - Beispiel 6</h2>
<div class="ld-exercise" data-exercise-id="5" data-exercise-title="5" id="ld-exercise-5">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">i</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="keyword type">unsigned</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">numWidgets</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="name">Widget</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">WidgetList</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">GetUntrustedSizeValue</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">((</span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">||</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">&gt;</span><span class="whitespace"> </span><span class="name">MAX_NUM_WIDGETS</span><span class="punctuation">))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="name">ExitError</span><span class="punctuation">(</span><span class="literal string">&quot;Incorrect number of widgets requested!&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="name">WidgetList</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">Widget</span><span class="whitespace"> </span><span class="operator">**</span><span class="punctuation">)</span><span class="name">malloc</span><span class="punctuation">(</span><span class="name">numWidgets</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="name">Widget</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;WidgetList ptr=%p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">WidgetList</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span><span class="keyword">for</span><span class="punctuation">(</span><span class="name">i</span><span class="operator">=</span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">i</span><span class="operator">&lt;</span><span class="name">numWidgets</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="name">i</span><span class="operator">++</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="name">WidgetList</span><span class="punctuation">[</span><span class="name">i</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">InitializeWidget</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span><span class="name">WidgetList</span><span class="punctuation">[</span><span class="name">numWidgets</span><span class="punctuation">]</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name builtin">NULL</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace"></span><span class="name">showWidgets</span><span class="punctuation">(</span><span class="name">WidgetList</span><span class="punctuation">);</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:V2PBUt7/LX/sLO5DmLZN+6/w+LfH4cUnacl5KWNEyow=:mRUfnM1de3RvE28A:LxUuLr52H8gmNEjRrkNJDcjv5Lt+FAOOjgrRrl9k6/4ZZF1l3HTMSY6vLE0wZtZsP9G2mHrNdoo+AnhESYCMMkFmOy+lKWaC4+gACefcbB+bgbuQjhZ708N/l11W0FZvOyBJzH3xbXoaSyDpdA6MheVpeOsq6l2ndOY5D/bVcR+tcdOukBZ2fmIALfCEIFFQkjh/EB7kqCM1W13K2F+2WsVIdheqpTa0xZZNcyNXyfpKDstl5k+GLqdq0dskMgOJrYgY1H3rU/4tOyvh9/z3i/AsGOYddvZV4DwjnISzmqWrD3ueEtZyxSz7JtVqstCv8HZj4pAcyQafoTycFAu/Qtk=</div>
</div>
</ld-topic><ld-topic id="cwe-787-out-of-bounds-write-mogliche-abhilfemasznahmen">
<h2>CWE-787: Out-of-bounds Write - M√∂gliche Abhilfema√ünahmen</h2>
<ul class="incremental-list">
<li><p>Verwendung einer sicheren Programmiersprache (Java, Rust ...)</p></li>
<li><p>Verwendung von Bibliotheken, die sicher(er) sind (z.‚ÄØB. <code>strncpy</code> statt <code>strcpy</code>)</p></li>
<li><p>Kompilierung mit entsprechenden Flags, die entsprechende Pr√ºfung aktivieren (z.‚ÄØB. <code>-D_FORTIFY_SOURCE=2</code>)</p></li>
<li><p>Kompilierung als Position-Independent-Code</p>
<p><span class="peripheral">Dies l√∂st nicht das Problem, aber es macht es schwerer eine Schwachstelle auszunutzen.</span></p>
</li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Dynamische Analyse Werkzeuge (z.‚ÄØB. <em>Fuzzing</em>, <em>Fault Injection</em>, ...)</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-79-improper-neutralization-of-input-during-web-page-generation-cross-site-scripting-or-xss">
<h2>CWE-79: Improper Neutralization of Input During Web Page Generation (<em>Cross-site Scripting</em> or <em>XSS</em>)</h2>
</ld-topic><ld-topic id="cwe-79-improper-neutralization-of-input-during-web-page-generation">
<h2>CWE-79: Improper Neutralization of Input During Web Page Generation</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Nutzereingaben werden nicht oder falsch bereinigt, bevor sie in die Ausgabe eingef√ºgt werden, die als Webseite f√ºr andere Benutzer verwendet wird.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Technische Auswirkungen<span class="colon">:</span></dt>
<dd><p>Speichermodifikation; DoS: Crash, Beendigung oder Neustart; Ausf√ºhren von nicht autorisiertem Code oder Befehlen</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Zugriffskontrolle, Vertraulichkeit</p>
</dd>
<dt>Typen<span class="colon">:</span></dt>
<dd><p>Stored XSS (Typ 2), Reflected XSS (Typ 1), DOM-based XSS (Typ 0)</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Durch eine XSS L√ºcke werden h√§ufig Informationen abgegriffen (z.‚ÄØB. Session Cookies). Allerdings ist es ggf. auch m√∂glich, dass der Angreifer die Session des Nutzers √ºbernimmt und sich als dieser ausgibt.</p>
</div>
</ld-topic><ld-topic id="stored-xss-typ-2">
<h2>Stored XSS (Typ 2)</h2>
<object aria-label="Stored XSS" class="align-center" data="images/xss/stored-xss.svg" role="img" type="image/svg+xml">
</object></ld-topic><ld-topic id="reflected-xss-typ-1">
<h2>Reflected XSS (Typ 1)</h2>
<object aria-label="Reflected XSS" class="align-center" data="images/xss/reflected-xss.svg" role="img" type="image/svg+xml">
</object><div class="supplemental docutils container">
<p>Reflected XSS ist h√§ufig schwerer auszunutzen, da der Angreifer den Nutzer dazu bringen muss, einen Link zu klicken, der den Angriffsvektor enth√§lt. Bei Stored XSS ist dies nicht notwendig, da der Angriffsvektor bereits auf dem Server gespeichert ist.</p>
</div>
</ld-topic><ld-topic id="dom-based-xss-typ-0">
<h2>Dom-based XSS (Typ 0)</h2>
<object aria-label="Dom-based XSS" class="align-center" data="images/xss/dom-based-xss.svg" role="img" type="image/svg+xml">
</object><div class="supplemental docutils container">
<p>Dom-based XSS ist am schwersten Auszunutzen, da der Angreifer den Nutzer dazu bringen muss den Schadcode in die Informationen einzubringen, die von dem Script verarbeitet werden (z.‚ÄØB. durch das Eingeben in ein Formular).</p>
</div>
</ld-topic><ld-topic id="cwe-79-xss-beispiel-1-xss-typ-1-php">
<h2>CWE-79: XSS - Beispiel 1 - XSS Typ 1 (Php)</h2>
<div class="ld-exercise" data-exercise-id="6" data-exercise-title="6" id="ld-exercise-6">
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other"># R√ºckgabe einer Willkommensnachricht basierend auf dem
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other"># HTTP Get username Parameter
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">$username = $_GET['username'];
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">echo '&lt;div class=&quot;header&quot;&gt; Welcome, ' . $username . '&lt;/div&gt;';</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:sPU03SO+14vQnZ7ohW5JJfA79fA0Ulg92JoAdFD5nDY=:+4ki/IKlVmeCuN5V:+kH0gSgZm4RujDm98t4UhhMocD9z2HBOAU8C6gBS0EMUFFdUPdVgqHCYWvD1rGHmorXpLhauVPTQrdORzNHOCiT/R/2UuoEX6gGjDLjPn3cabkQILMkrsY2y3fPVoMzxTsm2xR7yfC7jzEuYUmQ4g9Os0kinH6/NeAgS6dLWQm69GRMTc1myN+XrTE9VcMQpLfyIfEkfpXgcNh+4KnW+P920WVcLM/Blqen7fVFB7Kj8x5mweDxsG/N7N+4XyYooRqSMGoQtuPFt92jZ2/rpcot1v3eNdPo+H4SNkQLICEAhwukBAApVSwM2/UImp4git1mvA3v9RAc5VFnWfd3fDaz+F8fxwNXGbc5M5YYurMurK+KErjDCh9odZlUg+QSG8TvuAxznc2XOTxo02pbF9QzVeTAzRnVLvh3VHIZ6igDV/gcbwnEPtVMyTnGriRJCrw1GfpcUCcHdw9zsivMJeYomphn306VvGFCq+XgXRwsEcoYgBxFoL98/HBEeshoTbdj0y/OZPbAeTw7RtrXvoYRV6E0wT+64MpGf6w0R+ZMbRevY+2ne5/v8IRU95BV0kxNJRxmxpP+ygl7wS+4AzDxgneAieIpbo2KoqNYQoAsEF/DDXleKOrkCOzz/w18QEYpuuLPxRbPWPeUHE+t0gxZDUOjN5fIKZHIJy4SwsTBH/b2MJ1RAGraRASWy4N8Tm2GPnG4qslrs9pgARn6+d2fiqCDM6z9SYAa3HlWs7hDlyrAO6el0n7oG2vxCVpGQk3AeWUFfsAcHoG6VZGgGEg==</div>
</div>
</ld-topic><ld-topic id="cwe-79-xss-beispiel-2-xss-typ-2-jsp">
<h2>CWE-79: XSS - Beispiel 2 - XSS Typ 2 (JSP)</h2>
<div class="ld-exercise" data-exercise-id="7" data-exercise-title="7" id="ld-exercise-7">
<pre class="code jsp literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">&lt;%</span><span class="whitespace">  </span><span class="name">String</span><span class="whitespace"> </span><span class="name">eid</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">request</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;eid&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="name">Statement</span><span class="whitespace"> </span><span class="name">stmt</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">conn</span><span class="punctuation">.</span><span class="name attribute">createStatement</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">    </span><span class="name">ResultSet</span><span class="whitespace"> </span><span class="name">rs</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">stmt</span><span class="punctuation">.</span><span class="name attribute">executeQuery</span><span class="punctuation">(</span><span class="literal string">&quot;select * from emp where id=&quot;</span><span class="operator">+</span><span class="name">eid</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">rs</span><span class="whitespace"> </span><span class="operator">!=</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">        </span><span class="name">rs</span><span class="punctuation">.</span><span class="name attribute">next</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">        </span><span class="name">String</span><span class="whitespace"> </span><span class="name">name</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">rs</span><span class="punctuation">.</span><span class="name attribute">getString</span><span class="punctuation">(</span><span class="literal string">&quot;name&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="keyword">%&gt;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span>Employee<span class="whitespace"> </span>Name:<span class="whitespace"> </span><span class="keyword">&lt;%=</span><span class="whitespace"> </span><span class="name">name</span><span class="whitespace"> </span><span class="keyword">%&gt;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:C4/tVReqz7GPgwvqsg7oQqVgNh5CBalAnKXkcuahCss=:rristvk9k9qh8/SY:XkZoLB5QBTSzRwHSN801tChwvorXqpTp7nIFCIDedPgO2r5zU/5wPLQl2DbSrPP+gmNUOkwYI3WfQHfwFSw0ZOunxu+ukBC7ylT1Dr6906dARGRQ33SnDr4MW9tmI4joPbO+3Pi2hTLPF5O7Vs2buhWiD1piMzetB2MAdjzVh0s0jyrNMdVUL+fVWhqokKFu9eyfWm6bGKD+a3YvynMJbIj4FZ2djO247aWWTbK0of3FXZ+/G3d+6Wdo+rEkfbE0VpYZZGJRweT5lB5bdJAixitgj747494KLJNGPS0wnJYiq+Wv87b8VWNPyYSmMGN3Z1ZtmLOCj0TLO6PKce6+4psMEf6SvonpvrphqoLqApe0LNkx2kJ/D0TAeiquVD4n1f5btIQWUa6YwrK5WoFzLkpNrWVfDn9niD/OprKuQ/ZM68TC0/7nVGTMrfvpOyfVMnSk01lzTw75WjfpVq21To8OiCR77y6lh1kfly8lxnmfEPcS1/5SXbrlC79lFjbK5T9CuvEAYAUfOshLex45oplnXcl+YZiJuc6QFq48P2SOJOoFwZIYjPHtrCDHoNZan8dzUnoVYcY2QZTFeIL/yQ8mnZOY1hkssaeics5jaPghgm9VAUySAxYCZeODZ1LxZbqx9Xjga7gxPsD8ktu7rguDzhjIQ+v6L+GRA89yMhhX6CqL4UmM6TCFduQwYi/FStPCpSmYnSJ4wXslXdPMTPyWC1Fxtw9nsvflrPIyn1nIppiXGN1y0kOiBaTZbjktX2u7B6Bz8rbJowOGFg==</div>
</div>
</ld-topic><ld-topic id="cwe-79-xss-beispiel-3-xss-typ-2-php">
<h2>CWE-79: XSS - Beispiel 3 - XSS Typ 2 (PHP)</h2>
<div class="ld-exercise" data-exercise-id="8" data-exercise-title="8" id="ld-exercise-8">
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">$username = mysql_real_escape_string($username);
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">$fullName = mysql_real_escape_string($fullName);
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">$query = sprintf('Insert Into users (uname,pwd,fname) Values (&quot;%s&quot;,&quot;%s&quot;,&quot;%s&quot;)',
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">                $username,
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="other">                crypt($password),
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="other">                $fullName) ;
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="other">mysql_query($query);
</span></code><small class="ln">8 </small><code data-lineno="8 "><span class="other">...</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:avSgpUlE6jQrt9VkKfgBgT1uDpAYzfqLF0fswE1VJK4=:Mn5jRO5etBmJIleu:v1mYXfiiVcoJCbf2SrhI1eOFUZU2xyvMkvMXBGMRTAsle+cLx7LXOsyDYYjgCspsMJ8OsLhEv2RvsFKJ+edbXgbpuGu65Iw8sXCfCHQoeTiQiakjur/ddZUxqbYggkodVLiAXm753irNA4cvdDwU1YiaLwMkazd9RjHAS74L6Z4Zz/3pNEpXWs+U47TgHXUJVlKlKm26jV0xulH1BEfX/soweWMimT3KJchjz1USOInFJgtDzdfictzsvVs4egpOEUqNUz/QbYVN/lyBVkx2jFo3wAflZCAM9BWcgY8tXdIgfAkqfxLv4co3l+xi2O01cw1DV8tD/GTmUKWjdvSPLaIF7sVqd9oyKNQSFrqUiYgoJceij8m3qoUhOUW3+DpsOtu1aOQB7225XYuV/DizRsfJ8o8xiFblcRWeHI4b29GjK5K5s2gnZlG85uU0WVwcxsS9tOaJj4jFWU4dHo8CyiQfShAn4fc6USEDojWdPXfezVqEHzwJBaQDVYEDQtx+MW2gzarNAzHogovouZPgbNhsUSEwrJ49N86dNWXcNCcs</div>
</div>
</ld-topic><ld-topic id="cwe-79-improper-neutralization-of-input-during-web-page-generation-abhilfemasznahmen-und-erkennung">
<h2>CWE-79: Improper Neutralization of Input During Web Page Generation - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list list-with-explanations">
<li><p><strong>Pr√ºfe jeden Input</strong></p></li>
<li><p>Pr√ºfung, dass alle auf dem Client durchgef√ºhrten Pr√ºfungen auch auf dem Server vorgenommen werden</p></li>
<li><p>Verwendung von gepr√ºften/sicheren APIs</p></li>
<li><p>Verringerung der Angriffsfl√§che mit dem Ziel m√∂glichst wenig Daten in Cookies etc. zu speichern</p></li>
<li><p>Verwendung von HttpOnly Cookies (d.‚ÄØh. Cookies, die nicht √ºber JavaScript ausgelesen werden k√∂nnen)</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Beherzigen von Best Practices (<a class="reference external" href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">XSS Prevention Cheat Sheet</a>)</p></li>
<li><p>Setzen der CSP (Content Security Policy)</p>
<p>(Dies l√∂st nicht das Problem, minimiert aber ggf. die Auswirkungen!)</p>
</li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-89-improper-neutralization-of-special-elements-used-in-an-sql-command-sql-injection">
<h2>CWE-89: Improper Neutralization of Special Elements used in an SQL Command (<em>SQL Injection</em>)</h2>
</ld-topic><ld-topic id="cwe-89-improper-neutralization-of-special-elements-used-in-an-sql-command">
<h2>CWE-89: Improper Neutralization of Special Elements used in an SQL Command</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Ein SQL-Befehl wird ganz oder teilweise unter Verwendung extern beeinflusster Eingaben von einer vorgelagerten Komponente erzeugt. Dabei werden aber spezielle Elemente nicht oder falsch bereinigt, die den beabsichtigten SQL-Befehl ver√§ndern k√∂nnten, wenn er an eine nachgelagerte Komponente gesendet wird.</p>
</dd>
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Technologie<span class="colon">:</span></dt>
<dd><p>Datenbanken</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Zugriffskontrolle, Vertraulichkeit, Integrit√§t</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-89-sql-injection-beispiel-1-ms-sql">
<h2>CWE-89: SQL Injection - Beispiel 1 (MS SQL)</h2>
<div class="ld-exercise" data-exercise-id="9" data-exercise-title="9" id="ld-exercise-9">
<pre class="code sql literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword">SELECT</span><span class="whitespace"> </span><span class="name">ITEM</span><span class="punctuation">,</span><span class="name">PRICE</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">    </span><span class="keyword">FROM</span><span class="whitespace"> </span><span class="name">PRODUCT</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="keyword">WHERE</span><span class="whitespace"> </span><span class="name">ITEM_CATEGORY</span><span class="operator">=</span><span class="literal string single">'$user_input'</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="keyword">ORDER</span><span class="whitespace"> </span><span class="keyword">BY</span><span class="whitespace"> </span><span class="name">PRICE</span></code></pre>
<aside class="admonition incremental margin-top-2em larger warning">
<p class="admonition-title">Warnung</p>
<p>MS SQL hat eine eingebaute Funktion, die es erlaubt Shell Befehle auszuf√ºhren. Diese Funktion kann auch in einem SQL Statement verwendet werden.</p>
</aside>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:XCc1S7qLgmbgEoWOvxXUDSwDbOQL8lhJHhQojhLGGaE=:xWiXHXyVSgjQ0RWL:e/r22gCbGwnfAcYLqR3VCIFBH1pWyXjUOy9yKkb/dpCJ8Dnyi5VWz2knCMJUO/Z7sd4p+uzk2SLSONYLWsAmyAQTqelIwLmrsr7VLFE/XJ45+pUYcynmJHtfKB9aT6/rwohXtbp9heGHjfFv9JR7APaw0dT0FXIsQmfu+mc8a/TuJFBMuEqp7e1zUglPxUWV1j24F6nYKg==</div>
</div>
</ld-topic><ld-topic id="cwe-89-sql-injection-beispiel-2-php">
<h2>CWE-89: SQL Injection - Beispiel 2 (PHP)</h2>
<div class="ld-exercise" data-exercise-id="10" data-exercise-title="10" id="ld-exercise-10">
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">$id = $_COOKIE[&quot;mid&quot;];
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">mysql_query(
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">    &quot;SELECT MessageID, Subject FROM messages WHERE MessageID = '$id'&quot;
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">);</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:h7tcyaOwd3OSqi7O3HVVNvflF/5mPkbuYJB403FP4Bc=:XPXusKURWsMfqmhk:Gbq0EPDTz57cddSAwkLYAeqTAz9oRbEwwHeVWhhhaih4rQYShVbr99FRe2zik3VXXKVmp/Xrbb068h7n/gGet9l/HyuZlaLD+vNPgjLup0mMzOBh+NItXjZttc51jZxXH5SjivIhG7H+V6tmFLPlr51jnZ5kuLFzA8qKBTJRghRRk6SYhiE48JjVDn0rUGmJiuUMZiFZyE3HHd/V1aFvcimSpnN82C/NRatUlZgIZF2FP452ZNKUbmmf8guyvf5MMa5uhdDJXtk/kr2bCKqyIk7L7W14nOjPPCAwz/orsOP91oORukeffnXIhjtwZcuh4Bh300O3bTLZi+Q9n0Ljj3QqQ+nwlFcEA0ZSsnnvD1/ejX06yuzNvJg9RWmSac4Sj1Ah6we288+X+MODU/3XRsUtSFnrFYMhaOfDJ+tuXVgZ5C2tu3OtGkB+u+y23RokRlvtE2PBdfUwxxwCe6sK4gsMRf8PDDu2wV5OTccT2f0Eu4eEYnVqfVEt3t0/SA0r</div>
</div>
</ld-topic><ld-topic id="cwe-89-improper-neutralization-of-special-elements-used-in-an-sql-command-abhilfemasznahmen-und-erkennung">
<h2>CWE-89: Improper Neutralization of Special Elements used in an SQL Command - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list list-with-explanations">
<li><p>Verwendung von gepr√ºften/sicheren APIs</p></li>
<li><p>Verwendung von <em>Prepared Statements</em></p></li>
<li><p>Datenbank nur mit den notwendigen Rechten betreiben</p>
<p>(<em>Principle of Least Privilege</em>)</p>
</li>
<li><p>Sollte es notwendig sein einen dynamischen SQL Befehl zu erstellen, dann sollten gepr√ºfte Escapefunktionen verwendet werden</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>ggf. Application-level Firewall einsetzen</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-416-use-after-free-uaf">
<h2>CWE-416: Use After Free (UAF)</h2>
</ld-topic><ld-topic id="cwe-416-use-after-free">
<h2>CWE-416: Use After Free</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Referenzierung von Speicher nach der Freigabe kann dazu f√ºhren, dass ein Programm abst√ºrzt, unerwartete Werte verwendet oder Code ausf√ºhrt.</p>
</dd>
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Programmiersprachen<span class="colon">:</span></dt>
<dd><p>C, C++</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Verf√ºgbarkeit, Vertraulichkeit, Integrit√§t</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-416-use-after-free-triviales-beispiel">
<h2>CWE-416: Use After Free - Triviales Beispiel</h2>
<pre class="code C literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword type">char</span><span class="operator">*</span><span class="whitespace"> </span><span class="name">ptr</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">SIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">err</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">  </span><span class="name">abrt</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">  </span><span class="name">free</span><span class="punctuation">(</span><span class="name">ptr</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<pre class="code C incremental literal-block"><small class="ln">6 </small><code data-lineno="6 "><span class="comment single">// ... somewhere else in the code
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="comment single">//    char* otherPtr = (char*)malloc (SIZE);
</span></code><small class="ln">8 </small><code data-lineno="8 "><span class="comment single">//    otherPtr* = &lt;HACKER CONTROLLED VALUE&gt;; ...</span></code></pre>
<pre class="code C incremental literal-block"><small class="ln">10 </small><code data-lineno="10 "><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">abrt</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">  </span><span class="comment single">// Next: use of ptr after free which uses the hacker controlled value
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="comment single"></span><span class="whitespace">  </span><span class="name">logError</span><span class="punctuation">(</span><span class="literal string">&quot;operation aborted before commit&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">ptr</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<aside class="admonition hint">
<p class="admonition-title">Hinweis</p>
<p>Ziel ist es im Allgemeinen eine Referenz auf einen interessanten Speicherbereich zu erhalten, der bereits freigegeben wurde und dann den Inhalt dieses Speicherbereichs auszulesen bzw. zu manipulieren, um die n√§chste Verwendung zu kontrollieren.</p>
</aside>
</ld-topic><ld-topic id="cwe-416-use-after-free-beispiel">
<h2>CWE-416: Use After Free - Beispiel</h2>
<div class="ld-exercise" data-exercise-id="11" data-exercise-title="11" id="ld-exercise-11">
<ld-grid class="default-layout">
<ld-cell style="align-self:auto;">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdlib.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;string.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="comment preproc">#define BUFSIZER1 512
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment preproc"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">argv</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf1R1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf2R1</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf2R2</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="name">buf2R1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="name">BUFSIZER1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;buf2R1     -&gt; %p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="name">free</span><span class="punctuation">(</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;[FREED]       %p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="name">buf2R2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="name">BUFSIZER1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">    </span><span class="name">strncpy</span><span class="punctuation">(</span><span class="name">buf2R2</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">],</span><span class="whitespace"> </span><span class="name">BUFSIZER1</span><span class="literal number integer">-1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;buf2R2     -&gt; %p</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;buf2R2     =  %s</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace">    </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;!!! buf2R1 =  %s</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="name">buf2R1</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">17 </small><code data-lineno="17 "><span class="whitespace">    </span><span class="name">free</span><span class="punctuation">(</span><span class="name">buf2R2</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">18 </small><code data-lineno="18 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
</ld-cell><ld-cell style="align-self:auto;">
<p><strong>Fragen</strong>:</p>
<p>Wird dieses Program bis zum Ende laufen oder abst√ºrzen?</p>
<p>Welche Ausgabe erzeugt das Programm?</p>
<p>Ist die Ausgabe bei jedem Lauf gleich?</p>
</ld-cell></ld-grid><div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:uJQB2ecWQKmOGBE61qQS8CgKgzKNAe3MlOlZl8ibiOs=:yEqMWPj4AX7EW5Ph:792AmsiczdrTKO9rOxhVdddbPaUO8eRBEKBAGK2tEHt6Lf80mwdQgkQM//n/ZHL2+Hm8SNJfhIFkzlnKRR25TqKgrS3g59m9Mbx7Z97ZntEOIwWQoUTxbK+N+Q28/eFpIgsquj6kFQsMicYKSlTYsgM2udr0L3adavSjsovm/nLCTV0wWipvTPpo2gnjtiUQnn18ahFGLeUirWwVAIBSA1F/6c0RVWHLSbnr51DHIFreGFX3tzdAnSzTsjPJ2XzDAxjz1BalyV+V2pEClCt4Z+SrDrt9VjbmagSL2fDkDUZvGJ0qfXIhqg03VIZks2NT3OWRWRoAwe9trXlVOiofyKPz5/JhxKKm/T3NtbDvDNkowO9BFkZqwveWbi9Sr//cgAEXt8+62gBMKXZUNaDTd71R18h2+nQNOXrJuRES5WfbLIUBXYpwVr2/Cm+gzDJMMPxsWgLl2WttPyaTxfVTFxfFzD4CaoXjnDz34M83od6R2+skp4blOzUxSsDQ29JwwFtd0COdB9PSOGhkUHxEF7pSpNnN3r3fYXaytvFfntR8MDpBjgYKMml0Tuc4WB6kUJ91b98TCFHfUquDi3MlC02NXBajGJjVpbnfVma4IcTMkRsGks1uYjwjfUzqy7LJXedUrwAStW0aAazHnyOo7KhgZY2qG2KvCpJZSzo+tlDDn6T1wlAYPhU6YC9smfT0/fN7P/qA3y8QuDtfWeCrkTDUKq4cBx6FPlZAsqIactI19zaOOZQIXRPriVpgP6GDcaVBPcQ184P4Y1pQv3RD1g0kT36wYxAfRx4t6oGg9Nvsm3Tyr6qsLykhNys+O7KODcW84cldjV2brRA00a9tj+dw3/OPgm/Wu47rkdZc2E+uEuuUjxJh573ke5HiFLnzZxoXsvKXbEz86AkXA1+fJJiLda526XEgpFOUuKpFh5qM7X8b8fSAnjL3HXK5V/bowuTIllVp0+Z56f+8fo3T6e2pjoIp1zbP952yosOHx+aHMUoXit5tG22KkA7N7dAUosZO/xosLwKEiWTzkwVqZDaHfTGTnWwxW0x5nfzZTU6T92OEeTEiOtdE76qARoPt4px82rE6n/DGc/encaJXyz6m6mNgvPv/n8cBI6YqQ/sdrrOPXYNEN18k/axOiKxD82YDKvqInrXKzWJwNyJrSuK8Dyn+rAyw9Zlapp9tgGQkvsxPSUCG3o6IrdW9dBbSyEr7hlHkex4f9FYDysd+eTUi5603fqDOjW/NeW6cW2LiYAn3LEWribyup+jqw4JATogSdWTlsvefFKYSfRoc2n+fKX5Kjbus8aoNJq5ddLpbIvJOJBc0qDHSpKu09gKfrKmnLjaeOy73J2OGisEakZYK3EaJlD26KeUvxC+KxrNSBfxCGFj+ypjrmNMWtcxJfSMQZe0oyf2sxHzDoWJQ3n5xWVrQHe9YWtzoFrQ7STh/j+FzL8/zNMNP8oexWGBh2vZJgLjngvdMYqzc9rljVM4NLZbrEcVLfXg9Ub3nVOvdX2C+mQT2Ag3SYgnIT0fCqJfAebO0gmQ9qKI6MJoUFf51J8nl3DvlXZUscmJsObDjHNE+L0cQSTmblN4LXMhyNz6j1yFhCJsZrHKlWkkHg+04XGOWx4yK3MDIx9VZI8neXOaLgoEYFEqI9tAG/Wn6f9k6Q/gUw8AHIyLAsdjS4gyayM6Yjgt3eHQPTHXRvtNA/+V+NPb4AaHw7zVz3zazY/HKzdfw4HOg2YSoERwHt5NDxec1dFjzY7vZVJZSGWFLnyF8zmTaNr4tqfBwuZGnBM7Pm4WvUOVIyqpaytdaUiAxZu5IIlt7T5vtpAx+mD9166rxwGkPHf11xgT5Nu4IndNivAiFBR1+CffPs8/skm02GNoij5Oy/00vHidv166rrKIuWS8/CFC/pwYFNTUb2icV0cPubVjLLk3zauaDWvoVOnZtYY8KhKSED8nsIvMDCVdHMQoRHG09a2644HyMy92h6AkwIVNeGLsPDV08N+pZZe6vnmmVco74C6AbmFUsTjkxEDRse38Gk2MTGS4b1RXatDv014zD/YVHYm81pHRaewLDbLOfMkMSJE7xnMi5hKfH8frNnHj1Y13C5yQGEUqSgUMySAPBfsSwEa0dX6XsGDLvoORowP1jhFqzZN6IRXSLU3aRxvItkTG6iwSjtHA2Wko0ZRuzwE62Xlu232mmEj7XTPxj18/SkP8BTdFKGu1e4V0nm7LLUsxhWjrn95Fav/5c/FG9TR9hfD45FsiZbd6dzBvQfhHCgYNfTHutbWhOx+jJa/esrZECtu/bO112AIVe2HauoT1y5a4rp05iBim0m0rpH7xfhM9uOHnr/075jqYojLUmjhGJLLppX0WjeRrlVf3OrGTSFoFrccaIIxZUcTePVTCDolnN+ql8GMCTZbCnfWbTjEUxgJEraUMHjs1HvOCbsCPAqGj7iCg8tVCBSJj5sTQ6D7TfsFV5+GmNlPYoAonoTtc/qs84/7AzoS2vHD2z8/GeASTvWFGRFGFej/3yh4K6xlBWOz0+u+hz39gViXr0ndMXpnYgo7EL+TgeT28CBKlPoRRwDhKFSdrLwGQ2cH/y5AwiOp5CMc63KOY4hIFsoL/9t6ZeCZ8Ochdv2+yWMIzl2D908CVdiNxf7/D/vkpJ5SUoaY7VqgCR2wKUidieyNqrcuPhVRPcG606ivAG1G4Gk73cYLkJcuanznwGGoxpslUBMdUb5Bga5kc9HAVs7jEeLojVakOy0q2qpMHXqXww4yWW1Xi3yUS+K7bsXAa19MInlJfWyBTj8h6m/m0sRUXyo490D4m0SzBjO6Wy1olW0MwRWEG/CDPXperJXgVH/Q5oNPdr7tRycNEMlhvOr4y5W3D5t0QlkPGZLdBldLTdQr6a4tqWWvn/gVlnJQA/WZea0Mh3MZliEz5z6SrgRlsudii+Nt0ZqlSSbDIjQTZGP8UBbRaHUFv8ijmATKjvzRUv0at4/JuF1VvMy/rWR3keDvL3Y8V7+cTdy3kYY9OX61CaKzVFOKTrt65vJ100HOIA1x3U6HT7PjtpR/xK3dGKfWKMscK7GV/ibCebLXccbjN/p0GR7sD1PJaGPI5v8thh7In4g8WZCnCmf1rGwtzrdTcajWOiIaiIPvEQB9dYZ4vKqEA80x820Bf248f8gYtBPNhRW/YlPwcBYYT4A//JOomp+enr0v4G6r7O8/1HA02xBcxoQ5lc8nvcVGDrxpc2/b1HIfiROrnVI3YVC3DPWJ5E3OQbyongRHYwCw+vPlXXF2lodHsnYLF1B9QRepugvAlwrsPCeNN50yxL9DhlIXAgjWLmSM8qlrKbhNMGawDnSQQ/CdzioWweslp4wU+qBeA50JgabgLhAHBejtKPHBGasSp6gFjPIXrKKjMI06SXZId0HsoabaqTFvlT0g88TmB/BBLeNtM8wsV26F+aTlLDDtjiJUaxQ3OuzWsPD/SpwK2xU0AzWm+Br3SmmG9r+9M5AvBI0B+mw9K9PHlPoElqBKjTgi3hWmWohZH+eiE4tngr7h5rT4n2qL190v8vGNKpUD7aWr83NSk9xtcGKVpQTfLRVcwYIs1Q46p5buZlOY8srOeB69IXRQ3hvl2AJa3Jju+yLxF4jLdruoh+GX+V9he6VDrQW0ouvlTpiSkGO3HzuymEjufqZ/6FsfMb/vq7xCpyMJOUXh0eXywKIHizFQZsWtDWAd7xiFYqFbr4YTWJLXbdEsiMMToCDpyFY5XQP5f/18mlmtelqbxyzQcS8t0u9+/uGE8fTYSMIGw5V5QYBDbXo3yB0RFlhyhVlpwr1K/mdzYTb2iYC+C1XvBFbEabVZbKMxGX/59cL9BC/B1QjVO7+kCeGpUcbgAdQC/Hb+kaNP/zo1sFqqQnSw0ZYuBD7Cwu2it9xj8kOzssw9dwxV8yemOoQltrFdPKB+9CAoDUwAR4KXFtyWNr3jYwg/vqdVvUGBqAfGiV4NnVMVZhZXH8xmGZOGK0h0cbM/WDYnowYkRJ9iAyBab3WctQGLz39emJ7hThIvYZZ21kDic3LotkCSLo9TgQ1CJ60OTJApEawChFyek29gWIruBbY5VIpYFCJXfbkdOWbhvFef/As6+J0LwntClSKVewaozPvjVYc9BYqZA/9RUYC5NQxmKpWuhUxdlIaVP1aFvxUXW/j8G12WUewO49c9lKN/Tf373lgdj77pV+JtLSpswriMX1qTMaxDd4K/MfmJS5qMtr/ugovQ3MxgD3vORdJD5TFrLfBK1kzWJndeKgZFHClvuNG13rtDEdg4GVcewx3AOe51xXOSi+dM2AWbCVDtJ1GPcdD5ZhakEODDaJxSQYysi60zNLEHku8+lARnm7BZLr73HJU0Os7/R/Corezx8AQkvjV70Hdd6KrB8UTyTeb6nDse5T9IxUQYEhm9hOM+EeywwkkdRBev1wnD/Igz1+//G21fDHbr3lHerIFWGoihj5B3q/SER+tULXJf3wroRbIv3ajB9Yj0gJ0TnsLD/w/Zg7LpXtPRWOafrrC/Pql1CuA8MBgBbFs3pHG4b+07VGp4vVv0r6xFX5oB5/dgzwVu807KY4aw/p1ONL</div>
</div>
</ld-topic><ld-topic id="cwe-416-cve-2006-4997-ip-over-atm-clip-mkip-dereference-freed-pointer-linux-kernel">
<h2>CWE-416: CVE-2006-4997 IP over ATM clip_mkip dereference freed pointer (Linux Kernel)</h2>
<div class="ld-exercise" data-exercise-id="12" data-exercise-title="12" id="ld-exercise-12">
<pre class="code c literal-block"><code><span class="comment single">// clip_mkip (clip.c):
</span><span class="whitespace">    </span><span class="literal number integer">198</span><span class="whitespace"> </span><span class="keyword">static</span><span class="whitespace"> </span><span class="keyword type">void</span><span class="whitespace"> </span><span class="name">clip_push</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">atm_vcc</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">vcc</span><span class="punctuation">,</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">sk_buff</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">skb</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
    </span><span class="punctuation">...</span><span class="whitespace">
    </span><span class="literal number integer">234</span><span class="whitespace">         </span><span class="name">memset</span><span class="punctuation">(</span><span class="name">ATM_SKB</span><span class="punctuation">(</span><span class="name">skb</span><span class="punctuation">),</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">atm_skb_data</span><span class="punctuation">));</span><span class="whitespace">
    </span><span class="literal number integer">235</span><span class="whitespace">         </span><span class="name">netif_rx</span><span class="punctuation">(</span><span class="name">skb</span><span class="punctuation">);</span><span class="whitespace">
    </span><span class="literal number integer">236</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
    </span><span class="punctuation">...</span><span class="whitespace">         </span><span class="comment single">// PROBLEMATIC CODE STARTS HERE:
</span><span class="whitespace">    </span><span class="literal number integer">510</span><span class="whitespace">         </span><span class="name">clip_push</span><span class="punctuation">(</span><span class="name">vcc</span><span class="punctuation">,</span><span class="name">skb</span><span class="punctuation">);</span><span class="whitespace">
    </span><span class="literal number integer">511</span><span class="whitespace">         </span><span class="name">PRIV</span><span class="punctuation">(</span><span class="name">skb</span><span class="operator">-&gt;</span><span class="name">dev</span><span class="punctuation">)</span><span class="operator">-&gt;</span><span class="name">stats</span><span class="punctuation">.</span><span class="name">rx_packets</span><span class="operator">--</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="literal number integer">512</span><span class="whitespace">         </span><span class="name">PRIV</span><span class="punctuation">(</span><span class="name">skb</span><span class="operator">-&gt;</span><span class="name">dev</span><span class="punctuation">)</span><span class="operator">-&gt;</span><span class="name">stats</span><span class="punctuation">.</span><span class="name">rx_bytes</span><span class="whitespace"> </span><span class="operator">-=</span><span class="whitespace"> </span><span class="name">len</span><span class="punctuation">;</span><span class="whitespace">

</span><span class="comment single">// netif_rx (dev.c):
</span><span class="whitespace">    </span><span class="literal number integer">1392</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">netif_rx</span><span class="punctuation">(</span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">sk_buff</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">skb</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
    </span><span class="punctuation">...</span><span class="whitespace">
    </span><span class="literal number integer">1428</span><span class="whitespace">        </span><span class="name">kfree_skb</span><span class="punctuation">(</span><span class="name">skb</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="comment single">//drop skb
</span><span class="whitespace">    </span><span class="literal number integer">1429</span><span class="whitespace">        </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">NET_RX_DROP</span><span class="punctuation">;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:9Io5tNCChE1xvmq1MD/er1rg0PLo3BPNs/XfIeDBO5c=:ZpRYSCkGBqJ56GIL:VRtqalb9gKoA030GUxlOpnAmzYLosRKJIo4XXp9NrOY8d6rh8rTqYG56/HH78cPNGTw9xmswjLdE9fvKbuRVXw59Cp03NRZAYTW29aeahLIOcX5/bjctTgC7f8SBgZhDJ47v56AE3FHmgtom4NuekU600/QB03JUiwPiQQStbnPuyaNrYuwjMKDtBABJRjH61UqJbHuNYiMv0+GqSkeX4pkoiXTJGqm6T2GDstXJRMX7IxmMFkY6Z6MqBfvbTtFAa+heNqgca0FmTtv8BsQUYvalayA=</div>
</div>
</ld-topic><ld-topic id="cwe-416-use-after-free-abhilfemasznahmen-und-erkennung">
<h2>CWE-416: Use After Free - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list simple">
<li><p>Wahl einer sicheren Programmiersprache (z.‚ÄØB. RUST)</p></li>
<li><p>explizites <code>NULL</code> setzen, nachdem der Speicherbereich freigegeben wurde</p></li>
<li><p>Fuzzing</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
</ul>
<div class="supplemental docutils container">
<p>Empfohlene Lekt√ºre: <a class="reference external" href="https://github.blog/2021-03-24-real-world-exploit-chains-explained/">One day short of a full chain: Real world exploit chains explained</a> (In Teil 1 wird eine UAF Schwachstelle genutzt.)</p>
</div>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-78-improper-neutralization-of-special-elements-used-in-an-os-command-os-command-injection">
<h2>CWE-78: Improper Neutralization of Special Elements used in an OS Command (<em>OS Command Injection</em>)</h2>
</ld-topic><ld-topic id="cwe-78-improper-neutralization-of-special-elements-used-in-an-os-command">
<h2>CWE-78: Improper Neutralization of Special Elements used in an OS Command</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Alles oder zumindest ein Teil eines Betriebssystembefehls h√§ngt von extern beeinflussten Eingaben ab. Es erfolgt jedoch keine Bereinigung spezieller Elemente, die den beabsichtigten Betriebssystembefehl ver√§ndern k√∂nnten.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Verf√ºgbarkeit, Vertraulichkeit, Integrit√§t</p>
</dd>
<dt>Arten<span class="colon">:</span></dt>
<dd><ol class="arabic simple">
<li><p>Ein bestimmtes Program wird ausgef√ºhrt und die Nutzerdaten werden als Parameter √ºbergeben.</p></li>
<li><p>Die Anwendung bestimmt basierend auf den Nutzerdaten welches Program mit welchen Parametern ausgef√ºhrt wird.</p></li>
</ol>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-78-improper-neutralization-of-special-elements-used-in-an-os-command-beispiel-java">
<h2>CWE-78: Improper Neutralization of Special Elements used in an OS Command - Beispiel (Java)</h2>
<div class="ld-exercise" data-exercise-id="13" data-exercise-title="13" id="ld-exercise-13">
<pre class="code java literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="name">String</span><span class="whitespace"> </span><span class="name">btype</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">request</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;backuptype&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="name">String</span><span class="whitespace"> </span><span class="name">cmd</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">String</span><span class="punctuation">(</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="literal string">&quot;cmd.exe /K \&quot;c:\\util\\rmanDB.bat &quot;</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="operator">+</span><span class="name">btype</span><span class="operator">+</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="literal string">&quot;&amp;&amp;c:\\utl\\cleanup.bat\&quot;&quot;</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="name">System</span><span class="punctuation">.</span><span class="name attribute">Runtime</span><span class="punctuation">.</span><span class="name attribute">getRuntime</span><span class="punctuation">().</span><span class="name attribute">exec</span><span class="punctuation">(</span><span class="name">cmd</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="punctuation">...</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:dB66B8Rw/9wlpG9y44R3M+rGyWteJa3ybFHepsSNu1w=:m56mm0hrJSZFdZ+5:SocAdosO2qKiWZAICQmYmBsAHRFkrM8c6Immx/7T+mi+zoZGfXhVwbPpBPIaKxFU8IvBPreaDkAvVqDhdYXv87wIrGAzVmb28Mi9fwLWXCqUGDocJ4aeY/yzY5oNQP58lIZzJ8cEJo7RaR3U8MdHv/65XoJQRVLvqa/aH1f3kc9VbJTQxaMxTLGPfQEZBUXX/DMs/6dtPVe9kwegbOP/4lacu0QLBvDwzYXa00eyNFupnFk9cPcyrlV/DYJ7nk51V6BeuhpyOKMTYaRaDihZyw9rdZudjka3OWRPPmuehzmRLMmtDMLGmtRfCdaSylCigNnTOGTkz/7RQuha23dkFojn6gHGtb3RG+s=</div>
</div>
</ld-topic><ld-topic id="cwe-78-improper-neutralization-of-special-elements-used-in-an-os-command-abhilfemasznahmen-und-erkennung">
<h2>CWE-78: Improper Neutralization of Special Elements used in an OS Command - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list simple">
<li><p>Verwendung von gepr√ºften/sicheren APIs.</p></li>
<li><p>Anwendung bzw. Befehl nur mit den notwendigen Rechten betreiben (<em>Principle of Least Privilege</em>) bzw. in einer Sandbox ausf√ºhren.</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Dynammische Analyse in Kombination mit Fuzzing</p></li>
<li><p>Manuelle Code Reviews/Statische Analyse</p></li>
<li><p>ggf. Application-level Firewall einsetzen</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-20-improper-input-validation">
<h2>CWE-20: Improper Input Validation</h2>
</ld-topic><ld-topic id="cwe-20-improper-input-validation-1">
<h2>CWE-20: Improper Input Validation</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Empfangene Eingaben oder Daten werden nicht nicht oder falsch validiert in Hinblick darauf, dass die Eingaben die Eigenschaften haben, die f√ºr eine sichere und korrekte Verarbeitung der Daten erforderlich sind.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Verf√ºgbarkeit, Vertraulichkeit, Integrit√§t</p>
</dd>
<dt>Anwendungsbereiche<span class="colon">:</span></dt>
<dd><ul class="simple">
<li><p>Rohdaten - Strings, Zahlen, Parameter, Dateiinhalte, etc.</p></li>
<li><p>Metadaten - Information √ºber die Rohdaten, wie zum Beispiel <em>Header</em> oder Gr√∂√üe</p></li>
</ul>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-20-improper-input-validation-zu-verifizierende-werte-und-eigenschaften">
<h2>CWE-20: Improper Input Validation - zu verifizierende Werte und Eigenschaften</h2>
<ld-story>
<dl class="incremental-list dd-margin-left-3em field-list simple">
<dt>Gr√∂√üen<span class="colon">:</span></dt>
<dd><p>Z.¬†B. L√§nge, H√§ufigkeit, Preis, Rate, Anzahl der Vorg√§nge, Zeit usw.</p>
</dd>
<dt>Implizite oder abgeleitete Gr√∂√üen<span class="colon">:</span></dt>
<dd><p>Z.‚ÄØB. die tats√§chliche Gr√∂√üe einer Datei anstelle einer angegebenen Gr√∂√üe.</p>
</dd>
<dt>Indizes*<span class="colon">:</span></dt>
<dd><p>Offsets oder Positionen in komplexeren Datenstrukturen.</p>
</dd>
<dt>Schl√ºssel<span class="colon">:</span></dt>
<dd><p>Z.‚ÄØB. von Hashtabellen oder assoziativen Feldern.</p>
</dd>
<dt>Syntaktische Korrektheit<span class="colon">:</span></dt>
<dd><p>√úbereinstimmung mit der erwarteten Syntax.</p>
</dd>
<dt>Konsistenz<span class="colon">:</span></dt>
<dd><p>Z.¬†B. zwischen den Rohdaten und Metadaten oder zwischen Referenzen.</p>
</dd>
<dt>Semantische Korrektheit<span class="colon">:</span></dt>
<dd><p>Z.¬†B. Konformit√§t mit dom√§nenspezifischen Regeln, z.‚ÄØB. Gesch√§ftslogik.</p>
</dd>
<dt>Authentizit√§t<span class="colon">:</span></dt>
<dd><p>Z.‚ÄØB. von kryptografischen Signaturen.</p>
</dd>
</dl>
</ld-story></ld-topic><ld-topic id="o-reilly-ist-keine-sql-injection">
<h2>O'Reilly ist keine SQL Injection</h2>
<aside class="admonition observation">
<p class="admonition-title">Beobachtung</p>
<p>Ein Name wie <span class="docutils literal">O'Reily</span> stellt ein Problem dar, wenn er in ein SQL Statement eingef√ºgt wird, sollte jedoch von der Anwendung verarbeitet werden k√∂nnen und die Eingabevalidierung passieren.</p>
</aside>
<aside class="admonition incremental hint">
<p class="admonition-title">Hinweis</p>
<p>Die Validierung muss immer in Hinblick auf den Kontext erfolgen.</p>
</aside>
</ld-topic><ld-topic id="cwe-20-improper-input-validation-beispiel-partielle-validierung-in-c">
<h2>CWE-20: Improper Input Validation - Beispiel: Partielle Validierung in C</h2>
<div class="ld-exercise" data-exercise-id="14" data-exercise-title="14" id="ld-exercise-14">
<pre class="code c literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#define MAX_DIM 100
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">m</span><span class="punctuation">,</span><span class="name">n</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">error</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="comment multiline">/* m,n = board dimensions */</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="name">board_square_t</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">board</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace"></span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Please specify the board height: </span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="name">error</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">scanf</span><span class="punctuation">(</span><span class="literal string">&quot;%d&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">m</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">EOF</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">error</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;No integer passed!</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Please specify the board width: </span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="name">error</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">scanf</span><span class="punctuation">(</span><span class="literal string">&quot;%d&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="operator">&amp;</span><span class="name">n</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">EOF</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">error</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;No integer passed!</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">m</span><span class="whitespace"> </span><span class="operator">&gt;</span><span class="whitespace"> </span><span class="name">MAX_DIM</span><span class="whitespace"> </span><span class="operator">||</span><span class="whitespace"> </span><span class="name">n</span><span class="whitespace"> </span><span class="operator">&gt;</span><span class="whitespace"> </span><span class="name">MAX_DIM</span><span class="whitespace"> </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">die</span><span class="punctuation">(</span><span class="literal string">&quot;Value too large!</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace"></span><span class="name">board</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">board_square_t</span><span class="operator">*</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">m</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="name">n</span><span class="whitespace"> </span><span class="operator">*</span><span class="whitespace"> </span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="name">board_square_t</span><span class="punctuation">));</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">...</span></code></pre>
<aside class="admonition incremental warning">
<p class="admonition-title">Warnung</p>
<p>Ein vergleichbares Problem ist auch in sicheren Programmiersprachen m√∂glich.</p>
</aside>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:Wy7yqgY8agOHlHpgD418S3qvE0E8P6G7BJXwqg0kpHI=:rxGi8IzzlWYLqw9H:HUaKpgTZ65bdFvwA/ITq/PPK8I95SKgVsV3U5cRqJZeGWotbPVMpXPzDRq9JyyJDRwJT8Lw/Fs1sOjPwjtx0/ldwBbJADgKBzWwRCBW1HD0/s/jygQ5jZyCtbjsjEGCCSx94nTAliTZZcGlmkV//zhOGtcFJ+kQGkkYNwnvn4UnRR5pG/Eey27PNrJCiIOlLvOct3AXsDs7Ro/EGjgXJCgenJQ6jqYyI2YYPZ6pwT54VouXMVnGrfXCPE1A=</div>
</div>
</ld-topic><ld-topic id="cwe-20-improper-input-validation-abhilfemasznahmen-und-erkennung">
<h2>CWE-20: Improper Input Validation - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list simple">
<li><p>(begrenzt) Statische Analyse Werkzeuge</p></li>
<li><p>Manuelle statische Analyse insbesondere in Hinblick auf die zugrundeliegende Semantik</p></li>
<li><p>Dynamische Analyse mit Fuzzing</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-125-out-of-bounds-read">
<h2>CWE-125: Out-of-bounds Read</h2>
</ld-topic><ld-topic id="cwe-125-out-of-bounds-read-1">
<h2>CWE-125: Out-of-bounds Read</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Daten vor oder nach einem Puffer werden gelesen.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Programmiersprachen<span class="colon">:</span></dt>
<dd><p>C, C++</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit</p>
</dd>
<dt>Auswirkungen<span class="colon">:</span></dt>
<dd><p>Umgehung von Schutzma√ünahmen; Lesen von Speicher</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Die Ausnutzung dieser Schwachstelle ist h√§ufig schwierig, da nicht immer bekannt ist welche und wie viele Daten gelesen werden k√∂nnen. Es kann allerdings m√∂glich sein Speicheradressen auszulesen. Dies kann ggf. genutzt werden, um Mechanismen wie ASLR zu umgehen.</p>
</div>
</ld-topic><ld-topic id="cwe-125-out-of-bounds-read-beispiel-partielle-validierung-in-c">
<h2>CWE-125: Out-of-bounds Read - Beispiel: Partielle Validierung in C</h2>
<div class="ld-exercise" data-exercise-id="15" data-exercise-title="15" id="ld-exercise-15">
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">getValueFromArray</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">array</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">len</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">index</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">    </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">value</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="comment single">// check that the array index is less than the maximum length of the array
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">index</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="name">len</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">        </span><span class="comment single">// get the value at the specified index of the array
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="comment single"></span><span class="whitespace">        </span><span class="name">value</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">array</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="comment single">// if array index is invalid then output error message
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="comment single"></span><span class="whitespace">    </span><span class="comment single">// and return value indicating error
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">        </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Value is: %d</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">array</span><span class="punctuation">[</span><span class="name">index</span><span class="punctuation">]);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace">        </span><span class="name">value</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">-1</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace">    </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">15 </small><code data-lineno="15 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">value</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">16 </small><code data-lineno="16 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:Y5OzHxEC70mrJFzVlzRrkRB2XEmDznVZLZHrO6Pac+8=:YctidRBQc3TSswrP:33qRYqej7CoB6BYQ17gM+yVjkGUC0HG0EXwJZgvNKNikuUeLeoyr1H0nb680CY50hMDKimG6o01nER8o8siUHCK0padRM5hMff4L+NFqQdQVsXTa679FP/bSrJKLVlBzHh+PJlQPS/5TNrIxj139pL7qt+v6OLjC/DzeR9rm5i1RJRo3ve/LExKNpE+qFdsGVVPvkmkt8XmclSGdJzg=</div>
</div>
</ld-topic><ld-topic id="cwe-125-out-of-bounds-read-abhilfemasznahmen-und-erkennung">
<h2>CWE-125: Out-of-bounds Read - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list simple">
<li><p>eine sichere Programmiersprache verwenden</p></li>
<li><p>Fuzzing</p></li>
<li><p>Statische Analyse Werkzeuge welche Kontroll- und Datenflussanalyse durchf√ºhren</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-22-improper-limitation-of-a-pathname-to-a-restricted-directory-path-traversal">
<h2>CWE-22: Improper Limitation of a Pathname to a Restricted Directory (<em>Path Traversal</em>)</h2>
</ld-topic><ld-topic id="cwe-22-improper-limitation-of-a-pathname-to-a-restricted-directory">
<h2>CWE-22: Improper Limitation of a Pathname to a Restricted Directory</h2>
<dl class="field-list simple">
<dt>Kurzbeschreibung<span class="colon">:</span></dt>
<dd><p>Externe Eingaben werden f√ºr die Konstruktion eines Pfadnamens verwendet, der eine Datei oder ein Verzeichnis identifizieren soll, das sich unterhalb eines eingeschr√§nkten √ºbergeordneten Verzeichnisses befindet. Eine Bereinigung spezieller Elemente innerhalb des Pfadnamens erfolgt jedoch nicht ordnungsgem√§√ü, was dazu f√ºhren kann, dass der Pfadname zu einem Ort au√üerhalb des eingeschr√§nkten Verzeichnisses aufgel√∂st wird.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt>Wahrscheinlichkeit des Missbrauchs<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Betrifft<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrit√§t, Verf√ºgbarkeit</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-22-path-traversal-beispiel-fehlende-validierung">
<h2>CWE-22: Path Traversal - Beispiel: fehlende Validierung</h2>
<div class="ld-exercise" data-exercise-id="16" data-exercise-title="16" id="ld-exercise-16">
<p>PHP:</p>
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="comment preproc">&lt;?php</span>
</code><small class="ln">2 </small><code data-lineno="2 "><span class="name variable">$file</span> <span class="operator">=</span> <span class="name variable">$_GET</span><span class="punctuation">[</span><span class="literal string single">'file'</span><span class="punctuation">];</span>
</code><small class="ln">3 </small><code data-lineno="3 "><span class="keyword">include</span><span class="punctuation">(</span><span class="literal string double">&quot;/home/www-data/</span><span class="literal string interpol">$file</span><span class="literal string double">&quot;</span><span class="punctuation">);</span>
</code><small class="ln">4 </small><code data-lineno="4 "><span class="comment preproc">?&gt;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:3gLPQVazZ7o85d1CvoxRmknte7FJZUYQY86EMgPRK1Y=:TRfF4DOpFs1c1lI+:Rhl6mGetzdneOEI8FGmzsftQGEoWhumMYuGZJU/gyjjDzg8WysCDgXMqE7AjeuxdHned12QRY5hmiFIoqjBsbSvHNlQQ92MCQ60qyhfybxbziZO8a5CmjcQC94qhlh0L8jdLEYwMB1lKltuskw1f1rusT1RAGnHpgTZ/Hnuj9aiNxWwyNtFPz/odPCfgtvsFzPOW3g==</div>
</div>
</ld-topic><ld-topic id="cwe-22-path-traversal-beispiel-partielle-validierung">
<h2>CWE-22: Path Traversal - Beispiel: partielle Validierung</h2>
<div class="ld-exercise" data-exercise-id="17" data-exercise-title="17" id="ld-exercise-17">
<p>Perl:</p>
<pre class="code Perl literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$Username</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">GetUntrustedInput</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="name variable">$Username</span><span class="whitespace"> </span><span class="operator">=~</span><span class="whitespace"> </span><span class="literal string regex">s/\.\.\///</span><span class="punctuation">;</span><span class="whitespace">                </span><span class="comment single"># Remove ../</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$filename</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string">&quot;/home/user/&quot;</span><span class="whitespace"> </span><span class="operator">.</span><span class="whitespace"> </span><span class="name variable">$Username</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace"></span><span class="name">ReadAndSendFile</span><span class="punctuation">(</span><span class="name variable">$filename</span><span class="punctuation">);</span></code></pre>
<div class="incremental margin-top-2em docutils container">
<p>Java:</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">String</span><span class="whitespace"> </span><span class="name">path</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">getInputPath</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">path</span><span class="punctuation">.</span><span class="name attribute">startsWith</span><span class="punctuation">(</span><span class="literal string">&quot;/safe_dir/&quot;</span><span class="punctuation">))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="name">File</span><span class="whitespace"> </span><span class="name">f</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">File</span><span class="punctuation">(</span><span class="name">path</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="name">f</span><span class="punctuation">.</span><span class="name attribute">delete</span><span class="punctuation">()</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
</div>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:8uTO0iLAU3gPyyhD1rOrlbO3fjLmTmLKc4c6Ag0LzbM=:PJH17Y1yzg2GPXQN:iXe3y7P3dMuwWDksP30EwkCYbivXY3qFK0F90JO4wzaAwMSOAsvjkBpclOajrlybXAsyVJAE2wGu5wYZet+fZ+Hg4moW+SqY3jOpS+5M3fwHZk1Bm0fLn1PWXiZGEuCElXZcUfU88UZWevMOlqlNfn427O11S4LkFfXJFwLNdNpRHIsEmfZk1aqg9jLD/PO47okDqwVhnSTPLm/PJJE09EBt1MPESCqW+LC0Ed3sG9hyQ5nxfZivolnK0pRNGtuerNJ0aLBMHg0Ufn4runaOQOLTRfQjoCavrti2OOskMZVAaMnZaD9VNlYcCWIRcyV8Zv5rOwZh4+zc3GS9QmpBYC4VRtQAQQHeNJPpMFyOCcsCp9vxCSTZikU0DWfltzefIoJm9fZvRAWwPhXeGnAkA6ZYH+DEpLMNG7YtP5g1m2tiV6+ysJpyb4J0M6PClzRkY1pEelzZhI4apkpB+407FESULTciwADthbGIfTgvf9fZ6KajRSOoYoYdVkKKVtwSECLmf9RCjlGOiwiA1UzaQCS5Oore6gn8fPJMPfpxxVS1uqMV//d3WwcWi51KFjGR/wgWIlyBYb3lLuhwNbbiQ3yNM7DAfmobFBODj92wFtIfittPnX6C7SBCzpmjfDM8qEI6kHX12CQ1WXVoxZqmkD9SaWZc0SlKy4u1+58GxDmK3swecrCd2iDRPwBrL8qDZAlJRMEMBXBQaJLKZCHkF5CkQApUYeQbmpqeNNJQlHI8SATbsBU2pCredkXGgkb6EMoWyS57AB17LxSVNWKdakiZ78f/QyU7JnkPVEWYNaLBCn3n+W9v3t940IX5wbWBpFUf4mAOjVWQ99BgmjAxIwjGm3oLWDQa8BK+mQnfmoQPVdgVagPVS+PDnvG2kERVpwKAtkG5G45R0gD2KV7JPmQPQdtEfMhcQWB3/Os9DAkXP0vE7EObtkqObJWcacE4mg==</div>
</div>
</ld-topic><ld-topic id="cwe-22-path-traversal-beispiel-verwirrende-python-api">
<h2>CWE-22: Path Traversal - Beispiel: verwirrende Python API<a class="brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></h2>
<ld-grid class="default-layout">
<ld-cell style="align-self:auto;">
<pre class="code Python literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword namespace">import</span><span class="whitespace"> </span><span class="name namespace">os</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="keyword namespace">import</span><span class="whitespace"> </span><span class="name namespace">sys</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="keyword">def</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">():</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace"></span><span class="name">filename</span> <span class="operator">=</span> <span class="name">sys</span><span class="operator">.</span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="name">path</span> <span class="operator">=</span> <span class="name">os</span><span class="operator">.</span><span class="name">path</span><span class="operator">.</span><span class="name">join</span><span class="punctuation">(</span><span class="name">os</span><span class="operator">.</span><span class="name">getcwd</span><span class="punctuation">(),</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span>                    <span class="name">filename</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span><span class="keyword">try</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span>    <span class="keyword">with</span> <span class="name builtin">open</span><span class="punctuation">(</span><span class="name">path</span><span class="punctuation">,</span> <span class="literal string single">'r'</span><span class="punctuation">)</span> <span class="keyword">as</span> <span class="name">f</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span>    <span class="name">file_data</span> <span class="operator">=</span> <span class="name">f</span><span class="operator">.</span><span class="name">read</span><span class="punctuation">()</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="keyword">except</span> <span class="name exception">FileNotFoundError</span> <span class="keyword">as</span> <span class="name">e</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span>    <span class="name builtin">print</span><span class="punctuation">(</span><span class="literal string double">&quot;Error - file not found&quot;</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="comment single"># do something with file_data</span></code></pre>
</ld-cell><ld-cell class="incremental" style="align-self:auto;">
<blockquote class="epigraph">
<p><strong>Dokumentation os.path.join</strong></p>
<p>Join one or more path components intelligently. The return value is the concatenation of path and any members of *paths with exactly one directory separator following each non-empty part except the last, meaning that the result will only end in a separator if the last part is empty.</p>
<p>If a component is an absolute path [...], all previous components are thrown away and joining continues from the absolute path component.</p>
<p class="attribution">‚Äî<a class="reference external" href="https://docs.python.org/3.11/library/os.path.html#os.path.join">Python 3.11.7</a></p>
</blockquote>
</ld-cell></ld-grid><aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p>Verwirrende APIs gibt es in praktischen allen Sprachen!</p>
</aside>
</aside>
</ld-topic><ld-topic id="cwe-22-path-traversal-abhilfemasznahmen-und-erkennung">
<h2>CWE-22: Path Traversal - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list simple">
<li><p>Eingabe vollst√§ndig validieren; zum Beispiel √ºber kanonische Pfade</p></li>
<li><p>Sandboxen</p></li>
<li><p>Umgebung h√§rten</p></li>
<li><p>Bei Fehlerausgaben darauf achten, dass keine Informationen √ºber das Dateisystem preisgegeben werden</p></li>
<li><p>den Code mit minimalen Rechten ausf√ºhren</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-352-cross-site-request-forgery-csrf">
<h2>CWE-352: Cross-Site Request Forgery (<em>CSRF</em>)</h2>
</ld-topic><ld-topic id="cwe-352-cross-site-request-forgery-csrf-1">
<h2>CWE-352: Cross-Site Request Forgery (CSRF)</h2>
<dl class="field-list">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Die Webanwendung pr√ºft nicht bzw. kann nicht pr√ºfen, ob eine Anfrage absichtlich von dem Benutzer gestellt wurde, von dessen Browser sie √ºbermittelt wurde.</p>
<p>D.‚ÄØh. eine CSRF Schwachstelle nutzt das Vertrauen aus, das eine Webseite in den Browser eines Nutzers hat. Bei einem CSRF-Angriff wird ein legitimer Nutzer von einem Angreifer dazu gebracht, ohne sein Wissen eine Anfrage zu √ºbermitteln, die er nicht beabsichtigt hat und auch nicht bemerkt.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Mittel</p>
</dd>
<dt>Auswirkung<span class="colon">:</span></dt>
<dd><p>H√§ngt von den Nutzerrechten ab</p>
</dd>
<dt>Ausma√ü<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrit√§t, Verf√ºgbarkeit</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-352-cross-site-request-forgery-csrf-ursprungliche-form">
<h2>CWE-352: Cross-Site Request Forgery (CSRF) - urspr√ºngliche Form</h2>
<object aria-label="Cross-Site Request Forgery (CSRF) - urspr√ºngliche Form" data="images/csrf.svg" role="img" type="image/svg+xml">
</object></ld-topic><ld-topic id="cwe-352-cross-site-request-forgery-csrf-in-2023">
<h2>CWE-352: Cross-Site Request Forgery (CSRF) in 2023</h2>
<blockquote class="epigraph">
<p>Fiber ist ein von Express inspiriertes Web-Framework, das in Go geschrieben wurde. In der Anwendung wurde eine Cross-Site Request Forgery (CSRF)-Schwachstelle entdeckt, die es einem Angreifer erm√∂glicht, beliebige Werte zu injizieren und b√∂sartige Anfragen im Namen eines Benutzers zu f√§lschen. Diese Schwachstelle kann es einem Angreifer erm√∂glichen, beliebige Werte ohne Authentifizierung einzuschleusen oder verschiedene b√∂swillige Aktionen im Namen eines authentifizierten Benutzers durchzuf√ºhren, wodurch die Sicherheit und Integrit√§t der Anwendung gef√§hrdet werden kann. Die Schwachstelle wird durch eine unsachgem√§√üe Validierung und Durchsetzung von CSRF-Tokens innerhalb der Anwendung verursacht.</p>
<p class="attribution">‚Äî<a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2023-45128">CVE-2023-45128</a> (√ºbersetzt mit DeepL)</p>
</blockquote>
<aside class="admonition remark">
<p class="admonition-title">Bemerkung</p>
<p>Identifizierte Schwachstellen: <em>CWE-20</em> Improper Input Validation, <em>CWE-807</em> Reliance on Untrusted Inputs in a Security Decision, <em>CWE-565</em> Reliance on Cookies without Validation and Integrity Checking, <strong>CWE-352</strong> Cross-Site Request Forgery</p>
</aside>
</ld-topic><ld-topic id="cwe-352-cross-site-request-forgery-csrf-in-2023-1">
<h2>CWE-352: Cross-Site Request Forgery (CSRF) in 2023</h2>
<p>Standardtechniken, die CSRF verhindern <em>sollen</em>:</p>
<ul class="incremental-list simple">
<li><p>Same-site Cookies (f√ºr Authentifizierung)</p></li>
<li><p>CSRF-Tokens, wenn diese die folgenden Eigenschaften haben:</p>
<ul>
<li><p>Einmalig pro Nutzersession</p></li>
<li><p>Geheim</p></li>
<li><p>nicht vorhersagbar (z.‚ÄØB. eine sehr gro√üe, sicher erzeugte Zufallszahl)</p></li>
</ul>
</li>
<li><p>Validierung des Referer-Header</p></li>
<li><p>Custom Request Header, da diese nur vom JavaScript Code gesetzt werden k√∂nnen, der den gleichen Ursprung hat (siehe <em>Same Origin Policy</em> (SOP)).</p></li>
</ul>
<div class="incremental small foundations docutils container">
<p>Auch diese Techniken lassen sich ggf. (alle zusammen) aushebeln, <a class="reference external" href="https://portswigger.net/web-security/csrf">wenn die Anwendung weitere Schwachstellen aufweist</a>. So gibt/gab es Anwendungen, die Anfragen, die nur √ºber ein POST request gestellt werden sollten, auch bei einem GET akzeptiert haben.</p>
</div>
<div class="supplemental docutils container">
<p>In allen Browsern wird in der Zwischenzeit f√ºr Cookies die Same-site Policy angewandt mit dem Wert <code>Lax</code>. Dieser Wert hat zur Folge, dass Cookies nur dann gesendet werden, wenn der Nutzer explizit auf einen Link klickt oder sich innerhalb derselben Seite befindet.</p>
</div>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-434-unrestricted-upload-of-file-with-dangerous-type">
<h2>CWE-434: Unrestricted Upload of File with Dangerous Type</h2>
</ld-topic><ld-topic id="cwe-434-unrestricted-upload-of-file-with-dangerous-type-1">
<h2>CWE-434: Unrestricted Upload of File with Dangerous Type</h2>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Es ist m√∂glich potentiell gef√§hrliche Dateien hochzuladen bzw. zu transferieren, die von der Anwendung automatisch im Kontext der Anwendung verarbeitet werden.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Mittel</p>
</dd>
<dt>Auswirkung<span class="colon">:</span></dt>
<dd><p>Bis hin zur Ausf√ºhrung von beliebigen Befehlen</p>
</dd>
<dt>Ausma√ü<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrit√§t, Verf√ºgbarkeit</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-434-unrestricted-upload-of-file-with-dangerous-type-beispiel">
<h2>CWE-434: Unrestricted Upload of File with Dangerous Type - Beispiel</h2>
<div class="ld-exercise" data-exercise-id="18" data-exercise-title="18" id="ld-exercise-18">
<p>HTML:</p>
<pre class="code HTML literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">&lt;</span><span class="name tag">form</span> <span class="name attribute">action</span><span class="operator">=</span><span class="literal string">&quot;upload_picture.php&quot;</span> <span class="name attribute">method</span><span class="operator">=</span><span class="literal string">&quot;post&quot;</span> <span class="name attribute">enctype</span><span class="operator">=</span><span class="literal string">&quot;multipart/form-data&quot;</span><span class="punctuation">&gt;</span>
</code><small class="ln">2 </small><code data-lineno="2 ">    Choose a file to upload:
</code><small class="ln">3 </small><code data-lineno="3 ">    <span class="punctuation">&lt;</span><span class="name tag">input</span> <span class="name attribute">type</span><span class="operator">=</span><span class="literal string">&quot;file&quot;</span> <span class="name attribute">name</span><span class="operator">=</span><span class="literal string">&quot;filename&quot;</span><span class="punctuation">/&gt;</span>
</code><small class="ln">4 </small><code data-lineno="4 ">    <span class="punctuation">&lt;</span><span class="name tag">br</span><span class="punctuation">/&gt;</span>
</code><small class="ln">5 </small><code data-lineno="5 ">    <span class="punctuation">&lt;</span><span class="name tag">input</span> <span class="name attribute">type</span><span class="operator">=</span><span class="literal string">&quot;submit&quot;</span> <span class="name attribute">name</span><span class="operator">=</span><span class="literal string">&quot;submit&quot;</span> <span class="name attribute">value</span><span class="operator">=</span><span class="literal string">&quot;Submit&quot;</span><span class="punctuation">/&gt;</span>
</code><small class="ln">6 </small><code data-lineno="6 "><span class="punctuation">&lt;/</span><span class="name tag">form</span><span class="punctuation">&gt;</span></code></pre>
<p>PHP:</p>
<pre class="code PHP literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">// Define the target location where the picture being
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">// uploaded is going to be saved.
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">$target = &quot;pictures/&quot; . basename($_FILES['uploadedfile']['name']);
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="other">// Move the uploaded file to the new location.
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="other">move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target)</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:g1i1kjJVutvi8JM4d5luymFCnmPvxTXsoWHZm1E3SnE=:0Zi/sCPwhPhf2uUJ:2f+Z6iJU9k00W5bXrQTvDDkf/EsMOIAxj2tAV5C6yjefXfryFYbpSlXdgdovAyCOnwgwT3FF3Eb8BKNeWbO2GVXhzYDeUehZEUVfILAemuBd8QmzK9TWrij+4xw4taKMkaK6PNwEQkxasuPc4P/Kg+ByRD9E2zt71jZb9I+4zhl6TMZlKEYVEZVPDxct/cTEUungoi4dlltlVszwyjxeO/SqReTqdO174UbRzoye+nKwq97l9oaq9SSk/gogvN7sh0Qw5RJ1XcxrEX4syIVW9q/rPOSj0jilRquaTAU+5nexJZtn+QYmlEWyUI+cUe7UcR09YFVf8f5SykJ35j8kqerZH4NsVVF9/j2Z0NPiXLU483fy2t9CPqsh0TRpNA0KHs49q0xuVDKirxA/yWjxLhdgRInagcN27Sg+FO3p2HTPpAhBlYn5sGsMPApKVkgSBenUmbKx2xyPrjliYwfabD6bBk5F523vtpctUDyjL9BOKuGffi0eNLG8iBi1Z88Oys3w2crAcYrI+Ex44vvpbYb15U9wcvwH1mlv3blLLZOKYAVTQ1nTrv7osaVJNFoM64QGztkktU1uYbYFvAJWq6jrA+7C7DXEyuq8Y4ThMHDvDS6CzhcP7nlRmBROKZgJGLpAtVGbhvTqhGIF6wFXQfXoP9OZDDnfYcjjtJKsThVXdSDBtiPBXeNXqgd2JwYrlx7fwzAhzm35Ay0GWbQydYjn/pJdIFxaDLo1Zv5/sTOB1NC3SESyYskIFftO2UOtWF93Ub4TInb/YEfA/K7YnUqDwsBAjO2EVTD2MxjRN1Unx0aSEgGp+HBo/FKP7YPsFXIe823eyVxxY76c4ottKREdaf/Q4gbnljI7q4KUD5FREixR8prmVP8H6ZpVrB46B02EeHQ3ioTtJbyrwbxW6rHh3En+Vwy7hHqxlqfMzZMQKTf8uokmu31RZryNWYIWHAfmU/kAb57g5JHIOv/pLsrSE2Zo2TxNDTNal8Nwh4efIZlNKqBHrhdBd582kvHkMgI1wW3L+pnvSDwE56k8S/DRyffNKy9hyo7ahV1XB+osOR5V7NSSbJ4TqLhRClkZ+ZMd4p21p99+ecoAI70H6LNukau9tusFMDcxGCcrqPkaU3aj2BFPs7iDqz2fk872EJEQpwF/sKopsi/UiRdHvX/vom/kp+mj72o4Sk3pp12hriEOwlCqIbG+f8qMIuGm7P/AomIWYQW1hrdjCWG5IIKjgfbGsBCMN5Y=</div>
</div>
</ld-topic><ld-topic id="cwe-434-unrestricted-upload-of-file-with-dangerous-type-abhilfemasznahmen-und-erkennung">
<h2>CWE-434: Unrestricted Upload of File with Dangerous Type - Abhilfema√ünahmen und Erkennung</h2>
<ul class="simple">
<li><p>Beim Speichern von Dateien niemals den urspr√ºnglichen Dateinamen verwenden sondern einen vom Server generierten.</p></li>
<li><p>Speicher die Daten nicht im Kontext der Webanwendung sondern au√üerhalb des Webroots.</p></li>
<li><p>Pr√ºfe die Dateiendung. Pr√ºfe den Inhalt der Datei gegen die Erwartung.</p></li>
<li><p>Ausf√ºhren der Webanwendung mit minimalen Rechten.</p></li>
<li><p>Sandbox.</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-122-heap-based-buffer-overflow">
<h2>CWE-122: Heap-based Buffer Overflow</h2>
</ld-topic><ld-topic id="cwe-122-heap-based-buffer-overflow-1">
<h2>CWE-122: Heap-based Buffer Overflow</h2>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Ein Puffer√ºberlauf, bei dem der Puffer, der √ºberschrieben wird, auf dem Heap alloziiert wurde, was im Allgemeinen bedeutet, dass der Puffer mit einer Routine wie malloc() allloziiert wurde.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Hoch</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>C/C++</p>
</dd>
<dt>Auswirkung<span class="colon">:</span></dt>
<dd><p>Bis hin zur Ausf√ºhrung von beliebigen Befehlen</p>
</dd>
<dt>Ausma√ü<span class="colon">:</span></dt>
<dd><p>Vertraulichkeit, Integrit√§t, Verf√ºgbarkeit, Zugriffskontrolle</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-122-heap-based-buffer-overflow-2">
<h2>CWE-122: Heap-based Buffer Overflow</h2>
<div class="ld-exercise" data-exercise-id="19" data-exercise-title="19" id="ld-exercise-19">
<p>‚ÄûBasisbeispiel‚Äú in C:</p>
<pre class="code C literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="comment preproc">#define BUFSIZE 256
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="comment preproc"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">argv</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buf</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="name">buf</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="punctuation">)</span><span class="name">malloc</span><span class="punctuation">(</span><span class="keyword">sizeof</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="punctuation">)</span><span class="operator">*</span><span class="name">BUFSIZE</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">    </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">buf</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]);</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:5C3qGBts9U25W/jEis19+hhn93ro4MAUEnohFOL79WM=:EoNiHdiKyDSIh8HQ:HfgwfTqaE/+3MS/5yg0qKyl4PoG0XUnqrPcVKBxFmc3COltV8gyV48lxDF2vFQZT0wWfEBZupR2vHnIV0AFoQA7WKzQCMJg/IjZzAMobZiXxjSj2pVTB50XCmjrW4vS92BVwAwgiMflDz/zNcXLZoUFDssnzlurBMh4M2QkRNgJHT3So5Bmd1Tdy2wbmKkuM93l7ZQ==</div>
</div>
</ld-topic><ld-topic id="cwe-122-heap-based-buffer-overflow-abhilfemasznahmen-und-erkennung">
<h2>CWE-122: Heap-based Buffer Overflow - Abhilfema√ünahmen und Erkennung</h2>
<ul class="simple">
<li><p>Verwendung einer sicheren Programmiersprache</p></li>
<li><p>Verwendung von sicheren APIs</p></li>
<li><p>Kompilierung unter Verwendung entsprechender Schutzmechanismen (Position-Independent Executables (PIE), Canaries, ...)</p></li>
<li><p>H√§rtung der Umgebung (z.‚ÄØB. ASLR)</p></li>
<li><p>Statische Analyse Werkzeuge</p></li>
<li><p>Fuzzing</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-502-deserialization-of-untrusted-data">
<h2>CWE-502: Deserialization of Untrusted Data</h2>
</ld-topic><ld-topic id="cwe-502-deserialization-of-untrusted-data-1">
<h2>CWE-502: Deserialization of Untrusted Data</h2>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Nicht vertrauensw√ºrdige Daten werden deserialisiert ohne - <em>je nach Bibliothek notwendige vorhergehende</em> - Pr√ºfung, dass die Daten die erwarteten Eigenschaften haben.</p>
</dd>
<dt>Missbrauchswahrscheinlichkeit<span class="colon">:</span></dt>
<dd><p>Mittel</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>Java, Ruby, Python, PHP, JavaScript, ...</p>
</dd>
<dt>Ausma√ü<span class="colon">:</span></dt>
<dd><p>Insbesondere: Integrit√§t und Verf√ºgbarkeit (DoS); weitere Effekte sind vom Kontext abh√§ngig.</p>
</dd>
<dt>Alternative Begriffe<span class="colon">:</span></dt>
<dd><p>(Un-)Marshalling, (Un-)Pickling</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p>Bei der Serialisierung werden programminterne Objekte so verpackt, dass die Daten extern gespeichert und/oder √ºbertragen werden k√∂nnen. Die Deserialisierung kehrt diesen Prozess um.</p>
</div>
</ld-topic><ld-topic id="cwe-502-deserialization-of-untrusted-data-beispiel">
<h2>CWE-502: Deserialization of Untrusted Data - Beispiel</h2>
<p>Java</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">File</span><span class="whitespace"> </span><span class="name">file</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">File</span><span class="punctuation">(</span><span class="literal string">&quot;object.obj&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword">try</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">FileInputStream</span><span class="whitespace"> </span><span class="name">fin</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">FileInputStream</span><span class="punctuation">(</span><span class="name">file</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">      </span><span class="name">ObjectInputStream</span><span class="whitespace"> </span><span class="name">oin</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">ObjectInputStream</span><span class="punctuation">(</span><span class="name">fin</span><span class="punctuation">)</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">    </span><span class="name">javax</span><span class="punctuation">.</span><span class="name attribute">swing</span><span class="punctuation">.</span><span class="name attribute">JButton</span><span class="whitespace"> </span><span class="name">button</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">javax</span><span class="punctuation">.</span><span class="name attribute">swing</span><span class="punctuation">.</span><span class="name attribute">JButton</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">oin</span><span class="punctuation">.</span><span class="name attribute">readObject</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="supplemental docutils container">
<p>In diesem Beispiel wird ein Objekt aus einer Datei gelesen und in eine Variable vom Typ <code>javax.swing.JButton</code> geschrieben. Der Typ des Objekts wird nicht gepr√ºft. Es ist m√∂glich, dass die Datei ein Objekt enth√§lt, welches vom Typ <code>javax.swing.JButton</code> ist, aber nicht die Eigenschaften hat, die ein Button haben sollte. In diesem Fall wird keine Exception geworfen, aber das Objekt kann nicht wie erwartet verwendet werden bzw. es kommt zur Ausf√ºhrung von beliebigem Code.</p>
</div>
</ld-topic><ld-topic id="cwe-502-deserialization-of-untrusted-data-beispiel-1">
<h2>CWE-502: Deserialization of Untrusted Data - Beispiel</h2>
<div class="ld-exercise" data-exercise-id="20" data-exercise-title="20" id="ld-exercise-20">
<p>Python</p>
<pre class="code Python literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">class</span><span class="whitespace"> </span><span class="name class">ExampleProtocol</span><span class="punctuation">(</span><span class="name">protocol</span><span class="operator">.</span><span class="name">Protocol</span><span class="punctuation">):</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span>    <span class="keyword">def</span><span class="whitespace"> </span><span class="name function">dataReceived</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">data</span><span class="punctuation">):</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace"></span>        <span class="comment single"># ... parse the incoming data and</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span>        <span class="comment single"># after receiving headers, call confirmAuth() to authenticate</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace"></span>    <span class="keyword">def</span><span class="whitespace"> </span><span class="name function">confirmAuth</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">headers</span><span class="punctuation">):</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span>        <span class="keyword">try</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span>            <span class="name">token</span> <span class="operator">=</span> <span class="name">cPickle</span><span class="operator">.</span><span class="name">loads</span><span class="punctuation">(</span><span class="name">base64</span><span class="operator">.</span><span class="name">b64decode</span><span class="punctuation">(</span><span class="name">headers</span><span class="punctuation">[</span><span class="literal string single">'AuthToken'</span><span class="punctuation">]))</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span>            <span class="keyword">if</span> <span class="operator word">not</span> <span class="name">check_hmac</span><span class="punctuation">(</span><span class="name">token</span><span class="punctuation">[</span><span class="literal string single">'signature'</span><span class="punctuation">],</span> <span class="name">token</span><span class="punctuation">[</span><span class="literal string single">'data'</span><span class="punctuation">],</span> <span class="name">getSecretKey</span><span class="punctuation">()):</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace"></span>                <span class="keyword">raise</span> <span class="name">AuthFail</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace"></span>            <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">secure_data</span> <span class="operator">=</span> <span class="name">token</span><span class="punctuation">[</span><span class="literal string single">'data'</span><span class="punctuation">]</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span>        <span class="keyword">except</span><span class="punctuation">:</span><span class="whitespace">
</span></code><small class="ln">14 </small><code data-lineno="14 "><span class="whitespace"></span>            <span class="keyword">raise</span> <span class="name">AuthFail</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:G5kPP3MV0uVQzn2gbVX0WtVSWzMphxAPfz4bT1R67no=:GZlzj8t86uxMQN4Q:Eh09Vdy2MORTE1q53gZK+jR+UivH8gO+Jh31VU5D/rkeN+nn75Mp21qRZyIY8MAjYYKpVrlNDqN2fIh0R4B/OqFrXSQxoBWfllxsSF7ke0nE+g4RFhSiDOMgelQ2FrIJFhWfrnhR+BicnpXOMMhxlSTeJtGWMx9CRTN7s9iPBrIfUJOPQHDfFsepK0zupYgnNiu4uFfUrHPQ2Cb0Sq2th0uyrrUzrAjJm46WgzYYJ4e2ev090Vn0YHlFeOwgQHZuLYcffnhBTTmMpMmbG3PQMVeCVKrDraH9GbF1WSmOi4T+7oToRlYKIWTZeIg+d9nO7VosqfIcD1rf4YcwK+vvduOTBhSblD6YH4FzlhcpFVQlcwm5qA8s7MFE9eac7TOJQSy3cK/m5mAdMvmbqQz1ENLtpjKaNdPD6UA7qpGh3tMO0rVGtEvHGYP2Z6Lxzix6fzF4mwZsFCtLqxoP0AftOo8REXM9GGJkoH1klvLWlcYlE80NIqJUvF7raJOFPdaNr6OjWO3mFVGYr6/3IZ5OqDrbCz06Enz9EzkR8MmSoITTC85VnRwYtyRWqXv9HCwYHs1YUgFVYgE56eBJrx6aYr30OqrMUuwPXTVwnNsvxw6+Jef4ukJ/UqrL+EtVwKjJg9qEEAUmlqFRnLAQqiilzcIslKEBEl3oMTGeisDP0SGAZzwM/tl3V40YRIiVCdLqmJGRtjIoAEKmlMMUIpv1i6A9cNjG0r4JvkPKi/LqN9mR3sstZwUP1Cs3hJToFzCmdQFO0cflv4SbtYwxzhrEOEALAiGRTO98KQzw+yl8D4jYCyx6Qq5LWWpNWxuamOBEHMHxtBIsHCozyBkJVbyuqNVwmoyKdDPo3xf46SUBi9bZGTX8nHhbkyV+N6d0OMk9hn+l+VH/qs+dCDuKNj7qTSqAu5iPPqCtwFb5PSIqAQcRdkbHiZmyRAPFs0r0JvdIeq4/HKrucNTfoTp8RIc6uFJtI8gzYlqj2eiu</div>
</div>
</ld-topic><ld-topic id="cwe-502-deserialization-of-untrusted-data-abhilfemasznahmen-und-erkennung">
<h2>CWE-502: Deserialization of Untrusted Data - Abhilfema√ünahmen und Erkennung</h2>
<ul class="simple">
<li><p>ggf. Einsatz von Signaturen, um sicherzustellen, dass der serialisierte Code nicht manipuliert wurde</p></li>
<li><p>Serialisiere nur Daten, die auch wirklich serialisiert werden m√ºssen</p></li>
<li><p>Verwendung von sicheren Formaten (z.‚ÄØB. JSON)</p></li>
<li><p>statische Analyse</p></li>
</ul>
<p class="supplemental">Empfohlene Lekt√ºre: <a class="reference external" href="https://portswigger.net/web-security/deserialization">Deserialization Vulnerabilities</a></p>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-918-server-side-request-forgery-ssrf">
<h2>CWE-918: Server-Side Request Forgery (SSRF)<a class="brackets" href="#footnote-2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p>‚âà <span class="ger">Serverseitige Anfragef√§lschung</span></p>
</aside>
</aside>
</ld-topic><ld-topic id="cwe-918-server-side-request-forgery">
<h2>CWE-918: Server-Side Request Forgery</h2>
<dl class="field-list simple">
<dt>Kurze Beschreibung<span class="colon">:</span></dt>
<dd><p>Der Webserver erh√§lt eine URL oder eine √§hnliche Anfrage und ruft den Inhalt dieser URL ab, stellt aber nicht sicher, dass die Anfrage an das erwartete Ziel gesendet wird.</p>
</dd>
<dt>Technologien<span class="colon">:</span></dt>
<dd><p>Webserver</p>
</dd>
<dt>Ausma√ü<span class="colon">:</span></dt>
<dd><p>Vetraulichkeit, Integrit√§t</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-918-server-side-request-forgery-1">
<h2>CWE-918: Server-Side Request Forgery</h2>
<object aria-label="Server-Side Request Forgery (SSRF)" data="images/ssrf.svg" role="img" type="image/svg+xml">
</object></ld-topic><ld-topic id="cwe-918-server-side-request-forgery-2">
<h2>CWE-918: Server-Side Request Forgery</h2>
<p><strong>Beispiel: CVE-2002-1484</strong></p>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Wenn der DB4Web-Server so konfiguriert ist, dass er ausf√ºhrliche Debug-Meldungen verwendet, k√∂nnen entfernte Angreifer DB4Web als Proxy verwenden und √ºber eine Anfrage an eine URL, die die Ziel-IP-Adresse und den Port angibt, TCP-Verbindungen zu anderen Systemen (Port-Scan) versuchen, was einen Verbindungsstatus in der resultierenden Fehlermeldung erzeugt.</p>
</dd>
</dl>
<dl class="incremental-list field-list">
<dt>PoC<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="http://127.0.0.1/DB4Web/172.31.93.30:22/foo">http://127.0.0.1/DB4Web/172.31.93.30:22/foo</a></p>
</dd>
<dt>Workaround<span class="colon">:</span></dt>
<dd><p>Um die Ausnutzung dieses Features zu verhindern, muss die Standardfehlerseite durch eine benutzerdefinierte ersetzt werden.</p>
<div class="far-smaller minor docutils container">
<p>Der Hersteller betrachtet die Funktionalit√§t nicht als Fehler, sondern als Feature f√ºr Entwickler.</p>
</div>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-918-server-side-request-forgery-beispiel-nodejs-unicode-handling-fehler">
<h2>CWE-918: Server-Side Request Forgery - Beispiel: NodeJS Unicode Handling Fehler <a class="brackets" href="#footnote-3" id="footnote-reference-3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></h2>
<p>JavaScript:</p>
<pre class="code JavaScript literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name other">base</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string double">&quot;http://orange.tw/sandbox/&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name other">path</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name other">req</span><span class="punctuation">.</span><span class="name other">query</span><span class="punctuation">.</span><span class="name other">path</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name other">path</span><span class="punctuation">.</span><span class="name other">indexOf</span><span class="punctuation">(</span><span class="literal string double">&quot;..&quot;</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="operator">-</span><span class="literal number float">1</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="comment single">// check for no directory traversal</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace">    </span><span class="name other">http</span><span class="punctuation">.</span><span class="name other">get</span><span class="punctuation">(</span><span class="name other">base</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace"> </span><span class="name other">path</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name other">callback</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="incremental docutils container">
<p>Beispiel URL (<em>U+FF2E Full width Latin capital letter N</em>):</p>
<pre class="code restructuredtext incremental literal-block"><code>  http://orange.tw/sandbox/ÔºÆÔºÆ/passwd</code></pre>
<pre class="code restructuredtext incremental literal-block"><code>‚âô http://orange.tw/sandbox/\xFF\x2E\xFF\x2E/passwd</code></pre>
<pre class="code restructuredtext incremental literal-block"><code>‚âô http://orange.tw/sandbox/\x2E\x2E/passwd</code></pre>
<pre class="code restructuredtext incremental literal-block"><code>‚âô http://orange.tw/sandbox/../passwd</code></pre>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">Exploiting URL Parsers</a></p>
</aside>
</aside>
</ld-topic><ld-topic id="cwe-918-server-side-request-forgery-beispiel-url-parser-vs-abfrage-der-url">
<h2>CWE-918: Server-Side Request Forgery - Beispiel: URL Parser vs. Abfrage der URL</h2>
<p>PHP (&gt; 7.0.13):</p>
<pre class="code php literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="other">$url = 'http://foo&#64;127.0.0.1‚¨ú&#64;google.com:11211/'; // ‚¨ú is &quot;just&quot; a space
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="other">$parsed = parse_url($url);
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="other">var_dump($parsed[host]); // string(10) &quot;google.com&quot;
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="other">var_dump($parsed[port]); // int(11211)
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="other">curl($url);</span></code></pre>
<p>Ergebnis:</p>
<div class="incremental docutils container">
<p><span class="docutils literal">curl</span> fragt die URL <span class="docutils literal">127.0.0.1:11211</span> ab.</p>
<p>D.¬†h. <span class="docutils literal">curl</span> und php interpretieren die URL unterschiedlich.</p>
</div>
</ld-topic><ld-topic id="cwe-918-server-side-request-forgery-3">
<h2>CWE-918: Server-Side Request Forgery</h2>
<p class="rubric">Variante: Blind SSRF</p>
<p>Bei <em>Blind SSRF</em>-Schwachstellen werden auch Back-End-HTTP-Anfragen an eine bereitgestellte URL gestellt, die Antwort der Back-End-Anfrage jedoch nicht an die Front-End-Antwort der Anwendung zur√ºckgegeben.</p>
<div class="supplemental docutils container">
<p>Empfohlene Lekt√ºre: <a class="reference external" href="https://portswigger.net/web-security/ssrf/blind">Blind Server-Side Request Forgery (SSRF)</a></p>
</div>
</ld-topic><ld-topic id="cwe-918-server-side-request-forgery-abhilfemasznahmen-und-erkennung">
<h2>CWE-918: Server-Side Request Forgery - Abhilfema√ünahmen und Erkennung</h2>
<ul class="simple">
<li><p>keine (Wieder-)Verwendung der Eingabe URL</p></li>
<li><p>sichere APIs</p></li>
<li><p>statische Analyse (insbesondere Datenflu√üanalysen)</p></li>
<li><p>Behandlung von Zugriffen von lokalen Maschinen sollte mit der gleichen sorgfalt √ºberpr√ºft werden wie Zugriffe von externen Maschinen; andernfalls k√∂nnen kritische SSRF Angriffe durchgef√ºhrt werden</p></li>
<li><p>Firewall/Network Policy, um Zugriff auf interne Systeme zu verhindern</p></li>
</ul>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-843-access-of-resource-using-incompatible-type-type-confusion">
<h2>CWE-843: Access of Resource Using Incompatible Type (Type Confusion)</h2>
</ld-topic><ld-topic id="cwe-843-access-of-resource-using-incompatible-type-type-confusion-1">
<h2>CWE-843: Access of Resource Using Incompatible Type (Type Confusion)</h2>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Eine Anwendung initialisiert eine Ressource mit einem bestimmten Typ (z.‚ÄØB. Zeiger (<span class="eng">Pointer</span>), Objekt, etc.). Sp√§ter wird auf die Ressource (Variable) dann mit einem anderen Typ zugegriffen.</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>insbesondere (aber nicht ausschlie√ülich) C/C++; im Prinzip in jeder Sprache, die automatische Typkonvertierungen durchf√ºhrt.</p>
</dd>
<dt>Ausma√ü<span class="colon">:</span></dt>
<dd><p>Integrit√§t, Verf√ºgbarkeit, Vertraulichkeit</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-843-access-of-resource-using-incompatible-type-beispiel-in-c">
<h2>CWE-843: Access of Resource Using Incompatible Type - Beispiel in C</h2>
<div class="ld-exercise" data-exercise-id="21" data-exercise-title="21" id="ld-exercise-21">
<pre class="code c literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#define NAME_TYPE 1
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc"></span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">MessageBuffer</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">msgType</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="keyword">union</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">name</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">nameID</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="punctuation">};</span><span class="whitespace"> </span><span class="punctuation">};</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">**</span><span class="name">argv</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="keyword">struct</span><span class="whitespace"> </span><span class="name class">MessageBuffer</span><span class="whitespace"> </span><span class="name">buf</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">defaultMessage</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="literal string">&quot;Hello World&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace">    </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">msgType</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">NAME_TYPE</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">    </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">name</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">defaultMessage</span><span class="punctuation">;</span><span class="whitespace">              </span><span class="comment single">// printf(&quot;*buf.name %p&quot;, buf.name);
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="comment single"></span><span class="whitespace">    </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">nameID</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword type">int</span><span class="punctuation">)(</span><span class="name">defaultMessage</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="comment single">// printf(&quot;*buf.name %p&quot;, buf.name);
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="comment single"></span><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">buf</span><span class="punctuation">.</span><span class="name">msgType</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">NAME_TYPE</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;%s</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">name</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="keyword">else</span><span class="whitespace">                          </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;ID %d</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">buf</span><span class="punctuation">.</span><span class="name">nameID</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<aside class="admonition question">
<p class="admonition-title">Frage</p>
<p>Welche Ausgabe erzeugt das Programm?</p>
</aside>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:ocvcRFgIuEoBqZlonrVzhZbj3Vd7ZqiX3Nd5Xh8H1R4=:uDgA4qZ65v5EOj6j:63zh7NoCJsb3VdZyehYDB0kmqwERMvM2mGPtatfiQfQ71iuunKhjI4bwIeaPtA/fG78Xp+rbbna3Jt33FhCdXqV8Z4AtZOkm9HbaH6hwzyChm3YAOMuC3pBnyfk4H4gQIeTaf8nssU5TEdsubfIZnOCHtROdxbGuTLAxChgtkiRx4b+6wnWA/W4T3wGdZdn9VsFmRT0191eh66dq0MaJgKwPCgXZ4TsI2wsayXHsDI4jwO0Ym9RF5Dn3AoZiGxZD4Cy2AovHqEwWQ+J50yjzA6Qr/oOE/1rlhm0VLCq1IIelHavY2+99IjmAiPmstoU43A22YLp7Huif+uVpUCEQCz5evAI3paZbTWJwBdw3XFK5BR2YEDhmz+/iOqfxuFGnCleTGcsE/txsAFgQcgCeHVUh3ULLZgrlZdfErPmWR+j8VTZpa6xUBznZVzNvqui4i6CIxOlCdmp+HfRgvc/Gu/jNi1DwnjfqIbmcxAM9OGA4O35gkq0Nuav+Cto/y3iaF6BcCI23kv2ghJa9kDfEt3kQKfpstugEPs9WScrO4PmIKwzZWTw2SGN9oKpqXiR4QZ9UGxtk+igr5iBdwrQ9MSGyEdNoQWZuZpyIChvXv1Wl8Gi/vAVO61u0PYUMwGM=</div>
</div>
</ld-topic><ld-topic id="cwe-843-access-of-resource-using-incompatible-type-beispiel-in-perl">
<h2>CWE-843: Access of Resource Using Incompatible Type - Beispiel in Perl</h2>
<div class="ld-exercise" data-exercise-id="22" data-exercise-title="22" id="ld-exercise-22">
<pre class="code perl literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$UserPrivilegeArray</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="punctuation">[</span><span class="literal string">&quot;user&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;user&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal string">&quot;user&quot;</span><span class="punctuation">];</span><span class="whitespace">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="whitespace"></span><span class="keyword">my</span><span class="whitespace"> </span><span class="name variable">$userID</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">get_current_user_ID</span><span class="punctuation">();</span><span class="whitespace">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="whitespace"></span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name variable">$UserPrivilegeArray</span><span class="whitespace"> </span><span class="operator word">eq</span><span class="whitespace"> </span><span class="literal string">&quot;user&quot;</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword">print</span><span class="whitespace"> </span><span class="literal string">&quot;Regular user!\n&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace"></span><span class="keyword">else</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="keyword">print</span><span class="whitespace"> </span><span class="literal string">&quot;Admin!\n&quot;</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="whitespace"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace"></span><span class="keyword">print</span><span class="whitespace"> </span><span class="literal string">&quot;\$UserPrivilegeArray = $UserPrivilegeArray\n&quot;</span><span class="punctuation">;</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:QASJf5wzWY9AbtS1aUMu8jeE6GjkK6yQJY5RvdNW77g=:NGCjiVtvSZh2m3cn:UVBClrfHzLoPV/rGNTst63ACADXtrrs2WO04oYn0f4IIZg85/H0K60+RhCnAV+g8dLqY2ZnSm43ky3WsxPZjEwo1ZEdGQriYxFf6Z1oxV0ISj2/Z9p68H3ALMXWjU5JEbTpZUsVKAuNimlymeymKnezGw8N/5tH8GcvhydZ509rPCYOuXV5zuaR5gTx6Uneg9AszLfVm7KHifWPslz2Pd6MA4a4zDd3BuJoi864qP5egIMtC4UREHWqJD+AX5u6NU+bXEckZIP0hJQgfSppBwDSu9/He9G3ZOhVjB72H9L5xSjTDzGJxsTDab4e56/VWxrWIsRIBigd9c8CVnHCwSd8hAesNev0TrP4Hr9M4Xw9cwUGKw07uXwWCKQiwKDXI6D4QgLFosO4n41OpZlNei3TCKWn1p8vx9uDpQs1sjYpNwrVtYo2nQNcb/0FDaeZYK+Ev0KWP69q7zF9FEXt8L9joW+wQRPtqwu1KDjSf59At0LXcuCt0p5CDy5cTEGVHLfrqRRfMJ1aVCLjwXvsTfUq/zByr1NxGkcxq8SGSFm0iBsQN8Meg6rhj5BM6</div>
</div>
</ld-topic><ld-topic class="new-subsection transition-move-to-top" id="cwe-306-missing-authentication-for-critical-function">
<h2>CWE-306: Missing Authentication for Critical Function</h2>
</ld-topic><ld-topic id="cwe-306-missing-authentication-for-critical-function-1">
<h2>CWE-306: Missing Authentication for Critical Function</h2>
<dl class="field-list simple">
<dt>Beschreibung<span class="colon">:</span></dt>
<dd><p>Eine Anwendung f√ºhrt eine kritische Funktion aus, ohne die Identit√§t des Nutzers zu √ºberpr√ºfen. Kritischer Funktionen sind solche, die entweder signifikante Ressourcen verbrauchen oder nur von privilegierten Nutzern ausgef√ºhrt werden sollten.</p>
</dd>
<dt>Sprachen<span class="colon">:</span></dt>
<dd><p>&quot;alle&quot;</p>
</dd>
</dl>
</ld-topic><ld-topic id="cwe-306-missing-authentication-for-critical-function-abhilfemasznahmen-und-erkennung">
<h2>CWE-306: Missing Authentication for Critical Function - Abhilfema√ünahmen und Erkennung</h2>
<ul class="incremental-list simple">
<li><p>manuelle Code Reviews</p></li>
<li><p>statische Analyse (Bin√§rcode und/oder Quellcode)</p></li>
</ul>
</ld-topic><ld-topic class="s-vertical-title" id="dump-c-c">
<h2>Dump C /  C++</h2>
<img alt="Dump C / C++" class="screenshot align-center" src="screenshots/dump_c_c++_2024_02_27.webp" />
</ld-topic><ld-topic class="s-vertical-title" id="c-is-missjudged-by-the-white-house">
<h2>C++ is missjudged by the White House</h2>
<img alt="C++ is missjudged" class="align-center" src="screenshots/c++_creator_rebuts_white_house_warning-infoworld_2024_03_26.webp" />
</ld-topic><ld-topic class="new-section" id="open-worldwide-application-security-project-owasp">
<h2>Open Worldwide Application Security Project (OWASP)</h2>
</ld-topic><ld-topic id="owasp">
<h2>OWASP</h2>
<ul class="incremental-list simple">
<li><p>gemeinn√ºtzige Stiftung, die sich f√ºr die Verbesserung der Sicherheit von Software einsetzt</p></li>
<li><p>2001 gegr√ºndet</p></li>
<li><p>weltweit t√§tig</p></li>
<li><p>Stellt insbesondere Foren, Dokumente und Werkzeuge bereit</p></li>
<li><p>Dokumente, die bei der Entwicklung sicherer Anwendungen unterst√ºtzen:</p>
<ul>
<li><p><a class="reference external" href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Web Security Testing Guide</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-code-review-guide/">OWASP Code Review Guide</a></p></li>
</ul>
</li>
<li><p>Ausgew√§hlte Projekte:</p>
<ul class="incremental-list">
<li><p><a class="reference external" href="https://owasp.org/www-project-top-ten/">OWASP Top 10 (die relevantesten Sicherheitsprobleme bei Webanwendungen)</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-cheat-sheets/">Cheat Sheets</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-dependency-track/">OWASP Dependency-Track</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Web Security Testing Guide</a></p></li>
</ul>
</li>
</ul>
</ld-topic><ld-topic class="exercises" id="ubung-schwachstelle-n-1">
<h2>√úbung: Schwachstelle(n) (1)</h2>
<ld-scrollable>
<div class="ld-exercise" data-exercise-id="23" data-exercise-title="23 - malloc verstehen" id="ld-exercise-23">
<p class="ld-exercise-title rubric"><code class="c"><span class="name">malloc</span></code> verstehen</p>
<ol class="arabic simple">
<li><p>Benenne die Schwachstelle(n) entsprechend der CWEs (ohne ID).</p></li>
<li><p>Identifiziere die f√ºr die Schwachstelle(n) relevanten Zeilen im Code.</p></li>
<li><p>Gebe - falls m√∂glich - einen Angriffsvektor an.</p></li>
<li><p>Skizziere m√∂gliche Auswirkung der Schwachstelle(n) (z.‚ÄØB. Verlust der Vertraulichkeit, Integrit√§t oder Verf√ºgbarkeit; Umgehung der Zugriffskontrolle; beliebige Codeausf√ºhrung, ...)</p></li>
</ol>
<pre class="code C literal-block"><small class="ln"> 1 </small><code data-lineno=" 1 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 2 </small><code data-lineno=" 2 "><span class="comment preproc">#include</span><span class="whitespace"> </span><span class="comment preprocfile">&lt;string.h&gt;</span><span class="comment preproc">
</span></code><small class="ln"> 3 </small><code data-lineno=" 3 "><span class="comment preproc"></span><span class="keyword type">void</span><span class="whitespace"> </span><span class="name function">process</span><span class="punctuation">(</span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">str</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln"> 4 </small><code data-lineno=" 4 "><span class="whitespace">    </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">buffer</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">malloc</span><span class="punctuation">(</span><span class="literal number integer">16</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 5 </small><code data-lineno=" 5 "><span class="whitespace">    </span><span class="name">strcpy</span><span class="punctuation">(</span><span class="name">buffer</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">str</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln"> 6 </small><code data-lineno=" 6 "><span class="whitespace">    </span><span class="punctuation">...</span><span class="whitespace">
</span></code><small class="ln"> 7 </small><code data-lineno=" 7 "><span class="whitespace">    </span><span class="comment single">// ... definitively executed in the future: free(buffer);
</span></code><small class="ln"> 8 </small><code data-lineno=" 8 "><span class="comment single"></span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln"> 9 </small><code data-lineno=" 9 "><span class="whitespace"></span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="keyword type">int</span><span class="whitespace"> </span><span class="name">argc</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword type">char</span><span class="whitespace"> </span><span class="operator">*</span><span class="name">argv</span><span class="punctuation">[])</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">10 </small><code data-lineno="10 "><span class="whitespace">    </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">argc</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Usage: %s &lt;string&gt;</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]);</span><span class="whitespace"> </span><span class="keyword">return</span><span class="whitespace"> </span><span class="literal number integer">1</span><span class="punctuation">;</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">
</span></code><small class="ln">11 </small><code data-lineno="11 "><span class="whitespace">    </span><span class="name">process</span><span class="punctuation">(</span><span class="name">argv</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]);</span><span class="whitespace">
</span></code><small class="ln">12 </small><code data-lineno="12 "><span class="whitespace">    </span><span class="keyword">return</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">;</span><span class="whitespace">
</span></code><small class="ln">13 </small><code data-lineno="13 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:6RinVf6o/zwVC/wvT+jGpc32U9UFylI1nWCwjOTb7l0=:u7OrKCnQQczBWwe3:PLPY+eFnNgPbOioAlzvOZPA4Pcz7vvfWgzJgxHCZpKQB33Nr/zjRcqUEamyMGOVxp4a6CFYzXSfi0N/VlirIDtOuMiaVyZJI/JHbbwcwI8vcSclPmUNZOcUUgsu8x+Q8Hry7jugIxfIwdL4Hq90iWvU1CrsfYjRcC7zpx8eQAX9ncJticqGPtWoIxH4NURd5NoEN3feEkmCjd6NeNC111Inw2dfRhjMsTRw+14KxXGMLIqiq8CznGQFKMbvt6unSyx0340aDsGe6ptswE7YP7KCNCezrA93Ye5LdRvtHiP+prD9W/F67LPHYJhyXU84uFGPXUmilJlwnFN4z1jZMFRBTpF7TdEsfRu0By3pAZmP45vUvc3sD8K4dX/ID+/mDpbNy/VauUxi/nh9j1MVVmJ2GKOL2l3MDcjKvCgHWCjRO8DYQCXhC+K2J7EC+dedhfsZkbtuGMYdF/5p1QUBKErly6M7L9szywUCfRVzCSjpnS7z7smgui8Rn9zK8ICZaNYE3m+0go27nGFTNSq8nIwuSSrgxwR60O3/lz3wAFwfAUYTdE6wb3yybmVtV4DK43G7wF4hyxhJWxhcEoF/Q</div>
</div>
</ld-scrollable></ld-topic><ld-topic class="exercises" id="ubung-schwachstelle-n-2">
<h2>√úbung: Schwachstelle(n) (2)</h2>
<div class="ld-exercise" data-exercise-id="24" data-exercise-title="24 - REST API" id="ld-exercise-24">
<p class="ld-exercise-title rubric">REST API</p>
<p>Sie analysieren eine REST API die folgendes Verhalten aufweist, wenn man einem Blog einen Kommentar hinzuf√ºgen m√∂chte:</p>
<pre class="code HTTP literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name function">POST</span> <span class="name namespace">/post/comment</span> <span class="keyword reserved">HTTP</span><span class="operator">/</span><span class="literal number">1.1</span>
</code><small class="ln">2 </small><code data-lineno="2 "><span class="name attribute">Host</span><span class="operator">:</span> <span class="literal">important-website.com</span>
</code><small class="ln">3 </small><code data-lineno="3 "><span class="name attribute">Content-Length</span><span class="operator">:</span> <span class="literal">100</span>
</code><small class="ln">4 </small><code data-lineno="4 ">
</code><small class="ln">5 </small><code data-lineno="5 ">postId=3&amp;comment=This+&lt;post&gt;+was+helpful.&amp;name=Karl+Gustav</code></pre>
<p>Fragt man danach den Webservice nach dem Kommentar, dann erh√§lt man folgendes zur√ºck:</p>
<pre class="code HTML literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;comment&quot;</span><span class="punctuation">&gt;</span>
</code><small class="ln">2 </small><code data-lineno="2 ">    <span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;name&quot;</span><span class="punctuation">&gt;</span>Karl Gustav<span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span>
</code><small class="ln">3 </small><code data-lineno="3 ">    <span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;comment&quot;</span><span class="punctuation">&gt;</span>This <span class="punctuation">&lt;</span><span class="name tag">post</span><span class="punctuation">&gt;</span> was helpful.<span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span></code></pre>
<p>Bewerten Sie die Schwachstelle: CWE Name, problematische Codestelle(n), m√∂glicher Angriffsvektor und m√∂gliche Auswirkung.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:fVIU4kU3SwKGZwESfO1OC7zPCw2AWas9amNXJEdYt48=:iZsRG0nSXCVHlTx0:mNd6VElX/Z3iC066HB4YgDqw5Ia+BlJw9CZpf2R0YWphqxCJ9KPmwPeYXefkhWA+rE0JkhlnKmkuAYDEP1AfnA5hNDvpnCX0RGrEsvPF1Ars3pLGLcXzTaHM6lMqSHDb87TdGyCyIV4wkj/ATxSQD2ti2HmPyGpdrW5nxgiQg/AzUhLPiXiDbCoawggPidTpWIiM3AI4+llQWeKoxqXhrUlNialp9KbD8jn1ptFVs4gfDMQRIgnE5Pb2yF2dbKReR0kuX6F4IffhEG3GLMbsocbCd1Z27omBfncimKLS1Pb5ipeaTQ2yyNONK2bW7wHXRySmOCGDDvS6YizhEUYwe94irryuQknPiAmZGDJdqDwSsjHs84Q9dwglqRBqf8n+iEcI7bWpYto8ILq9Jndkbzx3dzK4bW1Q79rVUzC07r5+4cwFXm2OYP9Q6xkMDFcjRFY6VqhTXFKhP2xiOvLm1qgf0OFAIti4Hv5ZeeiREbZT48FydKYd5iSZxgheGruvhgq9eiEf+CAzpIWwqJr880aKXluJfTXnkbOW4wAHkQIGaogUScgmSTE90p3JgtZOAXRKdHtOrMwIXP2t3YNuZPXPBffHyGizjyAa3w1kbEAqlpjvN0u4XbryOLokD1oJnXWkEjQcEBE8yUJdBA8KJOEv2T/+RhKAxDtVS4mjaMWuhC1AA10nCsWhXWi7EwkPYL8H9KpDFMQkn66rs2DadJNBZpuDu5jYNtWeBtE=</div>
</div>
</ld-topic><ld-topic class="exercises" id="ubung-schwachstelle-n-3">
<h2>√úbung: Schwachstelle(n) (3)</h2>
<div class="ld-exercise" data-exercise-id="25" data-exercise-title="25 - SQL Abfrage mit Java" id="ld-exercise-25">
<p class="ld-exercise-title rubric">SQL Abfrage mit Java</p>
<pre class="code java literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="name">String</span><span class="whitespace"> </span><span class="name">query</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace">    </span><span class="literal string">&quot;SELECT account_balance FROM user_data WHERE user_name = &quot;</span><span class="whitespace">
</span></code><small class="ln">3 </small><code data-lineno="3 "><span class="whitespace">        </span><span class="operator">+</span><span class="whitespace"> </span><span class="name">request</span><span class="punctuation">.</span><span class="name attribute">getParameter</span><span class="punctuation">(</span><span class="literal string">&quot;customerName&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">4 </small><code data-lineno="4 "><span class="whitespace"></span><span class="keyword">try</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
</span></code><small class="ln">5 </small><code data-lineno="5 "><span class="whitespace">    </span><span class="name">Statement</span><span class="whitespace"> </span><span class="name">statement</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">connection</span><span class="punctuation">.</span><span class="name attribute">createStatement</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="punctuation">...</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">6 </small><code data-lineno="6 "><span class="whitespace">    </span><span class="name">ResultSet</span><span class="whitespace"> </span><span class="name">results</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">statement</span><span class="punctuation">.</span><span class="name attribute">executeQuery</span><span class="punctuation">(</span><span class="whitespace"> </span><span class="name">query</span><span class="whitespace"> </span><span class="punctuation">);</span><span class="whitespace">
</span></code><small class="ln">7 </small><code data-lineno="7 "><span class="whitespace"></span><span class="punctuation">}</span></code></pre>
<p>Bewerten Sie die Schwachstelle: CWE Name, problematische Codestelle(n), m√∂glicher Angriffsvektor und m√∂gliche Auswirkung.</p>
</div>
</ld-topic><ld-topic class="exercises" id="ubung-schwachstelle-n-4">
<h2>√úbung: Schwachstelle(n) (4)</h2>
<aside class="admonition dd-margin-left-3em note">
<p class="admonition-title">Bemerkung</p>
<p><strong>URL Encoding</strong></p>
<dl class="field-list simple">
<dt>%20<span class="colon">:</span></dt>
<dd><p>Leerzeichen</p>
</dd>
<dt>%22<span class="colon">:</span></dt>
<dd><p>&quot;</p>
</dd>
<dt>%3C<span class="colon">:</span></dt>
<dd><p>&lt;</p>
</dd>
<dt>%3E<span class="colon">:</span></dt>
<dd><p>&gt;</p>
</dd>
<dt>%2F<span class="colon">:</span></dt>
<dd><p>/</p>
</dd>
</dl>
</aside>
<div class="ld-exercise" data-exercise-id="26" data-exercise-title="26 - Verwendung von HTTP Query Parametern" id="ld-exercise-26">
<p class="ld-exercise-title rubric">Verwendung von HTTP Query Parametern</p>
<p>Sie beobachten folgendes Verhalten einer Webseite:</p>
<p><strong>Anfrage</strong></p>
<pre class="code http literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="error">https://my-website.com/search?</span><span class="whitespace">
</span></code><small class="ln">2 </small><code data-lineno="2 "><span class="whitespace"></span><span class="error">      term=This%20is%20a%20%3C%22%3Egift%3C%2F%22%3E</span></code></pre>
<p><strong>Antwort</strong></p>
<pre class="code HTML literal-block"><small class="ln">1 </small><code data-lineno="1 "><span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;search-result&quot;</span><span class="punctuation">&gt;</span>
</code><small class="ln">2 </small><code data-lineno="2 ">    <span class="punctuation">&lt;</span><span class="name tag">div</span> <span class="name attribute">class</span><span class="operator">=</span><span class="literal string">&quot;title&quot;</span><span class="punctuation">&gt;</span>This is a <span class="error">&lt;</span>&quot;&gt;gift<span class="error">&lt;</span>/&quot;&gt;<span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span>
</code><small class="ln">3 </small><code data-lineno="3 "><span class="punctuation">&lt;/</span><span class="name tag">div</span><span class="punctuation">&gt;</span></code></pre>
<p>Bewerten Sie die Schwachstelle: CWE Name, problematische Codestelle(n), m√∂glicher Angriffsvektor und m√∂gliche Auswirkung.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:ftNcLIdvboBzJYicOp9DJ7qn9Rpt7vtEptygS+QnJOs=:XSGslkeObFoUmefA:zVn81Us+UzU0mzEMyML3ymVbD+WLU5pS659eKktor2IOXV2dRbWOUJHrpR49y/jbXWgX+akOJLpyGpHYTHFKJhQdAe/usSypg0dCccxwZ67AVH2O99B07ULErd9Tsu4UEqhUy4nD0nsFu3v9Uq4dywGAFEQ9SASULhTTfQ4ES/Qpnc7UkMu+T4DYf54+yGfeSOj/oFu4WHHJFU5tKMfLmuT4TG9oFHqgkua0KPJ5VfPKQjfv+NgiZi+ojvdrCEhn0OZaNjwVOrDrlpNLcYVlzeLdQWJufe7fzMhTJowHZ2Pk/k2UC5CyLxAdn7KfV3l6VZm6mqJEi3CrpLbwe52zaBv44ETnWSDtv1haQXdIaMe/IdQYvWyAmpuOGdCQ3InjyxBUft6kTmSz9Aw63OtyKZwRbTzY3GNZNmQcExa4ykrZUyrgReroth0sdeQ1LiSbO0ar7pkM2Jwqj4EN7Esxc/YHKHJUgJaxs9DSwy6t4/ji1YHV7WvlhBW9bHdX1YE8nqSOQZ2M+E0nqopeND+XgyAYMGBhemRKRzNxbyuwq13TEJrIYn+rhmMB5jyO193mcAypE9KT+jg5v6cYHigJ4AB4gVU3qf9wVWJnwkQvkbsCpilawwWjz/OGDA==</div>
</div>
</ld-topic>
</template>
</body>
</html>
