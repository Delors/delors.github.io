<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta name="exercises-passwords" content="MTAwMDAw:QSxWaioWi0EqQNqhAv1wUiLzFEq9pvWsLEcXyIi+JLA=:KIfW7I6IWc7RNtYh:4tGKlt2E3CDScfzsFy1WanZs41Vf4SZBcyiH6MWj+NT2sKlwadz20PKbPIjWKqpe5TBZHlJ1neqpdl6yuDSfwET0DAGH+Y1xNRCoKOVlgqkZikzQmJr6UdtfMwH8AoBis7K4ZxSxOMVHEwufv9pgSD4QalAZGzk55QdiBmEzCnJvnldq99qfhn2vxMe1cdxl5r2xMq/P8PW6dj423OASr7t8W/0sF34+m0CeQxxFR9yKLMS3t9YZpaxvPbleX0YC+PRG75/2rRdGH4UMOgamyB8=" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="LD2 0.1" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;IT Sicherheit&quot;, &quot;Reverse Engineering&quot;" name="keywords" />
<meta content="Fortgeschrittene Angewandte IT Sicherheit" lang="de" name="description" xml:lang="de" />
<meta content="lecture-security-java_reverse_engineering" name="id" />
<meta content="last-viewed" name="first-slide" />
<title>Reverse Engineering 101</title>

    <script src="../LectureDoc2/ld-core.js" type="module"></script>

    <script src="../LectureDoc2/ld-components.js" type="module"></script>

    <!-- Additional scripts that interact with LectureDoc have to be added below. -->
    <link rel="stylesheet" href="../LectureDoc2/ld.css" type="text/css" />

    <link rel="stylesheet" href="../LectureDoc2/themes/DHBW/theme.css" type="text/css" />

    
    <script src="../LectureDoc2/themes/DHBW/logo.js" type="module"></script>
</head>
<body>
<template>
<div class="animated-symbol organic-red ld-slide" id="reverse-engineering-101">
<h1 class="title">Reverse Engineering 101</h1>

<div class="docutils container">
<dl class="field-list simple">
<dt>Dozent<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt>Kontakt<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="mailto:michael.eichberg&#64;dhbw-mannheim.de">michael.eichberg&#64;dhbw-mannheim.de</a></p>
</dd>
<dt>Version<span class="colon">:</span></dt>
<dd><p>1.0.1</p>
</dd>
</dl>
</div>
<div class="supplemental">
<dl class="field-list">
<dt>Folien<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/sec-reversing101/folien.de.rst.html">https://delors.github.io/sec-reversing101/folien.de.rst.html</a></p>
<p><a class="reference external" href="https://delors.github.io/sec-reversing101/folien.de.rst.html.pdf">https://delors.github.io/sec-reversing101/folien.de.rst.html.pdf</a></p>
</dd>
<dt>Fehler melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div></div>
<div class="ld-slide" id="vorerfahrungen">
<h2>Vorerfahrungen?</h2>
<ul class="incremental simple">
<li><p>Wer hat schon einmal Software or Hardware Reverse Engineering betrieben?</p></li>
<li><p>Wer kennt Java Bytecode?</p></li>
<li><p>Wer hat Erfahrung mit Python?</p></li>
</ul>
</div><div class="ld-slide" id="reverse-engineering">
<h2>Reverse Engineering</h2>
<p>Reverse Engineering ist die Analyse von Systemen mit dem Ziel, ihren Aufbau und ihre Funktionsweise zu verstehen.</p>
<div class="incremental">
<p>Typische Anwendungsfälle:</p>
<ul class="incremental simple">
<li><p>die Rekonstruktion (von Teilen) des Quellcodes von Programmen, die nur als Binärabbild vorliegen.</p></li>
<li><p>die Analyse von Kommunikationsprotokollen proprietärer Software</p></li>
</ul>
</div><div class="supplemental">
<p>Vom Reverse Engineering ist das <strong>Reengineering</strong> zu unterscheiden. Im Fall von letzteren geht es <span class="ger-quote">nur</span> darum die Funktionalität eines bestehenden Systems mit neuen Techniken wiederherzustellen.</p>
</div></div><div class="ld-slide" id="zweck-von-reverse-engineering">
<h2>Zweck von Reverse Engineering</h2>
<ul class="incremental simple">
<li><p>Herstellung von Interoperabilität</p></li>
<li><p>Untersuchung auf Schwachstellen</p></li>
<li><p>Untersuchung auf Copyrightverletzungen</p></li>
<li><p>Untersuchung auf Backdoors</p></li>
<li><p>Analyse von Viren, Würmern etc.</p></li>
<li><p>Umgehung von ungerechtfertigten(?) Schutzmaßnahmen (z. B. bei Malware)</p></li>
</ul>
</div><div class="ld-slide" id="bootrom-lucke">
<h2>Bootrom Lücke</h2>
<blockquote class="epigraph">
<p><strong>CPU-Lücke macht Malware-Infektionen nahezu unumkehrbar</strong></p>
<p>Die Schwachstelle verschafft Angreifern Zugang zu einer der höchsten Privilegienstufen heutiger PC-Systeme. Schadsoftware entzieht sich damit jeglicher Erkennung.</p>
<p>[...] Gegenüber Wired erklärten die Forscher, per Sinkclose ließen sich etwa Bootkits installieren, die für das Betriebssystem und gängige Antivirensoftware unsichtbar seien, während Angreifer einen Vollzugriff auf das Zielsystem erhielten.</p>
<p class="attribution">—August, 2024 - <a class="reference external" href="https://www.golem.de/news/sinkclose-trifft-amd-cpu-luecke-macht-malware-infektionen-nahezu-unumkehrbar-2408-187913.html">Golem.de</a> (<a class="reference external" href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-7014.html">AMD CVE</a>)</p>
</blockquote>
</div><div class="smaller-slide-title ld-slide" id="cve-2024-3094-liblzma-backdoor-in-openssh">
<h2><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2024-3094">CVE-2024-3094</a> - <span class="docutils literal">liblzma</span> Backdoor in OpenSSH<a class="footnote-reference brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a><a class="footnote-reference brackets" href="#footnote-2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></h2>
<ul class="incremental columns far-far-smaller">
<li><p>Ziel</p>
<p>Das Verhalten von SSH bei der Authentifikation so zu verändern, dass es dem Angreifer Zugang zum System erlaubt.</p>
<p>Zur Absicherung der Backdoor ist diese über ein Zertifikat abgesichert.</p>
</li>
<li><p>Verbreitung des Schadcode?</p>
<p>Die Bibliothek <span class="docutils literal">liblzma</span> wurde so angepasst, dass diese eine Backdoor in SSH einbaut.</p>
<p>Der Schadcode ist nur in den Tarballs zu finden - nicht im SourceCode im GIT. Der eigentliche Schadcode wurde versteckt in <em>Testfixtures</em>.</p>
<p>Der Code wurde so entworfen, dass bekannte Werkzeuge (<em>Valgrind</em>) keine Probleme erkennen.</p>
<p>Die Bibliothek wurde nur in bestimmten Situationen von OpenSSH verwendet.</p>
</li>
<li><p>Bewertung</p>
<p><em>CVSS Base Score</em>: 10.0 (kritisch)</p>
<p><em>Entstandener Schaden</em>: vermutlich gering, da (gerade noch) keine offiziellen Releases (von Debian, Ubuntu, etc.) betroffen waren.</p>
<p>Dem Angriff ging ein sehr langer Social Engineering Angriff voraus, weswegen mit höherer Wahrscheinlichkeit ein <span class="ger-quote">State-sponsored Actor</span> dahintersteckt.</p>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.innoq.com/de/podcast/030-xz-open-ssh-backdoor/transcript/">InnoQ  Podcast</a></p>
</aside>
<aside class="footnote brackets" id="footnote-2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.ssh.com/blog/a-recap-of-the-openssh-and-xz-liblzma-incident#:~:text=The%20harsh%20fact%20is%20that,by%20one%20of%20its%20maintainers">SSH Blob</a></p>
</aside>
</aside>
</div><div class="ld-slide" id="backdoor-in-16-d-link-routern">
<h2>Backdoor in 16 D-Link Routern<a class="footnote-reference brackets" href="#footnote-3" id="footnote-reference-3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></h2>
<ul class="simple">
<li><p>Angreifer können aus dem lokalen Netzwerk heraus den Telnet-Dienst betroffener D-Link-Router durch Angabe einer bestimmten Ziel URL aktivieren.</p></li>
<li><p>Die Admin-Zugangsdaten sind in der Firmware hinterlegt.</p></li>
<li><p>Vermutlich ursprünglich für werksseitige Tests.</p></li>
<li><p><em>CVSS Base Score</em>: 8.8 (hoch)</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.golem.de/news/d-link-versteckte-backdoor-in-16-routermodellen-entdeckt-2406-186277.html">Golem.de</a></p>
</aside>
</aside>
</div><div class="ld-slide" id="reverse-engineering-grundlegende-schritte">
<h2>Reverse Engineering - grundlegende Schritte</h2>
<ol class="arabic simple incremental dhbw">
<li><p>Informationsgewinnung zur Gewinnung aller relevanten Informationen über das Produkt.</p></li>
<li><p>Modellierung mit dem Ziel der (Wieder-)Gewinnung eines (abstrakten) Modells der relevanten Funktionalität.</p></li>
<li><p>Überprüfung (<span class="eng">review</span>) des Modells auf seine Richtigkeit und Vollständigkeit.</p></li>
</ol>
</div><div class="ld-slide" id="informationsgewinnung-beispiel">
<h2>Informationsgewinnung - Beispiel</h2>
<p>Gegeben sei eine App zum Ver- und Entschlüsseln von Dateien sowie ein paar verschlüsselte Dateien. Mögliche erste Schritte vor der Analyse von Binärcode:</p>
<div class="stack docutils container">
<div class="layer incremental docutils container">
<ul class="simple">
<li><p>Die ausführbare Datei ggf. mit <span class="docutils literal">file</span> (oder sogar mit <span class="docutils literal">binwalk</span>) überprüfen (z. B. wie wurde die Datei kompiliert und für welches Betriebssystem und Architektur)</p></li>
</ul>
<blockquote>
<p>Beispiel:</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>file<span class="whitespace"> </span>/usr/bin/openssl<span class="whitespace">
</span>/usr/bin/openssl:<span class="whitespace"> </span>Mach-O<span class="whitespace"> </span>universal<span class="whitespace"> </span>binary<span class="whitespace"> </span>with<span class="whitespace"> </span><span class="literal number">2</span><span class="whitespace"> </span>archi...<span class="whitespace">
</span>/usr/bin/openssl<span class="whitespace"> </span><span class="operator">(</span><span class="keyword">for</span><span class="whitespace"> </span>architecture<span class="whitespace"> </span>x86_64<span class="operator">)</span>:<span class="whitespace"> </span>Mach-O<span class="whitespace"> </span><span class="literal number">64</span>-bit<span class="whitespace">
</span>/usr/bin/openssl<span class="whitespace"> </span><span class="operator">(</span><span class="keyword">for</span><span class="whitespace"> </span>architecture<span class="whitespace"> </span>arm64e<span class="operator">)</span>:<span class="whitespace"> </span>Mach-O<span class="whitespace"> </span><span class="literal number">64</span>-bit</code></pre>
</blockquote>
</div>
<div class="layer incremental docutils container">
<ul>
<li><p>Die Dateien mit einem (guten) Hexeditor auf Auffälligkeiten untersuchen.</p>
<img alt="Hexeditor mit Dateninterpretation" class="align-center" src="pictures/hexeditor.png" style="height: 600px;" />
</li>
</ul>
</div>
<div class="layer incremental warning docutils container">
<p>Die Datei auf bekannte Viren und Malware überprüfen.</p>
</div>
<div class="layer incremental docutils container">
<ul>
<li><p>Eine Datei mit einem bekannten Inhalt verschlüsseln und danach vergleichen.</p>
<p>Ist die Datei gleich groß?</p>
<blockquote>
<p>Falls ja, dann werden keine Metainformationen gespeichert und das Passwort kann (ggf.) nicht (leicht) verifiziert werden.</p>
<p>(Es kann zumindest nicht direkt in der Datei gespeichert sein.)</p>
</blockquote>
</li>
</ul>
</div>
<div class="layer incremental docutils container">
<ul>
<li><p>Eine Datei mit verschiedenen Passworten verschlüsseln.</p>
<p>Sind die Dateien gleich?</p>
<blockquote>
<p>Falls ja, dann wäre die Verschlüsselung komplett nutzlos und es gilt nur noch den konstanten Schlüssel zu finden.</p>
</blockquote>
<p>Gibt es Gemeinsamkeiten?</p>
<blockquote>
<p>Falls ja, dann wäre es möglich, dass das Passwort (gehasht) in der Datei gespeichert wird.</p>
</blockquote>
</li>
</ul>
</div>
<div class="layer incremental docutils container">
<ul class="simple">
<li><p>Eine Datei mit einem wohldefinierten Muster verschlüsseln, um ggf. den <span class="ger-quote">Mode of Operation</span> (insbesondere ECB) zu identifizieren.</p></li>
</ul>
</div>
<div class="layer incremental docutils container">
<ul>
<li><p>Mehrere verschiedene Dateien mit dem gleichen Passwort verschlüsseln</p>
<p>Gibt es Gemeinsamkeiten?</p>
<blockquote>
<p>Falls ja, dann wäre es möglich, dass die entsprechenden Teile direkt vom Passwort abgeleitet werden/damit verschlüsselt werden.</p>
</blockquote>
</li>
</ul>
</div>
<div class="layer incremental docutils container">
<ul class="simple">
<li><p>...</p></li>
</ul>
</div>
<div class="layer incremental docutils container">
<ul class="simple">
<li><p>Reverse Engineering der App durchführen.</p></li>
</ul>
</div>
</div>
</div><div class="ld-slide" id="rechtliche-aspekte-des-reverse-engineering">
<h2>Rechtliche Aspekte des Reverse Engineering</h2>
<aside class="admonition caution">
<p class="admonition-title">Vorsicht!</p>
<p>Die Gesetzgebungen unterscheiden sich von Land zu Land teils signifikant.</p>
</aside>
<ul class="incremental simple">
<li><p>Die Rechtslage hat sich in Deutschland mehrfach geändert.</p></li>
<li><p>Umgehung von Kopierschutzmechanismen ist im Allgemeinen verboten.</p></li>
<li><p>Lizenzen verbieten das Reverse Engineering häufig; es stellt sich aber die Frage nach der Rechtmäßigkeit der Klauseln.</p></li>
</ul>
<div class="center-child-elements docutils container">
<aside class="admonition incremental warning">
<p class="admonition-title">Warnung</p>
<p>Bevor Sie Reverse Engineering von Systemen betreiben, erkundigen sie sich erst über mögliche rechtliche Konsequenzen.</p>
</aside>
</div>
</div><div class="new-section transition-scale ld-slide" id="software-reverse-engineering">
<h2>Software Reverse Engineering</h2>
</div><div class="ld-slide" id="ansatze">
<h2>Ansätze</h2>
<div class="scrollable docutils container">
<dl class="field-list simple">
<dt>statische Analyse<span class="colon">:</span></dt>
<dd><p>Studieren des Programms ohne es auszuführen; typischerweise mittels eines Disassemblers oder eines Decompilers.</p>
</dd>
</dl>
<dl class="incremental field-list simple">
<dt>dynamische Analyse<span class="colon">:</span></dt>
<dd><p>Ausführen des Programms; typischerweise unter Verwendung eines Debuggers oder eines instrumentations Frameworks (z. B. <a class="reference external" href="https://frida.re">Frida</a>).</p>
</dd>
</dl>
<dl class="incremental field-list">
<dt>hybride Analyse<span class="colon">:</span></dt>
<dd><p>Kombination aus statischer und dynamischer Analyse.</p>
<p>Ansätze wie <a class="reference external" href="https://www.unicorn-engine.org">Unicorn</a>, welches auf <a class="reference external" href="https://www.qemu.org">QEmu</a> aufbaut, erlaubt zum Beispiel die Ausführung von (Teilen von) Binärcode auf einer anderen Architektur als der des Hosts.</p>
<p>Ein Beispiel wäre die Ausführung einer Methode, die im Code verschlüsselte hinterlegte Strings entschlüsselt (<span class="eng">deobfuscation</span>), um die Analyse zu vereinfachen.</p>
</dd>
</dl>
<div class="incremental docutils container">
<p>Ggf. müssen für Teile des Codes, die die Hostfunktionalität nutzen, Stubs/Mocks bereitgestellt werden.</p>
</div>
</div>
</div><div class="ld-slide" id="disassembler">
<h2>Disassembler</h2>
<p>Überführt (maschinenlesbaren) Binärcode in Assemblercode</p>
<p>Kommandozeilenwerkzeuge (exemplarisch):</p>
<ul class="simple">
<li><p><span class="docutils literal">objdump <span class="pre">-d</span></span></p></li>
<li><p><span class="docutils literal">gdb</span></p></li>
<li><p><span class="docutils literal">radare</span></p></li>
<li><p><span class="docutils literal">javap (für Java)</span></p></li>
</ul>
<aside class="admonition incremental small hint">
<p class="admonition-title">Hinweis</p>
<p>Für einfache Programme ist es häufig möglich direkt den gesamten Assemblercode mittels der entsprechenden Werkzeuge zu erhalten. Im Falle komplexer Binärdateien (z. B. im ELF (Linux) und PE (Windows) Format) gilt dies nicht und erfordert ggf. manuelle Unterstützung zum Beispiel durch das Markieren von Methodenanfängen.</p>
<p>Im Fall von Java <span class="docutils literal">.class</span> ist die Disassemblierung immer möglich.</p>
</aside>
</div><div class="ld-slide" id="decompiler">
<h2>Decompiler</h2>
<p>Überführt (maschinenlesbarem) Binärcode <em>bestmöglich</em> in Hochsprache (meist C ähnlich oder Java). Eine <em>kleine</em> Auswahl von verfügbaren Werkzeugen:</p>
<ul class="simple">
<li><p>Hex-Rays IDAPro (kommerziell)</p></li>
<li><p><a class="reference external" href="https://ghidra-sre.org/">Ghidra</a> (unterstützt fast jede Platform; die Ergebnisse sind sehr unterschiedlich.)</p></li>
<li><p>JadX (Androids <span class="docutils literal">.dex</span> Format)</p></li>
<li><p>CFR (Java <span class="docutils literal">.class</span> Dateien)</p></li>
<li><p>IntelliJ</p></li>
</ul>
<div class="supplemental">
<p>Mittels Decompiler ist es ggf. möglich Code, der zum Beispiel ursprünglich in Kotlin oder Scala geschrieben und für die JVM kompiliert wurde, als Java Code zurückzubekommen.</p>
<p>Die Ergebnisse sind für Analysezwecke zwar häufig ausreichend gut – von funktionierendem Code jedoch ggf. (sehr) weit entfernt.</p>
<p><a class="reference external" href="https://decompiler.com">decompiler.com</a> unterstützt eine große Anzahl ausführbaren Dateien.</p>
</div><aside class="admonition incremental small hint">
<p class="admonition-title">Hinweis</p>
<p>Decompiler sind generell sehr hilfreich, aber gleichzeitig auch sehr fehlerbehaftet. Vieles, dass im Binärcode möglich ist, hat auf der Ebene des Sourcecodes keine Entsprechung.</p>
<p>Zum Beispiel unterstützt Java Bytecode beliebige Sprünge. Solche Code wird aber durch normale Programme, die z. B. in Java, Kotlin, Scala oder Clojure geschrieben wurden, nicht erzeugt. Decompiler kommen mit solchem Code in der Regel nicht (gut) zurecht.</p>
</aside>
</div><div class="ld-slide" id="cfr-decompiler">
<h2>cfr Decompiler</h2>
<img alt="The CFR Decompiler (Java)" class="align-center" src="pictures/cfr.png" style="height: 1050px;" />
</div><div class="ld-slide" id="jd-decompiler">
<h2>JD Decompiler</h2>
<div class="two-columns docutils container">
<div class="column no-separator docutils container">
<img alt="The JD Decompiler (Java)" src="pictures/jd.png" style="width: 875px;" />
</div>
<div class="column no-separator incremental small docutils container">
<figure>
<img alt="pictures/jd-excerpt.png" class="picture" src="pictures/jd-excerpt.png" style="width: 875px;" />
<figcaption>
<p>Beispiel fehlgeschlagener Dekompilierung</p>
</figcaption>
</figure>
</div>
</div>
</div><div class="ld-slide" id="jdec-decompiler">
<h2>JDec Decompiler</h2>
<img alt="The JDec Decompiler (Java)" class="align-center" src="pictures/jdec.png" style="height: 1050px;" />
</div><div class="ld-slide" id="debugger">
<h2>Debugger</h2>
<p>Dient der schrittweisen Ausführung des zu analysierenden Codes oder Hardware; ermöglichen zum Beispiel Speicherinspektion und Manipulation.</p>
<ul class="simple">
<li><p>gdb</p></li>
<li><p>lldb</p></li>
<li><p>x64dbg (Windows, Open-Source)</p></li>
<li><p>jdb (Java Debugger)</p></li>
</ul>
<div class="supplemental">
<p class="rubric">Hardware Debugger</p>
<p>Für das Debuggen von Hardware gibt es entsprechende Werkzeuge, z. B.
<a class="reference external" href="https://www.lauterbach.com">Lauterbach Hardware Debugger</a> (kommerziell und sehr teuer).</p>
<p>Mittels solcher Werkzeuge ist es möglich die Ausführung von Hardware Schritt für Schritt (<span class="eng">single step mode`</span>) zu verfolgen und den Zustand der Hardware (Speicher und Register) zu inspizieren. Dies erfordert jedoch häufig eine JTAG Schnittstelle oder etwas vergleichbares.</p>
</div></div><div class="new-section transition-fade ld-slide" id="erschwerung-des-reverse-engineering">
<h2>Erschwerung des Reverse Engineering</h2>
</div><div class="new-subsection ld-slide" id="obfuscation-verschleierung">
<h2>Obfuscation (<span class="ger">Verschleierung</span>)</h2>
</div><div class="ld-slide" id="obfuscation-fur-menschen-unverstandlich-code">
<h2>Obfuscation → für Menschen unverständlich Code</h2>
<ul class="incremental scrollable simple">
<li><p>Techniken, die dazu dienen das Reverse Engineering zu erschweren.</p></li>
<li><p>Häufig eingesetzt ...</p>
<ul class="incremental">
<li><p>von Malware</p></li>
<li><p>Adware (im Kontext von Android ein häufig beobachtetes Phänomen)</p></li>
<li><p>zum Schutz geistigen Eigentums</p></li>
<li><p>für DRM / Durchsetzung von Kopierrechten</p></li>
<li><p>zur Prävention von <span class="ger-quote">Cheating</span> (insbesondere im Umfeld von Online Games)</p></li>
<li><p>Wenn das Programm als Source Code vertrieben wird bzw. vertrieben werden muss (JavaScript)</p></li>
</ul>
</li>
<li><p>Arbeiten auf Quellcode oder Maschinencode Ebene</p></li>
<li><p>Grenze zwischen <em>Code Minimization</em>, <em>Code Optimization</em> und <em>Code Obfuscation</em> ist fließend.</p></li>
<li><p>Mögliche Werkzeuge (ohne Wertung der Qualität/Effektivität):</p>
<ul>
<li><p>[Java] Proguard / Dexguard</p></li>
<li><p>[C/C++] <a class="reference external" href="https://www.star-force.com/products/starforce-crypto/">Star Force</a></p></li>
</ul>
</li>
</ul>
<div class="supplemental">
<p>Gerade im Umfeld von klassischen <em>Binaries</em> für Windows, Mac und Linux erhöhen Compiler Optimierungen, z. B. von C/C++ und Rust Compilern (<span class="docutils literal"><span class="pre">-O2</span> / <span class="pre">-O3</span></span>), bereits den Aufwand, der notwendig ist den Code zu verstehen, erheblich.</p>
<aside class="admonition hint">
<p class="admonition-title">Hinweis</p>
<p>Einen ambitionierten und entsprechend ausgestatteten Angreifer wird <strong>Code Obfuscation</strong> bremsen, aber sicher nicht vollständig ausbremsen und das Vorhaben verteilen.</p>
</aside>
</div></div><div class="ld-slide" id="obfuscation-techniken-auszug">
<h2>Obfuscation - Techniken (Auszug)</h2>
<ul class="scrollable incremental">
<li><p><span class="minor">entfernen aller Debug-Informationen</span></p></li>
<li><p>Das Kürzen aller möglichen Namen (insbesondere Methoden und Klassennamen).</p></li>
<li><p>Das Verschleiern von Konstanten durch den Einsatz vermeintlich komplexer Berechnungen zu deren Initialisierung.</p>
<blockquote>
<pre class="code java copy-to-clipboard literal-block"><code><span class="operator">~</span><span class="punctuation">(((</span><span class="keyword type">int</span><span class="punctuation">)</span><span class="name">Math</span><span class="punctuation">.</span><span class="name attribute">PI</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="operator">^</span><span class="whitespace"> </span><span class="name">Integer</span><span class="punctuation">.</span><span class="name attribute">MAX_VALUE</span><span class="whitespace"> </span><span class="operator">&gt;&gt;</span><span class="whitespace"> </span><span class="literal number integer">16</span><span class="punctuation">)</span><span class="operator">+</span><span class="name">Short</span><span class="punctuation">.</span><span class="name attribute">MAX_VALUE</span></code></pre>
<pre class="code java incremental literal-block"><code><span class="operator">=</span><span class="whitespace"> </span><span class="literal number integer">2</span></code></pre>
</blockquote>
</li>
<li><p>Die Verwendung von Unicode Codepoints für Strings oder die Verschleierung von Strings mittels <a class="reference external" href="https://cryptii.com/pipes/rot13-decoder">rot13</a> Verschlüsselung.</p>
<pre class="code C copy-to-clipboard literal-block"><code><span class="whitespace"> </span><span class="comment multiline">/* ??? */</span><span class="whitespace"> </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;</span><span class="literal string escape">\x48</span><span class="literal string">&quot;&quot;e</span><span class="literal string escape">\154</span><span class="literal string">l</span><span class="literal string escape">\x6F</span><span class="literal string">&quot;&quot; </span><span class="literal string escape">\127</span><span class="literal string">o</span><span class="literal string escape">\x72</span><span class="literal string">&quot;&quot;l</span><span class="literal string escape">\144</span><span class="literal string">!&quot;</span><span class="punctuation">);</span></code></pre>
<pre class="code C incremental literal-block"><code><span class="comment multiline">/*  =  */</span><span class="whitespace"> </span><span class="name">printf</span><span class="punctuation">(</span><span class="literal string">&quot;Hello World!&quot;</span><span class="punctuation">);</span></code></pre>
</li>
<li><p>Das Umstellen von Instruktionen, um das Dekompilieren zu erschweren.</p></li>
<li><p>Das Hinzufügen von totem Code.</p></li>
<li><p>Den relevanten Teil der Anwendung komprimieren und verschlüsseln und erst bei Verwendung entpacken und entschlüsseln.</p></li>
<li><p>...</p></li>
</ul>
<div class="supplemental">
<p>Obfuscation auf Source Code Ebene:
<a class="reference external" href="https://www.ioccc.org/">International Obfuscated C Code Contest</a></p>
<p><strong>Umstellen von Instruktionen</strong></p>
<p>Das Umstellen von Instruktionen erschwert die Analyse, da viele Werkzeuge zum Dekompilieren auf die Erkennung von bestimmten Mustern im Code angewiesen sind und ansonsten nur sehr generischen (Spagetti Code) oder gar unsinnigen Code zurückgeben.</p>
<p><strong>Verschleierung von Strings</strong></p>
<p>Das Verschleiern von Strings kann insbesondere das Reversen von Binärcode erschweren, da ein Angreifer häufig <span class="ger-quote">nur</span> an einer ganz bestimmten Funktionalität interessiert ist und dann Strings ggf. einen sehr guten Einstiegspunkt für die weitergehende Analyse bieten.</p>
<p>Stellen Sie sich eine komplexe Java Anwendung vor, in der alle Namen von Klassen, Methoden und Attributen durch einzelne oder kurze Sequenzen von Buchstaben ersetzt wurden und sie suchen danach wie von der Anwendung Passworte verarbeitet werden. Handelt es sich um eine GUI Anwendung, dann wäre zum Beispiel die Suche nach Text, der in den Dialogen vorkommt (z. B. <span class="docutils literal">&quot;Password&quot;</span>) z. B. ein sehr guter Einstiegspunkt.</p>
</div></div><div class="new-subsection ld-slide" id="verschlusselung-von-bytecode-und-java-class-loader">
<h2>Verschlüsselung von Bytecode und Java Class Loader</h2>
</div><div class="ld-slide" id="classloader">
<h2><span class="docutils literal">ClassLoader</span></h2>
<ul class="incremental list-with-explanations">
<li><p><span class="docutils literal">ClassLoader</span> dienen dazu Klassen dynamisch zu laden. D. h. eine Klasse wird erst dann von der JVM geladen, wenn sie benötigt bzw. angefordert wird.</p></li>
<li><p>Jeder <span class="docutils literal">ClassLoader</span> spannt seinen eigenen Namensraum auf.</p>
<p>Zwei Instanzen der gleichen Klasse (d. h. mit dem selben Bytecode) sind nicht gleich (Referenzgleichheit), wenn zwei verschiedene <span class="docutils literal">ClassLoader</span> genutzt wurden.</p>
</li>
<li><p><span class="docutils literal">ClassLoader</span> stehen in einer Hierarchie.</p></li>
<li><p><span class="docutils literal">ClassLoader</span> können genutzt werden, um:</p>
<ul class="simple">
<li><p>ein Programm dynamisch zu erweitern (Plug-ins</p></li>
<li><p>um Klassen zu laden, die zur Laufzeit generiert wurden</p></li>
<li><p>um den Bytecode zu manipulieren, bevor er von der JVM ausgeführt wird.</p></li>
</ul>
</li>
</ul>
</div><div class="ld-slide" id="ein-eigener-classloader">
<h2>Ein eigener ClassLoader</h2>
<pre class="code Java copy-to-clipboard far-smaller literal-block"><code><span class="keyword declaration">static</span><span class="whitespace"> </span><span class="keyword declaration">class</span> <span class="name class">MyClassLoader</span><span class="whitespace"> </span><span class="keyword declaration">extends</span><span class="whitespace"> </span><span class="name">ClassLoader</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
  </span><span class="keyword declaration">public</span><span class="whitespace"> </span><span class="name function">MyClassLoader</span><span class="punctuation">(</span><span class="name">ClassLoader</span><span class="whitespace"> </span><span class="name">parent</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace"> </span><span class="keyword declaration">super</span><span class="punctuation">(</span><span class="name">parent</span><span class="punctuation">);</span><span class="whitespace"> </span><span class="punctuation">}</span><span class="whitespace">

  </span><span class="name decorator">&#64;Override</span><span class="whitespace">
  </span><span class="keyword declaration">protected</span><span class="whitespace"> </span><span class="name">Class</span><span class="operator">&lt;?&gt;</span><span class="whitespace"> </span><span class="name">findClass</span><span class="punctuation">(</span><span class="keyword declaration">final</span><span class="whitespace"> </span><span class="name">String</span><span class="whitespace"> </span><span class="name">name</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="keyword declaration">throws</span><span class="whitespace"> </span><span class="name">ClassNotFoundException</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
    </span><span class="keyword">try</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="keyword declaration">final</span><span class="whitespace"> </span><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name">in</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword declaration">super</span><span class="punctuation">.</span><span class="name attribute">getResourceAsStream</span><span class="punctuation">(</span><span class="name">name</span><span class="punctuation">))</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
      </span><span class="keyword declaration">final</span><span class="whitespace"> </span><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name">classBytes</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="keyword type">byte</span><span class="operator">[</span><span class="name">in</span><span class="punctuation">.</span><span class="name attribute">available</span><span class="punctuation">()</span><span class="operator">]</span><span class="punctuation">;</span><span class="whitespace">
      </span><span class="keyword declaration">final</span><span class="whitespace"> </span><span class="keyword declaration">var</span><span class="whitespace"> </span><span class="name">readBytes</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">in</span><span class="punctuation">.</span><span class="name attribute">read</span><span class="punctuation">(</span><span class="name">classBytes</span><span class="punctuation">);</span><span class="whitespace">
      </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">readBytes</span><span class="whitespace"> </span><span class="operator">!=</span><span class="whitespace"> </span><span class="name">classBytes</span><span class="punctuation">.</span><span class="name attribute">length</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
         </span><span class="keyword">throw</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">IOException</span><span class="punctuation">(</span><span class="literal string">&quot;failed reading class file: &quot;</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace"> </span><span class="name">name</span><span class="punctuation">);</span><span class="whitespace">
      </span><span class="punctuation">}</span><span class="whitespace">
      </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">defineClass</span><span class="punctuation">(</span><span class="name">name</span><span class="punctuation">,</span><span class="name">classBytes</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">classBytes</span><span class="punctuation">.</span><span class="name attribute">length</span><span class="punctuation">);</span><span class="whitespace">
    </span><span class="punctuation">}</span><span class="whitespace"> </span><span class="keyword">catch</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">IOException</span><span class="whitespace"> </span><span class="name">ioe</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
       </span><span class="keyword">throw</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">ClassNotFoundException</span><span class="punctuation">(</span><span class="literal string">&quot;failed loading &quot;</span><span class="whitespace"> </span><span class="operator">+</span><span class="whitespace"> </span><span class="name">name</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">ioe</span><span class="punctuation">);</span><span class="whitespace">
    </span><span class="punctuation">}</span><span class="whitespace">
  </span><span class="punctuation">}</span><span class="whitespace">
</span><span class="punctuation">}</span></code></pre>
</div><div class="ld-slide" id="classloading-example">
<h2>ClassLoading - Example</h2>
<div class="scrollable docutils container">
<p class="rubric">Ein Singleton</p>
<pre class="code Java copy-to-clipboard smaller literal-block"><code><span class="keyword declaration">public</span><span class="whitespace"> </span><span class="keyword declaration">class</span> <span class="name class">MySingleton</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">

    </span><span class="keyword declaration">private</span><span class="whitespace"> </span><span class="keyword declaration">static</span><span class="whitespace"> </span><span class="name">MySingleton</span><span class="whitespace"> </span><span class="name">instance</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="keyword declaration">private</span><span class="whitespace"> </span><span class="name function">MySingleton</span><span class="punctuation">()</span><span class="whitespace"> </span><span class="punctuation">{}</span><span class="whitespace">

    </span><span class="keyword declaration">public</span><span class="whitespace"> </span><span class="keyword declaration">static</span><span class="whitespace"> </span><span class="keyword declaration">synchronized</span><span class="whitespace"> </span><span class="name">MySingleton</span><span class="whitespace"> </span><span class="name function">instance</span><span class="punctuation">()</span><span class="whitespace"> </span><span class="punctuation">{</span><span class="whitespace">
        </span><span class="keyword">if</span><span class="whitespace"> </span><span class="punctuation">(</span><span class="name">instance</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="keyword constant">null</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="name">instance</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">MySingleton</span><span class="punctuation">();</span><span class="whitespace">
        </span><span class="keyword">return</span><span class="whitespace"> </span><span class="name">instance</span><span class="punctuation">;</span><span class="whitespace">
    </span><span class="punctuation">}</span><span class="whitespace">
</span><span class="punctuation">}</span></code></pre>
<div class="incremental docutils container">
<p class="rubric">Gleichheit von Instanzen</p>
<pre class="code Java copy-to-clipboard smaller literal-block"><code><span class="name">Object</span><span class="whitespace"> </span><span class="name">a</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">MySingleton</span><span class="punctuation">.</span><span class="name attribute">instance</span><span class="punctuation">();</span><span class="whitespace">
</span><span class="name">Object</span><span class="whitespace"> </span><span class="name">b</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">MySingleton</span><span class="punctuation">.</span><span class="name attribute">instance</span><span class="punctuation">();</span><span class="whitespace">
</span><span class="name">System</span><span class="punctuation">.</span><span class="name attribute">out</span><span class="punctuation">.</span><span class="name attribute">println</span><span class="punctuation">(</span><span class="name">a</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">b</span><span class="punctuation">);</span></code></pre>
<pre class="code Text literal-block"><code>Ergebnis: true</code></pre>
</div>
<div class="incremental docutils container">
<p class="rubric">Verwendung des SystemClassLoader</p>
<pre class="code Java copy-to-clipboard smaller literal-block"><code><span class="name">ClassLoader</span><span class="whitespace"> </span><span class="name">cl1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">ClassLoader</span><span class="punctuation">.</span><span class="name attribute">getSystemClassLoader</span><span class="punctuation">();</span><span class="whitespace">
</span><span class="name">Class</span><span class="operator">&lt;?&gt;</span><span class="whitespace"> </span><span class="name">clazz1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">cl1</span><span class="punctuation">.</span><span class="name attribute">loadClass</span><span class="punctuation">(</span><span class="literal string">&quot;demo.MySingleton&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span><span class="name">Object</span><span class="whitespace"> </span><span class="name">a</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">clazz1</span><span class="whitespace">
    </span><span class="punctuation">.</span><span class="name attribute">getDeclaredMethod</span><span class="punctuation">(</span><span class="literal string">&quot;instance&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">Class</span><span class="operator">&lt;?&gt;[]</span><span class="whitespace"> </span><span class="punctuation">{})</span><span class="whitespace">
    </span><span class="punctuation">.</span><span class="name attribute">invoke</span><span class="punctuation">(</span><span class="keyword constant">null</span><span class="punctuation">);</span><span class="whitespace">
</span><span class="name">ClassLoader</span><span class="whitespace"> </span><span class="name">cl2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">ClassLoader</span><span class="punctuation">.</span><span class="name attribute">getSystemClassLoader</span><span class="punctuation">();</span><span class="whitespace">
</span><span class="name">Class</span><span class="operator">&lt;?&gt;</span><span class="whitespace"> </span><span class="name">clazz2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">cl2</span><span class="punctuation">.</span><span class="name attribute">loadClass</span><span class="punctuation">(</span><span class="literal string">&quot;demo.MySingleton&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span><span class="name">Object</span><span class="whitespace"> </span><span class="name">b</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">clazz2</span><span class="whitespace">
    </span><span class="punctuation">.</span><span class="name attribute">getDeclaredMethod</span><span class="punctuation">(</span><span class="literal string">&quot;instance&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">Class</span><span class="operator">&lt;?&gt;[]</span><span class="whitespace"> </span><span class="punctuation">{})</span><span class="whitespace">
    </span><span class="punctuation">.</span><span class="name attribute">invoke</span><span class="punctuation">(</span><span class="keyword constant">null</span><span class="punctuation">);</span><span class="whitespace">

</span><span class="name">System</span><span class="punctuation">.</span><span class="name attribute">out</span><span class="punctuation">.</span><span class="name attribute">println</span><span class="punctuation">(</span><span class="name">a</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">b</span><span class="punctuation">);</span></code></pre>
<pre class="code Text literal-block"><code>Ergebnis: true</code></pre>
</div>
<div class="incremental docutils container">
<p class="rubric">Verwendung von zwei Instanzen von MyClassLoader</p>
<pre class="code Java copy-to-clipboard smaller literal-block"><code><span class="name">ClassLoader</span><span class="whitespace"> </span><span class="name">cl1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">MyClassLoader</span><span class="punctuation">();</span><span class="whitespace">
</span><span class="name">Class</span><span class="operator">&lt;?&gt;</span><span class="whitespace"> </span><span class="name">clazz1</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">cl1</span><span class="punctuation">.</span><span class="name attribute">loadClass</span><span class="punctuation">(</span><span class="literal string">&quot;demo.MySingleton&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span><span class="name">Object</span><span class="whitespace"> </span><span class="name">a</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">clazz1</span><span class="whitespace">
    </span><span class="punctuation">.</span><span class="name attribute">getDeclaredMethod</span><span class="punctuation">(</span><span class="literal string">&quot;instance&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">Class</span><span class="operator">&lt;?&gt;[]</span><span class="whitespace"> </span><span class="punctuation">{})</span><span class="whitespace">
        </span><span class="punctuation">.</span><span class="name attribute">invoke</span><span class="punctuation">(</span><span class="keyword constant">null</span><span class="punctuation">);</span><span class="whitespace">
</span><span class="name">ClassLoaderacl2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">MyClassLoader</span><span class="punctuation">();</span><span class="whitespace">
</span><span class="name">Class</span><span class="operator">&lt;?&gt;</span><span class="whitespace"> </span><span class="name">clazz2</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">cl2</span><span class="punctuation">.</span><span class="name attribute">loadClass</span><span class="punctuation">(</span><span class="literal string">&quot;demo.MySingleton&quot;</span><span class="punctuation">);</span><span class="whitespace">
</span><span class="name">Object</span><span class="whitespace"> </span><span class="name">b</span><span class="whitespace"> </span><span class="operator">=</span><span class="whitespace"> </span><span class="name">clazz2</span><span class="whitespace">
    </span><span class="punctuation">.</span><span class="name attribute">getDeclaredMethod</span><span class="punctuation">(</span><span class="literal string">&quot;instance&quot;</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="keyword">new</span><span class="whitespace"> </span><span class="name">Class</span><span class="operator">&lt;?&gt;[]</span><span class="whitespace"> </span><span class="punctuation">{})</span><span class="whitespace">
        </span><span class="punctuation">.</span><span class="name attribute">invoke</span><span class="punctuation">(</span><span class="keyword constant">null</span><span class="punctuation">);</span><span class="whitespace">

</span><span class="name">System</span><span class="punctuation">.</span><span class="name attribute">out</span><span class="punctuation">.</span><span class="name attribute">println</span><span class="punctuation">(</span><span class="name">a</span><span class="whitespace"> </span><span class="operator">==</span><span class="whitespace"> </span><span class="name">b</span><span class="punctuation">);</span></code></pre>
<div class="incremental docutils container">
<pre class="code Text literal-block"><code>Ergebnis: False</code></pre>
</div>
</div>
</div>
</div><div class="new-section transition-fade ld-slide" id="eine-sehr-kurz-einfuhrung-in-java-bytecode">
<h2>Eine sehr kurz Einführung in Java Bytecode</h2>
</div><div class="ld-slide" id="die-java-virtual-machine">
<h2>Die Java Virtual Machine</h2>
<ul class="incremental simple">
<li><p><strong>Java Bytecode</strong> ist die Sprache, in der Java (oder Scala, Kotlin, ...) Programme auf der Java Virtual Machine (JVM) <a class="footnote-reference brackets" href="#footnote-4" id="footnote-reference-4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> ausgeführt werden.</p></li>
<li><p><span class="minor">In den meisten Fällen arbeiten Java Decompiler so gut, dass ein tiefgehendes Verständnis von Java Bytecode selten notwendig ist.</span></p></li>
<li><p>Java Bytecode kann — muss aber nicht — interpretiert werden. (Z. B. können <span class="ger-quote">virtuelle Methodenaufrufe</span> in Java schneller sein als in C++.)</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-4">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.oracle.com/javase/specs/jvms/se21/html/index.html">Java Bytecode Spezifikation</a></p>
</aside>
</aside>
</div><div class="ld-slide" id="java-bytecode-stackbasierte-virtuelle-maschine">
<h2>Java Bytecode - stackbasierte virtuelle Maschine</h2>
<div class="smaller docutils container">
<p>Die JVM ist eine stackbasierte virtuelle Maschine.</p>
<p>Die getypten Operanden eines Befehls werden auf einem Stack abgelegt und die Operationen arbeiten auf den obersten Elementen des Stacks. Jeder Thread hat seinen eigenen Stack.</p>
<blockquote>
<div class="two-columns footnotesize incremental docutils container">
<div class="column docutils container">
<p class="rubric">Instruktionen</p>
<pre class="code java literal-block"><code><span class="name">nop</span><span class="whitespace">
</span><span class="name">bipush</span><span class="whitespace"> </span><span class="literal number integer">100</span><span class="whitespace">               </span><span class="error">→</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace">

</span><span class="name">bipush</span><span class="whitespace">  </span><span class="literal number integer">50</span><span class="whitespace">               </span><span class="error">→</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace">


</span><span class="name">iadd</span><span class="whitespace">        </span><span class="error">←</span><span class="whitespace"> </span><span class="literal number integer">2</span><span class="whitespace"> </span><span class="error">⨉</span><span class="whitespace"> </span><span class="keyword type">int</span><span class="whitespace">    </span><span class="error">→</span><span class="whitespace"> </span><span class="keyword type">int</span></code></pre>
</div>
<div class="column incremental docutils container">
<p class="rubric">Veränderung des Stacks</p>
<pre class="code java literal-block"><code><span class="error">└─────┘</span><span class="whitespace">
</span><span class="error">│</span><span class="whitespace"> </span><span class="literal number integer">100</span><span class="whitespace"> </span><span class="error">│</span><span class="whitespace">
</span><span class="error">└─────┘</span><span class="whitespace">
</span><span class="error">│</span><span class="whitespace">  </span><span class="literal number integer">50</span><span class="whitespace"> </span><span class="error">│</span><span class="whitespace">
</span><span class="error">│</span><span class="whitespace"> </span><span class="literal number integer">100</span><span class="whitespace"> </span><span class="error">│</span><span class="whitespace">
</span><span class="error">└─────┘</span><span class="whitespace">
</span><span class="error">│</span><span class="whitespace"> </span><span class="literal number integer">150</span><span class="whitespace"> </span><span class="error">│</span><span class="whitespace">
</span><span class="error">└─────┘</span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="supplemental">
<p>Eine Methode muss einen Stack begrenzter Höhe aufweisen. Code, für den die Stackhöhe nicht berechenbar ist, wird vom Compiler abgelehnt. (Zum Beispiel ein <span class="docutils literal">bipush</span> in einer Endlosschleife.)
Die benötigte Höhe des Stacks wird vom Compiler berechnet und von der JVM überprüft.</p>
</div></div><div class="ld-slide" id="java-bytecode-methodenaufrufe-und-lokale-variablen">
<h2>Java Bytecode - Methodenaufrufe und lokale Variablen</h2>
<ul class="incremental simple">
<li><p>Die Java Virtual Machine verwendet lokale Variablen zur Übergabe von Parametern beim Methodenaufruf.</p></li>
<li><p>Beim Aufruf von <em>Klassenmethoden</em> (<span class="docutils literal">static</span>) werden alle Parameter in aufeinanderfolgenden lokalen Variablen übergeben, beginnend mit der lokalen Variable 0.
D. h. in der aufrufenden Methode werden die Parameter vom Stack geholt und in lokalen Variablen gespeichert.</p></li>
<li><p>Beim Aufruf von <em>Instanzmethoden</em> wird die lokale Variable 0 dazu verwendet, um die Referenz (<span class="docutils literal">this</span>) auf das Objekt zu übergeben, auf dem die Instanzmethode aufgerufen wird.
Anschließend werden alle Parameter in aufeinanderfolgenden lokalen Variablen übergeben, beginnend mit der lokalen Variable 1.</p></li>
</ul>
<div class="supplemental">
<p>Die Anzahl der benötigten lokalen Variablen wird vom Compiler berechnet und von der JVM überprüft.</p>
</div></div><div class="small ld-slide" id="beispiel-default-constructor-in-java-bytecode">
<h2>Beispiel: <em>Default Constructor</em> In Java Bytecode</h2>
<p>Ein <em>Constructor</em> welcher keine expliziten Parameter hat und nur den super Konstruktor aufruft.</p>
<pre class="code java literal-block"><code><span class="comment single">// Method descriptor ()V</span><span class="whitespace">
</span><span class="comment single">// Stack: 1, Locals: 1</span><span class="whitespace">
</span><span class="keyword declaration">public</span><span class="whitespace"> </span><span class="name function">Main</span><span class="punctuation">();</span><span class="whitespace">
    </span><span class="literal number integer">0</span><span class="whitespace">  </span><span class="name">aload_0</span><span class="whitespace"> </span><span class="operator">[</span><span class="keyword">this</span><span class="operator">]</span><span class="whitespace">
    </span><span class="literal number integer">1</span><span class="whitespace">  </span><span class="name">invokespecial</span><span class="whitespace"> </span><span class="name">java</span><span class="punctuation">.</span><span class="name attribute">lang</span><span class="punctuation">.</span><span class="name attribute">Object</span><span class="punctuation">()</span><span class="whitespace">
    </span><span class="literal number integer">4</span><span class="whitespace">  </span><span class="keyword">return</span></code></pre>
<p>Die Zeilennummern und die Informationen über die lokalen Variablen sind optional und werden nur für Debugging Zwecke benötigt.</p>
<pre class="code java literal-block"><code><span class="name">Line</span><span class="whitespace"> </span><span class="name">numbers</span><span class="punctuation">:</span><span class="whitespace">         </span><span class="operator">[</span><span class="name">pc</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">line</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="literal number integer">9</span><span class="operator">]</span><span class="whitespace">
</span><span class="name">Local</span><span class="whitespace"> </span><span class="name">variable</span><span class="whitespace"> </span><span class="name">table</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="operator">[</span><span class="name">pc</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="punctuation">,</span><span class="whitespace"> </span><span class="name">pc</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="literal number integer">5</span><span class="operator">]</span><span class="whitespace">  </span><span class="name">local</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="keyword">this</span><span class="whitespace">
                                      </span><span class="name">index</span><span class="punctuation">:</span><span class="whitespace"> </span><span class="literal number integer">0</span><span class="whitespace">
                                      </span><span class="name">type</span><span class="punctuation">:</span><span class="whitespace">  </span><span class="name">de</span><span class="punctuation">.</span><span class="name attribute">dhbw</span><span class="punctuation">.</span><span class="name attribute">simplesecurepp</span><span class="punctuation">.</span><span class="name attribute">Main</span></code></pre>
<div class="supplemental">
<p>Es gibt weitere Metainformationen, die <span class="ger-quote">nur</span> für Debugging-Zwecke benötigt werden, z. B. Informationen über die ursprünglich Quelle des Codes oder die sogenannte &quot;Local Variable Type Table&quot; in Hinblick auf generische Typinformationen. Solche Informationen werden häufig vor Auslieferung entfernt bzw. nicht hineinkompiliert.</p>
</div></div><div class="ld-slide" id="beispiel-aufruf-einer-komplexeren-methode">
<h2>Beispiel: Aufruf einer komplexeren Methode</h2>
<pre class="code java small literal-block"><code><span class="comment single">// Method descriptor ([Ljava/lang/String;)V</span><span class="whitespace">
</span><span class="comment single">// Stack: 5, Locals: 8</span><span class="whitespace">
</span><span class="keyword declaration">public</span><span class="whitespace"> </span><span class="keyword declaration">static</span><span class="whitespace"> </span><span class="keyword type">void</span><span class="whitespace"> </span><span class="name function">main</span><span class="punctuation">(</span><span class="name">java</span><span class="punctuation">.</span><span class="name attribute">lang</span><span class="punctuation">.</span><span class="name attribute">String</span><span class="operator">[]</span><span class="whitespace"> </span><span class="name">args</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="keyword declaration">throws</span><span class="whitespace"> </span><span class="punctuation">...;</span><span class="whitespace">
    </span><span class="literal number integer">0</span><span class="whitespace">  </span><span class="name">aload_0</span><span class="whitespace"> </span><span class="operator">[</span><span class="name">args</span><span class="operator">]</span><span class="whitespace">
    </span><span class="literal number integer">1</span><span class="whitespace">  </span><span class="name">arraylength</span><span class="whitespace">
    </span><span class="literal number integer">2</span><span class="whitespace">  </span><span class="name">iconst_2</span><span class="whitespace">
    </span><span class="literal number integer">3</span><span class="whitespace">  </span><span class="name">if_icmpeq</span><span class="whitespace"> </span><span class="literal number integer">74</span><span class="whitespace">                </span><span class="comment single">// integer comparison for equality</span><span class="whitespace">
    </span><span class="literal number integer">6</span><span class="whitespace">  </span><span class="name">getstatic</span><span class="whitespace"> </span><span class="name">java</span><span class="punctuation">.</span><span class="name attribute">lang</span><span class="punctuation">.</span><span class="name attribute">System</span><span class="punctuation">.</span><span class="name attribute">err</span><span class="whitespace"> </span><span class="punctuation">:</span><span class="whitespace"> </span><span class="name">java</span><span class="punctuation">.</span><span class="name attribute">io</span><span class="punctuation">.</span><span class="name attribute">PrintStream</span><span class="whitespace">
    </span><span class="literal number integer">9</span><span class="whitespace">  </span><span class="name">ldc</span><span class="whitespace"> </span><span class="operator">&lt;</span><span class="name">String</span><span class="whitespace"> </span><span class="literal string">&quot;SimpleSecure++&quot;</span><span class="operator">&gt;</span><span class="whitespace">
    </span><span class="literal number integer">11</span><span class="whitespace">  </span><span class="name">invokevirtual</span><span class="whitespace"> </span><span class="name">java</span><span class="punctuation">.</span><span class="name attribute">io</span><span class="punctuation">.</span><span class="name attribute">PrintStream</span><span class="punctuation">.</span><span class="name attribute">println</span><span class="punctuation">(</span><span class="name">java</span><span class="punctuation">.</span><span class="name attribute">lang</span><span class="punctuation">.</span><span class="name attribute">String</span><span class="punctuation">)</span><span class="whitespace"> </span><span class="punctuation">:</span><span class="whitespace"> </span><span class="keyword type">void</span><span class="whitespace">
    </span><span class="punctuation">...</span></code></pre>
</div><div class="new-section transition-scale ld-slide" id="verschlusselung-von-daten">
<h2>Verschlüsselung von Daten</h2>
</div><div class="ld-slide" id="alternativen-zur-speicherung-von-passwortern">
<h2>Alternativen zur Speicherung von Passwörtern</h2>
<p>In einigen Anwendungsgebieten ist es möglich auf das explizite Speichern von Passwörtern ganz zu verzichten<a class="footnote-reference brackets" href="#footnote-5" id="footnote-reference-5" role="doc-noteref"><span class="fn-bracket">[</span>*<span class="fn-bracket">]</span></a>.</p>
<div class="incremental docutils container">
<p>Stattdessen wird z. B. einfach versucht das Ziel zu entschlüsseln und danach evaluiert ob das Passwort (vermutlich) das Richtige war.</p>
</div>
<div class="incremental docutils container">
<p>Kann darauf verzichtet werden zu überprüfen ob das Passwort korrekt war, dann sind keine Metainformationen notwendig und die verschlüsselte Datei kann genau so groß sein wie die unverschlüsselte Datei.</p>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-5">*</a><span class="fn-bracket">]</span></span>
<p>Bei einer Verschlüsselung mit OpenSSL wird das Passwort nicht gespeichert.</p>
</aside>
</aside>
</div><div class="ld-slide" id="schematische-darstellung-der-verschlusselung-von-containern-z-b-veracrypt">
<h2>Schematische Darstellung der Verschlüsselung von Containern (z. B. Veracrypt)</h2>
<img alt="Schematische Darstellung von Containern." class="align-center" src="graffles/verschluesselung_von_veracrypt.svg" style="width: 1800px;" />
</div><div class="ld-slide" id="generische-dateiverschlusselung-ohne-explizite-speicherung-des-passworts">
<h2>Generische Dateiverschlüsselung ohne explizite Speicherung des Passworts</h2>
<img alt="Beispiehafte Verschlüsselung von Containern." class="align-center" src="graffles/generische_dateiverschluesselung.svg" style="width: 1800px;" />
</div><div class="center-child-elements no-title ld-slide" id="fokussiert-bleiben">
<h2>Fokussiert bleiben!</h2>
<aside class="admonition warning incremental important">
<p class="admonition-title">Wichtig</p>
<p>Bleibe fokussiert!</p>
<p>Analysiere nur was notwendig ist.</p>
</aside>
</div><div class="integrated-exercise organic-red center-child-elements ld-slide" id="live-demo-reversing-simplesecure">
<h2>Live Demo - Reversing SimpleSecure++</h2>
</div><div class="integrated-exercise ld-slide" id="reverse-engineering-ubung">
<h2>Reverse Engineering Übung</h2>
<p class="rubric">Gegeben</p>
<dl class="field-list simple">
<dt>Programm<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="./exercise/securepp/securepp-0.0.1.jar">Secure++</a></p>
</dd>
<dt>Datei<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="./exercise/securepp/Poem.enc">Poem.enc</a></p>
</dd>
</dl>
<p class="rubric">Exemplarische Verwendung zum Verschlüsseln</p>
<pre class="code bash far-smaller copy-to-clipboard literal-block"><code>java<span class="whitespace"> </span>-jar<span class="whitespace"> </span>securepp-0.0.1.jar<span class="whitespace"> </span>de.dhbw.securepp.Main<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">    </span>-p<span class="whitespace"> </span><span class="literal string single">'VielleichtIstEsRichtig-vielleichtAuchNICHT...'</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">    </span>-in<span class="whitespace"> </span>Poem.txt<span class="whitespace"> </span>-out<span class="whitespace"> </span>Poem.enc</code></pre>
<p class="rubric">Aufgabe</p>
<div class="ld-exercise" data-exercise-id="1" data-exercise-title="1" id="ld-exercise-1">
<p>Entschlüsseln Sie die Datei Poem.enc, die mit dem Program Secure++ verschlüsselt wurde.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:K0KuWK4kx9RA8f6aEDCoggrIbz37N5egoR3AXh2q2Hc=:iXFLTMXWjSEEPx84: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</div>
</div>
</div>
</template>
</body>
</html>
