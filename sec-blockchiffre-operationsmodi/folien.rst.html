<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="LD2 0.1" />
<meta content="Michael Eichberg" name="author" />
<meta content="Blockchiffren, Operationsmodi, ECB, CBC, CFB, OFB, CTR, XTS-AES" name="keywords" />
<meta content="Block Cipher Operations" lang="en" name="description" xml:lang="en" />
<meta content="Betriebsmodi bei Blockchiffren" lang="de" name="description" xml:lang="de" />
<meta content="sec-blockchiffre-operationsmodi" name="id" />
<meta content="last-viewed" name="first-slide" />
<title>Betriebsmodi bei Blockchiffren</title>
<script type="text/javascript" src="../LectureDoc2/ext/mathjax/es5/tex-chtml.js?config=TeX-AMS_CHTML"></script>
<link rel="stylesheet" href="../LectureDoc2/normalize.css" type="text/css" />
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 9079 2022-06-19 14:00:56Z milde $                                                               */
/* :Copyright: © 2015, 2021 Günter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.2em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* …, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
/* inline images */
p img, p video, figure img, figure video {
  display: inline;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 9338 2023-04-08 21:08:47Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
  --field-indent: 9em; /* default indent of fields in field lists */
}
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
div.line-block,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes and Topics */
bockquote { margin: 1em 2em; }
blockquote p.attribution,
.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
.footnote-list {
  border-left: solid thin;
  padding-left: 0.25em;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
video.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
video.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
  margin-left: 1em;
  margin-right: -1%;
  background-color: #fffffa;
}


/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* https://docutils.sourceforge.io/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math */
/* for math-output=MathML (for math-output=HTML, see math.css) */
math .boldsymbol {
  font-weight: bold;
}
mstyle.mathscr, mi.mathscr {
  font-family: STIX, XITSMathJax_Script, rsfs10,
               "Asana Math", Garamond, cursive;
}

/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a[role="doc-noteref"] */
/* Citation References    */
/*   a.citation-reference */

</style>
    <script src="../LectureDoc2/ld-animations.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-help.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-core.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../LectureDoc2/ld.css" type="text/css" />
    <link rel="stylesheet" href="../LectureDoc2/themes/DHBW/theme.css" type="text/css" />
</head>
<body>
<div class="ld-slide" id="slide0">
<h1 class="title">Betriebsmodi bei Blockchiffren</h1>
<dl class="docinfo simple">
<dt class="dozent">Dozent<span class="colon">:</span></dt>
<dd class="dozent"><p><strong>Prof. Dr. Michael Eichberg</strong></p>
</dd>
<dt class="version">Version<span class="colon">:</span></dt>
<dd class="version">2024-02-18</dd>
<dt class="basierend-auf">Basierend auf<span class="colon">:</span></dt>
<dd class="basierend-auf"><p><em>Cryptography and Network Security - Principles and Practice, 8th Edition, William Stallings</em></p>
</dd>
</dl>
</div>
<div class="ld-slide" id="double-encryption">
<h2>Double Encryption</h2>
<img alt="drawings/operationsmodi/double_encryption.svg" class="align-center" src="drawings/operationsmodi/double_encryption.svg" style="width: 1200px;" />
</div><div class="ld-slide" id="meet-in-the-middle-attack">
<h2>Meet-in-the-Middle Attack</h2>
<ul class="simple">
<li><p>Observation: <span class="math">\(E(K_2,E(K_1,P)) = E(K_3,P)\)</span> does not hold. I.e., the use of double DES results in a mapping that is not equivalent to a single DES encryption.</p></li>
</ul>
<ul class="incremental simple">
<li><p>The meet-in-the-middle algorithm will attack this scheme. It does not depend on any particular property of DES but will work against any block encryption cipher.</p></li>
<li><p>The result is that a known plaintext attack against double-DES will succeed with an effort on the order <span class="math">\(2^{56}\)</span> compared to <span class="math">\(2^{55}\)</span> for a single DES.</p></li>
</ul>
</div><div class="ld-slide" id="triple-encryption-e-g-triple-des-with-three-keys">
<h2>Triple Encryption (E.g., Triple-DES with Three-Keys)</h2>
<img alt="drawings/operationsmodi/triple_encryption.svg" class="align-center" src="drawings/operationsmodi/triple_encryption.svg" style="width: 1500px;" />
</div><div class="ld-slide" id="triple-des-with-two-keys">
<h2>Triple-DES with Two Keys</h2>
<p>Obvious counter to the meet-in-the-middle attack is to use three stages of encryption with three different keys.</p>
<ul class="simple">
<li><p>This raises the cost of the meet-in-the-middle attack to <span class="math">\(2^{112}\)</span>, which is beyond what is practical.</p></li>
<li><p>Has the drawback of requiring a key length of <span class="math">\(56\,bits \times 3 = 168\,bits\)</span>, which may be somewhat unwieldy.</p></li>
<li><p>As an alternative Tuchman proposed a triple encryption method that uses only two keys.</p></li>
<li><p>3DES with two keys is a relatively popular alternative to DES and has been adopted for use in the key management standards ANSI X9.17 and ISO 8732.</p></li>
</ul>
</div><div class="ld-slide" id="triple-des-with-three-keys">
<h2>Triple-DES with Three Keys</h2>
<ul class="simple">
<li><p>Several attacks against 3DES with 2 keys have been developed, which are - however - still not practical.</p></li>
<li><p>Many researchers now feel that three-key 3DES is the preferred alternative.</p></li>
<li><p>Three-key 3DES has an effective key length of 168 bits and is defined as: <span class="math">\(C=E(K_3,D(K_2,E(K_1, P)))\)</span></p></li>
<li><p>Backward compatibility with DES is provided by putting: <span class="math">\(K_3 =K_2\)</span> or <span class="math">\(K_1 =K_2\)</span>.</p></li>
</ul>
</div><div class="ld-slide" id="modes-of-operation">
<h2>Modes of Operation</h2>
<ul class="simple">
<li><p>A technique for enhancing the effect of a cryptographic algorithm or adapting the algorithm for an application.</p></li>
<li><p>To apply a block cipher in a variety of applications, five modes of operation have been defined by NIST.</p>
<ul>
<li><p>The five modes are intended to cover a wide variety of applications of encryption for which a block cipher could be used</p></li>
<li><p>These modes are intended for use with any symmetric block cipher, including 3DES and AES.</p></li>
</ul>
</li>
</ul>
</div><div class="ld-slide" id="modes-of-operation-overview">
<h2>Modes of Operation - Overview</h2>
<table class="small" style="width: 100%;">
<thead>
<tr><th class="head"><p>Mode</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Typical Application</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Electronic Codebook (ECB)</p></td>
<td><p>Each block of plaintext bits is encoded independently using the same key.</p></td>
<td><ul class="simple">
<li><p>Secure transmission of single values (e.g., an encryption key)</p></li>
</ul>
</td>
</tr>
<tr><td><p>Cipher Block Chaining (CBC)</p></td>
<td><p>The input to the encryption algorithm is the XOR of the next block of plaintext and the preceding block of ciphertext.</p></td>
<td><ul class="simple">
<li><p>General-purpose block-oriented transmission</p></li>
<li><p>Authentication</p></li>
</ul>
</td>
</tr>
<tr><td><p>Cipher Feedback (CFB)</p></td>
<td><p>Input is processed s bits at a time.
Preceding ciphertext is used as input to the encryption algorithm to produce pseudorandom output, which is XORed with plaintext to produce next unit of ciphertext.</p></td>
<td><ul class="simple">
<li><p>General-purpose stream-oriented transmission</p></li>
<li><p>Authentication</p></li>
</ul>
</td>
</tr>
<tr><td><p>Output Feedback (OFB)</p></td>
<td><p>Similar to CFB, except that the input to the encryption algorithm is the preceding encryption output, and full blocks are used.</p></td>
<td><ul class="simple">
<li><p>Stream-oriented transmission over noisy channel (e.g., satellite communication)</p></li>
</ul>
</td>
</tr>
<tr><td><p>Counter (CTR)</p></td>
<td><p>Each block of plaintext is XORed with an encrypted counter. The counter is incremented for each subsequent block.</p></td>
<td><ul class="simple">
<li><p>General-purpose block-oriented transmission</p></li>
<li><p>Useful for high-speed requirements</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><div class="ld-slide" id="electronic-codebook">
<h2>Electronic Codebook</h2>
<img alt="opensource-drawings/ecb_encryption.svg" class="align-center" src="opensource-drawings/ecb_encryption.svg" style="width: 1200px;" />
<img alt="opensource-drawings/ecb_decryption.svg" class="align-center" src="opensource-drawings/ecb_decryption.svg" style="width: 1200px;" />
<div class="small docutils container">
<p>Author: <a class="reference external" href="https://commons.wikimedia.org/wiki/User:WhiteTimberwolf">https://commons.wikimedia.org/wiki/User:WhiteTimberwolf</a></p>
</div>
</div><div class="ld-slide" id="problems-when-using-ecb-mode-encryption">
<h2>Problems when using ECB Mode Encryption</h2>
<p><em>ECB-Tux</em> - the linux pinguin encrypted using ECB mode.</p>
<img alt="opensource-drawings/tux.ecb.from_robert_david_graham.png" src="opensource-drawings/tux.ecb.from_robert_david_graham.png" />
<div class="small docutils container">
<p>Source: <a class="reference external" href="https://github.com/robertdavidgraham/ecb-penguin">https://github.com/robertdavidgraham/ecb-penguin</a></p>
</div>
<p>Criteria and properties for evaluating and constructing block cipher modes of operation that are superior to ECB.</p>
<ul class="simple">
<li><p>Overhead</p></li>
<li><p>Error recovery</p></li>
<li><p>Error propagation</p></li>
<li><p>Diffusion</p></li>
<li><p>Security</p></li>
</ul>
</div><div class="ld-slide" id="cipher-block-chaining">
<h2>Cipher Block Chaining</h2>
<img alt="opensource-drawings/cbc_encryption.svg" class="align-center" src="opensource-drawings/cbc_encryption.svg" style="width: 1200px;" />
<div class="incremental docutils container">
<img alt="opensource-drawings/cbc_decryption.svg" class="align-center" src="opensource-drawings/cbc_decryption.svg" style="width: 1200px;" />
<div class="small docutils container">
<p>Author: <a class="reference external" href="https://commons.wikimedia.org/wiki/User:WhiteTimberwolf">https://commons.wikimedia.org/wiki/User:WhiteTimberwolf</a></p>
</div>
</div>
</div><div class="ld-slide" id="converting-block-ciphers-into-stream-ciphers">
<h2>Converting Block Ciphers into Stream Ciphers</h2>
<aside class="admonition smaller note">
<p class="admonition-title">Note</p>
<p>There are three modes that make it possible to convert a block cipher into a character-oriented stream cipher:</p>
<ul class="simple">
<li><p>Cipher Feedback Mode (CFB)</p></li>
<li><p>Output Feedback Mode (OFB)</p></li>
<li><p>Counter Mode (CTR)</p></li>
</ul>
<p>I.e., no padding is required when the message is not a multiple of the block size.</p>
</aside>
<p>For AES, DES, or any block cipher, encryption is performed on a block of b bits:</p>
<ul class="simple">
<li><p>In the case of (3)DES <span class="math">\(b=64\)</span></p></li>
<li><p>In the case of AES <span class="math">\(b=128\)</span></p></li>
</ul>
</div><div class="ld-slide" id="cipher-feedback-mode">
<h2>Cipher Feedback Mode</h2>
<img alt="opensource-drawings/cfb_encryption.svg" class="align-center" src="opensource-drawings/cfb_encryption.svg" style="width: 1200px;" />
<div class="incremental docutils container">
<img alt="opensource-drawings/cfb_decryption.svg" class="align-center" src="opensource-drawings/cfb_decryption.svg" style="width: 1200px;" />
<div class="small docutils container">
<p>Author: <a class="reference external" href="https://commons.wikimedia.org/wiki/User:WhiteTimberwolf">https://commons.wikimedia.org/wiki/User:WhiteTimberwolf</a></p>
</div>
</div>
</div><div class="ld-slide" id="cipher-feedback-mode-used-as-a-stream-cipher">
<h2>Cipher Feedback Mode used as a Stream Cipher</h2>
<img alt="drawings/operationsmodi/cfb_s_bits.svg" class="align-center" src="drawings/operationsmodi/cfb_s_bits.svg" style="width: 1200px;" />
</div><div class="ld-slide" id="output-feedback-mode">
<h2>Output Feedback Mode</h2>
<img alt="opensource-drawings/ofb_encryption.svg" class="align-center" src="opensource-drawings/ofb_encryption.svg" style="width: 1200px;" />
<div class="incremental docutils container">
<img alt="opensource-drawings/ofb_decryption.svg" class="align-center" src="opensource-drawings/ofb_decryption.svg" style="width: 1200px;" />
<div class="small docutils container">
<p>Author: <a class="reference external" href="https://commons.wikimedia.org/wiki/User:WhiteTimberwolf">https://commons.wikimedia.org/wiki/User:WhiteTimberwolf</a></p>
</div>
</div>
<!-- When used as a Stream Cipher we can simply discard the last bytes of the encrypted block cipher. -->
</div><div class="ld-slide" id="counter-mode">
<h2>Counter Mode</h2>
<img alt="opensource-drawings/ctr_encryption.svg" class="align-center" src="opensource-drawings/ctr_encryption.svg" style="width: 1200px;" />
<div class="incremental docutils container">
<img alt="opensource-drawings/ctr_decryption.svg" class="align-center" src="opensource-drawings/ctr_decryption.svg" style="width: 1200px;" />
<div class="small docutils container">
<p>Author: <a class="reference external" href="https://commons.wikimedia.org/wiki/User:WhiteTimberwolf">https://commons.wikimedia.org/wiki/User:WhiteTimberwolf</a></p>
</div>
</div>
</div><div class="ld-slide" id="counter-mode-advantages">
<h2>Counter Mode - Advantages</h2>
<dl class="field-list simple">
<dt>Hardware efficiency<span class="colon">:</span></dt>
<dd><p>can make use of hardware parallelization.</p>
</dd>
<dt>Software efficiency<span class="colon">:</span></dt>
<dd><p>easily parallelizable in software.</p>
</dd>
<dt>Preprocessing<span class="colon">:</span></dt>
<dd><p>the  encryption of the counters</p>
</dd>
<dt>Random access<span class="colon">:</span></dt>
<dd><p>The i-th block of plaintext of ciphertext can be processed in random-access fashion.</p>
</dd>
<dt>Provable security<span class="colon">:</span></dt>
<dd><p>as secure as the other modes</p>
</dd>
<dt>Simplicity<span class="colon">:</span></dt>
<dd><p>only the encryption algorithm is required.</p>
</dd>
</dl>
</div><div class="ld-slide" id="feedback-characteristics-of-modes-of-operation">
<h2>Feedback Characteristics of Modes of Operation</h2>
<img alt="drawings/operationsmodi/feedback_characteristics.svg" class="align-center" src="drawings/operationsmodi/feedback_characteristics.svg" style="width: 1750px;" />
</div><div class="ld-slide" id="xts-aes-mode-for-block-oriented-storage-devices">
<h2>XTS-AES Mode for Block-Oriented Storage Devices</h2>
<p>Approved as an additional block cipher mode of operation by NIST in 2010 Mode is also an IEEE Standard, IEEE Std 1619-2007</p>
<aside class="admonition note">
<p class="admonition-title">Note</p>
<p>Which potential threats are relevant?</p>
<!-- many similar blocks -->
<!-- data is freely accessible -->
</aside>
<ul class="simple">
<li><p>Standard describes a method of encryption for data stored in sector- based devices where the threat model includes possible access to stored data by the adversary.</p></li>
<li><p>Has received widespread industry support</p></li>
</ul>
</div><div class="ld-slide" id="tweakable-block-ciphers">
<h2>Tweakable Block Ciphers</h2>
<ul>
<li><p>XTS-AES mode is based on the concept of a tweakable block cipher</p></li>
<li><p>General structure:</p>
<p>To compute the ciphertext a:</p>
<ul class="simple">
<li><p><strong>Plaintext</strong></p></li>
<li><p><strong>Symmetric key</strong></p></li>
<li><p><strong>Tweak</strong></p></li>
</ul>
<p>is required.</p>
</li>
<li><p>Tweak need not be kept secret; purpose is to provide variability.</p></li>
</ul>
</div><div class="ld-slide" id="tweakable-block-ciphers-1">
<h2>Tweakable Block Ciphers</h2>
<img alt="drawings/operationsmodi/tweakable_block_cipher.svg" class="align-center" src="drawings/operationsmodi/tweakable_block_cipher.svg" style="width: 1750px;" />
</div><div class="ld-slide" id="storage-encryption-requirements">
<h2>Storage Encryption Requirements</h2>
<p>The requirements for encrypting stored data, also referred to as “data at rest”, differ somewhat from those for transmitted data.</p>
<p>The P1619 standard was designed to have the following characteristics:</p>
<ul class="incremental simple">
<li><p>The ciphertext is freely available for an attacker.</p></li>
<li><p>The data layout is not changed on the storage medium and in transit.</p></li>
<li><p>Data are accessed in fixed sized blocks, independently from each other.</p></li>
<li><p>Encryption is performed in 16-byte blocks, independently from each other.</p></li>
<li><p>There are no other metadata used, except the location of the data blocks within the whole data set.</p></li>
<li><p>The same plaintext is encrypted to different ciphertexts at different locations, but always to the same ciphertext when written to the same location again.</p></li>
<li><p>A standard conformant device can be constructed for decryption of data encrypted by another standard conformant device.</p></li>
</ul>
</div><div class="ld-slide" id="xts-aes-operation-on-a-single-block">
<h2>XTS-AES Operation on a Single Block</h2>
<img alt="drawings/operationsmodi/xts_aes.svg" class="align-center" src="drawings/operationsmodi/xts_aes.svg" style="width: 1750px;" />
<div class="small two-columns docutils container">
<ul class="simple">
<li><p>Key: The key where: <span class="math">\(Key = Key_1\, ||\, Key_2\)</span></p></li>
<li><p><span class="math">\(P_j\)</span>: The jth block of plaintext. All blocks have length 128 bits. A plaintext data unit, typically a disk sector, consists of a sequence of plaintext blocks.</p></li>
<li><p><span class="math">\(C_j\)</span>: The jth block of ciphertext.</p></li>
<li><p><span class="math">\(j\)</span>: The sequential number of the 128bit block inside the data unit.</p></li>
<li><p><span class="math">\(i\)</span>: The value of the 128bit tweak.</p></li>
<li><p><span class="math">\(\alpha\)</span>: A primitive element of GF(2^{128}) that corresponds to the polynomial <span class="math">\(x\)</span> (i.e., 0000...0010)</p></li>
<li><p><span class="math">\(\alpha^j\)</span>: <span class="math">\(\alpha\)</span> multiplied by itself <span class="math">\(j\)</span> times in <span class="math">\(GF(2^{128})\)</span></p></li>
<li><p><span class="math">\(\oplus\)</span> Bitwise XOR</p></li>
<li><p><span class="math">\(\otimes\)</span> Modular multiplication with binary coefficients modulo <span class="math">\(x^{128}+x^7+x^2+x+1\)</span>.</p></li>
</ul>
</div>
</div><div class="integrated-exercise ld-slide" id="ubung">
<h2>Übung</h2>
<ol class="arabic simple">
<li><p>Why is it important in CBC to protect the IV?</p></li>
</ol>
<blockquote>
<aside class="admonition admonition-solution">
<p class="admonition-title">Solution</p>
<p>If the IV is sent as is, we may be able in certain scenarios to flip some bytes of the plaintext (of the first block) when we change the IV.</p>
</aside>
</blockquote>
<ol class="arabic simple" start="2">
<li><p>In which operation modes is padding necessary?</p></li>
</ol>
<blockquote>
<aside class="admonition admonition-solution">
<p class="admonition-title">Solution</p>
<p>ECB and CBC (the input to the encryption is a full plaintext block).</p>
</aside>
</blockquote>
<ol class="arabic" start="3">
<li><p>What happens in case of a transmission error (single bit flip in the ciphertext) in ECB, CBC, CFB, OFB, CTR?</p>
<aside class="admonition admonition-solution">
<p class="admonition-title">Solution</p>
<dl class="field-list simple">
<dt>ECB<span class="colon">:</span></dt>
<dd><p>one block is affected (in case of DES and AES approx. 50% of the bits).</p>
</dd>
<dt>CBC<span class="colon">:</span></dt>
<dd><p>in the next block we will have one flipped bit in the plaintext and approx. 50% in the current block.</p>
</dd>
<dt>CFB<span class="colon">:</span></dt>
<dd><p>The flipped bit will affect the corresponding plaintext bit and all subsequent bits with a probability of approx. 50% as long the flipped bit is used as input to the encryption.</p>
</dd>
<dt>OFB, CTR<span class="colon">:</span></dt>
<dd><p>In the plaintext one bit will be flipped.</p>
</dd>
</dl>
</aside>
</li>
<li><p>Why does the IV in OFB has to be a nonce (i.e., unique to each execution of the encryption algorithm)?</p></li>
</ol>
<blockquote>
<aside class="admonition admonition-solution">
<p class="admonition-title">Solution</p>
<p>The O_i only depend on the key and the IV, if the IV is reused with the same key and we happen to know a specific plaintext we may be able to decrypt a corresponding ciphertext in a different message.</p>
</aside>
</blockquote>
<ol class="arabic" start="5">
<li><p>You want to determine if a program for encrypting files uses ECB mode. What do you need to do?</p>
<aside class="admonition admonition-one-solution">
<p class="admonition-title">One Solution</p>
<p>Use a document that consists of more than one block where each block has the size of the underlying cipher and each block has the same content. If ECB mode is used all blocks are encrypted in the same way.</p>
</aside>
</li>
<li><p>A friend of yours invented a new block cipher. You are <strong>very</strong> skeptical. Think about some very simple tests to invalidate the cipher.</p></li>
<li><p>Use the OFB mode in combination with a Caesar cipher. The block size is a single character. The key is the number of characters you are going to shift a character - as before. The IV is some character. To make the XOR work we map every character to a value and extend the alphabet with the digits 1 to 3, &quot;!&quot;, &quot;?&quot; and the &quot;_&quot;. This way it is always possible to output a meaningful character.</p>
<blockquote>
<p>Hence, we will have the following encoding:</p>
<table>
<thead>
<tr><th class="head"><p>Index</p></th>
<th class="head"><p>Character</p></th>
<th class="head"><p>Binary Representation</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>0</p></td>
<td><p>A</p></td>
<td><p>00000</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>B</p></td>
<td><p>00001</p></td>
</tr>
<tr><td><p>2</p></td>
<td><p>C</p></td>
<td><p>00010</p></td>
</tr>
<tr><td><p>3</p></td>
<td><p>D</p></td>
<td><p>00011</p></td>
</tr>
<tr><td><p>4</p></td>
<td><p>E</p></td>
<td><p>00100</p></td>
</tr>
<tr><td><p>5</p></td>
<td><p>F</p></td>
<td><p>00101</p></td>
</tr>
<tr><td><p>6</p></td>
<td><p>G</p></td>
<td><p>00110</p></td>
</tr>
<tr><td><p>7</p></td>
<td><p>H</p></td>
<td><p>00111</p></td>
</tr>
<tr><td><p>8</p></td>
<td><p>I</p></td>
<td><p>01000</p></td>
</tr>
<tr><td><p>9</p></td>
<td><p>J</p></td>
<td><p>01001</p></td>
</tr>
<tr><td><p>10</p></td>
<td><p>K</p></td>
<td><p>01010</p></td>
</tr>
<tr><td><p>11</p></td>
<td><p>L</p></td>
<td><p>01011</p></td>
</tr>
<tr><td><p>12</p></td>
<td><p>M</p></td>
<td><p>01100</p></td>
</tr>
<tr><td><p>13</p></td>
<td><p>N</p></td>
<td><p>01101</p></td>
</tr>
<tr><td><p>14</p></td>
<td><p>O</p></td>
<td><p>01110</p></td>
</tr>
<tr><td><p>15</p></td>
<td><p>P</p></td>
<td><p>01111</p></td>
</tr>
<tr><td><p>16</p></td>
<td><p>Q</p></td>
<td><p>10000</p></td>
</tr>
<tr><td><p>17</p></td>
<td><p>R</p></td>
<td><p>10001</p></td>
</tr>
<tr><td><p>18</p></td>
<td><p>S</p></td>
<td><p>10010</p></td>
</tr>
<tr><td><p>19</p></td>
<td><p>T</p></td>
<td><p>10011</p></td>
</tr>
<tr><td><p>20</p></td>
<td><p>U</p></td>
<td><p>10100</p></td>
</tr>
<tr><td><p>21</p></td>
<td><p>V</p></td>
<td><p>10101</p></td>
</tr>
<tr><td><p>22</p></td>
<td><p>W</p></td>
<td><p>10110</p></td>
</tr>
<tr><td><p>23</p></td>
<td><p>X</p></td>
<td><p>10111</p></td>
</tr>
<tr><td><p>24</p></td>
<td><p>Y</p></td>
<td><p>11000</p></td>
</tr>
<tr><td><p>25</p></td>
<td><p>Z</p></td>
<td><p>11001</p></td>
</tr>
<tr><td><p>26</p></td>
<td><p>1</p></td>
<td><p>11010</p></td>
</tr>
<tr><td><p>27</p></td>
<td><p>2</p></td>
<td><p>11011</p></td>
</tr>
<tr><td><p>28</p></td>
<td><p>3</p></td>
<td><p>11100</p></td>
</tr>
<tr><td><p>29</p></td>
<td><p>!</p></td>
<td><p>11101</p></td>
</tr>
<tr><td><p>30</p></td>
<td><p>?</p></td>
<td><p>11110</p></td>
</tr>
<tr><td><p>31</p></td>
<td><p>_</p></td>
<td><p>11111</p></td>
</tr>
</tbody>
</table>
<p>Now encode some messages using your new cipher. What will you realize?</p>
<aside class="admonition admonition-solution">
<p class="admonition-title">Solution</p>
<p>The same character is no longer (necessarily) mapped to the same target when it reappears in the original message; i.e, we have some diffusion.</p>
<aside class="admonition admonition-example">
<p class="admonition-title">Example</p>
<div class="math">
\begin{equation*}
IV = A, k = 3, M = AA
\end{equation*}
</div>
<div class="math">
\begin{equation*}
.. 1. I_1 = IV = A; E(I_1) = D; C_1 = A \oplus D = D
\end{equation*}
</div>
<div class="math">
\begin{equation*}
.. 2. I_2 = D; E(I_2) = G, C_2 = A \oplus G = G
\end{equation*}
</div>
</aside>
</aside>
<!-- example: M = T -->
<!-- IV Z, E(IV) = 3, C_1 = T \oplus 3 = "P" (10011 \oplus 11100 = 01111 = P) -->
</blockquote>
</li>
</ol>
</div>
</body>
</html>
