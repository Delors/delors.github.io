<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="LD2 0.1" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;IT Sicherheit&quot;, Passwortwiederherstellung" name="keywords" />
<meta content="Fortgeschrittene Angewandte IT Sicherheit" lang="de" name="description" xml:lang="de" />
<meta content="2023_11-w3wi_se403_passwort_wiederherstellung-regexp" name="id" />
<meta content="last-viewed" name="first-slide" />
<title>Reguläre Ausdrücke</title>
    <script src="../LectureDoc2/ld-crypto.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-lib.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-animations.js" type="text/javascript"></script>    
    <script src="../LectureDoc2/ld-help.js" type="text/javascript"></script>
    <script defer src="../LectureDoc2/ld-core.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../LectureDoc2/ld.css" type="text/css" />
    <link rel="stylesheet" href="../LectureDoc2/themes/DHBW/theme.css" type="text/css" />
</head>
<body>
<template>
<div class="ld-slide" id="regulare-ausdrucke">
<h1 class="title">Reguläre Ausdrücke</h1>

<div class="line-above padding-bottom-1em docutils container">
<dl class="field-list simple">
<dt>Dozent<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt>Kontakt<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="mailto:michael.eichberg&#64;dhbw-mannheim.de">michael.eichberg&#64;dhbw-mannheim.de</a></p>
</dd>
<dt>Version<span class="colon">:</span></dt>
<dd><p>1.0</p>
</dd>
</dl>
</div>
<div class="supplemental">
<dl class="field-list simple">
<dt>Folien<span class="colon">:</span></dt>
<dd><dl class="field-list simple">
<dt>HTML<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/lab-regexp/folien.de.rst.html">https://delors.github.io/lab-regexp/folien.de.rst.html</a></p>
</dd>
<dt>PDF<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/lab-regexp/folien.de.rst.html.pdf">https://delors.github.io/lab-regexp/folien.de.rst.html.pdf</a></p>
</dd>
</dl>
</dd>
<dt>Fehler auf Folien melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div></div>
<div class="ld-slide" id="regulare-ausdrucke-wiederholung">
<h2>Reguläre Ausdrücke (Wiederholung)</h2>
<p>Reguläre Ausdrücke (<span class="eng">regular expressions</span>) sind ein Standardwerkzeug. Wir verwenden diese insbesondere um Wörterbücher, Leaks und weitere Kontextinformationen zu verarbeiten.</p>
<p>Reguläre Ausdrücke können insbesondere zum Patternmatching auf Textdaten genutzt werden.</p>
<p>Reguläre Ausdrück beschreiben reguläre Sprachen und können durch einen endlichen Automaten erkannt werden.</p>
<p>Reguläre Ausdrücke - in der Standardeinstellung - nehmen immer einen maximalen Musterabgleich vor (<span class="eng">greedy matching / eager matching</span>).</p>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic">
<li><p>Zeichenklassen:</p>
<p>Buchstaben und Zahlen können direkt in einem regulären Ausdruck verwenden, um entsprechenden Text zu finden. Zum Beispiel steht <span class="docutils literal">&quot;a&quot;</span> für das Zeichen <span class="docutils literal">a</span>.</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string double">&quot;abc&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;a&quot;</span></code></pre>
<p>findet: <span class="docutils literal">a</span></p>
<p>Der Punkt repräsentiert ein beliebiges Zeichen - außer den Zeilenumbruch.</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string double">&quot;abc&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;a.&quot;</span></code></pre>
<p>findet: <span class="docutils literal">ab</span></p>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-1">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic">
<li><p>Zeichenklassen (fortgesetzt):</p>
<p>Eine ganze Klasse von Zeichen kann in eckigen Klammern angegeben werden &quot;[]&quot;.</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string double">&quot;abcdefg&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;[acg]&quot;</span></code></pre>
<p>findet: <span class="docutils literal">a</span>, <span class="docutils literal">c</span>, <span class="docutils literal">g</span></p>
<p>Klassen können auch durch Bereiche beschrieben werden (<span class="docutils literal"><span class="pre">a-z</span></span>, <span class="docutils literal"><span class="pre">A-Z</span></span>, <span class="docutils literal"><span class="pre">0-9</span></span>):</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string double">&quot;ab12xy&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;[a-z]&quot;</span></code></pre>
<p>findet: <span class="docutils literal">a</span>, <span class="docutils literal">b</span>, <span class="docutils literal">x</span>, <span class="docutils literal">y</span></p>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-2">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic">
<li><p>Zeichenklassen (fortgesetzt):</p>
<p>Welche Buchstaben genau durch eine Klasse repräsentiert werden hängt von den Spracheinstellungen ab!</p>
<pre class="code bash literal-block"><code><span class="name variable">LANG</span><span class="operator">=</span>de_DE.UTF-8<span class="punctuation">;</span><span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;aä&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;[a-z]&quot;</span></code></pre>
<p>findet: <span class="docutils literal">a</span>, <span class="docutils literal">ä</span></p>
<p>aber</p>
<pre class="code bash literal-block"><code><span class="name variable">LANG</span><span class="operator">=</span>C<span class="punctuation">;</span><span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;aä&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;[a-z]&quot;</span></code></pre>
<p>findet <span class="ger-quote">nur</span>: <span class="docutils literal">a</span></p>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-3">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic">
<li><p>Zeichenklassen (fortgesetzt):</p>
<p>Die Negation einer Klasse wird durch an ein <span class="docutils literal">^</span> direkt am Anfang der Klasse erzwungen.</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;abc123&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;[^a-z]&quot;</span></code></pre>
<p>findet: <span class="docutils literal">1</span>, <span class="docutils literal">2</span>, <span class="docutils literal">3</span></p>
</li>
<li><p>Escapezeichen:</p>
<p>Der Backslash <span class="docutils literal">\</span> dient als Escapezeichen für Sonderzeichen.</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;abc-123[a-z]&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;\[a-z\]&quot;</span></code></pre>
<p>findet: <span class="docutils literal"><span class="pre">[a-z]</span></span> <span class="minor">(aber nicht &quot;abc&quot;)</span></p>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-4">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic" start="3">
<li><p>Anker</p>
<p><span class="docutils literal">^</span>: Steht für den Anfang einer Zeile.</p>
<p><span class="docutils literal">$</span>: steht für das Ende einer Zeile.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;abcabcabc&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;abc&quot;</span><span class="whitespace">
</span>abc<span class="whitespace">
</span>abc<span class="whitespace">
</span>abc<span class="whitespace">
</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;abcY_abcZ&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;^abc.&quot;</span><span class="whitespace">
</span>abcY<span class="whitespace">
</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;XbcYbc&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;.bc</span>$<span class="literal string double">&quot;</span><span class="whitespace">
</span>Ybc</code></pre>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-5">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic" start="3">
<li><p>Quantifizierung</p>
<p><span class="docutils literal">*</span>: &quot;null oder mehr&quot; Vorkommen des vorherigen Zeichens oder Musters.</p>
<p><span class="docutils literal">+</span>: &quot;ein oder mehr&quot; Vorkommen des vorherigen Zeichens oder Musters.</p>
<p><span class="docutils literal">?</span>: &quot;null oder ein&quot; Vorkommen des vorherigen Zeichens oder Musters.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Sa--aa--aaaE&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;aa*&quot;</span><span class="whitespace">
</span>a,<span class="whitespace"> </span>aa,<span class="whitespace"> </span>aaa<span class="whitespace">
</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Sa--aa--aaaE&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;aa+&quot;</span><span class="whitespace">
</span>aa,<span class="whitespace"> </span>aaa<span class="whitespace">
</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Sa--aa--aaaE&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;a?&quot;</span><span class="whitespace">
</span>a,<span class="whitespace"> </span>a,<span class="whitespace"> </span>a,<span class="whitespace"> </span>a,<span class="whitespace"> </span>a,<span class="whitespace"> </span>a</code></pre>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-6">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic" start="3">
<li><p>Quatifizierung (fortgesetzt)</p>
<p><span class="docutils literal">{X,Y}</span>: zwischen X und Y Vorkommen des vorherigen Zeichens oder Musters. Die obere Grenze ist optional, um zum Beispiel X und mehr Vorkommen zu finden.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Sa--aa--aaaE&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;a{2,2}&quot;</span><span class="whitespace">
</span>aa<span class="whitespace">
</span>aa<span class="whitespace">
</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Sa--aa--aaaE&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;a{2,3}&quot;</span><span class="whitespace">
</span>aa<span class="whitespace">
</span>aaa</code></pre>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-7">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic" start="4">
<li><p>Alternativen: <span class="docutils literal">|</span> trennt  verschiedene Alternativen.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;HundMausAffe&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;Hund|Affe&quot;</span><span class="whitespace">
</span>Hund<span class="whitespace">
</span>Affe</code></pre>
<p class="incremental">Aufgrund des <span class="ger-quote">gierigem</span> Musterabgleichs ist bei dem Abgleich von Alternativen generell darauf zu achten, dass zuerst auf den letzten Abgleich geprüft wird.</p>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Schifffahrt&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;Schiff|Schifffahrt&quot;</span><span class="whitespace">
</span>Schifffahrt<span class="whitespace">

</span><span class="comment single"># Perl compatible
</span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;Schifffahrt&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string double">&quot;Schiff|Schifffahrt&quot;</span><span class="whitespace">
</span>Schiff</code></pre>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-grundlagen-8">
<h2>Reguläre Ausdrücke (Grundlagen)</h2>
<ol class="arabic" start="5">
<li><p>Klammern: <span class="docutils literal">()</span> dienen der Gruppierung von Teilausdrücken und der Referenzierbarkeit bzw. Rückreferenzen.</p>
<p>Beispiel: der folgende Ausdruck findet Zeichenketten, die mit dem Zeichen aufhören mit dem sie begonnen haben.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;XaaaaX&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;^(.).*\1</span>$<span class="literal string double">&quot;</span><span class="whitespace">
</span>XaaaaX<span class="whitespace">

</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;XaaaaY&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Eo<span class="whitespace"> </span><span class="literal string double">&quot;^(.).*\1</span>$<span class="literal string double">&quot;</span></code></pre>
</li>
</ol>
</div><div class="ld-slide" id="regulare-ausdrucke-fortgeschrittene-grundlagen">
<h2>Reguläre Ausdrücke (Fortgeschrittene Grundlagen)</h2>
<ol class="arabic" start="6">
<li><p>Lookahead</p>
<p><span class="docutils literal"><span class="pre">(?=...)</span></span>: ist ein positiver Lookahead und stellt sicher, dass ein bestimmtes Muster im Text folgt, ohne es selbst in das Ergebnis aufzunehmen.</p>
<p><span class="docutils literal"><span class="pre">(?!...)</span></span>: ist ein negativer Lookahead und stellt sicher, dass ein bestimmtes Muster im Text <em>nicht</em> folgt.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;HundKatzeHundMaus&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string single">'Hund(?=Katze).{1,2}'</span><span class="whitespace">
</span>HundKa<span class="whitespace">

</span>$<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span><span class="literal string double">&quot;HundKatzeHundMaus&quot;</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string single">'Hund(?!Katze).{1,2}'</span><span class="whitespace">
</span>HundMa</code></pre>
</li>
</ol>
</div><div class="transition-scale integrated-exercise ld-slide" id="fingerubungen">
<h2>Fingerübungen</h2>
<ol class="arabic simple">
<li><p>Prüfen Sie ob der Begriff: schmetterling oder Schmetterling in rockyou vorkommt.</p></li>
</ol>
<!-- grep -E "^[a-zA-Z]+$" /usr/share/wordlists/rockyou.txt | grep -ni "schmetterling" -->
<ol class="arabic simple" start="2">
<li><p>Finden Sie alle Passworte in denen ein Zeichen mind. 3 oder mehrmals wiederholt wird. z. B. &quot;x0000!&quot; oder &quot;aaaabbbb&quot;.</p></li>
</ol>
<!-- grep -E "(.)\1{3,}" /usr/share/wordlists/rockyou.txt -->
<ol class="arabic simple" start="3">
<li><p>Finden Sie alle Passworte, in denen eine Sequenz mit mindestens 3 Zeichen wiederholt wird. z. B. &quot;TestTest&quot; oder &quot;1AffeIstAffe#&quot;.</p></li>
</ol>
<!-- └─$ grep -E "(.{3,}).*\1" /usr/share/wordlists/rockyou.txt -->
</div>
</template>
</body>
</html>
