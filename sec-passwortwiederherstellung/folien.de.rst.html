<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta name="exercises-passwords" content="MTAwMDAw:XF2FVEjick7BbjP4IsRZrIn7A/9YNLrOL64B7Ekxs6Q=:rViFr0mK7hoU2qxG:00qqNbHv5FExlgylOTlvHW8++mRfGF9B0Cfnb1NYB9Gd6J8B53rF2GND1O+aAtxygIWE5r9wWsHTQllokMjYug+Rgbuhh6sNxLS3NjetwnQVs3mOf39gn6jW2YJOUmaz0+w3JEKIRk7I3a4Idc2J9grn8gXaK2rSKsWLZxfkFOdzlDEIuQe2GFgYqF58fxmQaMHsWVxrAtfLP/LYd/YOWzSUCngCjYJzaPNJIF60Q4UoBXMts1XKgWH7+r2UbxTCWvmTzuKN64e8v+z+Trtg8f8Gwzu2cGhq0jCD+JRoLlqgdrv7YfS1kkuoU4fqNY30JQmwhN8LNzBoZz5rhC5i7bdALknSiGmMBYqmo7iAliimm837o3yyFJsO5LJH5ApsSTfVCAFMZoBbuHuWxWUyZrP1t0iqTXFLTELIZfWdUDi6I5BAImDH/gTeGGyC3ugTYbCOECgqUaG60J42pgXDY+/TdiAN28RfzRTlQyk02+wquxZavT3a5a5O5tOOb5y2Oz5B1qBWJ6cg2zhMOIr+bBJkwJtN6Z3tusFGn6fXqTS3TzdH1otRuPbCywt35fefTPzIa+SSKiXFMboxU3j0/7zb6sFuDaeF0ZvK3odojGLXDHmxRcf1pqcM2VX4oaSXSpVp1AEW+Z8y1XqKLJ6KR3eJGNwv7DAOj3EsJs+cVtCyjUqsnEE3mX9m5b0PukqD+SN52C7Xc/stByYhOi5eMR9oXUuByWniy6h9o+m4xkj5yciHXjHEwUmwco0Lmd3p/GMO2M5m6xcGewwQrsjR+/lNzQgjgVmvgWoJdEcMDgONIacdHtcn3kYSI9FQh4yaslCXrstuvIaFBcEzkoPRzkg7UZL1c+fBWHPNwY1cBL11POcroOtGWBPbN0Vin193GWwRIJsDAn9htjDu/tsDWY4rklJi/Ng2/Q==" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="LD2 0.1" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;IT Sicherheit&quot;, Passwortwiederherstellung" name="keywords" />
<meta content="Fortgeschrittene Angewandte IT Sicherheit" lang="de" name="description" xml:lang="de" />
<meta content="lecture-security-passwort_wiederherstellung" name="id" />
<meta content="last-viewed" name="first-slide" />
<title>Passwortwiederherstellung</title>
<script type="text/javascript" src="../LectureDoc2/ext/mathjax/es5/tex-chtml-full.js?config=TeX-AMS_CHTML"></script>
    <script src="../LectureDoc2/ld-crypto.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-lib.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-animations.js" type="text/javascript"></script>    
    <script src="../LectureDoc2/ld-help.js" type="text/javascript"></script>
    <script defer src="../LectureDoc2/ld-core.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../LectureDoc2/ld.css" type="text/css" />
    <link rel="stylesheet" href="../LectureDoc2/themes/DHBW/theme.css" type="text/css" />
</head>
<body>
<template>
<div class="ld-slide" id="passwortwiederherstellung">
<h1 class="title">Passwortwiederherstellung</h1>

<div class="margin-top-1em padding-top-1em line-above docutils container">
<dl class="field-list simple">
<dt>Dozent<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt>Kontakt<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="mailto:michael.eichberg&#64;dhbw-mannheim.de">michael.eichberg&#64;dhbw-mannheim.de</a></p>
</dd>
<dt>Version<span class="colon">:</span></dt>
<dd><p>1.0</p>
</dd>
</dl>
</div>
<div class="supplemental">
<dl class="field-list simple">
<dt>Folien<span class="colon">:</span></dt>
<dd><dl class="field-list simple">
<dt>HTML<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/sec-passwortwiederherstellung/folien.de.rst.html">https://delors.github.io/sec-passwortwiederherstellung/folien.de.rst.html</a></p>
</dd>
<dt>PDF<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://delors.github.io/sec-passwortwiederherstellung/folien.de.rst.html.pdf">https://delors.github.io/sec-passwortwiederherstellung/folien.de.rst.html.pdf</a></p>
</dd>
</dl>
</dd>
<dt>Fehler auf Folien melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div></div>
<div class="ld-slide" id="was-ist-passwortwiederherstellung">
<h2>Was ist Passwortwiederherstellung?</h2>
<div class="smaller docutils container">
<p>Passwortwiederherstellung ist der Prozess, der dazu dient, ein nicht (mehr) vorhandenes Passwort wiederzuerlangen.</p>
</div>
<aside class="topic line-above red incremental small">
<p class="topic-title">Haftungsausschluss</p>
<div class="stack docutils container">
<div class="layer docutils container">
<blockquote class="epigraph">
<p>Wer unbefugt sich oder einem anderen Zugang zu Daten, die nicht f√ºr ihn bestimmt und die gegen unberechtigten Zugang besonders gesichert sind, unter √úberwindung der Zugangssicherung verschafft, wird mit Freiheitsstrafe bis zu drei Jahren oder mit Geldstrafe bestraft.</p>
<p class="attribution">‚Äî¬ß 202 a Abs. 1 StGB</p>
</blockquote>
</div>
<div class="layer incremental scriptsize docutils container">
<p><strong>Gericht sieht Nutzung von Klartext-Passw√∂rtern als Hacken an</strong></p>
<blockquote class="epigraph">
<p>[...] Vor dem Amtsgericht wurde ein Prozess verhandelt, der die Gefahren verdeutlicht, denen sich Menschen mitunter aussetzen, die versuchen, Sicherheitsl√ºcken in der Software deutscher Firmen zu finden. Das Amtsgericht hat einen Programmierer verurteilt, der im Auftrag eines Kunden eine Software analysiert und darin eine Sicherheitsl√ºcke gefunden hatte, welche die Daten von Eink√§ufern in Online-Shops im Internet offengelegt hatte. Der Programmierer kontaktierte [...] die betroffene Firma, die daraufhin die Sicherheitsl√ºcke schloss und ihn anzeigte. Aufgrund dieses Umstandes wurde der Programmierer nun wegen unbefugten Zugriffs auf fremde Computersysteme und Aussp√§hens von Daten ‚Äì welches unter dem sogenannten Hacker-Paragrafen 202a StGB unter Strafe gestellt ist ‚Äì [...] verurteilt[...].</p>
<p class="attribution">‚ÄîHeise.de - 19.01.2024 12:54 Uhr</p>
</blockquote>
</div>
</div>
</aside>
<div class="supplemental">
<ul class="simple">
<li><p>Wer hat schon einmal Passworte wiederhergestellt?</p></li>
<li><p>Wer hat Erfahrung mit Linux?</p></li>
<li><p>Wer hat Erfahrung mit Linux Kommandozeilenwerkzeugen f√ºr die Textverarbeitung?</p></li>
<li><p>Wer hat Erfahrung mit regul√§ren Ausdr√ºcken?</p></li>
<li><p>Wer hat Erfahrung mit Python?</p></li>
<li><p>Wer hat Erfahrung mit Java (Reverse Engineering)?</p></li>
</ul>
</div></div><div class="ld-slide" id="ist-passwortwiederherstellung-noch-relevant">
<h2>Ist Passwortwiederherstellung noch relevant?</h2>
<div class="three-columns docutils container">
<div class="column no-separator docutils container">
<img alt="Android Smartphone" class="incremental align-center" src="logos/android.webp" style="height: 575px;" />
</div>
<div class="column no-separator docutils container">
<img alt="Cryptostick" class="incremental align-center" src="logos/cryptostick.jpg" style="height: 400px;" />
<p class="text-align-center incremental"><span class="xxl">üõú</span></p>
</div>
<div class="column docutils container">
<img alt="Filevault Logo" class="incremental align-center" src="logos/filevault.webp" style="height: 300px;" />
<img alt="Veracrypt Logo" class="incremental align-center" src="logos/veracrypt.webp" style="height: 200px;" />
</div>
</div>
<div class="incremental margin-top-1em padding-top-1em line-above docutils container">
<p>Klassische Passw√∂rter werden (noch immer) in zahlreichen Bereichen verwendet. Beispiele sind Smartphones, Cryptosticks, Logins f√ºr Computer und Serversysteme, verschl√ºsselte Dateien und Datentr√§ger.</p>
</div>
<div class="supplemental docutils container">
<p><strong>Hintergrund</strong></p>
<p>Obwohl an vielen Stellen versucht wird Passw√∂rter aus vielen Gr√ºnden zur√ºck zu dr√§ngen, so ist die Verwendung noch allgegenw√§rtig und in machen Bereichen ist auch nicht unmittelbar eine Abl√∂sung zu erkennen.</p>
<p>Biometrie ist zum Beispiel in machen Bereichen kein Ersatz f√ºr Passw√∂rter und wird - wenn √ºberhaupt - nur erg√§nzend genommen. So ist es zum Beispiel im deutschen Recht erlaubt/m√∂glich einem Beschuldigten sein Smartphone bei Bedarf vor das Gesicht zu halten, um es zu entsperren. Je nach Qualit√§t des Fingerabdrucksensors k√∂nnen ggf. auch genommene Fingerabdr√ºcke verwendet werden. M√∂chte der Beschuldigte jedoch das Passwort nicht freiwillige nennen, dann besteht keine direkte weitere Handhabe.</p>
</div>
</div><div class="ld-slide" id="ist-passwortwiederherstellung-noch-relevant-1">
<h2>Ist Passwortwiederherstellung noch relevant?</h2>
<blockquote class="epigraph">
<p>Microsoft said hackers working for the Russian government breached its corporate networks recently and stole email from executives and some employees to find out what the company knew about them. The tech company said the breach was not due to any flaw in its software, but rather began with a ‚Äúpassword spraying.‚Äù The technique worked on what Microsoft said was an old test account, and the hackers then used the account‚Äôs privileges to get access to multiple streams of email.</p>
<p class="attribution">‚ÄîThe Washington Post; Joseph Menn (January 19, 2024)</p>
</blockquote>
</div><div class="ld-slide" id="ist-passwortwiederherstellung-noch-relevant-2">
<h2>Ist Passwortwiederherstellung noch relevant?</h2>
<blockquote class="epigraph">
<p><strong>Researchers Uncover How Outlook Vulnerability Could Leak Your NTLM Passwords</strong></p>
<p>A now-patched security flaw in Microsoft Outlook could be exploited by threat actors to access NT LAN Manager (NTLM) v2 hashed passwords when opening a specially crafted file.</p>
<p>[...]
Varonis security researcher Dolev Taler, who has been credited with discovering and reporting the bug, said NTLM hashes could be leaked by leveraging Windows Performance Analyzer (WPA) and Windows File Explorer. These two attack methods, however, remain unpatched.</p>
<p>&quot;What makes this interesting is that WPA attempts to authenticate using NTLM v2 over the open web,&quot; Taler said.</p>
<p class="attribution">‚Äî<a class="reference external" href="https://thehackernews.com/2024/01/researchers-uncover-outlook.html">The Hacker News (Jan 29, 2024)</a></p>
</blockquote>
</div><div class="vertical-title ld-slide" id="ist-passwortwiederherstellung-nicht-trivial">
<h2>Ist Passwortwiederherstellung nicht <span class="ger-quote">trivial</span>?</h2>
<img alt="H√§lfte alle Passw√∂rter in 1 Stunde geknackt" class="picture margin-left-1em margin-right-1em align-center" src="images/golem-passwortcracking.png" style="height: 1050px;" />
<p><a class="reference external" href="https://www.golem.de/news/forscher-machen-den-test-59-prozent-aller-passwoerter-in-unter-60-minuten-knackbar-2406-186329.html">golem.de</a></p>
</div><div class="vertical-title ld-slide" id="ist-passwortwiederherstellung-nicht-trivial-1">
<h2>Ist Passwortwiederherstellung nicht <span class="ger-quote">trivial</span>?</h2>
<img alt="An AI just cracked your password." class="picture margin-left-1em margin-right-1em align-center" src="logos/home_security_heroes.webp" style="height: 1152px;" />
<div class="docutils container">
<p>An AI just cracked your password.</p>
<p><a class="reference external" href="https://www.homesecurityheroes.com/ai-password-cracking/assets/pdf/hsh-an-ai-just-cracked-your-password-infographic.pdf">Home Security Heroes</a></p>
</div>
</div><div class="ld-slide" id="wiederherstellung-von-passwortern-mit-unterschiedlicher-komplexitat">
<h2>Wiederherstellung von Passw√∂rtern mit unterschiedlicher Komplexit√§t</h2>
<p>Beurteilen Sie die Qualit√§t der folgenden Passw√∂rter in Hinblick darauf wie aufw√§ndig es ist das Passwort wiederherzustellen:</p>
<ol class="arabic simple incremental smaller">
<li><p>Donaudampfschifffahrt</p></li>
<li><p>Passwort</p></li>
<li><p>ME01703138541</p></li>
<li><p>2wsx3edc4rfv</p></li>
<li><p>Haus Maus</p></li>
<li><p>iluvu</p></li>
<li><p>Emily18</p></li>
<li><p>MuenchenHamburg2023!!!!</p></li>
<li><p>hjA223dn4fw&quot;√º√§K√ü√ü k`‚â§-~ajsdk</p></li>
<li><p>Baum Lampe Haus Steak Eis Berg</p></li>
<li><p>password123</p></li>
</ol>
</div><div class="ld-slide" id="quellen-fur-passwortkandidaten">
<h2>Quellen f√ºr Passwortkandidaten</h2>
<ul class="incremental simple">
<li><p>W√∂rterb√ºcher</p></li>
<li><p>Verzeichnisse (z.‚ÄØB. Postleitzahlen, St√§dte, Stra√üennamen)</p></li>
<li><p>Leaks (Sammlungen von realen Passw√∂rtern, die meist von Hackern ver√∂ffentlicht wurden.)</p>
<ul>
<li><p>Rockyou</p></li>
<li><p>LinkedIn</p></li>
<li><p>Sony</p></li>
<li><p>etc.</p></li>
</ul>
</li>
</ul>
</div><div class="ld-slide" id="raum-der-passwortkandidaten">
<h2>Raum der Passwortkandidaten</h2>
<ul class="incremental simple">
<li><p>Eine vierstellige PIN: 10.000 m√∂gliche Kombinationen.</p></li>
<li><p>‚ÄûNormales‚Äú Passworte mit 8 Zeichen und 70 Zeichen im Zeichensatz (a-z, A-Z, 0-9 und ausgew√§hlte Sonderzeichen): <span class="math">\(70^8 = 576.480.100.000.000\)</span> Kombinationen.</p></li>
<li><p>Eine einfache Passphrase mit 4 W√∂rtern aus einem W√∂rterbuch mit 100.000 W√∂rtern: <span class="math">\(100.000^4 = 10^{20}\)</span> Kombinationen.</p></li>
<li><p>Eine Passphrase mit 6 W√∂rtern aus einem W√∂rterbuch mit 2.000 W√∂rtern: <span class="math">\(2.000^6 = 64 \times 10 ^{18}\)</span> Kombinationen.</p></li>
<li><p>Ein <span class="ger-quote">komplexes</span> Passwort mit 16 Zeichen und 84 Zeichen im Zeichensatz (a-z, A-Z, 0-9 und die meisten Sonderzeichen): <span class="math">\(84^{16} = 6,14 \times 10^{30}\)</span> Kombinationen.</p></li>
</ul>
<div class="supplemental">
<p>Eine vierstellige PIN kann niemals als sicher angesehen werden. Selbst wenn ein Bruteforce nur auf 4 oder 5 Versuche pro Stunde kommt, so ist es dennoch in wenigen Monaten m√∂glich die PIN zu ermitteln.</p>
</div></div><div class="center-child-elements not-title ld-slide" id="passworter-nicht-im-klartext-speichern">
<h2>Passw√∂rter nicht im Klartext speichern</h2>
<aside class="admonition warning">
<p class="admonition-title">Warnung</p>
<p>Es ist nie eine Option Passw√∂rter im Klartext zu speichern.</p>
</aside>
</div><div class="new-section transition-fade ld-slide" id="kryptografische-hashfunktionen-und-passworter">
<h2>Kryptografische Hashfunktionen und Passw√∂rter</h2>
</div><div class="ld-slide" id="hashfunktionen-wiederholung">
<h2>Hashfunktionen (Wiederholung)</h2>
<ul class="incremental simple">
<li><p>Eine Hashfunktion <span class="math">\(H\)</span> akzeptiert eine beliebig lange Nachricht <span class="math">\(M\)</span> als Eingabe und gibt einen Wert fixer Gr√∂√üe zur√ºck: <span class="math">\(h = H(M)\)</span>.</p></li>
<li><p>Eine √Ñnderung eines beliebigen Bits in <span class="math">\(M\)</span> sollte mit hoher Wahrscheinlichkeit zu einer √Ñnderung des Hashwerts <span class="math">\(h\)</span> f√ºhren.</p></li>
<li><p>Kryptographische Hashfunktionen werden f√ºr die Speicherung von Passw√∂rtern verwendet.</p></li>
</ul>
<div class="supplemental docutils container">
<p><strong>Kollisionen bei Hashes</strong></p>
<p>Wenn ein Passwort <span class="ger-quote">nur</span> als Hash gespeichert wird, dann gibt es zwangsl√§ufig Kollisionen und es k√∂nnte dann theoretisch passieren, dass ein Angreifer (zuf√§llig) ein v√∂llig anderes Passwort findet, dass bei der √úberpr√ºfung des Passworts akzeptiert wird. Die Konstruktion kryptografischer Hashfunktionen stellt jedoch sicher, dass dies in der Praxis nicht auftritt.</p>
</div>
</div><div class="ld-slide" id="kryptografische-hashfunktionen-fur-passworte">
<h2>Kryptografische Hashfunktionen f√ºr Passworte</h2>
<ul class="incremental smaller more-space-between-list-items simple">
<li><p>Bekannte kryptografische Hash-Funktionen: <span class="obsolete">MD4</span>, <span class="obsolete">MD5</span>, SHA-256, SHA-512, RIPE-MD, ...</p></li>
<li><p>Bekannte Funktion zur Schl√ºsselableitung: PBKDF2, ...</p></li>
<li><p>Beim Hashing von Passw√∂rtern werden die Basisalgorithmen in der Regel mehrfach (ggf. viele hunderttausend Male) angewendet, um die Laufzeit zu verl√§ngern und es f√ºr Angreifer schwieriger zu machen.</p></li>
<li><p>Mehrere Hash-Algorithmen/Schl√ºsselableitungsfunktionen wurden ausdr√ºcklich f√ºr das Hashing von Passw√∂rtern entwickelt, um g√§ngigen Angriffen zu widerstehen. z.‚ÄØB. bcrypt, scrypt oder die Argon2 Familie.</p></li>
<li><p>Einige dieser Algorithmen sind so rechenintensiv, dass sie nicht f√ºr Webanwendungen bzw. Situationen geeignet sind, in denen viele Benutzer gleichzeitig autorisiert werden m√ºssen. Diese Algorithmen werden in der Regel zum Schutz von Dateien, Containern oder lokaler Festplatten verwendet.</p></li>
</ul>
</div><div class="ld-slide" id="vom-salzen-salt">
<h2>Vom Salzen (<span class="eng">Salt</span>) ...</h2>
<div class="small docutils container">
<p><strong>Beobachtung/Problem</strong></p>
<p>Werden Passw√∂rter direkt mit Hilfe einer kryptografischen Hashfunktion gehasht, dann haben zwei Nutzer, die das gleiche Passwort verwenden, den gleichen Hash.</p>
<table class="tiny">
<thead>
<tr><th class="head"><p>User</p></th>
<th class="head"><p>Hash</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Alice</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',salt='',rounds=1000) =
<span class="docutils literal"><span class="pre">$5$rounds=1000$$lb/CwYgN/xR9dqYuYxYVtWkxMEh.VK.QOC9IKmy9DP/</span></span></p></td>
</tr>
<tr><td><p>Bob</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',salt='',rounds=1000) =
<span class="docutils literal"><span class="pre">$5$rounds=1000$$lb/CwYgN/xR9dqYuYxYVtWkxMEh.VK.QOC9IKmy9DP/</span></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="incremental small docutils container">
<p><strong>L√∂sung</strong></p>
<p>Passw√∂rter sollten immer mit einem einzigartigen und zuf√§lligen <span class="ger-quote">Salt</span> gespeichert werden, um Angriffe mittels Regenbogentabellen zu verhindern.</p>
<table class="tiny">
<thead>
<tr><th class="head"><p>User</p></th>
<th class="head"><p>Hash</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Alice</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',<span class="red">salt='0123456'</span>,rounds=1000)
<span class="docutils literal">$5$rounds=1000$0123456$66x8MB.qev25coq9OVrD1lr1ZGJJelAzOVlCDZykrY0</span></p></td>
</tr>
<tr><td></td>
<td></td>
</tr>
<tr><td><p>Bob</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',<span class="red">salt='1234567'</span>,rounds=1000)
<span class="docutils literal">$5$rounds=1000$1234567$LxD/hg29N9KYpNdFMW69Kk65BLkVLlzlSEJvqhCmFU9</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="supplemental docutils container">
<p><strong>Regenbogentabellen</strong></p>
<p>Eine Regenbogentabelle (<span class="eng">rainbow table</span>) bezeichnet eine vorberechnete Tabelle die konzeptionell zum einem Hash ein jeweilig dazugeh√∂rendes  Passwort speichert und einen effizienten Lookup erm√∂glicht. Dies kann ggf. die Angriffsgeschwindigkeit sehr signifikant beschleunigen.</p>
<p>Aufgrund der allgemeinen Verwendung von Salts sind Angriffe mit Hilfe von Regenbogentabellen heute nur noch von historischer Bedeutung.</p>
</div>
</div><div class="ld-slide" id="vom-salzen-salt-1">
<h2>Vom Salzen (<span class="eng">Salt</span>)...</h2>
<ul class="incremental more-space-between-list-items simple">
<li><p>Ein <em>Salt</em> sollte ausreichend lang sein (zum Beispiel 16 Zeichen oder 16 Byte).</p></li>
<li><p>Ein <em>Salt</em> darf nicht wiederverwendet werden.</p></li>
<li><p>Ein <em>Salt</em> wird am Anfang oder am Ende an das Passwort angeh√§ngt bevor selbiges gehasht wird.</p></li>
<li><p>Ein <em>Salt</em> unterliegt (eigentlich) keinen Geheimhaltungsanforderungen.</p></li>
</ul>
<aside class="admonition incremental small">
<p class="admonition-title">Problem</p>
<p>Sollte es einem Angreifer gelingen in eine Datenbank einzubrechen und die Tabellen mit den Nutzerdaten abzufragen (zum Beispiel aufgrund einer erfolgreichen SQL Injection), dann ist es Ihm danach direkt m√∂glich zu versuchen Passworte wiederherzustellen.</p>
</aside>
<div class="supplemental docutils container">
<p><strong>Speicherung von Salts</strong></p>
<p>In Webanwendungen bzw. allgemein datenbankgest√ºtzten Anwendungen wird der <em>Salt</em> h√§ufig in der selben Tabelle gespeichert in der auch der Hash des Passworts gespeichert wird. Im Falle von verschl√ºsselten Dateien, wird der Salt (unverschl√ºsselt) mit in der Datei gespeichert.</p>
</div>
</div><div class="ld-slide" id="und-pfeffern-pepper-von-passwortern">
<h2>... und Pfeffern (<span class="eng">Pepper</span>) von Passw√∂rtern</h2>
<div class="small docutils container">
<p>(In Normen bzw. in anderer Literatur wird statt <em>Pepper</em> auch <em>Secret Key</em>s verwendet.)</p>
</div>
<ul class="incremental more-space-between-list-items simple">
<li><p>Wie ein <em>Salt</em> geht auch der <em>Secret Key</em> in den Hashvorgang des Passworts ein.</p></li>
<li><p>Der <em>Secret Key</em> wird jedoch <strong>nicht</strong> mit den Hashwerten der Passworte gespeichert.</p>
<ul class="incremental">
<li><p>Ein <em>Secret key</em> kann zum Beispiel in einem Hardwaresicherheitsmodul (z.‚ÄØB. Secure Element oder TPM Chip) gespeichert werden.</p></li>
<li><p>Gel. wird der <em>Secret Key</em> bzw. ein Teil davon auch im Code gespeichert.</p></li>
</ul>
</li>
<li><p>Der <em>Secret Key</em> sollte zuf√§llig sein.</p></li>
<li><p>Wie ein Salt sollte auch auch <em>Secret Key</em> mind. 16 Byte lang sein. Um ein Brute-Force Angriff auf den <em>Secret Key</em> zu verhindern, sollte dem Angreifer zu einem Hash und Salt auch noch das Klartext Passwort bekannt sein.</p></li>
<li><p>Der <em>Secret Key</em> sollte pro Instanziierung einer Anwendung einmalig sein.</p></li>
</ul>
</div><div class="ld-slide" id="sichere-hashfunktionen-fur-passworte">
<h2>Sichere Hashfunktionen f√ºr Passworte</h2>
<ul class="simple">
<li><p>Argon2 (z.‚ÄØB. verwendete von LUKS2)</p></li>
<li><p>bcrypt (basierend auf Blowfish)</p></li>
<li><p>scrypt (z.‚ÄØB. erg√§nzend verwendet f√ºr das Hashing von Passw√∂rtern auf Smartphones)</p></li>
<li><p>yescrypt (z.‚ÄØB. moderne Linux Distributionen)</p></li>
</ul>
</div><div class="ld-slide" id="pbkdf2-password-based-key-derivation-function-2">
<h2><a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc2898.html#section-5.2">PBKDF2</a> (Password-Based Key Derivation Function 2)</h2>
<ul class="incremental more-space-between-list-items">
<li><p>Dient der Ableitung eines Schl√ºssels aus einem Passwort.</p></li>
<li><p>Das Ergebnis der Anwendung der PBKDF2 wird zusammen mit dem <em>Salt</em> und dem Iterationsz√§hler f√ºr die anschlie√üende Passwortverifizierung gespeichert.</p></li>
<li><p>die <span class="math">\(PBKDF2\)</span> Schl√ºsselableitungsfunktion hat 5 Parameter <span class="math">\(DK = PBKDF2(\)</span>PRF, Password, Salt, c, dkLen<span class="math">\()\)</span>:</p>
<blockquote>
<dl class="field-list simple">
<dt>PRF<span class="colon">:</span></dt>
<dd><p>eine Pseudozufallsfunktion; typischer Weise ein HMAC</p>
</dd>
<dt>Password<span class="colon">:</span></dt>
<dd><p>das Masterpasswort</p>
</dd>
<dt>Salt<span class="colon">:</span></dt>
<dd><p>der zu verwendende Salt</p>
</dd>
<dt>c<span class="colon">:</span></dt>
<dd><p>Z√§hler f√ºr die Anzahl an Runden</p>
</dd>
<dt>dkLen<span class="colon">:</span></dt>
<dd><p>die Bitl√§nge des abgeleiteten Schl√ºssels.</p>
</dd>
</dl>
</blockquote>
</li>
</ul>
<div class="supplemental docutils container">
<p>Die PBKDF2 ist nicht f√ºr das eigentliche Hashen zust√§ndig sondern <span class="ger-quote">nur</span> f√ºr das Iterieren der Hashfuntion und das eigentliche Key-stretching.</p>
<p>Laut OWASP sollten zum Beispiel f√ºr PBKDF2-HMAC-SHA512 600.000 Iterationen verwendet werden.</p>
</div>
</div><div class="ld-slide" id="hmac-hash-based-message-authentication-code">
<h2>HMAC (Hash-based Message Authentication Code)</h2>
<div class="small docutils container">
<p>Auch als <em>keyed-hash message authentication code</em> bezeichnet.</p>
<div class="math">
\begin{align*}
\begin{array}{rcl}
HMAC(K,m) &amp; = &amp; H( (K' \oplus opad) || H( ( K' \oplus ipad) || m) ) \\
K' &amp; = &amp;\begin{cases}
        H(K) &amp; \text{falls K gr√∂√üer als die Blockgr√∂√üe ist}\\
        K &amp; \text{andernfalls}
        \end{cases}
\end{array}
\end{align*}
</div>
<p><span class="math">\(H\)</span> is eine kryptografische Hashfunktion.</p>
<p><span class="math">\(m\)</span> ist die Nachricht.</p>
<p><span class="math">\(K\)</span> ist der geheime Schl√ºssel (<em>Secret Key</em>).</p>
<p><span class="math">\(K'\)</span> ist vom Schl√ºssel K abgeleiteter Schl√ºssel mit Blockgr√∂√üe (ggf. <em>padded</em> oder <em>gehasht</em>).</p>
<p><span class="math">\(||\)</span> ist die Konkatenation.</p>
<p><span class="math">\(\oplus\)</span> ist die XOR Operation.</p>
<p><span class="math">\(opad\)</span> ist das √§u√üere Padding bestehend aus Wiederholungen von 0x5c in Blockgr√∂√üe.</p>
<p><span class="math">\(ipad\)</span> ist das innere Padding bestehend aus Wiederholungen von 0x36 in Blockgr√∂√üe.</p>
</div>
</div><div class="ld-slide" id="section-1">
<h2></h2>
<img alt="Schl√ºsselableitung f√ºr den inneren und √§u√üeren Schl√ºssel K'" class="align-left" src="graffles/hmac_i_o_key_derivation.svg" style="height: 450px;" />
<img alt="Schl√ºsselableitung f√ºr den inneren und √§u√üeren Schl√ºssel K'" class="incremental margin-top-1em align-right" src="graffles/hmac_message_hashing.svg" style="height: 625px;" />
<div class="supplemental docutils container">
<p><strong>Padding und Hashing</strong></p>
<p>Im Rahmen der Speicherung von Passw√∂rtern und <em>Secret Keys</em> ist die Verwendung von Padding Operationen bzw. das Hashing von Passw√∂rtern, um Eingaben in einer wohl-definierten L√§nge zu bekommen, √ºblich. Neben dem hier gesehenen Padding, bei dem 0x00 Werte angef√ºgt werden, ist zum Beispiel auch das einfache Wiederholen des urspr√ºnglichen Wertes, bis man auf die notwendige L√§nge kommt, ein Ansatz.</p>
<p>Diese Art Padding darf jedoch nicht verwechselt werden mit dem Padding, dass ggf. im Rahmen der Verschl√ºsselung von Nachrichten notwendig ist, um diese ggf. auf eine bestimmte Blockgr√∂√üe zu bringen (zum Beispiel bei ECB bzw. CBC Block Mode Operations.)</p>
</div>
</div><div class="ld-slide" id="hmac-computation-in-python">
<h2>HMAC Computation in Python</h2>
<p><strong>Implementierung PBKDF2 mit einer Runde</strong></p>
<pre class="code python slightly-more-smaller literal-block"><code><span class="keyword namespace">import</span> <span class="name namespace">hashlib</span><span class="whitespace">
</span><span class="name">pwd</span> <span class="operator">=</span> <span class="literal string affix">b</span><span class="literal string double">&quot;MyPassword&quot;</span><span class="whitespace">
</span><span class="name">stretched_pwd</span> <span class="operator">=</span> <span class="name">pwd</span> <span class="operator">+</span> <span class="punctuation">(</span><span class="literal number integer">64</span><span class="operator">-</span><span class="name builtin">len</span><span class="punctuation">(</span><span class="name">pwd</span><span class="punctuation">))</span> <span class="operator">*</span> <span class="literal string affix">b</span><span class="literal string double">&quot;</span><span class="literal string escape">\x00</span><span class="literal string double">&quot;</span><span class="whitespace">

</span><span class="name">ikeypad</span> <span class="operator">=</span> <span class="name builtin">bytes</span><span class="punctuation">(</span><span class="name builtin">map</span><span class="punctuation">(</span><span class="keyword">lambda</span> <span class="name">x</span> <span class="punctuation">:</span> <span class="name">x</span> <span class="operator">^</span> <span class="literal number hex">0x36</span> <span class="punctuation">,</span> <span class="name">stretched_pwd</span><span class="punctuation">))</span> <span class="comment single"># xor with ipad</span><span class="whitespace">
</span><span class="name">okeypad</span> <span class="operator">=</span> <span class="name builtin">bytes</span><span class="punctuation">(</span><span class="name builtin">map</span><span class="punctuation">(</span><span class="keyword">lambda</span> <span class="name">x</span> <span class="punctuation">:</span> <span class="name">x</span> <span class="operator">^</span> <span class="literal number hex">0x5c</span> <span class="punctuation">,</span> <span class="name">stretched_pwd</span><span class="punctuation">))</span> <span class="comment single"># xor with opad</span><span class="whitespace">

</span><span class="name">hash1</span> <span class="operator">=</span> <span class="name">hashlib</span><span class="operator">.</span><span class="name">sha256</span><span class="punctuation">(</span><span class="name">ikeypad</span><span class="operator">+</span><span class="literal string affix">b</span><span class="literal string double">&quot;JustASalt&quot;</span><span class="operator">+</span><span class="literal string affix">b</span><span class="literal string double">&quot;</span><span class="literal string escape">\x00\x00\x00\x01</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">digest</span><span class="punctuation">()</span><span class="whitespace">
</span><span class="name">hmac</span>  <span class="operator">=</span> <span class="name">hashlib</span><span class="operator">.</span><span class="name">sha256</span><span class="punctuation">(</span><span class="name">okeypad</span><span class="operator">+</span><span class="name">hash1</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">digest</span><span class="punctuation">()</span></code></pre>
<div class="incremental docutils container">
<p><strong>Ergebnis</strong></p>
<pre class="code python slightly-more-smaller literal-block"><code><span class="name">hmac</span> <span class="operator">=</span><span class="whitespace">
</span><span class="literal string affix">b</span><span class="literal string single">'h</span><span class="literal string escape">\x88\xc2\xb6</span><span class="literal string single">X</span><span class="literal string escape">\xb7\xcb\x9c\x90\xc2</span><span class="literal string single">R...</span><span class="whitespace">
</span>  \<span class="name">x16</span>\<span class="name">x87</span>\<span class="name">x87</span>\<span class="name">x0e</span>\<span class="name">xad</span>\<span class="name">xa1</span>\<span class="name">xe1</span><span class="punctuation">:</span><span class="literal number integer">9</span>\<span class="name">xca</span><span class="literal string single">'</span></code></pre>
</div>
<div class="supplemental docutils container">
<p>HMAC ist auch direkt als Bibliotheksfunktion verf√ºgbar.</p>
<pre class="code python slightly-more-smaller literal-block"><code><span class="keyword namespace">import</span> <span class="name namespace">hashlib</span><span class="whitespace">
</span><span class="keyword namespace">import</span> <span class="name namespace">hmac</span><span class="whitespace">

</span><span class="name">hash_hmac</span> <span class="operator">=</span> <span class="name">hmac</span><span class="operator">.</span><span class="name">new</span><span class="punctuation">(</span><span class="whitespace">
</span>    <span class="literal string affix">b</span><span class="literal string double">&quot;MyPassword&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="literal string affix">b</span><span class="literal string double">&quot;JustASalt&quot;</span><span class="operator">+</span><span class="literal string affix">b</span><span class="literal string double">&quot;</span><span class="literal string escape">\x00\x00\x00\x01</span><span class="literal string double">&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">hashlib</span><span class="operator">.</span><span class="name">sha256</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">digest</span><span class="punctuation">()</span><span class="whitespace">

</span><span class="name">hash_hmac</span> <span class="operator">=</span><span class="whitespace">
</span>    <span class="literal string affix">b</span><span class="literal string single">'h</span><span class="literal string escape">\x88\xc2\xb6</span><span class="literal string single">X</span><span class="literal string escape">\xb7\xcb\x9c\x90\xc2</span><span class="literal string single">R...</span><span class="whitespace">
</span>      \<span class="name">x16</span>\<span class="name">x87</span>\<span class="name">x87</span>\<span class="name">x0e</span>\<span class="name">xad</span>\<span class="name">xa1</span>\<span class="name">xe1</span><span class="punctuation">:</span><span class="literal number integer">9</span>\<span class="name">xca</span><span class="literal string single">'</span></code></pre>
</div>
</div><div class="ld-slide" id="pbkdf2-hmac">
<h2>PBKDF2-HMAC</h2>
<p>(HMAC = Hash-based Message Authentication Code)</p>
<p>Im Fall von PBKDF2 ist der Schl√ºssel <span class="math">\(K\)</span> also das Passwort und die Nachricht <span class="math">\(M\)</span> das Salz.</p>
<p><strong>Beispielcode</strong></p>
<pre class="code python black smaller literal-block"><code><span class="keyword namespace">from</span> <span class="name namespace">passlib.crypto.digest</span> <span class="keyword namespace">import</span> <span class="name">pbkdf2_hmac</span><span class="whitespace">
</span><span class="name">pbkdf2_hmac</span><span class="punctuation">(</span><span class="literal string double">&quot;sha256&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">secret</span><span class="operator">=</span><span class="literal string affix">b</span><span class="literal string double">&quot;MyPassword&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">salt</span><span class="operator">=</span><span class="literal string affix">b</span><span class="literal string double">&quot;JustASalt&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">rounds</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">,</span>   <span class="comment single"># a real value should be &gt;&gt; 500.000</span><span class="whitespace">
</span>    <span class="name">keylen</span><span class="operator">=</span><span class="literal number integer">32</span> <span class="punctuation">)</span></code></pre>
<p class="incremental footnotesize">Bei einer Runde und passenden Blockgr√∂√üen ist das Ergebnis der PBKDF2 somit gleich mit der Berechnung des HMACs wenn der Salt um die Nummer des Blocks <span class="docutils literal">\x00\x00\x00\x01</span> erg√§nzt wurde.</p>
<div class="supplemental docutils container">
<p>In der konkreten Anwendung ist es ggf. m√∂glich das <em>Secret</em> auch zu Salzen und den <em>Salt</em> aus einer anderen Quellen abzuleiten.</p>
</div>
</div><div class="transition-move-left integrated-exercise ld-slide" id="ubung">
<h2>√úbung</h2>
<div class="slightly-more-smaller docutils container">
<div class="ld-exercise" data-exercise-id="1" data-exercise-title="1 - Schwachstellenbewertung" id="ld-exercise-1">
<p class="rubric">Schwachstellenbewertung</p>
<p>Ihnen liegt eine externer Festplatte/SSD mit USB Anschluss vor, die die folgenden Eigenschaften hat:</p>
<ul class="simple">
<li><p>Die Daten auf der SSD/FP sind hardwareverschl√ºsselte Festplatte.</p></li>
<li><p>Die Verschl√ºsselung erfolgt mit XTS-AES 256.</p></li>
<li><p>Es gibt eine spezielle Software, die der Kunde installieren muss, um das Passwort zu setzen. Erst danach wird die Festplatte <span class="ger-quote">freigeschaltet</span> und kann in das Betriebssystem eingebunden werden. Davor erscheint die SSD/FP wie ein CD Laufwerk auf dem die Software liegt.</p></li>
<li><p>Die SSD/FP ist FIPS zertifiziert und gegen Hardwaremanipulation gesch√ºtzt; zum Beispiel eingegossen mit Epox.</p></li>
<li><p>Das Passwort wird von der Software gehasht und dann als Hash an den Controller der externen FP/SSD √ºbertragen.</p></li>
<li><p>Im Controller wird der √ºbermittelte Hash direkt zur Autorisierung des Nutzers verwendet. Dazu wird der Hash mit dem im EPROM hinterlegten verglichen.</p></li>
</ul>
<p>Wie bewerten Sie die Sicherheit des Produkts?</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:YVOzClm7fB8a0sFYR/QtNrhLNzEL0qVMy/z+ouVZPu0=:49kbKWa1zSeKqaL6:+56pr+dalQlr9fg3VaCsxkypL3t5Yav03TGIb7xQ1Helhh/WuIvIkwTpvJdNh+b1xZMkqDqAyl/mHIWniiLPpGiDF9pjr8KWTFf5fdzJlEl1FBV4lKdAK1pQYLT+flLPPiqsY932sWsvokfvJoMiOGUHLl/i/NIp91y+XWJUgmqL7QymV0tSqA8fW9fMwDEc3A8kGm5Ppq4YO4r68sME+iAbkPs3d20rLv8Gzk5h5SyqrisoK7ZE1jFvdUB9gtqjGuqknynTdtwj1557tVDCgU9wtL9uywinO0JWdJykavGnDGdfdkaeZeRDBi6ES7OOptIH2YGEptnSqIx0yiyJS/GHEe9ZImIPIOBtT4ujts7YdyklYMG0+ALanYpUQc1wjDaC0FXBvHwI4vfoXaPPRo08GkYB8t/YhMHf3Dk3pDlCKSpVIDeVKUmP/kHT9YgBUhbKLG2zEYHjtoKOoWCR8XLSf1CBwSu98rdkXjf51e18luiLLGRquFnyhdYvgqTonC2LRJAvF4fQb9UXtUG5fsd6FKJU5HancvZM/fp5bHpblgAqDTflfGAYuFPmcjUEcrPhv5viCiF0NbHyS96ivZAIThXRStwXGqDmpBgU8gfZGHjqNH8f+CEtafsGKtlCitCVNrKcSiryXC2F8d586N1k7lf4E/kYzr9RmnmCgYbmXJKl/tqXjvY200pzPki9Xt8TqsC7No6TWlpVCq6eLUbKGAhGVK1Zv/u1v+sDz+o4FFqC98ARa1mpeLN5iWUOjCRh</div>
</div>
</div>
</div><div class="new-section transition-fade ld-slide" id="passwortwiederherstellung-101">
<h2>Passwortwiederherstellung 101</h2>
</div><div class="ld-slide" id="passwortwiederherstellung-1">
<h2>Passwortwiederherstellung</h2>
<ol class="arabic simple incremental impressive">
<li><p>Wissen wo/in welcher Form der Passworthash zu finden ist.</p></li>
<li><p>Extraktion des Hashes</p></li>
<li><p>Wiederherstellung des Passwortes durch das systematische Durchprobieren aller Kandidaten.</p></li>
</ol>
</div><div class="ld-slide" id="beispiel-wiederherstellung-eines-linux-login-passwortes">
<h2>Beispiel - Wiederherstellung eines Linux Login Passwortes</h2>
<pre class="code bash incremental literal-block"><code>~%<span class="whitespace"> </span>sudo<span class="whitespace"> </span>cat<span class="whitespace"> </span>/etc/shadow<span class="whitespace">
</span><span class="operator">[</span>...<span class="operator">]</span><span class="whitespace">
</span>john:<span class="name variable">$6$zElzjLsMqi36JXWG$FX2Br1</span>/<span class="operator">[</span>...<span class="operator">]</span>.<span class="whitespace"> </span>‚Ü©Ô∏é<span class="whitespace">
</span>RxAHnNCBsqiouWUz751crHodXxs0iqZfBt9j40l3G0:19425:0:99999:7:::<span class="whitespace">
</span><span class="operator">[</span>...<span class="operator">]</span></code></pre>
<pre class="code bash incremental line-above literal-block"><code>%<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string single">'$6$zElzjLsMqi36JXWG$FX2Br1/[...]. ‚Ü©Ô∏é
RxAHnNCBsqiouWUz751crHodXxs0iqZfBt9j40l3G0'</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>hash.txt</code></pre>
<pre class="code bash incremental line-above literal-block"><code>%<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1800</span><span class="whitespace"> </span>hash.txt<span class="whitespace"> </span>-a<span class="whitespace"> </span><span class="literal number">3</span><span class="whitespace"> </span><span class="literal string single">'?d?d?d?d?d?d'</span></code></pre>
<div class="supplemental docutils container">
<p><strong>Finden eines Hashes</strong></p>
<p>Im Falle von Linux Login Passworten ist genau spezifiziert wo die Passworte (<span class="docutils literal">/etc/shadow</span>) und in welcher Form die Passworte gespeichert werden. Nach dem Namen des Nutzers (im Beispiel <span class="docutils literal">john</span>) ist der verwendete Hashingalgorithmus vermerkt. Dieser unterscheidet sich zwischen den Distributionen. Aktuell setzen die meisten Distributionen auf <span class="docutils literal">yescrypt</span>. Danach folgen die Parameter. Insbesondere der Salt.</p>
<table>
<thead>
<tr><th class="head"><p>ID</p></th>
<th class="head"><p>Mode</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>$5$</p></td>
<td><p>Sha256crypt (veraltet)</p></td>
</tr>
<tr><td><p>$6$</p></td>
<td><p>SHA512crypt (in Abl√∂sung)</p></td>
</tr>
<tr><td><p>$y$ (or $7$)</p></td>
<td><p>yescrypt</p></td>
</tr>
</tbody>
</table>
</div>
</div><div class="ld-slide" id="systematisches-testen-aller-kandidaten">
<h2>Systematisches Testen aller Kandidaten</h2>
<p>Konzeptionell f√ºhrt die Software Hashcat die folgenden Schritte durch:</p>
<div class="monospaced small docutils container">
<p>&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000000&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000001&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000002&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000003&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000004&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000005&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000006&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000007&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000008&quot;) ‚úò</p>
<p class="incremental">...</p>
<p class="incremental">&lt;extracted_hash&gt; == SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;123456&quot;) ‚úîÔ∏é</p>
</div>
<div class="supplemental docutils container">
<p>Der folgende Code k√∂nnte als Grundlage genutzt werden, um das Passwort wiederherzustellen.</p>
<p>(Linux nutzt standardm√§√üig 5000 Runden.)</p>
<pre class="code python slightly-smaller literal-block"><code><span class="keyword namespace">from</span> <span class="name namespace">passlib.hash</span> <span class="keyword namespace">import</span> <span class="name">sha512_crypt</span><span class="whitespace">

</span><span class="name">sha512_crypt</span><span class="operator">.</span><span class="name">hash</span><span class="punctuation">(</span><span class="whitespace">
</span>    <span class="literal string double">&quot;123456&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">salt</span><span class="operator">=</span><span class="literal string double">&quot;zElzjLsMqi36JXWG&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">rounds</span><span class="operator">=</span><span class="literal number integer">5000</span><span class="punctuation">)</span></code></pre>
</div>
</div><div class="new-section transition-scale ld-slide" id="passworte-verstehen">
<h2>Passworte Verstehen</h2>
</div><div class="ld-slide" id="aufbau-von-passworten">
<h2>Aufbau von Passworten</h2>
<p>Von Menschen vergebene Passw√∂rter basieren h√§ufig auf Kombinationen von W√∂rtern aus den folgenden Kategorien:</p>
<ul class="incremental more-space-between-list-items simple">
<li><p>Pins: <span class="docutils literal">1111</span>, <span class="docutils literal">1234</span>, <span class="docutils literal">123456</span>, ‚Ä¶</p></li>
<li><p>Tastaturwanderungen (<span class="eng">keyboard walks</span>): <span class="docutils literal">asdfg</span>, <span class="docutils literal">q2w3e4r5t</span>, ‚Ä¶</p></li>
<li><p>Patterns: <span class="docutils literal">aaaaa</span>, <span class="docutils literal">ababab</span>, <span class="docutils literal">abcabcabc</span>, ‚Ä¶</p></li>
<li><p>Regul√§re W√∂rter aus W√∂rterb√ºchern: Duden, Webster, ‚Ä¶</p></li>
<li><p>Kontextinformationen:</p>
<ul>
<li><p>Szenespezifisch: <span class="docutils literal">acab</span>, szenetypischen Marken (z.‚ÄâB. Gucci, Ferrari), ‚Ä¶</p></li>
<li><p>Privates Umfeld: Namen von Kindern, Eltern, Hunden, Geburtsort, Adresse, ‚Ä¶</p></li>
</ul>
</li>
</ul>
</div><div class="ld-slide" id="haufige-passworte">
<h2>H√§ufige Passworte</h2>
<p>Eine gute Quelle f√ºr das Studium von Passw√∂rtern sind sogenannte <em>Leaks</em> oder auch Listen mit g√§ngigen Passw√∂rtern. Zum Beispiel <a class="reference external" href="https://www.beckershospitalreview.com/cybersecurity/30-most-common-passwords-of-2023.html">Becker's Health IT 2023</a>:</p>
<div class="three-columns small docutils container">
<div class="column text-align-center docutils container">
<p>123456</p>
<p>password</p>
<p>123456789</p>
<p>12345</p>
<p>12345678</p>
<p>qwerty</p>
<p>1234567</p>
<p>111111</p>
<p>1234567890</p>
<p>123123</p>
</div>
<div class="column text-align-center docutils container">
<p>abc123</p>
<p>1234</p>
<p>password1</p>
<p>iloveyou</p>
<p>1q2w3e4r</p>
<p>000000</p>
<p>qwerty123</p>
<p>zaq12wsx</p>
<p>dragon</p>
<p>sunshine</p>
</div>
<div class="column text-align-center docutils container">
<p>princess</p>
<p>letmein</p>
<p>654321</p>
<p>monkey</p>
<p>27653</p>
<p>1qaz2wsx</p>
<p>123321</p>
<p>qwertyuiop</p>
<p>superman</p>
<p>asdfghjkl</p>
</div>
</div>
<div class="supplemental">
<p><strong>Hinweise</strong></p>
<ul class="simple">
<li><p>Die Listen √§ndern sich in der Regel von Jahr zu Jahr nicht wesentlich.</p></li>
<li><p>Die konkrete Methodik ist oft fragw√ºrdig; in der Gesamtheit aber dennoch aussagekr√§ftig.</p></li>
</ul>
</div></div><div class="ld-slide" id="herausforderung-hashraten-in-mh-s-auf-aktueller-hardware">
<h2>Herausforderung: Hashraten in MH/s auf aktueller Hardware</h2>
<table class="incremental scriptsize no-table-borders">
<thead>
<tr><th class="head"><p><strong>Hashcat Mode (Hashcat 6.2.6)</strong></p></th>
<th class="head"><p><strong>Hash</strong></p></th>
<th class="head"><p><strong>RTX 1080Ti (250 W)</strong></p></th>
<th class="head"><p><strong>RTX 2080TI (260 W)</strong></p></th>
<th class="head"><p><strong>RTX 3090 (350 W)</strong></p></th>
<th class="head"><p><strong>RTX 4090 (450 W)</strong></p></th>
</tr>
</thead>
<tbody>
<tr><td><p>25700</p></td>
<td><p>Murmur</p></td>
<td></td>
<td></td>
<td></td>
<td><p>643700.0 (643 GH/s)</p></td>
</tr>
<tr><td><p>23</p></td>
<td><p>Skype</p></td>
<td><p>21330.1</p></td>
<td><p>27843.1</p></td>
<td><p>37300.7</p></td>
<td><p>84654.8</p></td>
</tr>
<tr><td><p>1400</p></td>
<td><p>SHA2-256</p></td>
<td><p>4459.7</p></td>
<td><p>7154.8</p></td>
<td><p>9713.2</p></td>
<td><p>21975.5</p></td>
</tr>
<tr><td><p>10500</p></td>
<td><p>PDF1.4-1.6</p></td>
<td><p>24.9</p></td>
<td><p>29.8</p></td>
<td><p>76.8</p></td>
<td><p>122.0</p></td>
</tr>
<tr><td><p>1800</p></td>
<td><p>SHA 512 Unix (5000 Iterations)</p></td>
<td><p>0.2</p></td>
<td><p>0.3</p></td>
<td><p>0.5</p></td>
<td><p>1.2</p></td>
</tr>
<tr><td><p>13723</p></td>
<td><p>Veracrypt SHA2- 512 + XTX 1536Bit</p></td>
<td><p>0.0004</p></td>
<td><p>0.0006</p></td>
<td><p>0.0009</p></td>
<td><p>0.002
(2000 H/s)</p></td>
</tr>
</tbody>
</table>
<div class="supplemental smaller">
<p><strong>Quellen:</strong></p>
<ul class="simple">
<li><p>4090: <span class="far-smaller">https://gist.github.com/Chick3nman/e4fcee00cb6d82874dace72106d73fef</span></p></li>
<li><p>3090: <span class="far-smaller">https://gist.github.com/Chick3nman/e4fcee00cb6d82874dace72106d73fef</span></p></li>
<li><p>1080Ti: <span class="far-smaller">https://www.onlinehashcrack.com/tools-benchmark-hashcat-nvidia-gtx-1080-ti.php</span></p></li>
<li><p>2080Ti: <span class="far-smaller">https://gist.github.com/binary1985/c8153c8ec44595fdabbf03157562763e</span></p></li>
</ul>
</div></div><div class="ld-slide" id="herausforderung-unmoglichkeit-eines-brute-force-angriffs-auf-luks2">
<h2>Herausforderung: Unm√∂glichkeit eines Brute-Force Angriffs auf Luks2</h2>
<img alt="Zeit die f√ºr einen Angriff auf LUKS2 ben√∂tigt wird." class="align-center" src="dgraphs/brute_force-luks2.svg" style="width: 900px;" />
</div><div class="ld-slide" id="herausforderung-unmoglichkeit-eines-brute-force-angriffs-auf-lange-passworte">
<h2>Herausforderung: Unm√∂glichkeit eines Brute-Force Angriffs auf lange Passworte</h2>
<img alt="Zeit f√ºr f√ºr Angriffe auf lange Passw√∂rter ben√∂tigt wird." class="align-center" src="dgraphs/brute_force.svg" style="width: 1820px;" />
</div><div class="ld-slide" id="herausforderung-stets-neue-algorithmen">
<h2>Herausforderung: stets neue Algorithmen</h2>
<blockquote class="epigraph">
<p>Angriff auf LUKS2 mit Argon2</p>
<p>[‚Ä¶] The choice of Argon2 as a KDF makes GPU acceleration impossible. As a result, you‚Äôll be restricted to CPU-only attacks, which may be very slow or extremely slow depending on your CPU. To give an idea, you can try 2 (that‚Äôs right, two) passwords per second on a single Intel(R) Core(TM) i7-9700K CPU &#64; 3.60GHz. Modern CPUs will deliver a slightly better performance, but don‚Äôt expect a miracle: LUKS2 default KDF is deliberately made to resist attacks. [‚Ä¶]</p>
<p class="attribution">‚ÄîElcomsoft <a class="reference external" href="https://blog.elcomsoft.com/2022/08/probing-linux-disk-encryption-luks2-argon-2-and-gpu-acceleration">Luks2 with Argon2</a></p>
</blockquote>
</div><div class="transition-move-left integrated-exercise ld-slide" id="gedankenexperiment">
<h2>Gedankenexperiment</h2>
<div class="ld-exercise" data-exercise-id="2" data-exercise-title="2 - Kosten und Aufwand f√ºr Passwortwiederherstellung" id="ld-exercise-2">
<p class="rubric">Kosten und Aufwand f√ºr Passwortwiederherstellung</p>
<p>Sie wollen einen <em>SHA-256</em> angreifen und sie haben 100 Nvidia 4090 GPUs. Jede GPU hat eine Hash-Rate von ~22GH/s (mit Hashcat 6.2.6) und ben√∂tigt ~500 Watt pro Stunde (Wh). Der verwendete Zeichensatz besteht aus 84 verschiedenen Zeichen (z.‚ÄØB. a-z, A-Z, 0-9, &lt;einige Sonderzeichen&gt;).</p>
<ol class="arabic simple">
<li><p>Wie lange dauert es, ein 10-stelliges Passwort zu ermitteln (Worst Case)?</p></li>
<li><p>Wie viel Geld wird es Sie kosten, ein 10-stelliges Passwort zu knacken (Worst Case), wenn 1kWh 25ct kostet?</p></li>
<li><p>Werden Sie im Laufe Ihres Lebens in der Lage sein, ein Passwort mit 12 Zeichen L√§nge zu ermitteln?</p></li>
</ol>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:G15ZUrWM2dSyX12+i1Y4HwAiwWDco47dA/WXZddrR+4=:KOXKYctlQIreyH4D:Qj9z+/0WWHGUCiScWuumov2OL6RzG0lX3okSDadF2aMZxKlraCItKVZNdrTA/3S8L6g4JZcaiguKGf0oJJUv/7vZ0PVI7mdoGL5QAVs5eS/1N8Pap2b/khfzGaCuU6fQzk/+dNisXO+V7u6IWS5/Pzoq9l/kePCYp1yoRz6RJvbK2rnbEACe7fX8pRlHy5GwPaUCQrU4HquU48ErH+t+39RQlHuWnojiSWrRCuIVcIhfLSz7DjZfUU9oAg4+parEKLUcqiqHfCYycIcq+utLLxxXu2OcO3BrIok3A76bN3DveX+pUeBleZ5p8/TnJGhFWLCXvafq+oSADb2yxn2F5brQzIhIBJeurPoCZuTWwGtLXjJz06AhvjMBnkdTjn8cGag4TF06LIgSKqo9Chj4zANxOIO3kzSF9OUeerOeFet+VuMFQy0YRH1O+kR8ep03+kdEKVme6odKeRMYaNm9KUQntAowxI2iSxr4X0fpIRAL6G73lpntHBW9nUEh57folEnxMHpR0EOkxWAm2T7mmtjPSyS3ODnth7u3R3ruLm4tbx3lew8GRy5HY5IbHHVt3m4lwhAoK9MAeqJ4jpcAmkdYthO73+/XkVYw64BkwnyPw5ivmBbFaWETZKWPn9BAE6rbSMAUoaT+ycAmfWXUUNCMYbJ/SPVqBSnPcwUJFmd75lUkGkkM2l5iBoFBr8sCcz62gxdsWjMRxBUfWE1ZZw+F8YkjjhrfTlPyjFt10ninZiDOC36B8/J6QBpqdjf83aQEIxeyA3hQSlHrU6PB1UVICv+YID8fyVrcK/Ya9cS2BJHzU0caUwkG1TARqVUrZZEC+cUmP5bSFfevxr3NBmkVxOWrQJpEcfGLV4gA3KCZJoaxh9dY4AXz2VTcmqHJJjyZFs0EmyKysZCHrqIgl8yDHF9q5nKvof62XnpS8cteVjvlvE+0Rn3WZeTnvIazOYY29l1ZrAogiIT9FWD0Z2IyzSHzoKTHCjCe6w==</div>
</div>
</div><div class="transition-move-left integrated-exercise ld-slide" id="gedankenexperiment-1">
<h2>Gedankenexperiment</h2>
<div class="ld-exercise" data-exercise-id="3" data-exercise-title="3 - Verstehen des Suchraums" id="ld-exercise-3">
<p class="rubric">Verstehen des Suchraums</p>
<p>Sie haben <span class="ger-quote">ganz viele`</span> Grafikkarten und einen sehr schnellen Hash. Sie kommen auf eine Hashrate von 1‚ÄØTHash/Sekunde (<span class="math">\(1 \times 10^{12}\)</span>). Sie haben einen Monat Zeit f√ºr das Knacken des Passworts.
Gehen Sie davon aus, dass Ihr Zeichensatz 100 Zeichen umfasst.</p>
<p>Berechnen Sie den Anteil des Suchraums, den Sie abgesucht haben, wenn das Passwort 32 Zeichen lang sein sollte. Dr√ºcken Sie den Anteil des abgesuchten Raums in Relation zu der Anzahl der Sandk√∂rner der Sahara aus. Gehen Sie davon aus, dass die Sahara ca. 70 Trilliarden (<span class="math">\(70 \times 10^{21}\)</span>) Sandk√∂rner hat.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:GUcXZe9o8jdIEXW+UPoJzBk0lY4kgGHn4Nce5OJ9cZs=:1JkS6NQRe9vTnKnt:UK+rHU6ieRUmfCuioZZylpFRTKYO3ZZ9hRdWeRoxe5m4eTS737IMP0YhOU0BhA9RAP0TGKaMfL+0nlscoKfhaXcVAZ3Xz8hRvxx1uJRS8J/JIFHOhL7uiSeSSQcyYC8D/6845WFclrpt4JbxOZCjoq4Msj2Y+u/1U1sraFJpmRNkMdfnI6YbVHGSOsal4GqbhRDy4HqckxNyFkOMlsITysmepWkJrEIGAy+tnIWBNgmjJEBJ3geovqwI7ebyz3hnjn6DHpep5mzE75mJjIdYlkQV0v4cV4vzvJRIRRtpNhJ924wsMcNIRuy1nviuPb2JjJwOmbEYAaE24DpPpCKsODtd62lLIuW2OXzJi7J6aRvL1Jlo5I7oIJN6Y8ECX/p3b6zJK5O8AG1piLPRzV+pDZ2nkiWMkx51DCAG3SMso1ea7/bx/ySfgVyMMTt4lpoyUVufO7++2UxRKehM8+XZomiRxEt10JZGcWu0PMghD1vDcnr0J+X14uBoAEbNw8gLEKFBCHyNlZ38afkbsoVm+hKPZBOUNqO0wEM4Nr00YUghDBsJsy7qpCoUT7lMvINEsaemIg3Ww0D8C+e1cqLRnMjbZAbvMZAduIczaPSX0/zP9/TWVJBSppy0O585HZQYlGUCv9ayqEoCnF1jkW4X6TRbMlKJeq5S1mwr/QyP8f6JTv2pU7uOoKU+Uw06EcXRnfGlNNs+hZZvtdJHXikuMVP05Bvm9p0lG8GhShLEbeIbCoDQtAAApSa7Ax8H1/sEttb1Fz4lFei0ODtvxc7NqB3gDzju1WIq2Br/C8Fk8zVkG2IQ5XkgtQFLxPvOuk1+ZHzGiku/3wfBn2kIeuk6ewaPf56Kc1HjdH0Znb2mR8M95L+HgtMzbxQLKJaO3DztNV4LQgfA1tcZUYoQdmSgbU7EyDPaOryXUC2GL3mbfvDvouqjBIuJn4chljdY6W8OkP++KB1hYejy0Mr1k3rHuWlMckia2rpFsjy0WwYmgzOaCYIeN8AE4doYKweVV+vy5uEtWdIXzylfBh8TcY0mTVn6lJUZDXgbuCdqM95HN5oIlMiW+UkXNjaNyRP4cj5i/IRSJjI85BjGkETvI34AfvCCLj1LNF6Bxj0yRcA27XTDOpTil82+Mpo07F58nYgadQS9DwSVdP+LxEFu2tuNX5AEK1vkXixqvYkfeseyyR9ZYM40HJFatTDHTGShtaKLIExwVk9wve8kF5ILtMntS9XYyp1ENb3ayL9rhqsveG04Yk8fygc0WRdgGc9w0vkV5/zWcGN6lz/W40qDaaNpsDT17xN5Ube1mxtQ0agzmBwC0afegOCeEwgicrOlb6Nd04faptZ0HurB+ivUAO+A8uZQ3dyn4rQJgQcDN0NR5s1MeQDoYksTeoH16/ey8k0g2dVfPttXAr+PsP9htREgoIuv3wuIHoE6NC3Q0kCqeJUHaoqtvuwFY/bcfCZ4rQ0QSo0GzlHLfRVBoMGfzDZugq/ZME/SYXWI87mUonAtuiP9rjTTFDNox09eEVlJG9vHymoCYbosUt1ugZs1l++1pAskxgpETTFpyZtaQBO7i8ZxxGI5VMQnwpKlIPcXsdTPd9jtOHNS81NR2XLRm22ODmVAqDZqSZ6JFCFF3VUw1kWH39o5xhjJQWNTA/j3N7JCpZzdozgZJ/o2L6PBqUQ/7JLNyZBOZ2Dxi4lb00y5fLE5RZyr/aWaPrEghMVW28dE</div>
</div>
</div><div class="ld-slide" id="herausforderung-passwortrichtlinien">
<h2>Herausforderung: Passwortrichtlinien</h2>
<p>Moderne Passwortrichtlinien (<span class="eng">Password Policies</span>) machen es unm√∂glich, √§ltere Leaks <em>direkt</em> zu nutzen.</p>
<p><em>Beispiele:</em></p>
<ul class="incremental more-space-between-list-items simple">
<li><p>Mindestanzahl von Zeichen (maximale Anzahl von Zeichen)</p></li>
<li><p>Anforderungen an die Anzahl der Ziffern, Sonderzeichen, Gro√ü- und Kleinbuchstaben</p></li>
<li><p>Anforderungen an die Vielfalt der verwendeten Zeichen</p></li>
<li><p>einige Passw√∂rter (z.‚ÄØB. aus bekannten Leaks und W√∂rterb√ºchern) sind verboten</p></li>
<li><p>...</p></li>
</ul>
<div class="supplemental docutils container">
<p>Passwortrichtlinien extrem: <a class="reference external" href="https://neal.fun/password-game/">Password Game</a></p>
<p>Die wichtigsten <a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf">NIST-Richtlinien</a> f√ºr Passw√∂rter:</p>
<ul class="simple">
<li><p>Mindestl√§nge von 8 Zeichen.</p></li>
<li><p>Keine Komplexit√§tsanforderung. Benutzer sollten auch die M√∂glichkeit haben, Leerzeichen einzuf√ºgen, um die Verwendung von Phrasen zu erm√∂glichen. F√ºr die Benutzerfreundlichkeit [...] kann es von Vorteil sein, wiederholte Leerzeichen in getippten Passw√∂rtern vor der √úberpr√ºfung zu entfernen.</p></li>
</ul>
</div>
</div><div class="ld-slide" id="die-struktur-von-passwortern-verstehen">
<h2>Die Struktur von Passw√∂rtern verstehen</h2>
<div class="scriptsize docutils container">
<p>Analyse auf Grundlage des <span class="ger-quote">ber√ºhmten</span> Rockyou-Lecks.</p>
<p>Hier haben wir alle Kleinbuchstaben auf l, Gro√übuchstaben auf u, Ziffern auf d und Sonderzeichen auf s abgebildet.</p>
</div>
<table class="align-left compact-cells tiny no-inner-borders" style="width: 100%;">
<tbody>
<tr><td><p>llllllll</p></td>
<td><p>4,8037%</p></td>
<td><p>lllllllldd</p></td>
<td><p>1,4869%</p></td>
<td><p>dddddddddddd</p></td>
<td><p>0,2683%</p></td>
<td><p>ddddddll</p></td>
<td><p>0,1631%</p></td>
</tr>
<tr><td><p>llllll</p></td>
<td><p>4,1978%</p></td>
<td><p>lllllld</p></td>
<td><p>1,3474%</p></td>
<td><p>lllddddd</p></td>
<td><p>0,2625%</p></td>
<td><p>lllllls</p></td>
<td><p>0,1615%</p></td>
</tr>
<tr><td><p>lllllll</p></td>
<td><p>4,0849%</p></td>
<td><p>llllllld</p></td>
<td><p>1,3246%</p></td>
<td><p>lllllllllldd</p></td>
<td><p>0,2511%</p></td>
<td><p>ddddlll</p></td>
<td><p>0,1613%</p></td>
</tr>
<tr><td><p>lllllllll</p></td>
<td><p>3,6086%</p></td>
<td><p>llllllllllll</p></td>
<td><p>1,3223%</p></td>
<td><p>llllllllllllllll</p></td>
<td><p>0,2340%</p></td>
<td><p>dlllllll</p></td>
<td><p>0,1583%</p></td>
</tr>
<tr><td><p>ddddddd</p></td>
<td><p>3,4003%</p></td>
<td><p>llldddd</p></td>
<td><p>1,2439%</p></td>
<td><p>lllldddddd</p></td>
<td><p>0,2322%</p></td>
<td><p>dllllll</p></td>
<td><p>0,1575%</p></td>
</tr>
<tr><td><p>dddddddddd</p></td>
<td><p>3,3359%</p></td>
<td><p>llllldddd</p></td>
<td><p>1,2109%</p></td>
<td><p>llddddd</p></td>
<td><p>0,2270%</p></td>
<td><p>llllddddd</p></td>
<td><p>0,1560%</p></td>
</tr>
<tr><td><p>dddddddd</p></td>
<td><p>2,9878%</p></td>
<td><p>lllllldddd</p></td>
<td><p>1,1204%</p></td>
<td><p>uuuuuudd</p></td>
<td><p>0,2189%</p></td>
<td><p>dddddddl</p></td>
<td><p>0,1557%</p></td>
</tr>
<tr><td><p>lllllldd</p></td>
<td><p>2,9326%</p></td>
<td><p>lllllllld</p></td>
<td><p>1,1168%</p></td>
<td><p>ddddll</p></td>
<td><p>0,2169%</p></td>
<td><p>uuuudd</p></td>
<td><p>0,1551%</p></td>
</tr>
<tr><td><p>llllllllll</p></td>
<td><p>2,9110%</p></td>
<td><p>lllllddd</p></td>
<td><p>1,0633%</p></td>
<td><p>lddddddd</p></td>
<td><p>0,2064%</p></td>
<td><p>lllllddddd</p></td>
<td><p>0,1395%</p></td>
</tr>
<tr><td><p>dddddd</p></td>
<td><p>2,7243%</p></td>
<td><p>llllllddd</p></td>
<td><p>0,9225%</p></td>
<td><p>ddddddddddddd</p></td>
<td><p>0,2017%</p></td>
<td><p>ddllllll</p></td>
<td><p>0,1391%</p></td>
</tr>
<tr><td><p>ddddddddd</p></td>
<td><p>2,1453%</p></td>
<td><p>llllllllld</p></td>
<td><p>0,9059%</p></td>
<td><p>ullllldd</p></td>
<td><p>0,1930%</p></td>
<td><p>ulllll</p></td>
<td><p>0,1379%</p></td>
</tr>
<tr><td><p>llllldd</p></td>
<td><p>2,0395%</p></td>
<td><p>lllll</p></td>
<td><p>0,8793%</p></td>
<td><p>ddddllll</p></td>
<td><p>0,1905%</p></td>
<td><p>uuuuuuuuuu</p></td>
<td><p>0,1378%</p></td>
</tr>
<tr><td><p>llllllldd</p></td>
<td><p>1,9092%</p></td>
<td><p>lllllllllllll</p></td>
<td><p>0,8334%</p></td>
<td><p>uuuuuuuuu</p></td>
<td><p>0,1886%</p></td>
<td><p>llllllls</p></td>
<td><p>0,1374%</p></td>
</tr>
<tr><td><p>lllllllllll</p></td>
<td><p>1,8697%</p></td>
<td><p>llllld</p></td>
<td><p>0,8005%</p></td>
<td><p>uuuuudd</p></td>
<td><p>0,1815%</p></td>
<td><p>lllllllllld</p></td>
<td><p>0,1345%</p></td>
</tr>
<tr><td><p>lllldddd</p></td>
<td><p>1,6420%</p></td>
<td><p>llllddd</p></td>
<td><p>0,7759%</p></td>
<td><p>lllllllllddd</p></td>
<td><p>0,1808%</p></td>
<td><p>llllllllllldd</p></td>
<td><p>0,1344%</p></td>
</tr>
<tr><td><p>lllldd</p></td>
<td><p>1,5009%</p></td>
<td><p>ddddddddddd</p></td>
<td><p>0,7524%</p></td>
<td><p>llllllllldddd</p></td>
<td><p>0,1725%</p></td>
<td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
</tr>
</tbody>
</table>
</div><div class="ld-slide" id="die-zusammensetzung-von-passwortern-verstehen">
<h2>Die Zusammensetzung von Passw√∂rtern verstehen</h2>
<div class="small docutils container">
<p>Analyse des <em>rockyou</em> Leaks.</p>
<table class="tiny no-table-borders no-inner-borders incremental">
<thead>
<tr><th class="head"><p>‚àë Passworte</p></th>
<th class="head"><p>14.334.851</p></th>
<th class="head"><p>100%</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Pins</p></td>
<td><p>2.346.591</p></td>
<td><p>16,37%</p></td>
</tr>
<tr><td><p>Passworte mit Buchstaben</p></td>
<td><p>11.905.977</p></td>
<td><p>83,34%</p></td>
</tr>
</tbody>
</table>
<div class="incremental docutils container">
<p>Analyse der Passworte mit Buchstaben:</p>
<table class="tiny no-table-borders no-inner-borders incremental">
<thead>
<tr><th class="head"><p>Kategorie</p></th>
<th class="head"><p>Absolut</p></th>
<th class="head"><p>Prozentual</p></th>
<th class="head"><p>Beispiele</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr><td><p>E-Mails</p></td>
<td><p>26.749</p></td>
<td><p>0,22%</p></td>
<td><p>me&#64;me.com</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Zahlen gerahmt von Buchstaben</p></td>
<td><p>35696</p></td>
<td><p>0,30%</p></td>
<td><p>a123456a</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Leetspeak</p></td>
<td><p>64.672</p></td>
<td><p>0,54%</p></td>
<td><p>G3tm0n3y</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Patterns</p></td>
<td><p>124.347</p></td>
<td><p>1,04%</p></td>
<td><p>lalala</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Regul√§re oder Popul√§re W√∂rter</p></td>
<td><p>4.911.647</p></td>
<td><p><strong>41,25%</strong></p></td>
<td><p>princess</p></td>
<td><p>iloveu</p></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Sequenzen</p></td>
<td><p>5.290</p></td>
<td><p>0,04%</p></td>
<td><p>abcdefghij</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>keyboard walks (de/en)</p></td>
<td><p>14.662</p></td>
<td><p>0,12%</p></td>
<td><p>q2w3e4r</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Einfache Wortkombinationen</p></td>
<td><p>535.037</p></td>
<td><p>4,49%</p></td>
<td><p>pinkpink</p></td>
<td><p>sexy4u</p></td>
<td><p>te amo</p></td>
<td></td>
</tr>
<tr><td><p>Komplexe Wortkombinationen</p></td>
<td><p>5.983.259</p></td>
<td><p><strong>50,25%</strong></p></td>
<td><p>Inparadise</p></td>
<td><p>kelseylovesbarry</p></td>
<td></td>
<td></td>
</tr>
<tr><td><p><em>&lt;Rest&gt;</em></p></td>
<td><p>204.618</p></td>
<td><p>1,72%</p></td>
<td><p>j4**9c+p</p></td>
<td><p>i(L)you</p></td>
<td><p>p&#64;55w0rd</p></td>
<td><p>sk8er4life</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="supplemental">
<p class="rubric">Hinweise</p>
<p>Die Sprachen, die bei der Identifizierung der W√∂rter ber√ºcksichtigt wurden, waren: &quot;de, en, fr, es, pt, nl&quot;.</p>
<p><em>Popul√§re W√∂rter</em> sind W√∂rter, die auf Twitter oder Facebook verwendet wurden, z.‚ÄØB. &quot;iloveu&quot;, &quot;iluvu&quot;, ....</p>
</div></div><div class="ld-slide" id="der-effekt-von-passwortrichtlinien-auf-passworter">
<h2>Der Effekt von Passwortrichtlinien auf Passw√∂rter</h2>
<p>Reale Passwortrichtlinie:</p>
<blockquote>
<p>Nutze 1 Gro√übuchstabe, 1 Kleinbuchstabe, 2 Symbole, 2 Ziffern, 4 Buchstaben, 4 Nicht-Buchstaben</p>
</blockquote>
<div class="incremental docutils container">
<p>Exemplarisch beobachteter Effekt wenn die Passw√∂rter vorher einfacher waren und der Benutzer gezwungen wurde diese zu erweitern:</p>
<blockquote>
<p>Password11##</p>
<p>Password12!!</p>
</blockquote>
<p>d.‚ÄØh. die Passworte werden mit m√∂glichst geringem Aufwand erweitert.</p>
</div>
</div><div class="ld-slide" id="aufbau-von-passwortern-zusammenfassung">
<h2>Aufbau von Passw√∂rtern - Zusammenfassung</h2>
<ul class="more-space-between-list-items simple">
<li><p>Passw√∂rter, die h√§ufig eingegeben werden m√ºssen, basieren in den allermeisten F√§llen auf <span class="ger-quote">echten</span> W√∂rtern.</p></li>
<li><p>Echte W√∂rter werden oft nicht unver√§ndert verwendet, sondern nach einfachen Regeln umgewandelt, z.‚ÄØB. durch Anh√§ngen einer Zahl oder eines Sonderzeichens, Ver√§nderung der Gro√ü-/Kleinschreibung, etc.</p></li>
</ul>
<aside class="admonition incremental small">
<p class="admonition-title">Frage</p>
<p>Wie k√∂nnen wir gute Passwortkandidaten identifizieren/generieren, wenn ein <em>Leak</em> nicht ausreicht oder nur eine kleine Anzahl von Passw√∂rtern getestet werden kann?</p>
<div class="incremental docutils container">
<p>Zum Beispiel dauert das Testen aller Passw√∂rter von Rockyou...:</p>
<p>~13.000.000 Passworte / 5 Hashes/Sekunde ‚âà 1 Monat</p>
<p>~13.000.000 Passworte / 5 Hashes/Stunde ‚âà ~297 Jahre</p>
</div>
</aside>
</div><div class="ld-slide" id="herausforderungen-beim-testen-generieren-von-passwortern">
<h2>Herausforderungen beim Testen/Generieren von Passw√∂rtern</h2>
<p>Aufgrund der <span class="ger-quote">Unm√∂glichkeit</span> eines Brute-Force-Angriffs stellen sich folgende Herausforderungen:</p>
<ul class="incremental simple">
<li><p>Verf√ºgbare <em>Kontextinformationen sollten in die Auswahl/Generierung einflie√üen</em>.</p></li>
<li><p>Es sollten nur <em>technisch sinnvolle</em> Passw√∂rter getestet/generiert werden.</p></li>
<li><p>Es sollten <em>keine Duplikate</em> getestet werden.</p></li>
<li><p>Auswahl/Generierung von <em>Passw√∂rten in absteigender Wahrscheinlichkeit</em>.</p></li>
<li><p><span class="minor">Die Auswahl/Generierung sollte effizient sein.</span></p></li>
</ul>
<div class="supplemental docutils container">
<p>Technisch sinnvolle Passw√∂rter sind solche, die die zu Grunde liegenden Passwortrichtlinien und auch weiteren technischen Anforderungen erf√ºllen. Zum Beispiel den von der Software verwendeten Zeichensatz (UTF-8, ASCII, ...) oder im Falle eines Smartphones/Krytosticks die eingebbaren Zeichen.</p>
<p>Sollte der Algorithmus zum Generieren der Passw√∂rter langsamer sein als die Zeit, die ben√∂tigt wird, um ein Passwort zu falsifizieren, dann beschr√§nkt nicht mehr l√§nger nur die Hashrate den Suchraum.</p>
</div>
</div><div class="ld-slide" id="ansatze-und-werkzeuge-zum-generieren-von-passwortlisten">
<h2>Ans√§tze und Werkzeuge zum Generieren von Passwortlisten</h2>
<ul class="simple">
<li><dl class="simple">
<dt>Grundlegende Werkzeuge zum <span class="ger-quote">vermischen von W√∂rtern</span> (<span class="eng">word mangling</span>)</dt>
<dd><ul>
<li><p>Prince</p></li>
<li><p>Markov-Modelle (OMEN)</p></li>
<li><p>Hashcat</p></li>
<li><p>...</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="incremental docutils container">
<p>Um vorhandene Kontextinformationen zu erweitern, k√∂nnen ggf. (frei) verf√ºgbare Wordembeddings verwendet werden.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://relatedwords.org/relatedto/Ferrari">RelatedWords.org</a> setzt (unter anderem) auf ConceptNet und WordEmbeddings.</p></li>
<li><p><a class="reference external" href="https://reversedictionary.org/wordsfor/Manhattan">Reversedictionary.org</a> setzt auf WordNet und liefert erg√§nzende Ergebnisse.</p></li>
</ul>
</div>
</div><div class="ld-slide" id="markov-ketten">
<h2>Markov-Ketten</h2>
<aside class="admonition note smaller incremental">
<p class="admonition-title">Hintergrund</p>
<p>Eine Markov-Kette beschreibt eine Sequenz m√∂glicher Ereignisse in welcher die Wahrscheinlichkeit des n√§chsten Ereignisses nur vom Zustand des vorherigen Ereignis abh√§ngt.</p>
</aside>
<p>OMEN lernt - zum Beispiel basierend auf Leaks - die Wahrscheinlichkeiten f√ºr das Aufeinanderfolgen von Bigrammen und Trigrammen und nutzt diese, um neue Passwortkandidaten zu generieren.</p>
<aside class="admonition smaller incremental">
<p class="admonition-title">Grundlegende Idee</p>
<p>Gegeben: <span class="docutils literal">lachen, sachen, last, muster</span></p>
<p>Bigramme: <span class="docutils literal">2*la, 2*ch, 2*en, sa, 2*st, mu, er</span></p>
<p>Auf ein <span class="docutils literal">st</span> folgt entweder ein <span class="docutils literal">er</span> oder <span class="docutils literal">&lt;Wortende&gt;</span>; demzufolge ist <span class="docutils literal">laster</span> ein Kandidat, aber auch <span class="docutils literal">must</span>.</p>
</aside>
</div><div class="ld-slide" id="password-cracking-using-probabilistic-context-free-grammars-pcfg">
<h2>Password Cracking Using Probabilistic Context-Free Grammars <a class="citation-reference" href="#pcfg-1" id="citation-reference-1" role="doc-biblioref">[PCFG]</a></h2>
<ul class="incremental smaller">
<li><p>Lernt die Muster, Worte, Ziffern und verwendeten Sonderzeichen basierend auf der Auswertung von realen Leaks. Die gelernte Grammatik wird als Schablone verwendet und aus <span class="ger-quote">W√∂rterb√ºchern</span> bef√ºllt. (Zum Beispiel: <span class="docutils literal">S ‚Üí D1L3S2 ‚Üí 1L3!! ‚Üí 1luv!!</span> )</p></li>
<li><p>Generiert Passwortkandidaten mit absteigender Wahrscheinlichkeit.</p></li>
<li><dl>
<dt>Proze√ü:</dt>
<dd><ol class="arabic">
<li><p>Vorverarbeitung, um die Basisstrukturen und deren Wahrscheinlichkeiten zu identifizieren (z.‚ÄØB. zwei Ziffern gefolgt von einem Sonderzeichen und 8 Buchstaben.)</p></li>
<li><p>Passwortkandidatengenerierung unter Beachtung der Wahrscheinlichkeiten der Basisstrukturen und der Wahrscheinlichkeiten der Worte, Ziffern und Sonderzeichen.</p>
<p><span class="minor">(In der Originalversion wurden die Wahrscheinlichkeiten von Worten nicht beachtet; die auf GitHub verf√ºgbare Version enth√§lt jedoch zahlreiche Verbesserungen.)`</span></p>
</li>
</ol>
</dd>
</dl>
</li>
</ul>
</div><div class="ld-slide" id="pcfg-analyse-beispiel">
<h2>PCFG - Analyse - Beispiel</h2>
<div class="small docutils container">
<p>Im ersten Schritt werden die Produktionswahrscheinlichkeiten von Basisstrukturen, Ziffernfolgen, Sonderzeichenfolgen und Alpha-Zeichenfolgen ermittelt. (Z. Bsp.:
<span class="docutils literal">!cat123</span> <span class="math">\(\Rightarrow\)</span> S<sub>
1</sub>L<sub>
3</sub>D<sub>
3</sub>)</p>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Basis Struktur</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>L3S1D3</p></td>
<td><p>12788</p></td>
<td><p>0.75</p></td>
</tr>
<tr><td><p>S1L3D3</p></td>
<td><p>2789</p></td>
<td><p>0.35</p></td>
</tr>
</tbody>
</table>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>S1</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>!</p></td>
<td><p>12788</p></td>
<td><p>0.50</p></td>
</tr>
<tr><td><p>.</p></td>
<td><p>2789</p></td>
<td><p>0.30</p></td>
</tr>
<tr><td><p>&#64;</p></td>
<td><p>1708</p></td>
<td><p>0.20</p></td>
</tr>
</tbody>
</table>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>L3</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>cat</p></td>
<td><p>12298</p></td>
<td><p>0.85</p></td>
</tr>
<tr><td><p>dog</p></td>
<td><p>2890</p></td>
<td><p>0.15</p></td>
</tr>
</tbody>
</table>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>D3</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>123</p></td>
<td><p>10788</p></td>
<td><p>0.60</p></td>
</tr>
<tr><td><p>321</p></td>
<td><p>5789</p></td>
<td><p>0.35</p></td>
</tr>
<tr><td><p>654</p></td>
<td><p>4708</p></td>
<td><p>0.25</p></td>
</tr>
</tbody>
</table>
</div>
</div><div class="ld-slide" id="pcfg-generierung-beispiel">
<h2>PCFG - Generierung - Beispiel</h2>
<div class="small docutils container">
<p><strong>Ergebnis der Analyse</strong>:</p>
<aside class="admonition note small">
<p class="admonition-title">Hinweis</p>
<p>Nicht-Terminale = <span class="docutils literal">[S,T]</span></p>
<p>Terminale = <span class="docutils literal">[a, b, c, d, e, ‚Ä¶, z, 0, ‚Ä¶, 9]</span></p>
</aside>
<table class="small highlight-line-on-hover">
<thead>
<tr><th class="head"><p>Nich-Terminale</p></th>
<th class="head"><p>Produktion</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>S</p></td>
<td><p><span class="docutils literal">password</span>T</p></td>
<td><p>0.7</p></td>
</tr>
<tr><td><p>S</p></td>
<td><p><span class="docutils literal">secure</span>T</p></td>
<td><p>0.3</p></td>
</tr>
<tr><td><p>T</p></td>
<td><p><span class="docutils literal">123</span></p></td>
<td><p>0.6</p></td>
</tr>
<tr><td><p>T</p></td>
<td><p><span class="docutils literal">111</span></p></td>
<td><p>0.4</p></td>
</tr>
</tbody>
</table>
<div class="incremental docutils container">
<p><strong>Ableitung</strong>:</p>
<ol class="arabic simple">
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password123</span></p></li>
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password111</span></p></li>
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure123</span></p></li>
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure111</span></p></li>
</ol>
</div>
</div>
</div><div class="ld-slide" id="pcfg">
<h2>PCFG+</h2>
<dl class="field-list simple">
<dt>Next Gen PCFG Password Cracking <a class="citation-reference" href="#ngpcfg" id="citation-reference-2" role="doc-biblioref">[NGPCFG]</a><span class="colon">:</span></dt>
<dd><p>Unterst√ºtzt Tastaturwanderungen (zum Beispiel <span class="docutils literal">asdf</span> oder <span class="docutils literal">qwerty12345</span>) und Passworte bestehend aus mehrerern Worten und wiederholten Worten (zum Beispiel <span class="docutils literal">qpqpqpq</span>).</p>
</dd>
</dl>
<dl class="incremental margin-top-1em line-above padding-top-1em field-list simple">
<dt>On Practical Aspects of PCFG Password Cracking <a class="citation-reference" href="#paofpcfg" id="citation-reference-3" role="doc-biblioref">[PAofPCFG]</a><span class="colon">:</span></dt>
<dd><p>Im Wesentlichen Performanceoptimierungen, um PCFG schneller zu machen.</p>
</dd>
</dl>
<dl class="incremental margin-top-1em line-above padding-top-1em field-list simple">
<dt>Using personal information in targeted grammar-based probabilistic password attacks <a class="citation-reference" href="#piandpcfg" id="citation-reference-4" role="doc-biblioref">[PIandPCFG]</a><span class="colon">:</span></dt>
<dd><p>Im Wesentlichen werden zwei PCFGs gewichtet zusammengef√ºhrt (0 &lt; alpha &lt; 1).</p>
</dd>
</dl>
</div><div class="ld-slide" id="sepass-semantic-password-guessing-using-k-nn-similarity-search-in-word-embeddings-sepass">
<h2>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings <a class="citation-reference" href="#sepass" id="citation-reference-5" role="doc-biblioref">[SePass]</a></h2>
<p>Zus√§tzliche Wortkandidaten werden mithilfe von <em>Worteinbettungen</em> identifiziert. Erm√∂glicht es verwandte W√∂rter automatisch zu finden.</p>
<p><strong>Example</strong></p>
<div class="two-columns smaller docutils container">
<div class="column padding-right-1em docutils container">
<p>Gegeben:</p>
<blockquote>
<p><span class="shiny-green">Ferrari</span>01</p>
<p>!<span class="shiny-green">Audi</span>!</p>
<p><span class="shiny-green">Mercedes</span>88</p>
<p><span class="shiny-green">Bugatti</span> 666</p>
</blockquote>
</div>
<div class="column margin-left-1em docutils container">
<p><span class="ger-quote">Offensichtliche</span> Kandidaten f√ºr Basisw√∂rter:</p>
<blockquote>
<div class="incremental docutils container">
<p>Porsche</p>
<p>Mclaren</p>
<p>Lamborghini</p>
<p>Aston Martin</p>
</div>
</blockquote>
</div>
</div>
</div><div class="ld-slide" id="sepass-semantic-password-guessing-using-k-nn-similarity-search-in-word-embeddings">
<h2>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings</h2>
<p>Vermeidet menschliche Voreingenommenheit.</p>
<p><strong>Example</strong></p>
<div class="two-columns smaller docutils container">
<div class="column padding-right-1em docutils container">
<p>Gegeben:</p>
<blockquote>
<p><span class="shiny-green">Luke</span>2017</p>
<p><span class="shiny-green">John</span>1976</p>
<p>01<span class="shiny-green">Mark</span>!</p>
</blockquote>
</div>
<div class="column margin-left-1em docutils container">
<p><span class="ger-quote">Offensichtliche</span> Kandidaten f√ºr Basisw√∂rter:</p>
<blockquote>
<div class="incremental docutils container">
<p>Matthew</p>
<p>Bible</p>
<p>Gospel</p>
</div>
</blockquote>
</div>
</div>
</div><div class="ld-slide" id="sepass-semantic-password-guessing-using-k-nn-similarity-search-in-word-embeddings-1">
<h2>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings</h2>
<p>Vermeidet menschliche Voreingenommenheit.</p>
<p><strong>Example</strong></p>
<div class="two-columns smaller docutils container">
<div class="column padding-right-1em docutils container">
<p>Gegeben:</p>
<blockquote>
<p><span class="shiny-green">Luke</span>2017</p>
<p><span class="shiny-green">John</span>1976</p>
<p>01<span class="shiny-green">Mark</span>!</p>
</blockquote>
</div>
<div class="column margin-left-1em docutils container">
<p><span class="ger-quote">Offensichtliche</span> Kandidaten f√ºr Basisw√∂rter:</p>
<blockquote>
<div class="incremental docutils container">
<p>Leia</p>
<p>Darth Vader</p>
<p>Palpatine</p>
</div>
</blockquote>
</div>
</div>
</div><div class="ld-slide" id="bewertung-von-passworten">
<h2>Bewertung von Passworten</h2>
<div class="tiny docutils container">
<dl class="field-list simple">
<dt>Donaudampfschifffahrt<span class="colon">:</span></dt>
<dd><p>Ist weder in Rockyou noch im Duden und auch nicht in den Corpora von Twitter und Facebook von 2022 zu finden.</p>
</dd>
<dt>Passwort<span class="colon">:</span></dt>
<dd><p>Nr. 93968 in Rockyou.</p>
</dd>
<dt>password123<span class="colon">:</span></dt>
<dd><p>Nr. 1348 in Rockyou.</p>
</dd>
<dt>2wsx3edc4rfv<span class="colon">:</span></dt>
<dd><p>So nicht in Rockyou, aber 1qaz2wsx3edc4rfv ist Nr. 143611 in Rockyou.</p>
</dd>
<dt>Haus Maus<span class="colon">:</span></dt>
<dd><p>In Rockyou ist lediglich hausmaus zu finden.</p>
</dd>
<dt>iluvu<span class="colon">:</span></dt>
<dd><p>Nr. 1472 in Rockyou.</p>
</dd>
<dt>Emily060218<span class="colon">:</span></dt>
<dd><p>Emily ist Nr. 35567 in Rockyou. Die Zahl ist ganz offensichtlich ein Datum: 6. Feb. 2018 und k√∂nnte ein Geburtsdatum, Hochzeitsdatum, oder ein f√ºr die Person vergleichbar bedeutends Datum sein.</p>
</dd>
<dt>MuenchenHamburg2023!!!!<span class="colon">:</span></dt>
<dd><p>Das Passwort ist zwar sehr lang aber es handelt sich vermutlich um zwei - f√ºr die entsprechende Person - bedeutende Orte. Die Zahl und die Sonderzeichen sind vermutlich auf eine Passwortrichtlinie zur√ºckzuf√ºhren.</p>
</dd>
<dt>hjA223dn4fw&quot;√º√§K√ü√ü k`‚â§-~ajsdk<span class="colon">:</span></dt>
<dd><p>28 Stellen basierend auf einem Zeichensatz, der vermutlich ca. 192 Zeichen pro Stelle umfasst.</p>
</dd>
<dt>Baum Lampe Haus Steak Eis Berg<span class="colon">:</span></dt>
<dd><p>Es handelt sich um ein Passwort mit 30 Stellen, dass vermutlich mit Hilfe von Diceware generiert wurde und 6 Worte umfasst.</p>
</dd>
<dt>ME01703138541<span class="colon">:</span></dt>
<dd><p>Namensk√ºrzel und Telefonnummer.</p>
</dd>
</dl>
</div>
<div class="supplemental docutils container">
<div class="foundations the-blue-background docutils container">
<p><strong>Diceware</strong></p>
<p>Auch wenn dem Angreifer
(a) bekannt ist, dass das Passwort mit Hilfe von Diceware generiert wurde,
(b) die zugrundeliegende Wortliste vorliegt und
(c) auch die L√§nge (hier 6 Worte) bekannt sein sollte, dann umfasst der Suchraum: <span class="math">\((6^5)^6 \approx 2,21\times 10^{23}\)</span> Passwortkandidaten. Sollte man also mit einer Geschwindigkeit von 1 Billion Hashes pro Sekunde angreifen k√∂nnen, dann brauch man noch immer √ºber 7000  Jahre f√ºr das Absuchen des vollst√§ndigen Suchraums.</p>
<p>Beim klassischen Dicewareansatz umfasst das W√∂rterbuch <span class="math">\(6^5\)</span> Worte, da man mit einem normalen W√ºrfel f√ºnfmal W√ºrfelt und dann das entsprechende Wort nachschl√§gt. W√ºrde man zum Beispiel die folgenden Zahlen w√ºrfeln: 1,4,2,5,2. Dann w√ºrde man das Wort zur Zahl: 14252 nachschlagen.</p>
</div>
<div class="foundations the-blue-background docutils container">
<p><strong>Zeichensatz</strong></p>
<p>Auf einer deutschen Standardtastatur f√ºr Macs k√∂nnen in Kombination mit <span class="ger-quote">Shift</span>, <span class="ger-quote">Alt</span> und <span class="ger-quote">Alt+Shift</span> zum Beispiel 192 verschiedene Zeichen eingegeben werden ‚Äì ohne auf Unicode oder Zeichentabellen zur√ºckgreifen zu m√ºssen.</p>
</div>
</div>
</div><div class="ld-slide" id="worterbuchgenerierung-evaluation-von-werkzeugen">
<h2>W√∂rterbuchgenerierung - Evaluation von Werkzeugen</h2>
<img alt="Evaluation verschiedener Ans√§tze f√ºr die Passwortevaluation" class="align-center" src="passwortwiederherstellung-evaluation.png" style="width: 1200px;" />
</div><div class="new-section transition-scale ld-slide" id="werkzeuge-und-methoden-zur-wiederherstellung-von-passwortern">
<h2>Werkzeuge und Methoden zur Wiederherstellung von Passw√∂rtern</h2>
</div><div class="new-subsection ld-slide" id="grundlegende-werkzeuge">
<h2>Grundlegende Werkzeuge</h2>
<ul class="simple">
<li><p><a class="reference external" href="../lab-shell/folien.rst.html">Linux Shell</a></p></li>
<li><p><a class="reference external" href="../lab-regexp/folien.rst.html">Regul√§re Ausdr√ºcke</a></p></li>
</ul>
</div><div class="new-subsection transition-fade ld-slide" id="extraktion-von-hashes">
<h2>Extraktion von Hashes</h2>
<div class="supplemental docutils container">
<p><strong>Hinweis</strong></p>
<p>Im Folgenden diskutieren wir nur exemplarisch die Extraktion einiger Hashes, um das grundlegende Vorgehen zu besprechen. Im Allgemeinen gibt es f√ºr weit(er) verbreitete Software h√§ufig bereits L√∂sungen zur Hashextraktion. Falls nicht, dann muss man Googeln und/oder Reverse Engineering betreiben.</p>
</div>
</div><div class="ld-slide" id="quellen-fur-werkzeuge-anleitungen">
<h2>Quellen f√ºr Werkzeuge &amp; Anleitungen</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hashcat/hashcat/tree/master/tools">Hashcat Tools</a></p></li>
<li><p><a class="reference external" href="https://github.com/openwall/john">John (the Ripper)</a></p></li>
<li><p>Googeln</p></li>
</ul>
</div><div class="ld-slide" id="relevante-linux-kommandozeilenwerkzeuge">
<h2>Relevante Linux Kommandozeilenwerkzeuge</h2>
<ul class="incremental">
<li><p><span class="docutils literal">file</span> dient der Ermittlung des Typs einer Datei.</p></li>
<li><p><span class="docutils literal">binwalk</span> durchsucht Bin√§rdateien in Hinblick auf das Vorkommen bekannter Muster (insbsondere Dateiheader, aber auch Kryptokonstanten etc.)</p>
<p><span class="docutils literal"><span class="pre">-E</span></span> kann zur Visualisierung der Entropie verwendet werden.</p>
</li>
<li><p><span class="docutils literal">dd</span> kopiert Daten blockweise von einem Startpunkt in einer Datei in eine andere Datei. Wird ggf. zum Extrahieren von Hashes ben√∂tigt.</p></li>
<li><p><span class="docutils literal">xxd</span> und <span class="docutils literal">hexdump</span> erstellen beide einen Hexdump einer Datei.</p></li>
</ul>
</div><div class="ld-slide" id="verschlusselte-pdf-dateien">
<h2>Verschl√ºsselte PDF Dateien</h2>
<p>Extraktion erfolgt (zum Beispiel) mit den John Tools:</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>pdf2john<span class="whitespace"> </span>Document.pdf<span class="whitespace"> </span>&gt;<span class="whitespace"> </span>Document.pdf.john<span class="whitespace">
</span>$<span class="whitespace"> </span>cat<span class="whitespace"> </span>Document.pdf.john<span class="whitespace">
</span>Document.pdf:<span class="name variable">$pdf$4</span>*4*128*-3392*1*16*861da8b9c1672ddc3953dee025<span class="whitespace">
</span>5d622d*32*301d0810078c5698ab17b286e2123070000000000000000000000<span class="whitespace">
</span><span class="literal number">00000000000</span>*32*c038ddb8fbdaeb67b6e80e2d936108fc851ff40c5b652c71<span class="whitespace">
</span>97bda4f797939532</code></pre>
<p>Danach kann der Hash entweder direkt mit John angegriffen werden, oder nach dem Entfernen des Headers mit Hashcat.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>pdf2john<span class="whitespace"> </span>Document.pdf<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;s/^[^:]+://&quot;</span><span class="whitespace">        </span><span class="comment single"># Dateiname entfernen
</span><span class="whitespace">  </span>&gt;<span class="whitespace"> </span>Document.pdf.hashcat</code></pre>
</div><div class="ld-slide" id="libreoffice-dateien">
<h2>Libreoffice Dateien</h2>
<p>Extraktion des Basishashes erfolgt auch hier (zum Beispiel) mit den John Tools. Danach muss sowohl der Prefix als auch der Suffix, der f√ºr die Entschl√ºsselung nicht relevant ist, abgeschnitten werden, wenn im Folgenden Hashcat verwendet werden soll.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>libreoffice2john<span class="whitespace"> </span>Document.odt<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span>-e<span class="whitespace"> </span><span class="literal string single">'s/[^:]+://'</span><span class="whitespace"> </span>-e<span class="whitespace"> </span><span class="literal string single">'s/:::::[^:]+$//'</span><span class="whitespace">
  </span>&gt;<span class="whitespace"> </span>Document.odt.hashcat</code></pre>
<div class="incremental docutils container">
<p>Um zu verstehen, wie der Hash genau auszusehen hat, ist es im Allgemeinen hilfreich sich die erwartete Struktur f√ºr einen Hash anzusehen: <a class="reference external" href="https://hashcat.net/wiki/doku.php?id=example_hashes">Hashcat - Example Hashes</a></p>
</div>
</div><div class="ld-slide" id="verschlusselte-mac-disk-images-dmg">
<h2>Verschl√ºsselte Mac Disk Images (.dmg)</h2>
<p>In diesem Fall hat nur John (the Ripper) Unterst√ºtzung f√ºr den konkreten Hash.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>dmg2john<span class="whitespace"> </span>Container.dmg<span class="whitespace"> </span>&gt;<span class="whitespace"> </span>Container.dmg.john<span class="whitespace">   </span><span class="comment single"># Extraktion</span></code></pre>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span>john<span class="whitespace"> </span>Container.dmg.john<span class="whitespace"> </span><span class="literal string escape">\ </span><span class="whitespace">                    </span><span class="comment single"># Angriff
</span><span class="whitespace">  </span>--wordlist<span class="operator">=</span>/usr/share/wordlists/rockyou.txt</code></pre>
</div><div class="ld-slide" id="verschlusselter-usb-stick-apfs-volume">
<h2>Verschl√ºsselter USB Stick (APFS Volume)</h2>
<p>Es liegt ein normaler USB Stick vor auf dem eine Partition vom Typ <span class="docutils literal">Apple APFS</span> ist.</p>
<pre class="smaller literal-block">Disk /dev/sda: 14.45 GiB, 15518924800 bytes, 30310400 sectors
Disk model: Flash Disk
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: 1D63D8AE-7CBC-47BE-9093-8469B0786EAF

Device      Start      End  Sectors  Size Type
/dev/sda1      40   409639   409600  200M EFI System
/dev/sda2  409640 30310359 29900720 14.3G Apple APFS</pre>
</div><div class="ld-slide" id="verschlusselter-usb-stick-apfs-volume-1">
<h2>Verschl√ºsselter USB Stick (APFS Volume)</h2>
<ol class="arabic">
<li><p>Installation von <a class="reference external" href="https://github.com/Banaanhangwagen/apfs2hashcat">apfs2hashcat</a> (umfasst das Kompilieren der Sourcen)</p></li>
<li><p>Hash extrahieren durch <span class="ger-quote">Copy-and-Paste</span> aus dem Logfile/der Konsole.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>sudo<span class="whitespace"> </span>./apfs-dump-quick<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span>/dev/sda2<span class="whitespace"> </span><span class="literal string escape">\ </span><span class="whitespace">  </span><span class="comment single"># /dev/sda2 ist die Ziel APFS Partition
</span><span class="whitespace">  </span>/tmp/log.txt</code></pre>
</li>
<li><p>Hash angreifen</p>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">18300</span><span class="whitespace"> </span>fv2.hashcat<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span>/usr/share/wordlists/rockyou.txt</code></pre>
</li>
</ol>
</div><div class="new-subsection transition-fade ld-slide" id="passwortwiederherstellung-mit-hashcat">
<h2>Passwortwiederherstellung mit Hashcat</h2>
</div><div class="ld-slide" id="hashcat-einfuhrung">
<h2>Hashcat - Einf√ºhrung</h2>
<p>Hashcat ist ‚Äì Stand 2024 ‚Äì das Tool zum Wiederherstellen von Passw√∂rtern.</p>
<p>Liest ein(e Liste von) Hash(es) ein und pr√ºft, ob einer der angegebenen Passwortkandidaten nach dem Hashen mit einem gegeben Hash √ºbereinstimmt.</p>
<ul class="incremental simple">
<li><p>unterst√ºtzt √ºber 350 Hash-Typen (mit einigen automatischen Erkennungen)</p></li>
<li><dl class="simple">
<dt>unterst√ºtzt mehrere Angriffsmodi, z.‚ÄØB.,</dt>
<dd><ul>
<li><p>W√∂rterbuch (ggf. mit Regeln)</p></li>
<li><p>Masken</p></li>
<li><p>Kombinationen aus W√∂rterb√ºchern und Masken</p></li>
<li><p>&lt;Lesen von Passwortkandidaten aus stdin&gt;</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Open-Source</p></li>
<li><p>Kann zum Generieren von neuen Kandidaten verwendet werden.</p></li>
<li><p>ist CUDA/OpenCL basiert und <strong>auf entsprechenden Grafikkarten extrem schnell</strong>.</p></li>
</ul>
</div><div class="ld-slide" id="hashcat-relevante-parameter">
<h2>Hashcat - relevante Parameter</h2>
<div class="two-columns smaller docutils container">
<div class="column padding-right-1em docutils container">
<p>Angriffsmodi:</p>
<pre class="code bash literal-block"><code>-a0<span class="whitespace"> </span>Angriff<span class="whitespace"> </span>mit<span class="whitespace"> </span>W√∂rterbuch<span class="whitespace">
    </span><span class="operator">(</span>ggf.<span class="whitespace"> </span>mit<span class="whitespace"> </span>Regeln<span class="whitespace"> </span>-r<span class="operator">)</span><span class="whitespace">

</span>-a1<span class="whitespace"> </span>Kombinationsangriff<span class="whitespace">
    </span>Angriff<span class="whitespace"> </span>mit<span class="whitespace"> </span>dem<span class="whitespace"> </span>Kreuzprodukt<span class="whitespace">
    </span>zweier<span class="whitespace"> </span>W√∂rterb√ºcher.<span class="whitespace">

</span>-a3<span class="whitespace"> </span>Brute-force<span class="whitespace"> </span>Angriff<span class="whitespace">

</span>-a6<span class="whitespace"> </span>Hybridangriff<span class="whitespace">
    </span>W√∂rterbuch<span class="whitespace"> </span>und<span class="whitespace"> </span>Maske</code></pre>
</div>
<div class="column margin-left-1em docutils container">
<p>Brute-force - Eingebaute Zeichens√§tze:</p>
<p class="monospaced">?l = abcdefghijklmnopqrstuvxyz</p>
<p class="monospaced">?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ</p>
<p class="monospaced">?d = 0123456789</p>
<p class="monospaced">?s = !&quot;$%&amp;'()*+,-./:;&lt;=&gt;?&#64;[]^_{|}~</p>
<p class="monospaced">?a = ?l?u?d?s</p>
<p>Definition von bis zu 4 eigenen Zeichens√§tzen ist m√∂glich.</p>
</div>
</div>
</div><div class="ld-slide" id="hashcat-ausgewahlte-regeln-teilweise-john-kompatibel">
<h2><a class="reference external" href="https://hashcat.net/wiki/doku.php?id=rule_based_attack">Hashcat - Ausgew√§hlte Regeln</a> (Teilweise John kompatibel)</h2>
<table class="small incremental">
<thead>
<tr><th class="head"><p>Name</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Input</p></th>
<th class="head"><p>Output</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Nothing</p></td>
<td><p>:</p></td>
<td><p>Do nothing (passthrough)</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
</tr>
<tr><td><p>Lowercase</p></td>
<td><p>l</p></td>
<td><p>Lowercase all letters</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssw0rd</span></p></td>
</tr>
<tr><td><p>Uppercase</p></td>
<td><p>u</p></td>
<td><p>Uppercase all letters</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">P&#64;SSW0RD</span></p></td>
</tr>
<tr><td><p>Capitalize</p></td>
<td><p>c</p></td>
<td><p>Capitalize the first letter and lower the rest</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">P&#64;ssw0rd</span></p></td>
</tr>
<tr><td><p>Toggle Case</p></td>
<td><p>t</p></td>
<td><p>Toggle the case of all characters in word.</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">P&#64;SSw0RD</span></p></td>
</tr>
<tr><td><p>Reverse</p></td>
<td><p>r</p></td>
<td><p>Reverse the entire word</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">dr0Wss&#64;p</span></p></td>
</tr>
<tr><td><p>Duplicate</p></td>
<td><p>d</p></td>
<td><p>Duplicate entire word</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssW0rdp&#64;ssW0rd</span></p></td>
</tr>
<tr><td><p>Append</p></td>
<td><p>$X</p></td>
<td><p>Append X to the end</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssW0rdX</span></p></td>
</tr>
<tr><td><p>Prepend</p></td>
<td><p>^X</p></td>
<td><p>Prepend X at the beginning</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">Xp&#64;ssW0rd</span></p></td>
</tr>
<tr><td><p>...</p></td>
<td><p>...</p></td>
<td><p>...</p></td>
<td><p>...</p></td>
<td><p>...</p></td>
</tr>
</tbody>
</table>
</div><div class="small ld-slide" id="szenario-1-eine-pin-angreifen">
<h2>Szenario 1: eine Pin Angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Gegeben sein ein mit SHA256 gehashter 5-stelliger Pin in der Datei: <span class="docutils literal">5_digits_pin.sha256</span>.</p>
<p>Hashwert:</p>
<div class="monospaced docutils container">
<p><span class="docutils literal">79737ac46dad121166483e084a0727e5d6769fb47fa9b0b627eba4107e696078</span></p>
</div>
<p><strong>Angriff mit Maske</strong></p>
<pre class="code bash incremental literal-block"><code>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>5_digits_pin.sha256<span class="whitespace"> </span>-a3<span class="whitespace"> </span><span class="literal string double">&quot;?d?d?d?d?d&quot;</span></code></pre>
<div class="incremental docutils container">
<dl class="field-list simple">
<dt>-m 1400<span class="colon">:</span></dt>
<dd><p>Modus f√ºr einen einfachen SHA256 Hash.</p>
</dd>
<dt>-a3<span class="colon">:</span></dt>
<dd><p>bezeichnet einen Maskenangriffe</p>
</dd>
<dt>&quot;?d?d?d?d?d&quot;<span class="colon">:</span></dt>
<dd><p>Beschreibt die Maske. Hier 5 Ziffern (<span class="eng">digits</span>).</p>
</dd>
</dl>
</div>
</div><div class="small ld-slide" id="szenario-2-ein-hoffentlich-einfaches-loginpasswort-angreifen">
<h2>Szenario 2: Ein (hoffentlich) einfaches Loginpasswort angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Ein mit SHA512crypt gehashtes Passwort in der Datei: <span class="docutils literal">password.sha512crypt</span>.</p>
<p><strong>Angriff mit W√∂rterbuch</strong></p>
<pre class="code bash literal-block"><code>hashcat<span class="whitespace"> </span>password.sha512crypt<span class="whitespace"> </span>-a0<span class="whitespace"> </span>/usr/share/wordlists/rockyou.txt</code></pre>
<div class="incremental docutils container">
<dl class="field-list simple">
<dt>-a0<span class="colon">:</span></dt>
<dd><p>bezeichnet einen W√∂rterbuchangriff.</p>
</dd>
<dt>/usr/share/wordlists/rockyou.txt<span class="colon">:</span></dt>
<dd><p>Das zum Angriff verwendete W√∂rterbuch; der Pfad ist der Standardpfad zum Rockyou W√∂rterbuch in Kali Linux.</p>
</dd>
</dl>
</div>
</div><div class="small ld-slide" id="szenario-3-ein-komplexeres-passwort-angreifen">
<h2>Szenario 3: ein komplexeres Passwort angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Ein mit MD5 gehashtes Passwort in der Datei: <span class="docutils literal">password.md5</span>. Ein erster Angriff mit Rockyou war nicht erfolgreich.</p>
<p><strong>Angriff mit W√∂rterbuch und Regelsatz</strong></p>
<pre class="code bash incremental literal-block"><code>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">0</span><span class="whitespace"> </span>password.md5<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">            </span>-a0<span class="whitespace"> </span>/usr/share/wordlists/rockyou.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">            </span>-r<span class="whitespace"> </span>/usr/share/hashcat/rules/best64.rule</code></pre>
<div class="incremental docutils container">
<dl class="field-list">
<dt>-a0<span class="colon">:</span></dt>
<dd><p>bezeichnet einen W√∂rterbuchangriff.</p>
</dd>
<dt>/usr/share/wordlists/rockyou.txt<span class="colon">:</span></dt>
<dd><p>Das zum Angriff verwendete W√∂rterbuch.</p>
</dd>
<dt>-r /usr/share/hashcat/rules/best64.rule<span class="colon">:</span></dt>
<dd><p>Der zum Beugen der Passwortkandidaten verwendete Regelsatz.</p>
<p>Der Regelsatz best64 hat sich in einem Wettbewerb als <span class="ger-quote">bester</span> Regelsatz erwiesen.</p>
</dd>
</dl>
</div>
</div><div class="small ld-slide" id="szenario-4-ein-passwort-mit-salt-angreifen">
<h2>Szenario 4: ein Passwort mit Salt angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Ein MD5 Hash ist gegeben: <span class="docutils literal">c84b5c34c9ff7d3431018d795b5975e5</span>. Weiterhin ist bekannt, dass der verwendete <em>Salt</em> <span class="docutils literal">SALT</span> ist.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic incremental">
<li><p>Modus f√ºr MD5+Salt heraussuchen (<span class="docutils literal"><span class="pre">-m10</span></span>); ggf. Beispielhash ansehen, um zu verstehen, wie der Hash aufgebaut ist.</p></li>
<li><p>Erzeugen des Hashes f√ºr Hashcat:</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string double">&quot;c84b5c34c9ff7d3431018d795b5975e5:SALT&quot;</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>salted.m5.hash</code></pre>
</li>
<li><p>Mit Hashcat angreifen:</p>
<pre class="code bash literal-block"><code>hashcat<span class="whitespace"> </span>-m10<span class="whitespace"> </span>salted.md5.hash<span class="whitespace">  </span>-a3<span class="whitespace"> </span><span class="literal string single">'?a?a?a?a'</span></code></pre>
</li>
</ol>
<div class="supplemental">
<p><strong>L√∂sung</strong></p>
<p>Das Passwort ist <span class="docutils literal">Test</span>. In diesem Fall w√§re es auch m√∂glich gewesen direkt zu Pr√ºfen ob das Passwort <span class="docutils literal">Test</span> ist, indem man Hashcat im Modus -m0 (f√ºr reinen MD5) startet und als Kandidaten <span class="docutils literal">TestSALT</span> vorgibt.</p>
</div></div><div class="small ld-slide" id="szenario-5-kombination-von-worterbuch-mit-eigenem-regelsatz">
<h2>Szenario 5: Kombination von W√∂rterbuch mit eigenem Regelsatz</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Wir greifen einen sogennanten langsamen Hash an und k√∂nnen deswegen nur wenige Passworte gezielt testen.</p>
<p>Aufgrund von Social Engineering/Ermittlungen wissen wir, dass die Person h√§ufig kurze Worte (max 4 Buchstaben nimmt) diese aber oft verdoppelt und h√§ufig die Worte mit einem Gro√übuchstaben anfangen l√§sst.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic simple incremental">
<li><p>Erstellen eines fokussierten W√∂rterbuchs: <span class="docutils literal">candidates.txt</span>.</p></li>
<li><p>Erstellen des Regelsatzes: <span class="docutils literal">case.rule</span>.</p></li>
<li><p>Angriff mit den erstellten W√∂rterbuch und dem Regelsatz.</p></li>
</ol>
</div><div class="small ld-slide" id="szenario-5-kombination-von-worterbuch-mit-eigenem-regelsatz-1">
<h2>Szenario 5: Kombination von W√∂rterbuch mit eigenem Regelsatz</h2>
<p><strong>Angriff</strong></p>
<ol class="arabic">
<li><p>Generierung von <span class="docutils literal">candidates.txt</span></p>
<p>Um sicherzustellen, dass wir keine Duplikate testen, wandeln wir alle Worte in Kleinschreibung um und filtern entsprechende Duplikate. Die Beachtung aller Varianten in Hinblick auf die Gro√ü- und Kleinschreibung wird durch die Regeln sichergestellt.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string double">&quot;^[a-zA-Z]{3,4}(?=[^a-zA-Z])&quot;</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">       </span>/usr/share/wordlists/rockyou.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>tr<span class="whitespace"> </span><span class="operator">[</span>:upper:<span class="operator">]</span><span class="whitespace"> </span><span class="operator">[</span>:lower:<span class="operator">]</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-u<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span>&gt;<span class="whitespace"> </span>candidates.txt</code></pre>
</li>
</ol>
<div class="supplemental docutils container">
<p><strong>Zu Bedenken</strong></p>
<p>Die gezeigte Operation l√∂st die Ordnung in der Datei auf und sortiert diese alphabetisch. Dies ist aber h√§ufig nicht gew√ºnscht ‚Äì insbesondere wenn der Leak nach Verwendungsh√§ufigkeit sortiert ist!</p>
</div>
</div><div class="small ld-slide" id="szenario-5-kombination-von-worterbuch-mit-eigenem-regelsatz-2">
<h2>Szenario 5: Kombination von W√∂rterbuch mit eigenem Regelsatz</h2>
<p><strong>Angriff</strong></p>
<ol class="arabic">
<li><p>Erstellen des Regelsatzes: <span class="docutils literal">case.rule</span></p>
<p>Um sicherzugehen, dass wir alle Varianten abdecken, brauchen wir drei Regeln.</p>
<table class="incremental no-table-borders" style="width: 100%;">
<tbody>
<tr><td><p>cd</p></td>
<td><p><span class="minor">Erst Gro√ü-Kleinschreibung anpassen und dann duplizieren.</span></p></td>
</tr>
<tr><td><p>dc</p></td>
<td><p><span class="minor">Erst duplizieren und dann Gro√ü-Kleinschreibung anpassen.</span></p></td>
</tr>
<tr><td><p>d</p></td>
<td><p><span class="minor">Einfach nur duplizieren.</span></p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<ol class="arabic incremental" start="2">
<li><p>Angriff mittels Hahcat</p>
<pre class="code bash literal-block"><code>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1700</span><span class="whitespace"> </span>hash.sha125<span class="whitespace"> </span>candidates.txt<span class="whitespace"> </span>-r<span class="whitespace"> </span><span class="keyword">case</span>.rule</code></pre>
</li>
</ol>
<div class="supplemental docutils container">
<p><strong>Tips</strong></p>
<p>Das beherrschen von regul√§ren Ausdr√ºcken ist bei der Passwortrekonstruktion sehr hilfreich.</p>
<p>Der folgende Ausdruck liefert zum Beispiel alle 4stelligen Worte aus Rockyou mit Hilfe eines Lookheads, dass l√§ngere Worte filtert.</p>
<pre class="code bash black literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string double">&quot;^[a-zA-Z]{3,4}(?=[^a-zA-Z])&quot;</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">     </span>/usr/share/wordlists/rockyou.txt</code></pre>
<p>Das Passwort <span class="docutils literal">TreeTree</span> w√ºrde sich damit erfolgreich wiederherstellen lassen.</p>
</div>
</div><div class="small ld-slide" id="szenario-6-kartesiche-produkt-von-zwei-worterbuchern">
<h2>Szenario 6: Kartesiche Produkt von zwei W√∂rterb√ºchern</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Aufgrund von Social Engineering/Ermittlungen wissen wir, dass die Person sehr gerne zwischen deutschen Gro√üst√§dten pendelt. Nachdem andere Versuche nicht zum Erfolge gef√ºhrt habe, wollen wir jetzt Passworte der Art: &quot;BerlinHamburg&quot; testen.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic incremental">
<li><p>Erstellen eines fokussierten W√∂rterbuchs durch &quot;Googeln&quot; von gro√üen St√§dten.</p></li>
<li><p>Angriff durch Kombination des W√∂rterbuchs mit sich selbst.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>hash.sha256<span class="whitespace"> </span>-a<span class="whitespace"> </span><span class="literal number">1</span><span class="whitespace"> </span>big_cities2.txt<span class="whitespace"> </span>big_cities2.txt</code></pre>
</li>
</ol>
</div><div class="small ld-slide" id="szenario-7-worterbuch-mit-maske">
<h2>Szenario 7: W√∂rterbuch mit Maske</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Es ist bekannt, dass die Passw√∂rter der Gruppierung h√§ufig mit vier Zahlen und zwei Sonderzeichen aus einer sehr kleinen Mengen von Sonderzeichen (<span class="docutils literal">$!.</span>) enden. Davor kommt ein Wort mit ca. 4-8 Stellen in den typischerweiser &quot;liebe/love/luv&quot; vorkommt.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic simple incremental">
<li><p>Erstellen eines fokussierten W√∂rterbuchs: <span class="docutils literal">candidates.txt</span></p></li>
<li><p>Angriff mit passendem Maskenangriff</p></li>
</ol>
</div><div class="small ld-slide" id="szenario-7-worterbuch-mit-maske-1">
<h2>Szenario 7: W√∂rterbuch mit Maske</h2>
<p><strong>Angriff mit Hybridangriff</strong></p>
<p><span class="docutils literal">candidates.txt</span> enth√§lt alle Begriffe aus rockyou, die die Anforderung erf√ºllen:</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-oE<span class="whitespace"> </span><span class="literal string double">&quot;[a-zA-Z]*[Ll]((uv)|(ove)|(iebe))[a-zA-Z]*&quot;</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">      </span>/usr/share/wordlists/rockyou.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-u<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>candidates.txt</code></pre>
<p class="incremental">Angriff mit Hashcat:</p>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>hash.sha256<span class="whitespace"> </span>candidates.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">    </span>-a<span class="whitespace"> </span><span class="literal number">6</span><span class="whitespace"> </span>-1<span class="whitespace"> </span><span class="literal string single">'$.!'</span><span class="whitespace"> </span><span class="literal string single">'?d?d?d?d?1?1'</span></code></pre>
<div class="supplemental docutils container">
<p><strong>Beispiel</strong></p>
<p>In diesem Falle verwenden wir einen Hybridangriff, der eine Wordliste mit einer Maske kombiniert. Hier definieren wir unseren eigenen <span class="ger-quote">Zeichensatz</span> mit dem Parameter <span class="docutils literal"><span class="pre">-1</span> <span class="pre">'$.!'</span></span> und referenzieren diesen in unserer Maske sp√§ter mit <span class="docutils literal"><span class="pre">?1</span></span>.</p>
<p>Ein Beispielpasswort, dass wir mit dem Ansatz ermitteln k√∂nnten, w√§re:</p>
<table class="monospaced">
<thead>
<tr><th class="head"><p>SHA256</p></th>
<th class="head"><p>Passwort</p></th>
</tr>
</thead>
<tbody>
<tr><td><dl class="simple">
<dt>b9cace43df57bc694498bf4d7434f45a</dt>
<dd><p>8466c4a924f608d54fd279d24b3dc937</p>
</dd>
</dl>
</td>
<td><p>ILuvU2023!!</p></td>
</tr>
</tbody>
</table>
</div>
</div><div class="small ld-slide" id="szenario-8-passworter-mit-muster">
<h2>Szenario 8: Passw√∂rter mit Muster</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Wir m√∂chten ein W√∂rterbuch erstellen mit <span class="ger-quote">W√∂rtern</span>, die Buchstabenvervielf√§ltigungen enthalten, aber nicht l√§nger als 16 Zeichen sind. Zum Beispiel: <span class="docutils literal">aaaaBBBBcccc</span> oder auch <span class="docutils literal">AFFFFFE</span>.
Weiterhin soll die Liste nach der L√§nge der gefundenen Eintr√§ge aufsteigend sortiert sein und Zeichen, die keine Buchstaben sind, einfach gel√∂scht werden.</p>
<p><strong>L√∂sung</strong></p>
<div class="incremental docutils container">
<p>Heraussuchen entsprechender W√∂rter aus rockyou mittels Linux Kommandozeilenwerkzeugen.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;([a-zA-Z])\1{3,}&quot;</span><span class="whitespace"> </span>/usr/share/wordlists/rockyou.txt<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;^.{4,16}</span>$<span class="literal string double">&quot;</span><span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string single">'s/[^a-zAZ]//g'</span><span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-u<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>awk<span class="whitespace"> </span><span class="literal string single">'{print length &quot; &quot; $1}'</span><span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-n<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string single">'s/^[0-9]+ //'</span></code></pre>
</div>
<div class="supplemental docutils container">
<p><em>Alternative Aufgabenstellung</em></p>
<p>Sortierung der finalen Liste nach nach der H√§ufigkeit der Muster, angefangen mit dem h√§ufigsten Mustern.</p>
</div>
</div><div class="small ld-slide" id="szenario-9-passworter-bestehend-aus-fragmenten">
<h2>Szenario 9: Passw√∂rter bestehend aus Fragmenten</h2>
<p><strong>Ausgangssituation</strong></p>
<ul class="simple">
<li><p>Einer gegebenen Liste k√∂nnen wir nur entnehmen, dass alle Passw√∂rter zusammengesetzt sind aus den Fragmenten: <span class="docutils literal">ab</span>, <span class="docutils literal">mem</span>, <span class="docutils literal">li</span> und <span class="docutils literal">xy</span>.</p></li>
<li><p>Dar√ºber hinaus ist immer eine Zahl vorangestellt und am Ende kommt ein Punkt (<span class="docutils literal">.</span>) oder ein Ausrufezeichen (<span class="docutils literal">!</span>).</p></li>
<li><p>Die L√§nge scheint zwischen 6 und 16 Zeichen zu sein und Fragmente k√∂nnen sich wiederholen.</p></li>
</ul>
<p>Beispiel: <span class="docutils literal">1ablixyxy.</span></p>
<p><strong>Vorgehen</strong></p>
<ol class="arabic simple incremental">
<li><p>Erstellen eines Basisw√∂rterbuchs (<span class="docutils literal">base.txt</span>) mit den Fragmenten als Eintr√§ge.</p></li>
<li><p>Erstellen von Regeln f√ºr das Voranstellen und Anh√§ngen der entsprechenden (Sonder)zeichen.</p></li>
<li><p>Aus Basisw√∂rterbuch das finale W√∂rterbuch f√ºr den Angriff generieren.</p></li>
<li><p>Mit dem finalen W√∂rterbuch und entsprechenden Regeln angreifen.</p></li>
</ol>
</div><div class="small ld-slide" id="szenario-9-generierung-von-worterbuchern-aus-fragmenten">
<h2>Szenario 9: Generierung von W√∂rterb√ºchern aus Fragmenten</h2>
<p><strong>L√∂sung</strong></p>
<p>Zu Generierung aller Kombinationen aus den Fragmenten verwenden wir den Princeprocessor.  Der Princeprocessor ist sehr schnell und erm√∂glicht es in F√§llen die Ausgabe direkt an Hashcat durchzureichen und das Zwischenw√∂rterbuch nicht explizit speichern zu m√ºssen.</p>
<p><strong>Angriff</strong></p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>princeprocessor<span class="whitespace"> </span>--pw-min<span class="operator">=</span><span class="literal number">6</span><span class="whitespace"> </span>--pw-max<span class="operator">=</span><span class="literal number">16</span><span class="whitespace"> </span>base.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>hash.sha256<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">     </span>-r<span class="whitespace"> </span>number_prepend.rule<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">     </span>-r<span class="whitespace"> </span>sc_append.rule</code></pre>
<div class="supplemental docutils container">
<p><em>Aufbau von</em> <span class="docutils literal">number_prepend.rule</span>:</p>
<pre class="code bash black literal-block"><code>^0<span class="whitespace">
</span>^1<span class="whitespace">
</span>...<span class="whitespace">
</span>^9</code></pre>
<p><em>Aufbau von</em> <span class="docutils literal">sc_append.rule</span>:</p>
<pre class="code bash black literal-block"><code>$.<span class="whitespace">
</span><span class="name variable">$!</span></code></pre>
<p>Mit dem obigen Ansatz k√∂nnte zum Beispiel das folgende Passwort ermittelt werden:</p>
<table>
<thead>
<tr><th class="head"><p>SHA256</p></th>
<th class="head"><p>Passwort</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>8b11f8e8d487266a791d6d723a3e380c
38f49679735a7f3395ace4302e83dd0e</p></td>
<td><p>8abxylixy.</p></td>
</tr>
</tbody>
</table>
<p>In diesem Falle w√§re es auch m√∂glich gewesen nur einen Regelsatz zu erstellen mit den passenden Regeln (zum Beispiel: <span class="docutils literal">^1$.</span>, <span class="docutils literal">^1$!</span>, ...) der Aufwand w√§re hier jedoch h√∂her gewesen und h√§tte keinen Nutzen gehabt.</p>
<p>Im Allgemeinen ist jedoch bei der Verwendung des Kreuzproduktes von Regeln immer darauf zu achten, dass keine (oder zumindest keine relevante Anzahl von) Regeln dupliziert werden. Ein Beispiel w√§re das Kreuprodukt aus einem Regelnsatz f√ºr das optionale Anh√§ngen einer Ziffer mit sich selbst. Sei der Regelsatz:</p>
<pre class="code black literal-block"><code>:
$1
$2</code></pre>
<p>und w√ºrde man diesen mit sich selber kombinieren, um alle F√§lle des Anh√§ngens von keiner, einer bzw. zwei Zahlen abzudecken, dann w√ºrden folgende Regeln entstehen:</p>
<pre class="code black literal-block"><code>::
:$1
:$2
$1$1
$1$2
$2$1
$2$2
$1:
$2:</code></pre>
<p>Wie zu erkennen ist, f√ºhren zum Beispiel die Regeln <span class="docutils literal">$1:</span> und <span class="docutils literal">:$1</span> jeweils zum gleichen Ergebnis und w√§ren deswegen nicht effektiv.</p>
</div>
</div><div class="small ld-slide" id="szenario-10-hashcat-als-werkzeug-zur-worterbuchgenerierung">
<h2>Szenario 10: Hashcat als Werkzeug zur W√∂rterbuchgenerierung</h2>
<p><strong>Ausgangssituation</strong>
Gegeben sein 3 W√∂rterb√ºcher <a class="footnote-reference brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>: <span class="docutils literal">base1.txt</span>, <span class="docutils literal">base2.txt</span> und <span class="docutils literal">base3.txt</span>. Gesucht ist ein W√∂rterbuch, dass alle Kombinationen aus den drei W√∂rterb√ºchern enth√§lt und bei dem alle Teilworte immer mit Sonderzeichen (-) voneinander getrennt sind.</p>
<div class="incremental docutils container">
<p><strong>Beispiel</strong>
Sei <span class="docutils literal">base1.txt</span>: <em>Kuh</em>, <em>Schwein</em>; <span class="docutils literal">base2.txt</span>: <em>Haus</em>, <em>Villa</em> und <span class="docutils literal">base3.txt</span>: <em>Baum</em>, <em>Busch</em>. Dann w√§re das gesuchte W√∂rterbuch: <em>Kuh-Haus-Baum</em>, <em>Kuh-Haus-Busch</em>, ..., <em>Schwein-Villa-Busch</em>.</p>
</div>
<div class="incremental docutils container">
<p><strong>Vorgehen</strong></p>
<div class="incremental docutils container">
<ol class="arabic simple">
<li><p>Erzeugen des Kreuzprodukts der ersten beiden W√∂rterb√ºcher.</p></li>
</ol>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>--stdout<span class="whitespace"> </span>base1.txt<span class="whitespace"> </span>base2.txt<span class="whitespace"> </span>-j<span class="whitespace"> </span><span class="literal string single">'$-'</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>base1-base2.txt</code></pre>
</div>
<div class="incremental docutils container">
<ol class="arabic simple">
<li><p>Erzeugen des finalen W√∂rterbuchs durch Bildung des Kreugprodukts der Ergebnisse aus Schritt 1 mit dem dritten W√∂rterbuch.</p></li>
</ol>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>--stdout<span class="whitespace"> </span>base1-base2.txt<span class="whitespace"> </span>base3.txt<span class="whitespace"> </span>-j<span class="whitespace"> </span><span class="literal string single">'$-'</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>final.txt</code></pre>
</div>
</div>
<div class="supplemental docutils container">
<p>Die Hashcat Utilities Bibliothek hat auch noch weitere Werkzeug zum Kombinieren von W√∂rterb√ºchern, die viele F√§lle sehr effizient abdecken (auch den besprochenen). Jedoch ist es gerade in F√§llen, in denen komplexere Regeln zur Anwendung kommen sollen, h√§ufiger sinnvoller/nowendig direkt Hashcat im &quot;stdout&quot; Modus zu verwenden, um die Zwischenw√∂rterb√ºcher zu generieren.</p>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p>Die selbe Vorgehensweise l√§sst sich auch anwenden, wenn man ein W√∂rterbuch mit sich selber kombinieren m√∂chte.</p>
</aside>
</aside>
</div><div class="ld-slide" id="passworter-angreifen-zusammenfassung">
<h2>Passw√∂rter angreifen - Zusammenfassung</h2>
<ul class="incremental more-space-between-list-items simple">
<li><p>Passw√∂rter k√∂nnen vielfach effizient angegriffen werden.</p></li>
<li><p>(gute bis exzellente) Kenntnisse √ºber die Zielpersonen sind h√§ufig notwendig.</p></li>
<li><p>Viele Werkzeuge sind verf√ºgbar (siehe auch Hashcat Werkzeuge, Princeprocessor, John the Ripper, etc.)</p></li>
<li><p>Kleine etablierte Kommandozeilenwerkzeuge (<span class="docutils literal">tr</span>, <span class="docutils literal">greb</span>, <span class="docutils literal">sed</span>, <span class="docutils literal">awk</span>, ...) oder selbstentwickelte Werkzeuge (zum Beispiel in Python) sind h√§ufig erg√§nzend notwendig und f√ºhren oft  schneller zum Ziel als die Suche nach <em>dem</em> Tool.</p></li>
<li><p>Insbesondere wenn es um die semantische Anreicherung von W√∂rterb√ºchern geht, dann sind (bisher) keine etablierten Werkzeuge vorhanden.</p></li>
<li><p>H√§ufig f√ºhren nur Kombinationen von etablierten und eigenen Werkzeugen zum gew√ºnschten Ziel.</p></li>
</ul>
</div><div class="integrated-exercise ld-slide" id="ubung-stellen-sie-die-passworter-wieder-her">
<h2>√úbung - Stellen Sie die Passw√∂rter wieder her...</h2>
<div class="ld-exercise" data-exercise-id="4" data-exercise-title="4 - MD5 Hash eines trivialen Passworts" id="ld-exercise-4">
<p class="rubric">MD5 Hash eines trivialen Passworts</p>
<pre class="code text copy-to-clipboard literal-block"><code>81dc9bdb52d04dc20036dbd8313ed055</code></pre>
<p>Hinweise: Das Passwort ist kurz, besteht nur aus Ziffern und ist sehr h√§ufig.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:SqY3uVOCxbQlYS7DrKEfofviyl3h56QEc6J79+aB/nA=:DG4OtTISl2ZZkiq/:4cQwpT4GzGRH3xthsXM2h4IUsDvrgSe+FxDcRW9jNiULUKotU2aFOkKs0q0wnnt5+F2Pm0JESji08ZYIDsstu6uMsLZjYjWYkr2Hipj4zwejm//rZTQFMMvbugeIEjuUNMq0/ovoj65wLyolNCwGxAYPnqouRxqPljJxBJpTbEATDTbiFUDJOVeVrxpuwuVJaLnbkROwwxS9dgu03KdsmMrhO1GV3zJQ4oMYrtdXaSw6ePJje6GHwyMVjdyLbzUO0OkXZ3s9x/LQhlG2fdFqN95cahYwGihYro3SH+GAIwRLtqzYbrJrqT06aw9E5hosd/PPbW7bnJ3PQYvwdnq8jiwdj0pn7D0txFB6h+NTEgy2isIPgbCCWL80VmX2gOLWAKk4j0P9T8lap+PqNXiq20/kjHwXKyhKiRYx9cYH/QZ4BHRFTpmVjcEfS3HovefVlkvApsqILDXUXN6xvAbxUTfHOkn1w3nQY0w5krxIdvbFCGOTyrr8cuqvLmEv2InG/v/BWk2PWWbA7jOWG0zBIXoKjbcAviF3qKLBroZ8Q7MW6nqyFoeVzdDhjsfVedgZmsu/DeAFKZPoAJtTjQUdAclCtfsphPMzPUCaZxVSMV3chvqMzb6IK81kewdTGore8fM7KJyWS7ijs1GxeAjYBU5VcS8w9XTqjHM04qAgH27xpsQjsqsA9ADmTQSjaHj5y/eKXCjH/hntdD5OcxVOkYPWZN+0wxoD51hHpldmFP1zWg4ap1I9j/BxabSR/CYQ32Xg9J/K/me6eoLQUP7+geXRG5MLWzlzBjeLgo4QMZmGILFS4B+mlskbE8fKvWv0qnqb6jHIIvKxZE50qAU2sP6o9dqkFDTrmKoTOwafMwxHnoY5JCZK1licNU8Dnto8Oj3aiF+z7lYRTE2htqKVY7rZEm9T0z3SGbDYdRUPCmZ9HCoBlJEMV9hIYlH90x5shQWp2AwyBHOA6EIpkplYI/0NrlqJmCpQDoznGteCg91uiM5M+abDsxpcOUnFQL5z2bcUY1Y1V1slCVnr4dOflR1IXWGPW1m6ETd4uhlzHoJrgipNQTeTLGAJC7WontvCNkO1D2goFCjuyU9q4iCkx9BfYZqWNYso+15sWvLxzSm73tpVb08uXnceR5mpzzJvaaPk5cfx3ZpYGmPj1hcjsKZQsBSG1MS+waMjAkjd3XqGu0hDybVP0pIFkkEtJl3lz3xD10Z9yJZR10s+jxpDtNvHge4OdyuVlAHd4PT1/YATXFEAvz10d+MpRXHHzeA9IORG7wo5eoI+BSMos2UGOZztUeng+q0JepUwPBgUiVE459d8acykzWljtJfkx68W2xfE5bmjFyBIsjPkQgh9pjQD4I/UXqDI4uX54Psz3YaJsr2SEPTwMNqcbF3DhutMuPu6oHrd9/ZMtvZvu9IpvPPLTHUa+V2g/WesVDhjGSTNZlUDtuWCdjVMpChS7KOTiCwVnoC/edBuRMndXB+X066AB44Bw6aGpJtWF+pAPBnBOwPZhiR54KtfHWFxM40A4RaDqKclLrLzY5kczOUG88xBRltQs8h9czBa7wxZf4hFubjztnE18IEAUsQPWi+t0Z1EQCKorZaPN/17rczOGw5qh+asrxMULQF32vq6w+a6Y2A+Hb/I9lY79ps9VhwjBUczIk78s++YTRuHonXH54vQLwHUWEG05fCr1YhcU5AJlNwwpG/dBlDqhTkOqfqDz9L4lyj9+ZAOhra9hKDvjDPsC0JA9439+1H0/YNKK3YMuZNWTeuZwLS4fFrKW31wIdOHugyZltna4cztJeoQPXXa1RILyfdxJuv3PDdiI2DVrY61zMjpGJ5kecw/68F+0lAGANkFMRfgZgUlXk0+nu9VYxrlH+xcu4rYTLWIR870wACRN28bLTvb1naIhGsCVwneFgX7Q1Dg0OsW6bL0Bsx1izionhFihzAiv529ly+mgO7CSShgDT0P6WBT0Oi4KWIdi0d6ieAZaLFh8hDrFyH/sMZBHR2ViC0UDCgWkgnYbxpxys5ezf/84kyupLugkWNIyk0MdhrCy8Xkz0KC2sz/EiAZ5A/GfQpvniHisLCVCQd2QmOzBFDogDfzxLgfaXlR6eYtraCytcCcgnRkakICmdIbWWZ2XJfz8YUTW/lzWeafnuigjYwvtPidc5IkOQTrmgR2TTPEqlZfMYygO/pIXkHghpilAoL4WI6FCWODULgeOTYbmHiNL9aJclVdSuVvx/GM1iONbN8vcuJpZA6g0ElYQx2OGhjgJIM91RuhSY69Vnsg/XfYTK5d9ww0NQ31d8x8jX0ZoMrksDaKkdBiOL+3WVP7gAmgft9bVt1a/IazTjMJGjvpkpyQHekQ/wjcGndH86tZ8IoOOz1O2hzFabd7p9m9svS5XJxadQ2skKCQjA5lzwc2nMrbXOPCnh5/bNt9vZlI1VQiX5lc4AKqDyq0M7dd0LUVeyn62+f58lY5TU0zhec7FMh+kV74OEgjtajAPcOPThLgDOaYJnBPTUHJdywg61493pmf3Q/l9JDOJtgc353fyyqum+YHi9hZ/Gbyq/C0v7JatIR8B0RDZC7c7Jam2pT1WyiJTUsuRq8nzcIWAUUGkoTPfqTVVmcjgFMFC/9oQD90vAGXw5FSiEgnG8pMuMhqx52eAbIDObvh8e9cROOHue0BAApVF8WHLBTrbRqi1lnn2BUlYlQuSPsVU307YM+PtnZ3rtRbmvGvbDiHepJmrtW0FC+xL2MCi8K04Ft/NqWQ2dlwCPcA63VSc9JB+BnR4S8x3Tu88eLbQftk2gCmeq/u2MGqnv6VPcJ7bFV3JNqiMrehsQ90gOaQm944MOxIs0sqUcEoxvQQcybWpW01uRjPMIeAAAyTyPB2opoUTVsFI5p7Tz+k5Z6olxTRi4WCH0G7/kWSrRYbvCqBL+6Vm3TdWn5IoGPEwkTeX+yv9Q5Snr06z14+pSwhcyl1a1IObbZqVLNAJMwRDEcMXIsH18bloFSrgommdtIGdEy2FbfNfDkdtcGY1c2JGyOe2+f0Z2yVKAPIXojHW0mZStWX2mCMxEs93O2XooKjT8Ku2vH1nbTQ</div>
</div>
<div class="ld-exercise" data-exercise-id="5" data-exercise-title="5 - MD5 Hash eines einfachen Passworts" id="ld-exercise-5">
<p class="rubric">MD5 Hash eines einfachen Passworts</p>
<pre class="code text copy-to-clipboard literal-block"><code>7c6a180b36896a0a8c02787eeafb0e4c</code></pre>
<p>Hinweise: Das Passwort besteht aus Buchstaben gefolgt von Ziffern und ist sehr h√§ufig.</p>
<p>Sie k√∂nnen Hashcat (<a class="reference external" href="https://hashcat.net/hashcat/">https://hashcat.net/hashcat/</a>) verwenden oder ein Bash-Skript schreiben oder eine kleine L√∂sung in einer Programmiersprache Ihrer Wahl entwickeln.</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:lveL96GnwGqei0JYTIc+DY1tIyJr4iWcn8zxZ2TGIME=:Qw1Tnc9C0N3nfQPI:1+W4zNgT3LwV424jaWXWjc8sGhDp89BcU7vP+OFMgGjCciR3ColRR+TV0QBTHIDGub319Uujo6iv0s2ZOvrFsYytn4EuH3rq5162h5Sl6QzLZG5c4swJfXQ=</div>
</div>
</div><div class="ld-slide" id="sichere-passworter">
<h2>Sichere Passw√∂rter</h2>
<ul class="simple">
<li><p>Nehmen Sie kein Passwort, dass 1:1 in einem W√∂rterbuch, Verzeichnis oder Leak (vgl. <a class="reference external" href="https://haveibeenpwned.com">https://haveibeenpwned.com</a>) vorkommt.</p></li>
<li><p>Nehmen Sie keine Szenepassw√∂rter (zum Beispiel: admin, root, acab, 1312, 88, ...).</p></li>
<li><p>Je l√§nger desto besser, aber keine trivialen S√§tze.</p></li>
<li><p>W√§hlen Sie ein Passwort, dass sie sich merken k√∂nnen. Kombinieren Sie z.‚ÄØB. Dinge aus Ihrem privaten Umfeld, die aber niemand direkt mit Ihnen in Verbindung bringen kann. (D.‚ÄØh. die Namen Ihrer Kinder, Haustiere, etc. sind keine gute Wahl, aber ggf. das Modell Ihres Fernsehers in Kombination mit einer Pin und dem Namen Ihres ersten Smartphones getrennt durch ein paar Sonderzeichen).</p></li>
</ul>
</div><div class="ld-slide" id="literaturverzeichnis">
<h2>Literaturverzeichnis</h2>
<div class="tiny docutils container">
<div role="list" class="citation-list">
<div class="citation" id="sepass" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-5">SePass</a><span class="fn-bracket">]</span></span>
<p>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings; Maximilian H√ºnem√∂rder, Levin Sch√§fer, Nadine-Sarah Sch√ºler, Michael Eichberg &amp; Peer Kr√∂ger, ADMA 2022: Advanced Data Mining and ApplicationsSpringer LNAI, volume 13726</p>
</div>
<div class="citation" id="pcfg-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-1">PCFG</a><span class="fn-bracket">]</span></span>
<p>S. Aggarwal, M. Weir, B. Glodek and B. Medeiros, &quot;Password Cracking Using Probabilistic Context-Free Grammars,&quot; in 2009 30th IEEE Symposium on Security and Privacy (SP); doi: <a class="reference external" href="https://doi.ieeecomputersociety.org/10.1109/SP.2009.8">10.1109/SP.2009.8</a></p>
</div>
<div class="citation" id="ngpcfg" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-2">NGPCFG</a><span class="fn-bracket">]</span></span>
<p>S.Houshmand, S. Aggarwal and R. Flood, &quot;Next Gen PCFG Password Cracking,&quot; in IEEE Transactions on Information Forensics and Security, vol. 10, no. 8, pp. 1776-1791, Aug. 2015, doi: 10.1109/TIFS.2015.2428671.</p>
</div>
<div class="citation" id="paofpcfg" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-3">PAofPCFG</a><span class="fn-bracket">]</span></span>
<p>Hranick√Ω, R., Li≈°tiak, F., Miku≈°, D., Ry≈°av√Ω, O. (2019). On Practical Aspects of PCFG Password Cracking. In: Foley, S. (eds) Data and Applications Security and Privacy XXXIII. DBSec 2019. Lecture Notes in Computer Science(), vol 11559. Springer, Cham. <a class="reference external" href="https://doi.org/10.1007/978-3-030-22479-0_3">https://doi.org/10.1007/978-3-030-22479-0_3</a></p>
</div>
<div class="citation" id="piandpcfg" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-4">PIandPCFG</a><span class="fn-bracket">]</span></span>
<p>Houshmand, S., Aggarwal, S. (2017). Using Personal Information in Targeted Grammar-Based Probabilistic Password Attacks. In: Peterson, G., Shenoi, S. (eds) Advances in Digital Forensics XIII. DigitalForensics 2017. IFIP Advances in Information and Communication Technology, vol 511. Springer, Cham. <a class="reference external" href="https://doi.org/10.1007/978-3-319-67208-3_16">https://doi.org/10.1007/978-3-319-67208-3_16</a></p>
</div>
</div>
</div>
</div>
</template>
</body>
</html>
