<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta name="exercises-passwords" content="MTAwMDAw:0wclO86Nwu3T1h2RjXgV7fx0Xz1oQx8XeYP4FxqN9f4=:WokNf0VPnQjT9HfA:CG3GfYlX6Y98u/akdlRvAxxQeWcLDPaZV8FSvy5QxPig+eclPwvLhSAcmfSFfmrPJqZ6a1ea4bHM6PHKqJV28Zws5Y+bzJVHPFMYcUiSrlvioAYAKghoE4IxY5VajfeTjDb+i8/6ZzGat90rk+L0J/8o2zbE+7G5mxoMgjZyG2PHwBbM0chFhNWVsOGONiUx62mJOTqeCs3Y2vgpWhoxqYj74v1Byh3mFGLvEYHhQphJnaEIYQo/GIs1fve0oqabWgVaqQeUroiRT0E1ccQojRk215BMuILVV6n7kuCRRuAYCL14nY792b3HITQaz6bgmlN5PzdJ0nVDkZ3kl2oA1N1iKCiI6W8TVHVffNZVJNYVZ3PCjWSH4+YDK3GfC7KmzaiUR9/UW5chIwGK/plBDz0iyZcAMGcmz4F0vPMvPsrnahOXG+Z9ZSfTdUkkioBTYKHfex7oT8dfHBy/b9CnfdnoI1pj4uGTczQAE5+nFxUN1Td/hDSv6cBkKMzW4tMFtvJ1g5h90OM6MOtv0wEhR2YVviNRjIocEnHZRalEMU+dDi6rLVlK6gxfCIteiPynpvsMktaA5ov0ZBWrxfywmNL5BURmWYkFWdNsMIuAISRqeUfDUVBqVXHN2McVBy/yKNv2qkzBK21zPLk0nyvmmxNIeml/1LdhL6TE3erYeZNdoTZWS6JFOK6ksI0/kX/Gm16ytHfhN1Ia6SGaBqL2roHqthwFlFKl/JB7mSsp2Q/PDpgF7XZXugkGBnRfeg==" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="LD2 0.1" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;TCP&quot;, &quot;DDoS&quot;, SSH" name="keywords" />
<meta content="Network Security - Eine Einführung in die Sicherheit von (verteilten) Systemen" lang="de" name="description" xml:lang="de" />
<meta content="lecture-security-a-primer-in-network-security" name="id" />
<meta content="last-viewed" name="first-slide" />
<title>Eine erste Einführung in die Sicherheit von (verteilten) Systemen</title>
<script type="text/javascript" src="../LectureDoc2/ext/mathjax/es5/tex-chtml-full.js?config=TeX-AMS_CHTML"></script>

    <script src="../LectureDoc2/ld-core.js" type="module"></script>

    <script src="../LectureDoc2/ld-components.js" type="module"></script>

    <!-- Additional scripts that interact with LectureDoc have to be added below. -->
    <link rel="stylesheet" href="../LectureDoc2/ld.css" type="text/css" />

    <link rel="stylesheet" href="../LectureDoc2/themes/DHBW/theme.css" type="text/css" />

    
</head>
<body>
<template>
<div class="ld-slide" id="eine-erste-einfuhrung-in-die-sicherheit-von-verteilten-systemen">
<h1 class="title">Eine erste Einführung in die Sicherheit von (verteilten) Systemen</h1>
<dl class="docinfo">
<dt class="dozent">Dozent<span class="colon">:</span></dt>
<dd class="dozent"><p><a class="reference external" href="https://delors.github.io/cv/folien.de.rst.html">Prof. Dr. Michael Eichberg</a></p>
</dd>
<dt class="contact">Kontakt<span class="colon">:</span></dt>
<dd class="contact"><a class="reference external" href="mailto:michael.eichberg&#64;dhbw-mannheim.de">michael.eichberg&#64;dhbw-mannheim.de</a></dd>
<dt class="version">Version<span class="colon">:</span></dt>
<dd class="version">1.1</dd>
</dl>
<div class="footer-left tiny docutils container">
<p>Die Folien basieren in weiten Teilen auf einem Foliensatz von Prof. Dr. Henning Pagnia.</p>
<p>Alle Fehler sind meine eigenen.</p>
</div>
<div class="supplemental">
<dl class="field-list">
<dt>Folien<span class="colon">:</span></dt>
<dd><p>[HTML] <a class="reference external" href="https://delors.github.io/sec-tcp-ssh-firewalls/folien.de.rst.html">https://delors.github.io/sec-tcp-ssh-firewalls/folien.de.rst.html</a></p>
<p>[PDF] <a class="reference external" href="https://delors.github.io/sec-tcp-ssh-firewalls/folien.de.rst.html.pdf">https://delors.github.io/sec-tcp-ssh-firewalls/folien.de.rst.html.pdf</a></p>
</dd>
<dt>Fehler melden<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://github.com/Delors/delors.github.io/issues">https://github.com/Delors/delors.github.io/issues</a></p>
</dd>
</dl>
</div></div>
<div class="ld-slide" id="themen">
<h2>Themen</h2>
<ul class="simple">
<li><p><a class="reference internal" href="#transmission-control-protocol-tcp">Transmission Control Protocol (TCP)</a></p></li>
<li><p><a class="reference internal" href="#einmal-passworter">Einmal-Passwörter</a></p></li>
<li><p><a class="reference internal" href="#secure-shell-ssh">Secure Shell (SSH)</a></p></li>
<li><p><a class="reference internal" href="#firewalls">Firewalls</a></p></li>
</ul>
</div><div class="new-section transition-fade ld-slide" id="transmission-control-protocol-tcp">
<h2>Transmission Control Protocol (TCP)</h2>
</div><div class="vertical-title ld-slide" id="tcp-grundlagen">
<h2>TCP Grundlagen</h2>
<ul class="incremental more-space-between-list-items simple">
<li><p>Protokoll der Schicht 4 (Transport Layer) basiert auf IP</p></li>
<li><p>verbindungsorientierte Kommunikation zweier Rechner im Internet zuverlässig und geordnet:</p>
<ul class="incremental">
<li><p>Verwerfen von Duplikaten und fehlerhaft übertragener Pakete</p></li>
<li><p>automatisches Wiederversenden fehlender Pakete</p></li>
<li><p>Nachrichtenpuffer: Daten werden in korrekter Reihenfolge an Applikation zugestellt</p></li>
</ul>
</li>
<li><p>Verbindungsaufbau immer zwischen zwei Sockets (Socket-Adresse: IP Adresse und 16 Bit-Port-Nummer)</p></li>
</ul>
</div><div class="ld-slide" id="aufbau-einer-tcp-verbindung">
<h2>Aufbau einer TCP Verbindung</h2>
<p>Dreifacher Handshake:</p>
<div class="supplemental">
<p><strong>Terminologie</strong>:</p>
<dl class="field-list simple">
<dt>SYN<span class="colon">:</span></dt>
<dd><p><span class="eng">synchronize (session establishment)</span></p>
</dd>
<dt>ACK<span class="colon">:</span></dt>
<dd><p><span class="eng">acknowledge</span></p>
</dd>
<dt>RST<span class="colon">:</span></dt>
<dd><p><span class="eng">reset</span></p>
</dd>
</dl>
<p><strong>Verbindungsaufbau - Ablauf</strong>:</p>
<ol class="arabic simple">
<li><p>Client sendet SYN Paket mit initialer Sequenznummer (hier) 1000 an den Server.</p></li>
<li><p>Server sendet ein SYN-ACK Paket mit seiner initialen Sequenznummer (hier) 2000 und ein ACK mit der Sequenznummer 1001 (initiale Sequenznummer des Clients +1) an den Client</p></li>
<li><p>Client sendet ein ACK Paket mit Sequenznummer 2001 (initiale Sequenznummer des Servers +1) an den Server; danach ist die Verbindung aufgebaut.</p></li>
</ol>
<p>Das Betriebssystem sollte die initialen Sequenznummern zufällig wählen, so dass ein Angreifer diese nicht leicht vorhersagen kann. Beide Seiten haben eigene Sequenznummern, die unabhängig voneinander sind.</p>
<p>Bei einer laufenden Verbindung werden die Sequenznummern inkrementiert und es ist nicht (mehr) erkennbar wer die Verbindung aufgebaut hat.</p>
</div><div class="stack docutils container">
<div class="layer docutils container">
<div class="center-child-elements"><svg width="1200" height="600" viewBox="0 0 1200 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>
    <text x="125" y="75" style="font-weight: bolder">Client</text>
    <line x1="200" y1="100" x2="200" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <text x="925" y="75" style="font-weight: bolder">Server</text>
    <line x1="1000" y1="100" x2="1000" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="200" y1="400" x2="200" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="1000" y1="400" x2="1000" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />

    <text x="500" y="65" transform="rotate(6.6)">SYN(1000)</text>
    <line x1="200" y1="110" x2="1000" y2="190" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
</svg></div></div>
<div class="layer overlay incremental docutils container">
<div class="center-child-elements"><svg height="600" width="1200" viewBox="0 0 1200 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>

    <text x="270" y="300" transform="rotate(-6.6)">SYN(2000), ACK(1001)</text>
    <line x1="1000" y1="200" x2="200" y2="290" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>

</svg></div></div>
<div class="layer overlay incremental docutils container">
<div class="center-child-elements"><svg height="600" width="1200" viewBox="0 0 1200 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>

    <text x="555" y="315" transform="rotate(6.6)">ACK(2001)</text>
    <line x1="200" y1="300" x2="1000" y2="390" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
</svg></div></div>
</div>
</div><div class="ld-slide" id="ports-bei-tcp">
<h2>Ports bei TCP</h2>
<ul class="incremental simple">
<li><p>Port-Nummern werden für die Kommunikation zwischen zwei Diensten/Prozessen verwendet</p></li>
<li><p>Ports sind 16 Bit Zahlen (0-65535)</p></li>
<li><p>(Unix) Ports &lt; 1024 sind privilegiert (nur root kann diese öffnen)</p></li>
<li><p>einige Port-Nummern sind Standarddiensten zugeordnet</p></li>
</ul>
</div><div class="small ld-slide" id="port-nummern-einiger-standarddienste">
<h2>Port-Nummern einiger Standarddienste <a class="footnote-reference brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></h2>
<p><strong>Ungeschützte Dienste</strong></p>
<table class="highlight-line-on-hover">
<colgroup>
<col style="width: 13.3%" />
<col style="width: 80.0%" />
<col style="width: 6.7%" />
</colgroup>
<thead>
<tr><th class="head"><p>Protokoll</p></th>
<th class="head"><p>Dienst</p></th>
<th class="head"><p>Portnummer</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>ftp</p></td>
<td><p>Dateitransfer</p></td>
<td><p>21</p></td>
</tr>
<tr><td><p>smtp</p></td>
<td><p>Simple Mail Transfer Protocol</p></td>
<td><p>25</p></td>
</tr>
<tr><td><p>dns</p></td>
<td><p>Domain Name System</p></td>
<td><p>53</p></td>
</tr>
<tr><td><p>http</p></td>
<td><p>Hypertext Transfer Protocol</p></td>
<td><p>80</p></td>
</tr>
<tr><td><p>login</p></td>
<td><p>Login auf entfernte Rechner</p></td>
<td><p>513</p></td>
</tr>
</tbody>
</table>
<p><strong>Geschützte Dienste</strong></p>
<table class="highlight-line-on-hover">
<colgroup>
<col style="width: 13.3%" />
<col style="width: 80.0%" />
<col style="width: 6.7%" />
</colgroup>
<thead>
<tr><th class="head"><p>Protokoll</p></th>
<th class="head"><p>Dienst</p></th>
<th class="head"><p>Portnummer</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>ssh</p></td>
<td><p>Secure Shell</p></td>
<td><p>22</p></td>
</tr>
<tr><td><p>https</p></td>
<td><p>HTTP über Secure Socket Layer</p></td>
<td><p>443</p></td>
</tr>
<tr><td><p>smtps</p></td>
<td><p>SMTP über Secure Socket Layer</p></td>
<td><p>465</p></td>
</tr>
<tr><td><p>imaps</p></td>
<td><p>IMAP über Secure Socket Layer</p></td>
<td><p>993</p></td>
</tr>
<tr><td><p>pop3s</p></td>
<td><p>POP3 über Secure Socket Layer</p></td>
<td><p>995</p></td>
</tr>
</tbody>
</table>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.iana.org/assignments/service-names-port-numbers">Port numbers assigned by IANA</a></p>
</aside>
</aside>
</div><div class="ld-slide" id="angriffe-auf-tcp-motivation">
<h2>Angriffe auf TCP - Motivation</h2>
<ul class="incremental simple">
<li><p>Netzwerkprogrammierung mit TCP ist relativ komfortabel.</p></li>
<li><p>Viele Dienste sind mit TCP implementiert.</p></li>
<li><p>Angreifer nutzen Schwachstellen in TCP Diensten aus.</p></li>
<li><p>Server haben heutzutage im Allgemeinen alle nicht verwendeten Dienste geschlossen. Ein Angreifer muss verwundbare Dienste zum Beispiel erst durch Port Scans finden.</p></li>
</ul>
</div><div class="ld-slide" id="port-scans-tcp-connect-scan">
<h2>Port Scans: TCP Connect Scan</h2>
<div class="two-columns docutils container">
<div class="column docutils container">
<ul class="incremental simple">
<li><p>vollständiger Verbindungsaufbau zu allen bzw. zu ausgewählten Ports</p></li>
</ul>
<div class="incremental docutils container">
<p><strong>Bewertung</strong>:</p>
<ul class="simple">
<li><p>simpelster Port Scan</p></li>
<li><p>große Entdeckungsgefahr (Scan selbst ist kein Angriff)</p></li>
<li><p>mögliche Verbesserung: zwischen dem Scannen mehrerer Ports Pausen einstreuen (Wie lange?)</p></li>
</ul>
</div>
</div>
<div class="column no-border docutils container">
<svg width="900" height="440" viewBox="0 0 1200 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>
    <text x="125" y="75" style="font-weight: bolder">Scanner</text>
    <line x1="200" y1="100" x2="200" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <text x="925" y="75" style="font-weight: bolder">Server</text>
    <line x1="1000" y1="100" x2="1000" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="200" y1="400" x2="200" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="1000" y1="400" x2="1000" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />

    <text x="500" y="65" transform="rotate(6.6)">SYN</text>
    <line x1="200" y1="110" x2="1000" y2="190" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>

    <text x="390" y="300" transform="rotate(-6.6)">SYN / ACK</text>
    <line x1="1000" y1="200" x2="200" y2="290" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>

    <text x="555" y="315" transform="rotate(6.6)">ACK</text>
    <line x1="200" y1="300" x2="1000" y2="390" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
</svg></div>
</div>
</div><div class="ld-slide" id="port-scans-tcp-syn-scan">
<h2>Port Scans: TCP SYN Scan</h2>
<div class="two-columns docutils container">
<div class="column docutils container">
<ol class="arabic simple incremental">
<li><p>Senden eines TCP-Segments mit gesetztem SYN-Flag an einen Port</p></li>
<li><p>falls der <em>Port offen</em> ist, kommt SYN/ACK zurück danach RST senden</p></li>
<li><p>falls der <em>Port nicht offen</em> ist, kommt RST (oder nichts) zurück</p></li>
</ol>
<div class="incremental docutils container">
<p><strong>Bewertung</strong>:</p>
<ul class="simple">
<li><p>kein vollständiger Verbindungsaufbau</p></li>
<li><p>meist nicht protokolliert</p></li>
<li><p>geringe(re) Entdeckungsgefahr</p></li>
</ul>
</div>
</div>
<div class="column docutils container">
<svg width="900" height="440" viewBox="0 0 1200 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>
    <text x="125" y="75" style="font-weight: bolder">Scanner</text>
    <line x1="200" y1="100" x2="200" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <text x="925" y="75" style="font-weight: bolder">Server</text>
    <line x1="1000" y1="100" x2="1000" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="200" y1="400" x2="200" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="1000" y1="400" x2="1000" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />

    <text x="500" y="65" transform="rotate(6.6)">SYN</text>
    <line x1="200" y1="110" x2="1000" y2="190" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>

    <text x="390" y="300" transform="rotate(-6.6)">SYN / ACK</text>
    <line x1="1000" y1="200" x2="200" y2="290" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>

    <text x="555" y="315" transform="rotate(6.6)">RST</text>
    <line x1="200" y1="300" x2="1000" y2="390" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
</svg></div>
</div>
</div><div class="ld-slide" id="port-scans-stealth-scans">
<h2>Port Scans: Stealth Scans</h2>
<p>Versenden eines für den Verbindungsaufbau ungültigen TCP-Segments an einen Port:</p>
<blockquote>
<ul class="incremental simple">
<li><p>NULL-Scan (keine Flags)</p></li>
<li><p>ACK-Scan (ACK-Flag)</p></li>
<li><p>FIN-Scan (FIN-Flag)</p></li>
<li><p>XMAS-Scan (alle Flags)</p></li>
</ul>
<p class="incremental">Laut RFC kommt RST zurück, falls Port offen. (Reaktion aber abhängig vom Betriebssystem)</p>
</blockquote>
<div class="incremental docutils container">
<p><strong>Bewertung</strong>:</p>
<ul class="simple">
<li><p>Zugriff wird meist nicht protokolliert</p></li>
<li><p>Scan bleibt unbemerkt</p></li>
</ul>
</div>
<div class="supplemental">
<p><strong>XMAS-Scan</strong>:</p>
<p>Bei diesem Scan sind alle Flags gesetzt; ein XMAS-Scan wird auch als Christmas-Tree-Scan bezeichnet, da das Paket erleuchtet ist wie ein Weihnachtsbaum.</p>
</div></div><div class="ld-slide" id="port-scans-idle-scan">
<h2>Port Scans: Idle Scan <a class="footnote-reference brackets" href="#footnote-2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></h2>
<p>Bei allen bisher betrachteten Scans kann der Scanner prinzipiell identifiziert werden. Unter Verwendung eines sog. Zombies geht es auch anders:</p>
<div class="two-columns docutils container">
<div class="column docutils container">
<p>Sondiere IP ID des Zombies:</p>
<img alt="Idle Scan - Schritte 1-2" class="align-left" src="images/idle-scan/idle-scan-step1.svg" style="width: 700px;" />
</div>
<div class="column faded-to-white docutils container">
<p>Starte Scan:</p>
<img alt="Idle Scan - Schritte 3-5" class="align-left" src="images/idle-scan/idle-scan-step2.svg" style="width: 750px;" />
</div>
</div>
<div class="supplemental">
<p>Zombies: ein Rechner (Computer, Drucker oder anderes IoT Gerät) im Internet <em>möglichst ohne eigenen Netzverkehr</em> und mit <em>altem</em> Betriebssystem, bei dem die IP ID in vorhersehbarer Weise inkrementiert wird. (Bei modernen Betriebssystemen ist die IP ID zufällig, <strong>konstant</strong> oder sogar <span class="docutils literal">null</span>.)</p>
<p>Sollte ein Intrusion Detection System vorhanden sein, so wird dieses den Zombie als Angreifer identifizieren.</p>
<p><strong>Grundlegende Idee</strong>: Der Zombie sendet ein RST Paket zurück, da er kein SYN gesendet hat und kein SYN/ACK erwarte. Dadurch erfährt der Angreifer die aktuelle IP ID des Zombies. Über diesen Seitenkanal - d. h. die Veränderung der IP ID des Zombies - kann der Angreifer nun den Zustand des Ports auf dem Zielrechner ermitteln.</p>
</div><aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://nmap.org/book/idlescan.html">NMap Book</a></p>
</aside>
</aside>
</div><div class="ld-slide" id="port-scans-idle-scan-1">
<h2>Port Scans: Idle Scan</h2>
<div class="two-columns docutils container">
<div class="column docutils container">
<p>Starte Scan:</p>
<img alt="Idle Scan - Schritte 3-5" class="align-left" src="images/idle-scan/idle-scan-step2.svg" style="width: 750px;" />
</div>
<div class="column docutils container">
<p>Sondiere IP ID des Zombies:</p>
<img alt="Idle Scan - Schritt 6" class="align-right" src="images/idle-scan/idle-scan-step3.svg" style="width: 700px;" />
</div>
</div>
</div><div class="ld-slide" id="port-scans-idle-scan-zusammenfassung">
<h2>Port Scans: Idle Scan - Zusammenfassung</h2>
<ul>
<li><p>Angreifer sendet SYN/ACK Paket an Zombie</p></li>
<li><p>der Zombie antwortet mit RST und enthüllt seine IP ID (<span class="eng">IP Fragment Identification Number</span>).</p></li>
<li><p>Angreifer sendet SYN (&quot;vom&quot; Zombie) an Port des Servers</p></li>
<li><p>[<strong>Port offen</strong>] Der Zielrechner antwortet mit SYN/ACK an den Zombie, wenn der Port offen ist.</p>
<p>[<strong>Port geschlossen</strong>] Der Zielrechner antwortet mit RST an den Zombie, wenn der Port geschlossen ist. Dies wird vom Zombie ignoriert.</p>
</li>
<li><p>[<strong>Port offen</strong>] Der Zombie antwortet mit RST, da er kein SYN gesendet hat und kein SYN/ACK erwartet und erhöht seine IP ID.</p></li>
<li><p>Der Angreifer sendet wieder ein SYN/ACK an den Zombie, um die IP ID zu erfahren.</p></li>
</ul>
<div class="supplemental">
<p>Mit einem IDLE Scan kann nicht unterschieden werden, ob der Port geschlossen oder gefiltert ist.</p>
</div></div><div class="ld-slide" id="port-scans-mit-nmap">
<h2>Port Scans mit nmap</h2>
<ul class="incremental simple">
<li><p>alle Arten von Port-Scans möglich</p></li>
<li><p>auch OS fingerprinting</p></li>
<li><p>u. U. sogar Ermittlung der Versionsnummern von Diensten</p></li>
</ul>
<pre class="code bash incremental smaller copy-to-clipboard literal-block"><code>$<span class="whitespace"> </span>nmap<span class="whitespace"> </span><span class="literal number">192</span>.168.178.121<span class="whitespace"> </span>-Pn<span class="whitespace">
</span>Starting<span class="whitespace"> </span>Nmap<span class="whitespace"> </span><span class="literal number">7</span>.94<span class="whitespace"> </span><span class="operator">(</span><span class="whitespace"> </span>https://nmap.org<span class="whitespace"> </span><span class="operator">)</span><span class="whitespace"> </span>at<span class="whitespace"> </span><span class="literal number">2023</span>-12-14<span class="whitespace"> </span><span class="literal number">13</span>:16<span class="whitespace"> </span>PST<span class="whitespace">
</span>Nmap<span class="whitespace"> </span>scan<span class="whitespace"> </span>report<span class="whitespace"> </span><span class="keyword">for</span><span class="whitespace"> </span>Michaels-MacBook-Pro<span class="whitespace"> </span><span class="operator">(</span><span class="literal number">192</span>.168.178.121<span class="operator">)</span><span class="whitespace">
</span>Host<span class="whitespace"> </span>is<span class="whitespace"> </span>up<span class="whitespace"> </span><span class="operator">(</span><span class="literal number">0</span>.0056s<span class="whitespace"> </span>latency<span class="operator">)</span>.<span class="whitespace">
</span>Not<span class="whitespace"> </span>shown:<span class="whitespace"> </span><span class="literal number">995</span><span class="whitespace"> </span>filtered<span class="whitespace"> </span>tcp<span class="whitespace"> </span>ports<span class="whitespace"> </span><span class="operator">(</span>no-response<span class="operator">)</span><span class="whitespace">
</span>PORT<span class="whitespace">     </span>STATE<span class="whitespace"> </span>SERVICE<span class="whitespace">
</span><span class="literal number">53</span>/tcp<span class="whitespace">   </span>open<span class="whitespace">  </span>domain<span class="whitespace">
</span><span class="literal number">88</span>/tcp<span class="whitespace">   </span>open<span class="whitespace">  </span>kerberos-sec<span class="whitespace">
</span><span class="literal number">445</span>/tcp<span class="whitespace">  </span>open<span class="whitespace">  </span>microsoft-ds<span class="whitespace">
</span><span class="literal number">5000</span>/tcp<span class="whitespace"> </span>open<span class="whitespace">  </span>upnp<span class="whitespace">
</span><span class="literal number">7000</span>/tcp<span class="whitespace"> </span>open<span class="whitespace">  </span>afs3-fileserver</code></pre>
<div class="supplemental">
<p><strong>OS-Fingerprinting</strong></p>
<p>Beim OS-Fingerprinting werden Datenpakete analysiert, die aus einem Netzwerk stammen, um Informationen für spätere Angriffe zu gewinnen. Durch die Erkennung des Betriebssystems, mit dem ein Netzwerk arbeitet, haben Hacker es leichter, Schwachstellen zu finden und auszunutzen. OS-Fingerprinting kann auch Konfigurationsattribute von entfernten Geräten sammeln. Diese Art von Aufklärungsangriff ist in der Regel (einer) der erste(n) Schritt(e).</p>
<p>Es gibt zwei Arten von OS-Fingerprinting: (1) Aktiv und (2) passiv.</p>
<blockquote>
<ol class="arabic simple">
<li><p>Bei einem aktiven OS-Fingerprinting-Versuch senden die Angreifer ein Paket an das Zielsystem und warten auf eine Antwort, um den Inhalt des TCP-Pakets zu analysieren.</p></li>
<li><p>Bei einem passiven Versuch agieren die Angreifer eher als &quot;Schnüffler&quot;, der keine absichtlichen Änderungen oder Aktionen im Netzwerk vornimmt. Passives OS-Fingerprinting ist ein unauffälligerer, aber wesentlich langsamerer Prozess.</p></li>
</ol>
</blockquote>
</div></div><div class="ld-slide" id="port-knocking">
<h2>Port Knocking</h2>
<ul class="incremental list-with-explanations">
<li><p>Ein Knock-Daemon versteckt offene Ports auf dem Server.</p></li>
<li><p>Zugriffe auf alle Ports werden im Log-File protokolliert.</p></li>
<li><p>Knock-Daemon beobachtet das Log-File.</p></li>
<li><p>Erst nach Erkennen einer vordefinierten (Einmal-)Klopfsequenz öffnet der Knock-Daemon den gewünschten Port für diesen Client.</p></li>
<li><p>Client kann nun die Verbindung aufbauen.</p></li>
<li><p>Weiterentwicklung: TCP Stealth</p>
<p>In diesem Fall werden offene Ports dadurch versteckt, dass sie nur auf spezielle SYN-Pakete mit bestimmten Sequenznummern reagieren. Die Sequenznummern sind ggf. kryptografisch abgesichert und basieren auf vorher ausgetauschten Schlüsseln.</p>
</li>
</ul>
<div class="supplemental">
<p><strong>Weiterführend</strong></p>
<p>Alternativen zu einer Knock-Sequenz ist zum Beispiel, dass der Port nur dann als offen gilt, wenn die IP ID eine bestimmte Sequenznummer aufweist.</p>
<p>M.Krzywinski: Port Knocking: Network Authentication Across Closed Ports in SysAdmin Magazine 12: 12-17. (2003)</p>
</div></div><div class="ld-slide" id="connection-hijacking">
<h2>Connection Hijacking</h2>
<p>Angreifer übernimmt eine bestehende - zum Beispiel eine bereits durch (Einmal-)Passwort authentisierte - Verbindung.</p>
<img alt="Connection Hijacking (einfache Variante)" class="align-center" src="images/connection-hijacking.svg" style="height: 800px;" />
<div class="supplemental">
<p>TCP/IP-Hijacking ist eine Form eines Man-in-the-Middle-Angriffs. Der Angreifer bestimmt erst die IP-Adressen der beiden Sitzungsteilnehmer.</p>
<p>Danach gibt es mehrere Möglichkeiten:</p>
<ul>
<li><p>Der Angreifer schickt (&quot;in einer Pause&quot;) ein Paket mit der passenden Sequenznummer an den Server.</p>
<p><em>(Dies kann dann in einem ACK-Storm enden, was ggf. unterbunden werden muss (zum Beispiel durch das Senden eines RSTs), oder ignoriert werden kann.)</em></p>
</li>
<li><p>Der Angreifer macht einen Client em DoS-Angriff unerreichbar, um sich dann mit dem Anderen zu verbinden, indem er die Netzwerk-ID des ausgeschalteten Clients nutzt.</p></li>
</ul>
</div></div><div class="ld-slide" id="denial-of-service-dos-angriffe">
<h2>Denial-of-Service (DoS) Angriffe</h2>
<p>Ziel des Angreifers: Lahmlegen eines Dienstes oder des ganzen Systems ...</p>
<ul class="simple">
<li><p>durch Ausnutzen von Schwachstellen (<span class="eng">vulnerabilities</span>, z. B. Buffer Overflow)</p></li>
<li><p>durch Generierung von Überlast (Ausschöpfen von RAM, CPU, Netzwerkbandbreite, ...)</p></li>
</ul>
<aside class="admonition incremental smaller">
<p class="admonition-title">Beispiel: Ping-of-Death</p>
<p>(Historisch: aus dem Jahr 1997)</p>
<p>Ein <span class="docutils literal">ping</span> (vgl. Internet Control Message Protocol (ICMP)) verwendet üblicherweise kleine Nachrichten, verwendete Länge ist aber einstellbar.</p>
<p>Falls zu groß ⇒ Buffer Overflow ⇒ Systemabsturz!</p>
<p>Variante: mittels Fragmentierung ließen sich generell übergroße IP-Pakete (&gt;65,536 Byte) erstellen.</p>
</aside>
</div><div class="ld-slide" id="denial-of-service-syn-flooding-angriff">
<h2>Denial-of-Service: SYN-flooding Angriff</h2>
<ul class="incremental">
<li><p>Angriff auf Design</p></li>
<li><p>Angreifer sendet eine Verbindungsaufbauanforderung (gesetztes SYN-Flag) an Zielmaschine</p></li>
<li><p>Server generiert eine halboffene TCP-Verbindung</p></li>
<li><p>Angreifer wiederholt in schneller Folge dieses erste Paket zum Verbindungsaufbau</p>
<p>⇒ vollständiges Füllen der internen Systemtabelle</p>
<p>⇒ Anfragen normaler Benutzer werden zurückgewiesen</p>
</li>
<li><p>Angreifer verwendet i. Allg. IP-Spoofing weswegen Firewalls wirkungslos sind.</p></li>
<li><p>Abwehr: SYN-Cookies</p></li>
</ul>
</div><div class="ld-slide" id="syn-cookies-d-j-bernstein">
<h2><a class="reference external" href="https://cr.yp.to/syncookies.html">SYN-Cookies - D J. Bernstein</a></h2>
<p>SYN-Cookies sind speziell konstruiert initiale Sequenznummern.</p>
<div class="stack">
<div class="layer">
<svg width="1700" height="600" viewBox="0 0 1700 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>
    <text x="125" y="75" style="font-weight: bolder">Client</text>
    <line x1="200" y1="100" x2="200" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="200" y1="400" x2="200" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />

    <text x="925" y="75" style="font-weight: bolder">Server</text>
    <line x1="1500" y1="100" x2="1500" y2="400" style="stroke:rgb(0,0,0);stroke-width:3" />
    <line x1="1500" y1="400" x2="1500" y2="550" stroke-dasharray="5,5" style="stroke:rgb(0,0,0);stroke-width:3" />

    <text x="500" y="75" transform="rotate(4.25)">SYN(1000)</text>
    <line x1="200" y1="110" x2="1500" y2="190" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
</svg></div><div class="layer overlay incremental overlay incremental">
<svg height="600" width="1700" viewBox="0 0 1700 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>

    <text x="270" y="290" transform="rotate(-4.25)">SYN(2000), ACK(with cookie)</text>
    <line x1="1500" y1="200" x2="200" y2="290" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
</svg><div class="smaller docutils container">
<p>Der Cookie ermöglicht es, dass keine Informationen im Speicher gehalten werden müssen. Der Cookie encodiert die Informationen, die der Server benötigt, um die Verbindung aufzubauen: Client IP, time window, etc.</p>
</div>
</div><div class="layer overlay incremental overlay incremental">
<svg height="600" width="1800" viewBox="0 0 1800 600" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker
        id="arrow"
        viewBox="0 0 10 10"
        refX="10"
        refY="5"
        markerWidth="8"
        markerHeight="8"
        orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" />
        </marker>
    </defs>

    <text x="555" y="325" transform="rotate(4.2)">ACK(with cookie(+1))</text>
    <line x1="200" y1="300" x2="1500" y2="390" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>

    <text x="1515" y="340" style="font-size:40px">Validierung</text>
    <text x="1515" y="390" style="font-size:40px">des Cookie</text>
    <line x1="1600" y1="400" x2="1600" y2="455" style="stroke:rgb(0,0,0);stroke-width:3" marker-end="url(#arrow)"/>
    <text x="1515" y="490" style="font-size:40px">ggf. </text>
    <text x="1515" y="540" style="font-size:40px">Verbindungs-</text>
    <text x="1515" y="590" style="font-size:40px">aufbau</text>

</svg></div></div></div><div class="ld-slide" id="distributed-denial-of-service-ddos-angriff">
<h2>Distributed Denial-of-Service (DDoS) Angriff</h2>
<p>Opfer wird von sehr vielen Angreifern mit Nachrichten überflutet.</p>
<div class="incremental docutils container">
<p>Ein Beispiel: Smurf-Angriff:</p>
<img alt="Smurf Angriff" class="align-center" src="images/smurf-angriff.svg" style="height: 800px;" />
</div>
</div><div class="ld-slide" id="distributed-denial-of-service-ddos-angriff-1">
<h2>Distributed Denial-of-Service (DDoS) Angriff</h2>
<ul class="incremental simple">
<li><p>Bot-Netze (Botnetze) werden verwendet, um DDoS-Angriffe durchzuführen.</p></li>
<li><p>Bot-Netze können viele 10.000 Rechner umfassen.</p></li>
<li><p>IoT Geräte sind besonders beliebt (z. B. IP-Kameras, Smart-TVs, Smart-Home Geräte, ...), da diese oft nicht ausreichend geschützt sind und trotzdem permanent mit dem Internet verbunden sind.</p></li>
<li><p>Beliebte Ziele:</p>
<ul>
<li><p>Onlinespieleserver</p></li>
<li><p>Banking-Portale</p></li>
<li><p>politische Webseiten</p></li>
</ul>
</li>
<li><p>Firewalls und Intrusion Detection Systeme sind meist wirkungslos, da die Angriffe von vielen verschiedenen IP-Adressen kommen.</p></li>
</ul>
</div><div class="ld-slide" id="distributed-reflected-denial-of-service-drdos-angriff">
<h2>Distributed-Reflected-Denial-of-Service (DRDoS) Angriff</h2>
<div class="two-columns docutils container">
<div class="column no-separator smaller docutils container">
<ul>
<li><p>Idee:</p>
<ul class="simple">
<li><p>Es wird eine Anfrage an einen Server gesendet, die eine große Antwort auslöst. (Z. B. hat(te) der NTP Monlist Befehl eine Antwort, die ca. 200 Fach größer ist als die Anfrage!)</p></li>
<li><p>Mittels IP-Spoofing wird die IP-Adresse des Opfers als Absenderadresse verwendet.</p></li>
</ul>
<ul class="incremental simple">
<li><p>Es werden insbesondere Dienste basierend auf UDP verwendet, da hier keine Verbindung aufgebaut werden muss.</p></li>
</ul>
</li>
</ul>
</div>
<img alt="DRDoS Angriff" class="align-center" src="images/drdos.svg" style="width: 600px;" />
</div>
<ul class="incremental smaller simple">
<li><p>Nehmen einen signifikanten Teil aller DDoS-Angriffe ein.</p></li>
<li><p>Die Tatsache, dass die Sender legitime Server sind, erschwert die Abwehr.</p></li>
<li><p><span class="eng">Egress Filtering</span> kann helfen, die Verwendung von IP-Spoofing zu verhindern.</p></li>
</ul>
<div class="supplemental">
<p>Bereits im Jahr 2018 wurde ein Angriff er Bandbreite von 1,7 TBit/s beobachtet.</p>
<dl class="field-list simple">
<dt>Egress Filtering<span class="colon">:</span></dt>
<dd><p>Der Router verwirft alle Pakete, die eine Absenderadresse verwenden, die nicht aus dem eigenen Netzwerk stammt.</p>
</dd>
</dl>
</div></div><div class="ld-slide" id="distributed-denial-of-service-ddos-angriffe-beispiel">
<h2><a class="reference external" href="https://cloud.google.com/blog/products/identity-security/google-cloud-mitigated-largest-ddos-attack-peaking-above-398-million-rps">Distributed Denial-of-Service (DDoS) Angriffe - Beispiel</a></h2>
<blockquote class="epigraph">
<p>[...] Google's DDoS Response Team has observed the trend that distributed denial-of-service (DDoS) attacks are <strong>increasing exponentially in size</strong>. Last year, we blocked the largest DDoS attack recorded at the time. This August [2023], we stopped an even larger DDoS attack — 7½ times larger — that also used new techniques to try to disrupt websites and Internet services.</p>
<p>This new series of DDoS attacks reached <strong>a peak of 398 million requests per second (rps)</strong>, and relied on a novel HTTP/2 “Rapid Reset” technique based on stream multiplexing that has affected multiple Internet infrastructure companies. By contrast, last year's largest-recorded DDoS attack peaked at 46 million rps.</p>
</blockquote>
</div><div class="ld-slide" id="distributed-denial-of-service-angriffe-beispiele">
<h2>Distributed Denial-of-Service Angriffe - Beispiele</h2>
<div class="smaller docutils container">
<ul class="simple">
<li><p><strong>TCP Stack Attacks</strong> SYN, FIN, RST, ACK, SYN-ACK, URG-PSH, other combinations of TCP Flags, slow TCP attacks</p></li>
<li><p><strong>Application Attacks</strong>:HTTP GET/POST Floods, slow HTTP Attacks, SIP Invite Floods, DNS Attacks, HTTPS Protocol Attacks</p></li>
<li><p><strong>SSL/TLS Attacks</strong>: Malformed SSL Floods, SSL Renegotiation, SSL Session Floods</p></li>
<li><p><strong>DNS Cache Poisoning</strong></p></li>
<li><p><strong>Reflection Amplification Flood Attacks</strong>: TCP, UDP, ICMP, DNS, mDNS, SSDP, NTP, NetBIOS, RIPv1, rpcbind, SNMP, SQL RS, Chargen, L2TP, Microsoft SQL Resolution Service</p></li>
<li><p><strong>Fragmentation Attacks</strong>: Teardrop, Targa3, Jolt2, Nestea</p></li>
<li><p><strong>Vulnerability Attacks</strong></p></li>
<li><p><strong>Resource Exhaustion Attacks</strong>: Slowloris, Pyloris, LOIC, etc.</p></li>
<li><p><strong>Flash Crowd Protection</strong></p></li>
<li><p><strong>Attacks on Gaming Protocols</strong></p></li>
</ul>
</div>
</div><div class="ld-slide" id="schutz-vor-ddos-angriffen-on-site-robustheitsmasznahmen">
<h2>Schutz vor DDoS-Angriffen - On-Site Robustheitsmaßnahmen</h2>
<ul class="incremental simple">
<li><p>Aufrüsten der Ressourcen (z. B. Bandbreite, CPU, RAM, ...)</p></li>
<li><p>Exemplarische Sofortmaßnahmen bei aktivem Angriff:</p>
<ul class="incremental smaller">
<li><p>Whitelisting von IP-Adressen von besonders wichtigen Clients</p></li>
<li><p>Blacklisting von IP-Adressen aus bestimmten Bereichen</p></li>
<li><p>Captchas</p></li>
<li><p>Überprüfung der Browser-Echtheit</p></li>
</ul>
</li>
<li><p>Anti-DDos Appliances</p></li>
</ul>
<aside class="admonition warning incremental">
<p class="admonition-title">Achtung</p>
<p>Diese Maßnahmen sind häufig teuer und ggf. begrenzt effektiv; wenn der Angriff die verfügbare Brandbreite übersteigt, sind diese Maßnahmen wirkungslos.</p>
</aside>
</div><div class="ld-slide" id="schutz-vor-ddos-angriffen-off-site-robustheitsmasznahmen">
<h2>Schutz vor DDoS-Angriffen - Off-Site Robustheitsmaßnahmen</h2>
<ul class="incremental simple">
<li><p>Einbinden des ISP</p></li>
<li><p>Einbinden spezialisierter Dienstleister (im Angriffsfall wird mittels BGP-Rerouting der Traffic an den Dienstleister umgeleitet, der dann die DDos Attacke filtert.)</p></li>
<li><p>Content-Delivery-Networks (CDNs) für statische Inhalte (z. B. Cloudflare, Akamai, ...)</p></li>
<li><p>Distributed Clouds</p></li>
</ul>
</div><div class="ld-slide" id="password-sniffing">
<h2>Password Sniffing</h2>
<dl class="field-list">
<dt>In der Anfangszeit<span class="colon">:</span></dt>
<dd><p>unverschlüsselte Übertragung von Passwörtern (telnet, ftp, ...)</p>
</dd>
<dt>In der Übergangszeit<span class="colon">:</span></dt>
<dd><p>Verwendung von Einmal-Passwörtern (S/Key, ...)</p>
</dd>
<dt>Heute<span class="colon">:</span></dt>
<dd><p>Passwörter werden verschlüsselt übertragen (ssh, https, ...)</p>
<p>Zusätzliche Absicherung durch Zwei-Faktor-Authentifizierung (basierend auf Einmalpassworten: TOTP, ...)</p>
</dd>
</dl>
<div class="supplemental">
<p>Unverschlüsselte Passworte können leicht mittels eines Sniffers, der den Netzwerkverkehr mitschneidet (z. B. Wireshark), abgefangen werden.</p>
</div></div><div class="ld-slide" id="einmal-passworter">
<h2>Einmal-Passwörter</h2>
<p>Die Idee ist, dass Passwörter nur genau einmal gültig sind und nicht wiederverwendbar sind.</p>
<ul class="simple">
<li><p>Tokens (z. B. RSA SecurID)</p></li>
<li><p>Codebuch: Liste von Einmal-Passwörtern, die das gemeinsame Geheimnis sind.</p></li>
<li><p>S/Key: Passwort <span class="ger-quote">wird mit einem Zähler kombiniert</span> und dann gehasht.</p></li>
</ul>
</div><div class="ld-slide" id="das-s-key-verfahren">
<h2>Das S/Key Verfahren</h2>
<p>Einmal-Passwort-System nach Codebuch-Verfahren, dass im Original auf der kryptographischen Hashfunktion MD4 basiert.</p>
<div class="stack">
<div class="layer">
<p><strong>Initialisierung</strong></p>
<ol class="arabic incremental smaller list-with-explanations">
<li><p>Der Nutzer gibt sein Passwort <span class="math">\(W\)</span> ein; dies ist der geheime Schlüssel.</p>
<p>(Sollte <span class="math">\(W\)</span> bekannt werden, dann ist die Sicherheit des Verfahrens nicht mehr gewährleistet.)</p>
</li>
<li><p>Eine kryptografische Hash-Funktion <span class="math">\(H\)</span> wird n-mal auf <span class="math">\(W\)</span> angewandt, wodurch eine Hash-Kette von n einmaligen Passwörtern entsteht. <span class="math">\(H(W), H(H(W)), \dots, H^{n}(W)\)</span></p></li>
<li><p>Das initiale Passwort wird verworfen.</p></li>
<li><p>Der Benutzer erhält die <span class="math">\(n\)</span> Passwörter, die in umgekehrter Reihenfolge ausgedruckt werden: <span class="math">\(H^n(W), H^{n-1}(W), ..., H(H(W)), H(W)\)</span>.</p></li>
<li><p>Nur das Passwort <span class="math">\(H^n(W)\)</span>, das an erster Stelle der Liste des Benutzers steht, der Wert von <span class="math">\(n\)</span> und ggf. ein Salt, wird auf dem Server gespeichert.</p></li>
</ol>
</div><div class="layer incremental">
<p><strong>Anmeldung</strong></p>
<p>Identifiziere das letzte verwendete Passwort <span class="math">\(n\)</span>.</p>
<ul class="incremental smaller simple">
<li><p>Der Server fragt den Nutzer nach dem Passwort <span class="math">\(n-1\)</span> (d. h. <span class="math">\(H^{n-1}(W)\)</span>) und übermittelt ggf. auch den Salt.</p></li>
<li><p>Der Server hasht das Passwort und vergleicht es dann mit dem gespeicherten Passwort <span class="math">\(H^n(W)\)</span>.</p></li>
<li><p>Ist das Passwort korrekt, dann wird der Nutzer angemeldet und der Server speichert das Passwort <span class="math">\(H^{n-1}(W)\)</span> als neues Passwort <span class="math">\(H^n(W)\)</span> und dekrementiert n.</p></li>
</ul>
</div></div><div class="supplemental">
<p>Intern verwendet S/KEY 64-bit Zahlen. Für die Benutzbarkeit werden diese Zahlen auf sechs kurze Wörter, von ein bis vier Zeichen, aus einem öffentlich zugänglichen 2048-Wörter-Wörterbuch (<span class="math">\(2048 = 2^{11}\)</span>) abgebildet. Zum Beispiel wird eine 64-Bit-Zahl auf &quot;ROY HURT SKI FAIL GRIM KNEE&quot; abgebildet.</p>
</div></div><div class="ld-slide" id="hmac-based-one-time-password-hotp">
<h2>HMAC-based one-time password (HOTP)<a class="footnote-reference brackets" href="#footnote-3" id="footnote-reference-3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></h2>
<ul>
<li><p>ermöglicht die Erzeugung von Einmal-Passwörtern auf Basis eines geheimen Schlüssels und eines Zählers; Parameter:</p>
<blockquote>
<ul class="incremental far-smaller simple">
<li><p>Ein kryptografisches Hash-Verfahren <span class="math">\(H\)</span> (Standard ist SHA-1)</p></li>
<li><p>einen geheimen Schlüssel <span class="math">\(K\)</span>, der eine beliebige Bytefolge ist</p></li>
<li><p>Ein Zähler <span class="math">\(C\)</span>, der die Anzahl der Iterationen zählt</p></li>
<li><p>Länge des Passworts: <span class="math">\(d\)</span> (6-10, Standardwert ist 6, empfohlen werden 6-8)</p></li>
</ul>
</blockquote>
</li>
</ul>
<ul class="incremental">
<li><p>Zur Authentifizierung berechnen beide das Einmalpasswort (HOTP) und dann vergleicht der Server den Wert mit dem vom Client übermittelten Wert:</p>
<div class="far-smaller docutils container">
<p>Berechnung aus dem Schlüssel <span class="math">\(K\)</span> und dem Zähler <span class="math">\(C\)</span>:</p>
<blockquote>
<p class="incremental"><span class="math">\(HOTP(K, C) = truncate(HMAC_H(K, C))\)</span></p>
<div class="incremental docutils container">
<p><span class="math">\(truncate(MAC) = extract31(MAC, MAC[(19 \times  8 + 4):(19 \times  8 + 7)])\)</span></p>
</div>
<p class="incremental"><span class="math">\(HOTP\; value = HOTP(K, C)\; mod\; 10^d\qquad\)</span> (führende Nullen werden nicht abgeschnitten)</p>
</blockquote>
</div>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.rfc-editor.org/rfc/rfc4226">https://www.rfc-editor.org/rfc/rfc4226</a></p>
</aside>
</aside>
<div class="supplemental">
<p><span class="math">\(truncate\)</span> verwendet die 4 niederwertigsten Bits des MAC als Byte-Offset i in den MAC.
Der Wert <span class="math">\(19\)</span> kommt daher, dass ein SHA-1 <span class="math">\(160\)</span> Bit hat und <span class="math">\(160/8 = 20\)</span> Byte.</p>
<p>Eine Schwäche des Algorithmus ist, dass beide Seiten den Zähler erhöhen müssen und, falls die Zähler aus dem Tritt geraten, ggf. eine Resynchronisation notwendig ist.</p>
</div></div><div class="ld-slide" id="time-based-one-time-password-totp">
<h2>Time-based one-time password (TOTP)<a class="footnote-reference brackets" href="#footnote-4" id="footnote-reference-4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a></h2>
<ul class="simple">
<li><p>Erzeugung von zeitlich limitierten Einmal-Passwörtern (z. B. 30 Sekunden)</p></li>
</ul>
<ul class="incremental list-with-explanations">
<li><p>Basierend auf einem vorher ausgetauschten geheimen Schlüssel und der aktuellen Zeit</p>
<p>Z. B. Unix-Zeit in Sekunden (ganzzahlig) und danach gerundet auf 30 Sekunden.</p>
</li>
<li><p>Es wird das HOTP Verfahren mit der Zeit als Zähler verwendet und entweder SHA-256 oder SHA-512 als Hashverfahren, d. h. TOTP <span class="math">\(value(K)\)</span> = HOTP <span class="math">\(value(K, C_T)\)</span>, wobei <span class="math">\(T\)</span> die <span class="ger-quote">aktuelle Zeit</span> ist.</p>
<p><span class="math">\(C_T = \lfloor { T - T_0 \over T_X } \rfloor\)</span></p>
<ul class="simple">
<li><p><span class="math">\(T_X\)</span> ist die Länge eines Zeitintervalls (z. B. 30 Sekunden)</p></li>
<li><p><span class="math">\(T\)</span> ist die aktuelle Zeit in Sekunden seit einer bestimmten Epoche</p></li>
<li><p><span class="math">\(T_0\)</span> ist bei Verwendung der Unix-Zeit <span class="math">\(0\)</span></p></li>
<li><p><span class="math">\(C_T\)</span> ist somit die Anzahl der Dauern <span class="math">\(T_X\)</span> zwischen <span class="math">\(T_0\)</span> und <span class="math">\(T\)</span></p></li>
</ul>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-4">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.rfc-editor.org/rfc/rfc6238">https://www.rfc-editor.org/rfc/rfc6238</a></p>
</aside>
</aside>
<div class="supplemental">
<p>Das verfahren verlangt somit, dass die Uhren von Server und Client (hinreichend) synchronisiert sind.</p>
</div></div><div class="ld-slide" id="secure-shell-ssh">
<h2><a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc4254">Secure Shell (SSH)</a></h2>
<p><strong>Verschlüsselte Verbindung</strong></p>
<p>SSH ermöglicht die sichere Fernanmeldung von einem Computer bei einem anderen (typischerweise über TCP über Port 22). Es bietet mehrere Optionen für eine starke Authentifizierung und schützt die Sicherheit und Integrität der Kommunikation durch starke Verschlüsselung</p>
<div class="incremental docutils container">
<p><strong>Ablauf</strong></p>
<ol class="arabic simple">
<li><p>Authentisierung des Server-Rechners</p></li>
<li><p>Authentisierung des Benutzers (bzw. des Clients) mittels</p>
<ol class="loweralpha simple">
<li><p>Passwort</p></li>
<li><p><span class="obsolete">.rhosts-Eintrag</span></p></li>
<li><p>privatem <span class="minor">(RSA-)</span>Key (hauptsächlich verwendete Methode)</p></li>
</ol>
</li>
<li><p>Kommunikation über symmetrisch verschlüsselte Verbindung</p></li>
</ol>
</div>
<div class="supplemental">
<p>Die Authentifizierung mittels eines Schlüsselpaars dient primär der Automatisierung (dann wird auch keine <span class="ger-quote">Schlüsselphrase</span> zum Schutz des Passworts verwendet). Auf jeden Fall ist effektives Schlüsselmanagement erforderlich:</p>
<blockquote class="epigraph">
<p>[...] In einigen Fällen haben wir mehrere Millionen SSH-Schlüssel gefunden, die den Zugang zu Produktionsservern in Kundenumgebungen autorisieren, wobei 90 % der Schlüssel tatsächlich ungenutzt sind und für einen Zugang stehen, der zwar bereitgestellt, aber nie gekündigt wurde.</p>
<p class="attribution">—<a class="reference external" href="https://www.ssh.com/academy/ssh/protocol">SSH.com (Dez. 2023)</a></p>
</blockquote>
</div></div><div class="ld-slide" id="secure-shell-ssh-protokoll">
<h2>Secure Shell (SSH) - Protokoll</h2>
<img alt="SSH Protokoll" class="align-center" src="images/ssh/initiation.svg" style="width: 1850px;" />
<div class="incremental small docutils container">
<p>Beide Seiten haben einen Public-private Key Schlüsselpaar zur Gegenseitigen Authentifizierung</p>
<dl class="field-list simple">
<dt>User Keys<span class="colon">:</span></dt>
<dd><ul class="simple">
<li><p><span class="docutils literal">Authorized keys</span> - Serverseitige Datei mit den öffentlichen Schlüsseln der Nutzer</p></li>
<li><p><span class="docutils literal">Identity keys</span> - private Schlüssel der Nutzer</p></li>
</ul>
</dd>
<dt>Host keys<span class="colon">:</span></dt>
<dd><p>dienen der Authentifizierung von Servern (verhindern Man-in-the-Middle-Angriffe)</p>
</dd>
<dt>Session Keys<span class="colon">:</span></dt>
<dd><p>werden für die symmetrische Verschlüsselung der Daten in einer Verbindung verwendet. Session Keys (<span class="ger">Sitzungsschlüssel</span>) werden während des Verbindungsaufbaus ausgehandelt.</p>
</dd>
</dl>
</div>
<div class="supplemental">
<p>Im Falle von SSH gibt es kein initiales Vertrauen zwischen Server und Client.</p>
</div></div><div class="ld-slide" id="secure-shell-ssh-verbindungsaufbau-beispiel">
<h2>Secure Shell (SSH) - Verbindungsaufbau - Beispiel</h2>
<div class="scrollable docutils container">
<pre class="code text far-far-smaller literal-block"><code>debug1: Reading configuration data /etc/ssh/ssh_config
debug1: Applying options for *
debug1: Connecting to example.org [1.2.3.4] port 22.
debug1: Connection established.
debug1: identity file /home/user/.ssh/id_rsa type -1
debug1: identity file /home/user/.ssh/id_rsa-cert type -1
debug1: identity file /home/user/.ssh/id_dsa type -1
debug1: identity file /home/user/.ssh/id_dsa-cert type -1
debug1: Remote protocol version 1.99, remote software version OpenSSH_5.8
debug1: match: OpenSSH_5.8 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.5p1 Debian-6
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server-&gt;client aes128-ctr hmac-md5 none
debug1: kex: client-&gt;server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024&lt;1024&lt;8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Host 'example.org' is known and matches the RSA host key.
debug1: Found key in /home/user/.ssh/known_hosts:1
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,password,keyboard-interactive,hostbased
debug1: Next authentication method: publickey
debug1: Trying private key: /home/user/.ssh/id_rsa
debug1: Trying private key: /home/user/.ssh/id_dsa
debug1: Next authentication method: keyboard-interactive
debug1: Authentications that can continue: publickey,password,keyboard-interactive,hostbased
debug1: Next authentication method: password
user&#64;example.org's password:
debug1: Authentication succeeded (password).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions&#64;openssh.com
debug1: Entering interactive session.
debug1: Sending environment.
debug1: Sending env LANG = en_US.UTF-8</code></pre>
</div>
</div><div class="ld-slide" id="secure-shell-ssh-risiken-durch-mangelnde-schlusselverwaltung">
<h2>Secure Shell (SSH) - Risiken durch mangelnde Schlüsselverwaltung</h2>
<ul class="incremental simple">
<li><p>Schlüssel werden nicht regelmäßig ausgetauscht</p></li>
<li><p>Schlüssel werden nicht gelöscht, wenn sie nicht mehr benötigt werden</p></li>
<li><p>viele (die meisten) Schlüssel werden nicht verwendet</p></li>
<li><p>Es ist oft nicht bekannt, wer Zugriff auf welche Schlüssel hat(te)</p></li>
<li><p>Es ist nicht bekannt, welche Schlüssel auf welche Systeme Zugriff haben</p></li>
<li><p>Malware kann SSH-Schlüssel stehlen</p></li>
<li><p>SSH Keys können ggf. privilegierten Zugriff gewähren</p></li>
<li><p>SSH Keys können benutzt werden, wenn um Backdoors zu verstecken</p></li>
<li><p>Server keys erlauben ggf. Man-in-the-Middle-Angriffe</p></li>
</ul>
</div><div class="ld-slide" id="ssh-tunneling">
<h2>SSH Tunneling</h2>
<ul>
<li><p>ermöglicht die Übertragung beliebiger Netzwerkdaten über eine verschlüsselte SSH-Verbindung. z. B.</p>
<ul class="simple">
<li><p>um ältere Anwendungen zu verschlüsseln.</p></li>
<li><p>um VPNs (Virtual Private Networks) zu implementieren.</p></li>
<li><p>um über Firewalls hinweg auf Intranetdienste zuzugreifen.</p></li>
</ul>
</li>
<li><p>ermöglicht auch Port-forwarding</p>
<p><span class="far-smaller">(Lokale Ports werden auf entfernten Rechner weitergeleitet.)</span></p>
</li>
</ul>
<img alt="SSH Protokoll" class="align-center" src="images/ssh/tunneling.svg" style="width: 1450px;" />
</div><div class="ld-slide" id="ssh-und-back-tunneling">
<h2>SSH und <span class="ger-quote">Back-tunneling</span></h2>
<ul class="incremental simple">
<li><p>Der Angreifer richtet einen Server außerhalb des Zielnetzwerks ein</p></li>
<li><p>Nach Infiltration des Zielsystems verbindet der Angreifer sich von innen mit dem externen SSH-Server.</p></li>
<li><p>Diese SSH-Verbindung wird so eingerichtet, das eine TCP-Port-Weiterleitung von einem Port auf dem externen Server zu einem SSH-Port auf einem Server im internen Netzwerk möglich ist.</p></li>
<li><p>Die meisten Firewalls bieten wenig bis gar keinen Schutz dagegen.</p></li>
</ul>
<div class="supplemental">
<p>Es ist in diesem Fall besonders interessant für den Angreifer den SSH Server zum Beispiel bei einem Cloud-Anbieter zu betreiben, welcher von dem Unternehmen  standardmäßig verwendet wird (am Anfang steht immer die Aufklärung!). In diesem Fall wird die Firewall keine ausgehenden SSH-Verbindungen dorthin blockieren.</p>
</div></div><div class="ld-slide" id="schwachstellen-in-ssh">
<h2>Schwachstellen in SSH</h2>
<blockquote class="epigraph">
<p><strong>Nearly 11 million SSH servers vulnerable to new Terrapin attacks</strong></p>
<p>[...]
It [The Terrapin attack] manipulates sequence numbers during the handshake process to compromise the integrity of the SSH channel, particularly when specific encryption modes like ChaCha20-Poly1305 or CBC with Encrypt-then-MAC are used.
[...]</p>
<p>By Bill Toulas</p>
<p class="attribution">—<a class="reference external" href="https://www.bleepingcomputer.com/news/security/nearly-11-million-ssh-servers-vulnerable-to-new-terrapin-attacks/">January 3, 2024 10:06 AM</a></p>
</blockquote>
</div><div class="integrated-exercise transition-move-left ld-slide" id="ubung">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="1" data-exercise-title="1 - Port Scans - IDLE Scan" id="ld-exercise-1">
<p class="rubric">Port Scans - IDLE Scan</p>
<ul class="simple">
<li><p>Warum kann bei einem IDLE Scan nicht festgestellt werden warum ein Port geschlossen oder gefiltert ist?</p></li>
<li><p>Welchen Wert hat die IP ID des Zombies, der einem IDLE Scan durchführt, wenn der Zielport offen bzw. geschlossen ist, wenn der Scanner diesen wieder abfragt?</p></li>
</ul>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:gKjd0x2hxHD1Re3kTYdpNybK9r+IwF0CDjiKcMcJBr4=:ZE5aQVnks7T3Yks0:3oq10YBTlOu+KM7FGcCTjb+dbpg2/Ny6SjO27ZNoM663XQ78C53uWms7AqnJWtULsy5hvd6aeztCkCCQweuE+BmdpY97Ngbv3BaaQONLq5PPCvPJsf2+1jKA2Pb6DxJK14x/P5HUy+gDTQuvJE1Vww0UcBv51VQAuysqjTF+WZL+RnUSlAzX7YFyA3+jyBUitathL7XX+gn3a8hSZmK6ZfN0zwVeIjGLV000o7ysWxJq0caYcDzLJl/wEQxcULDBJUcK+q6ayYzFjfg3kR1ZKbzer2YS7CbtUXn5JWlI41qnYrsBijgnS2ByCmoP/h5ShfjKKVleBz6hSVk2H88wlW0eSdNMttzOzXeKbiOcsiOaYbs134r/aCH4/PCZSzzQVkUS14QtQIK+Bwcqt3PU6wGwM6hotEjZbBgBXQ16QQIcuyQ3KvNnbsGmwOQMw2BnmiruOhv3m/E9ClyR0egwCuZWbLRL2uifkIdtfbwC+gWDTVpOtj76c9ZQtZTVG5imHefZ0Ky1Nr9HEHs01mMyaT3kFTYLdYz3VMNrrbaZwKnnZdT8a36+M/0V/4n2hVu5dtaNZexOzvh9xaYs6Xo79wArp07WnpKtFZH/Wm1YQOE95fdb2KkbAA/WLojf2ksDbC0xdMr96jZdlbhuFntGKbjhrOMlwcAQpvkc561p2lu2JV87mICpQVtoc7D8GnG+yonnez6v0A==</div>
</div>
</div><div class="integrated-exercise transition-move-left ld-slide" id="ubung-1">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="2" data-exercise-title="2 - S/Key" id="ld-exercise-2">
<p class="rubric">S/Key</p>
<ol class="arabic simple">
<li><p>Welche Vorteile bieten Einmalpasswortsysteme gegenüber Systemen mit mehrfach zu verwendenden Passworten?</p></li>
<li><p>Welchen Angriffen sind Einmalpasswortsysteme weiterhin ausgesetzt?</p></li>
<li><p>Generieren Sie eine Liste von Einmalpassworten mit Initialwert <span class="math">\(r = 769\)</span>. Generieren Sie <span class="math">\(H(r)\)</span> bis <span class="math">\(H^6(r)\)</span> wenn die Einwegfunktion hier der Einfachheit halber <span class="math">\(H(x) = x^2\; mod\; 1000\)</span> ist.</p></li>
<li><p>Wie oft kann sich der Benutzer anmelden? Wie sieht seine Liste aus?</p></li>
<li><p>Welchen Wert speichert der Server vor dem ersten Anmeldevorgang?</p></li>
<li><p>Spielen Sie zwei Anmeldevorgänge durch.</p></li>
<li><p>Wenn ein Passwort <span class="math">\(H^L(W), 1 &lt; L &lt; N\)</span> bekannt ist, welche Auswirkungen hat dies auf die Sicherheit des Verfahrens?</p></li>
</ol>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:ZmgvZiHCitv9FxOV0TjrZHVdzLtclBpLCKLyVPfYfzw=:PZS1oaSscxhYGBMS:6vFg2JgaiYaLkdcPplET79lDo5C+7BMsI8wcS4C9LMGhKd3lQ3qJPjOGSMWJ17TBB0HEdsd8OpaeZbYlkzv+pAyXXd5t8rtG3YcaGB3ehINxXHzZ8fGQt6kstDMQfx2GXgV/wuLmk3BwF0fI877mkVSITWyqzutVMI537+JaLvmDQvF/IFX3JowlSSgDlmbtP0+k5FM2nx7kyqvFnghrclEU+RhLzGV8ersTPN1hPFufLJlcARHNmG7UlbD4AY0HUwVgITDs2uV7/d5v1JAVeFM9frGwJ6Bjd94bbNITIfUIsJmd7qZ7L+wwBVEjd3AxMl6mmfiQGWcpzwFoBSzmONO+UfApcep6adVU+S2SZlZoszMGsy9WW9CnuYdXZ0V9jgEg1A3WJH3Z/MHEDqEXWxFZzXfqGoD9MuYouyet8VtgtuLrcANVYC5qj1SzqBfD3eBKB+kBn6vj6ckiigphngBhcEVLttnVFsWggZInXNsyzJAzvFrUibWAny6hXlD+ivm92aCTx9+mbMslcShu9tWV8dNJtXrM/w9NH8cLPJNWig/kck3/hmeoW4uZRt2AvtsiLvu7wr7RV+xPUDNzU+4h4GQgWjnlvBXMOW4TsWKy+NG4+I9+YIfepFbRoUPko4GetsnoDK0QHCHFJXJQS3U3JY/wHaas2b7CjBJqZz95XIHL4xrJlnT43fYKXuTzlHnGxcE+19ByGKDQhwfSSeo4lQs1SkWXjKJOuRvarqwKaKxhw/g3TVlcFyuhtZe8rytkePRrnvVe7IzuSATyp4miUWxk+vkMuXpwe6mEmhP9kCbTSFu1C+ZTDW345d4WnDbrihN2l1SkR1kVOcROfdHp024xgYxRhAeFgeRuUu8k5XNYbiq7K9EP64yLmEDVybxy/aKCtFyGkemHIzsbIntKWZgIB2uDvP52m/elxqVbvEOc+S4JUyCRpHFd6h5LEk+ef6MBR1EtA+1zthrqyY/99Lr7mFHssqx1/wSVhQWI2XCy4CGRRqfmygpgKgv5oRrS6deWh6byOD7w6JYTbvJIi3Ew4Fy/jxzbhEIj1VcQMKM2n5OpK31w5Rk4N7ygy9EfWzPs+SwxKitCn2e3BhyCxe+NY02c6ouWi07tHCk+/hN0+yWrsxmYUGQ4YUF5o1y8UNol11GY23BbB8TjHMMTJnjEYh6TQzi2vZN4ZItAZqTJ5ggVXRoEOVcS0SdZN3R6/mBCdF+yE/jgWQAVgd1IPwIGOFuI6xD9/IvDoTZ7JXKcZW+ZLtI9QBD1Y5dfYi67G08Rbq2S0bJK7kBzU20h02d5RqHyvuLTVU9oicQ3tybJfkR6ZjxlDEcJQ1buylOB+CPD7qd6wbqMJkNoNsfdDDwWoPaFznFqn4QPoCaKcFX1pgaqcEAKseSp+VXn9fTjfIbPLCboVR5/HovtK/iPf20E79Etfe+qsC6sI6MATVNTED4wVZoEdZW2+gT40PnL/Pce9MyPJYnR1vAAhn7FRDQDqIaooou65pH3aSbOlGWe5uDcX+iq1dEuQtDSAQZg5Rl76ymZ7ZDmYZ9hMbxkgXYVLxAzjBtlpiEytT47aKArImhTbjta9+YaZ49fdVyu9uCzvVs9e/dwLk7iZ+GGo399lrUhZdJA8ISNZSX7IJnCUMMGD0vA4zbLHIDI2356C3bxm+NhZhJEh7tnJTgajrlKhUfVgxciBUGr7H6ha+N17GJzSWhiP6e+FQBEFXRuPFoR2xKswQF1pJz99Vd5EJ/QDAzcZ9bZt/utIXyhwPAY2h9TuFWp4ykkNg==</div>
</div>
</div><div class="integrated-exercise transition-move-left ld-slide" id="ubung-2">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="3" data-exercise-title="3 - TOTP" id="ld-exercise-3">
<p class="rubric">TOTP</p>
<p>Identifizieren Sie die Vor- und Nachteile von TOTP gegenüber S/Key und fragen Sie sich an welcher Stelle es (aus Sicherheitsperspektive) mögliche Schwächen gibt?</p>
<p>Die Standardzeitspanne ist 30 Sekunden. Welcher Konsequenzen hätte eine deutliche Verlängerung bzg. Verkürzung der Zeitspanne?</p>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:3NAjvStjM3Cc7moeyIsEoEWsxRyjse4T6LJAS/GRsPg=:HInKlAVPFlrZ6+oq:veZFL2+v0O9MMTmngafIn/ayM+9UMQbeV2dGs0iuBMOIxixDueJQZdZB6Zviv8ivhz0nzodT2bDnbJbYrS3Ut8/3Sa2JK6kJA063su0VWMLIPTCS0sYLeymeL0m0xQ9ETBrCuTOF/tnmh1UQW/Aks8qVK/DmU+NvpIQNhi8leiHzJ+reu2ZqugYmeBJo53pYMYXpuM6NpQogw/Ofp0seYTQGMYEWkkN4BiNKXXzmMubyUZGqRJX7D5eS5cCQhdFHNf+tA3kKra31njQoPIU+BMfQ0AGghBXZSmT4nRqN4cg7IYK6MCLjXUENuWba5aGky5BGznYmvT/Qvb0SpcspwC1/nnZwfn0+uGYrzkeS/o2w+KNtknuOYyEksDKyLifk9O2lsif30s6kOJEWppRRcKf/Zhh14BKr2l+QTKjNp5izqPav512TbF5zLhV7ReiBneIlwkFH8RRXHFtnZsgtVQ7ixcPz7uYIHxZ9k3FB5X5XRbGKMPiMyI8O0dEys636Oatm8HWfKxLGCPb9XQGjKyGxSnnvdnQVBbYeDdiOuck8Pj0Gn+1wkaH4Mqs2a8F4ynWA2LTbzpkPRlwnKvKLOf7O0WGn0MFM2qWydlpay8Qo4m1riSZKAfnCpvVCeoEW+9/wAwn6j+q+FEHByWeT066gukTtcQioq8bTjb/9LHl0OpqXzM/3fmnilHx+vX+9NjkXKmHTzgT5lWUzzUdPFLQdbjKAtrTdNfHfPkaKNgy7EiZyOjRKureHu/5UXe3qkKLbhiqBhCfhD5OPbdgueX6okb/5L1K1r279MnM2CHwKb8lB+wNs02VBqZ9HRvMwA5CnSiu8hBNY0dFhkXLwwdaeULXepk9AIN9J3C4zqApZ1ZqENEbRQuUTZPZQZAobN+Qpq9GYpviJflEygqMcE00IvBkjEjvYz94EyBx+1WHs4kHt32Cm8QdDsKweIRWVLarUFjtQOCsAd719atczCaqVH/M5mnniFR1ZhWhDGRPOjR/igsPbpp2jNUs4gUSfflaV2BHj6GqnKXEqwK8aw8XbUM83RnqvWManOoNOdb4u+153yBaQYsj8bXNek4+pU+PkQ8JBHxPCYUTYjBAt1tj32fWEqrCk7uQZ7MaLImxoCIWhMsh1JqJJgrqTOaIMyuX8b/5RXVyt+VkbiOw75kkXHNdrYFvJ1oFNbw4wl6LWT3CXFKRKi9QQvtVEldI8cppYGzwpatzXtI3Ye7WQFjEzNqjSYyxGsomwMHOc6ztOwNFR1ue4FPDPeJdGtNqVn7XouxQ/t5obiAIQ2rbH9N0gokIYRCyk1UoULHIYJhgOYjRsz8HPVpeR7v8KxX0rDe2Y9sRt4fTrKkUgnH0xuXoMDQcDBlw4AkvWKeifknje18J3aXHhHY4kTSAyKk0sbi4S/DnejNohrtP9DCHg4gzlmG5vOSbx+ez+/G8I6hpYVUQ8nV77r3QzR1zQQyOk0pZltZ/Kltz0BqSSBupCt33W7pQjvTX91gItPLX9DsBBc4408vgY6HnWnpZpJbYfARGA26g3iXlyBH/vmtbV/94/u61XzaHDFWW33mFpAN8FmBvI0Tt2M+kqMsF4MSMpm4SKM2NAcjrOJNn0HuxwRIO5U6Wyuh3ZSG5QqYLH</div>
</div>
</div><div class="integrated-exercise transition-move-left ld-slide" id="ubung-3">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="4" data-exercise-title="4 - DDoS" id="ld-exercise-4">
<p class="rubric">DDoS</p>
<ol class="arabic simple">
<li><p>Welches Problem entsteht wenn zum Schutze vor Angriffen auf die Verfügbarkeit die Ressourcen von IT-Systemen und deren Internet-Anbindung erhöht werden?</p></li>
<li><p>Recherchieren Sie was ein <span class="ger-quote">Low and Slow Angriff</span> ist.</p></li>
<li><p>Wo kann überall <span class="ger-quote">Egress filtering</span> statt finden.</p></li>
</ol>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:+QhQkXtElp3bCVvdspU8D86KnQC93SEhaDEQAN1vJT0=:7cY7oMI0w/GB6mc+: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</div>
</div>
</div><div class="new-section transition-fade ld-slide" id="firewalls">
<h2>Firewalls</h2>
</div><div class="ld-slide" id="unabhangiges-netz-ideale-situation">
<h2>Unabhängiges Netz - <span class="ger-quote">Ideale Situation</span></h2>
<img alt="Ideale Situation" class="align-center" src="images/firewalls/all-save.svg" style="height: 700px;" />
<dl class="field-list simple">
<dt>Vorteile<span class="colon">:</span></dt>
<dd><ul class="simple">
<li><p>keinerlei Angriffsmöglichkeiten von außen</p></li>
</ul>
</dd>
<dt>Nachteile<span class="colon">:</span></dt>
<dd><ul class="simple">
<li><p>kein Schutz gegen Insider</p></li>
<li><p>kein Zugang zum Internet</p></li>
</ul>
</dd>
</dl>
<div class="supplemental">
<p>Wie bereits diskutiert gibt es auch Angriffsmuster gegen Air-Gapped-Systeme. Ein Beispiel ist der Stuxnet-Wurm, der sich initial über USB-Sticks verbreitet.</p>
</div></div><div class="ld-slide" id="von-der-notwendigkeit-des-schutzes-von-rechnern">
<h2>Von der Notwendigkeit des Schutzes von Rechnern</h2>
<blockquote class="epigraph">
<p>[...] Züger und sein Team hätten [...] erst kürzlich ein Experiment durchgeführt, [...]. Sie hätten einen Computer &quot;ohne jeglichen Schutz&quot; mit dem Internet verbunden, um zu sehen, wie lange es dauere, bis er befallen sei. Konkrete Details zur Konfiguration dieses Systems werden zwar nicht genannt, angeblich war der Rechner aber schon nach 20 Minuten infiltriert.</p>
<p class="attribution">—<a class="reference external" href="https://www.golem.de/news/iot-hacker-missbrauchen-zahnbuersten-fuer-ddos-angriffe-2402-181921.html">Golem.de 6.2.2024</a></p>
</blockquote>
</div><div class="ld-slide" id="schutzschicht-zwischen-internem-und-externem-netz">
<h2>Schutzschicht zwischen internem und externem Netz</h2>
<img alt="Schutzschicht zwischen internem und externem Netz" class="align-center" src="images/firewalls/firewall.svg" style="height: 770px;" />
<ul class="simple">
<li><p>Kontrolle des Nachrichtenverkehrs durch Filterung</p></li>
<li><p>begrenzte Isolation mit begrenztem Schutz</p></li>
</ul>
<div class="supplemental">
<p>Eine Firewall schafft zwischen verbundenen Netzen Sicherheitsdomänen mit unterschiedlichem Schutzbedarf. Eine wichtige Teilaufgabe ist das Ausarbeiten von Sicherheitsrichtlinien.</p>
</div></div><div class="ld-slide" id="realisierung-von-virtual-private-networks-vpn">
<h2>Realisierung von Virtual Private Networks (VPN)</h2>
<img alt="Realisierung von Virtual Private Networks (VPN)" class="align-center" src="images/firewalls/vpn.svg" style="width: 1500px;" />
<ul class="simple">
<li><p>Aufbau einer scheinbar privaten Verbindung von Firmenteilnetzen über das (öffentliche) Internet</p></li>
<li><p>Zusätzliche Verbindungsverschlüsselung zwischen den Firewalls.</p></li>
</ul>
<div class="supplemental">
<p>Ziel ist es aktive und passive Angriffe zu unterbinden.
Selbst bei verschlüsselten Verbindungen kann die Verkehrsflussanalyse noch Informationen liefern über die Verbindungen liefern.</p>
</div></div><div class="ld-slide" id="kommerzielle-vpns-fur-endnutzer">
<h2>Kommerzielle VPNs für Endnutzer</h2>
<img alt="Einsatz von Virtual Private Networks (VPN) für Privatnutzer" class="align-center" src="images/firewalls/vpn-commercial.svg" style="width: 1400px;" />
<div class="supplemental">
<p><strong>Motivation</strong></p>
<ul class="simple">
<li><p>Schutz der Privatsphäre; der ISP kennt nicht mehr die Webseiten, die man aufruft</p></li>
<li><p>Die IP-Adresse des Nutzers ist den aufgerufenen Webseiten nicht mehr bekannt und kann deswegen der Umgehung von Geo-Blocking dienen.</p></li>
</ul>
<p><strong>Nachteile?</strong></p>
<ul class="simple">
<li><p>Vertrauen in den VPN-Anbieter muss vorhanden sein. Insbesondere, beim Einsatz zum Stärken der Privatsphäre, muss der VPN-Anbieter vertrauenswürdig sein und sollte ein so genannter &quot;no-log&quot; Anbieter sein. Es gibt auch (kostenlose) VPN-Anbieter, die die Daten der Nutzer verkaufen (ehemals: <a class="reference external" href="https://techcrunch.com/2019/02/21/facebook-removes-onavo/?guccounter=1&amp;guce_referrer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8&amp;guce_referrer_sig=AQAAAGVIppEgEOd9Z0FoMbmk2TCleRmD9wCMWDmIzGYEjIo1c7Cmz8NpiSoibthFG5IZQzmZ-kiJq-5Wj1bj21byh7YUrC_aSJJk1Bapwz80GSgzLFS-LHCF2OOetUYLSKwEG7W75znuqJJBJcNTTbtJ1UGB95Yu90saK9aIIkEywcRq">Facebook Onavo</a>).</p></li>
</ul>
</div></div><div class="ld-slide" id="schutz-auf-den-schichten-des-tcp-ip-stacks">
<h2>Schutz auf den Schichten des TCP/IP Stacks</h2>
<p>Zentraler Schutz des gesamten internen Netzwerks durch:</p>
<ul class="incremental">
<li><p>Paket Filter (<span class="eng">Packet Filtering</span>)</p>
<ul>
<li><p>Blockieren bestimmter IP-Empfänger-Adressen (extern / intern)</p></li>
<li><p>Blockieren bestimmter IP-Absender-Adressen (extern / intern)</p>
<p><span class="minor">(z. B. aus dem Internet mit internen IP-Absender-Adressen.)</span></p>
</li>
<li><p>Blockieren bestimmter Dienste; ggf. nur für bestimmte IP-Adressen</p></li>
</ul>
</li>
<li><p>Filter auf Anwendungsebene (<span class="eng">Application-level Filtering</span>)</p>
<ul class="simple">
<li><p>inhaltsbezogene Filterung der Verkehrsdaten eines Dienstes</p></li>
<li><p>z. B. Virenfilter</p></li>
<li><p>wirkungslos bei verschlüsselten Verkehrsdaten</p></li>
</ul>
</li>
<li><p>Protokollierungsmöglichkeit der Kommunikation von / nach extern</p></li>
</ul>
<div class="supplemental">
<p>Firewalls (alleine) können die Struktur des Netzwerks nicht verbergen.</p>
</div></div><div class="smaller ld-slide" id="dos-attacke-auf-anwendungsebene">
<h2>DoS Attacke auf Anwendungsebene</h2>
<blockquote class="epigraph">
<p>[...]</p>
<p>Angriff auf die Kleinen</p>
<p>Waren bei früheren Spamangriffen massenhaft Accounts auf der größten Mastodon-Instanz <span class="docutils literal">mastodon.social</span> angelegt worden, die dann von dort ihre Inhalte verbreiteten, trifft es nun nicht die größte, sondern die kleinsten. Automatisiert werden dabei Instanzen ausgesucht, auf denen eine Registrierung ohne Überprüfung und sogar ohne ein Captcha möglich ist. Das können etwa solche mit wenigen Accounts sein, die von Enthusiasten etwa für eine Gemeinde betrieben werden. Waren die Verantwortlichen in den vergangenen Tagen nicht aufmerksam, wurden diese Instanzen dann regelrecht überrannt. Die Spam-Accounts verschickten massenhaft Nachrichten mit einem Bild des namensgebenden Frühstücksfleischs und Links zu Discord-Servern, die wohl lahmgelegt werden sollten.</p>
<p class="attribution">—<a class="reference external" href="https://www.heise.de/news/Mastodon-Spamwelle-zeigt-Schwaechen-auf-und-weckt-Sorge-vor-schlimmerer-Methode-9632055.html">Mastodon: Spamwelle zeigt Schwächen auf [...]</a></p>
</blockquote>
</div><div class="ld-slide" id="realisierungsmoglichkeiten-von-firewalls">
<h2>Realisierungsmöglichkeiten von Firewalls</h2>
<ul class="incremental simple">
<li><p>Hardware-Firewall</p>
<ul>
<li><p>Screening Router</p></li>
<li><p>Application Gateway (auch Bastion Host)</p>
<ul>
<li><p>Proxy-Server für bestimmte Dienste</p></li>
<li><p>Client-Software (HTTP-Browser, telnet, ftp, ...)</p></li>
<li><p>Server-Software</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Software-Firewall (<em>Personal Firewall</em>)</p></li>
</ul>
<div class="supplemental">
<p>Im Falle eines <span class="eng">Bastion Host</span>, ist dies der einzige unmittelbar erreichbare Rechner.</p>
</div><!-- .. class:: vertical-title -->
</div><div class="ld-slide" id="dual-homed-host">
<h2>Dual-Homed Host</h2>
<img alt="Dual-Homed Host" class="margin-1em align-right" src="images/firewalls/dual-homed-host.svg" style="width: 800px;" />
<p><strong>Aufbau</strong></p>
<ul class="simple">
<li><p>zwei Netzwerkkarten: ggf. private interne Adressen</p></li>
<li><p>Screening Router &amp; Gate: Packet Filter und Application-Level Filter</p></li>
<li><p>Proxy-Dienste installieren</p></li>
<li><p>Benutzer-Logins von extern</p></li>
<li><p>Konf. der Netzwerkkarten: IP-Pakete nicht automat. weiterleiten</p></li>
</ul>
</div><div class="ld-slide" id="screening-router">
<h2>Screening Router</h2>
<div class="two-columns no-default-width docutils container">
<div class="column no-separator docutils container">
<p><strong>Aufbau</strong></p>
<ul class="simple">
<li><p>programmierbarer Hardwarerouter</p></li>
<li><p>simple Filterfunktionen:</p></li>
<li><p>nur Paket-Header prüfen</p></li>
<li><p>schnelle Auswertung ermöglicht hohen Durchsatz</p></li>
<li><p>Realisierung eines Packet Filters</p></li>
</ul>
<p><strong>Bewertung</strong></p>
<div class="two-columns docutils container">
<div class="column no-separator docutils container">
<ul class="positive-list simple">
<li><p>einfach und billig</p></li>
<li><p>flexibel</p></li>
</ul>
</div>
<div class="column docutils container">
<ul class="negative-list simple">
<li><p>schwer zu testen</p></li>
<li><p>Protokollierung</p></li>
<li><p>Fernwartung</p></li>
<li><p>keine Inhaltsfilterung</p></li>
</ul>
</div>
</div>
</div>
<div class="column docutils container">
<img alt="Screening Router" class="margin-1em align-center" src="images/firewalls/screening-router.svg" style="width: 600px;" />
</div>
</div>
</div><div class="ld-slide" id="screened-host">
<h2>Screened Host</h2>
<img alt="Screened Host" class="margin-1em padding-left-1em align-right" src="images/firewalls/screened-host.svg" style="height: 900px;" />
<p><strong>Aufbau</strong></p>
<ul class="simple">
<li><p>Screening Router blockiert:</p>
<ul>
<li><p>Pakete von / an interne Rechner (nicht Gate)</p></li>
<li><p>Source-Routed Pakete</p></li>
</ul>
</li>
<li><p>von extern nur Gate sichtbar</p></li>
<li><p>Pakete von intern nur via Gate</p></li>
<li><p>Gate bietet Proxy-Server (z. B. für E-Mail)</p></li>
</ul>
<div class="supplemental">
<p>Gibt es für eine bestimmte Anwendung kein Application-level Proxy, dann kann auf einen für TCP/UDP generischen Proxy zurückgegriffen werden. Dieser arbeitet auf dem Session Layer und kann nur die Header-Informationen auswerten. Es handelt sich dann um ein <span class="eng">Circuit-level Proxy/Gateway</span>. Im Vergleich zu einem Application-level Proxy ist die Sicherheit geringer, da der Circuit-level Proxy nicht in der Lage ist, die Daten zu interpretieren.</p>
<p>Ein allgemeines Problem ist, dass viele Anwendungen auf generische Protokolle wie HTTP aufsetzen. Weiterhin betreiben einige Anwendungen <span class="ger-quote">Port Hopping</span>, d. h. sie wechseln den Port wenn der Standardport nicht offen ist.</p>
<p>Eine Anforderung an <span class="ger-quote">Next-generation Firewalls</span> ist, dass diese die Analyse von den Daten einer Anwendung unabhängig vom Port und Protokoll ermöglichen.</p>
</div></div><div class="ld-slide" id="konfiguration-eines-gateways">
<h2>Konfiguration eines Gateways</h2>
<p>Das Ziel der Konfiguration muss eine minimale angreifbare Oberfläche sein.</p>
<ul class="incremental simple">
<li><p>Abschalten aller nicht-benötigten Netzdienste</p></li>
<li><p>Löschen aller nicht benötigter Programme</p></li>
<li><p>Rechte von /bin/sh auf 500 setzen</p></li>
<li><p>Rechte aller Systemverzeichnisse auf 711 setzen</p></li>
<li><p>keine regulären Benutzerkennungen</p></li>
<li><p>root-Login mit Einmal-Passwortsystem</p></li>
<li><p>setzen von Platten- und Prozess-Quotas</p></li>
<li><p>volle Protokollierung, möglichst auf Hardcopy-Gerät</p></li>
<li><p>möglichst sichere, stabile und regelmäßig aktualisierte Betriebssystemversion einsetzen</p></li>
</ul>
</div><div class="ld-slide" id="screened-subnet">
<h2>Screened Subnet</h2>
<img alt="Screened Subnet" class="align-right" src="images/firewalls/screened-subnet.svg" style="width: 950px;" />
<p><strong>Aufbau</strong></p>
<ul class="incremental simple">
<li><p>interner Screening Router als weiterer Schutzwall</p>
<ul>
<li><p>blockiert Dienste, die nicht einmal bis zum Gate gelangen sollen</p></li>
<li><p>lässt nur Pakete zum / vom Gate durch</p></li>
</ul>
</li>
<li><p>äußeres Netz realisiert Demilitarisierte Zone (DMZ) für HTTP-Server, Mail-Server, ...</p></li>
</ul>
</div><div class="ld-slide" id="intrusion-detection-systeme-ids">
<h2>Intrusion Detection Systeme (IDS)</h2>
<aside class="admonition admonition-definition">
<p class="admonition-title">Definition</p>
<p>Ein IDS ist ein Gerät (meist ein speziell konfigurierter Rechner), das vielfältige Techniken zur Erkennung von Angriffen anwendet und Angriffe meldet und ggf. abwehrt, in dem (z. B.) die Firewall automatisch umkonfiguriert wird.</p>
</aside>
<div class="incremental docutils container">
<p><strong>Motivation</strong></p>
<ul class="incremental simple">
<li><p>Firewalls alleine sind zu statisch und deswegen häufig nicht ausreichend</p></li>
<li><p>bessere Aufzeichnung und flexiblere Erkennung notwendig</p></li>
<li><p>angepasste Reaktion notwendig</p></li>
</ul>
</div>
<div class="incremental docutils container">
<p><strong>Umsetzung</strong></p>
<p>An verschiedenen, neuralgischen Stellen werden spezielle Sensoren platziert, die (hier) den Netzwerkverkehr überwachen und verdächtige Aktivitäten melden.</p>
</div>
<div class="supplemental">
<p>Miteinander verwandt bzw. typischerweise in einem Produkt zu finden:</p>
<ul class="simple">
<li><p>Intrusion Detection (IDS)</p></li>
<li><p>Intrusion Response (IRS)</p></li>
<li><p>Intrusion Prevention (IPS)</p></li>
</ul>
</div></div><div class="ld-slide" id="ids-erkennungstechniken">
<h2>IDS-Erkennungstechniken</h2>
<ul class="simple">
<li><p>Signaturerkennung</p></li>
<li><p>statistische Analyse</p></li>
<li><p>Anomalieerkennung</p></li>
</ul>
<aside class="admonition incremental">
<p class="admonition-title">Probleme</p>
<ul class="simple">
<li><p>Fälschlicherweise gemeldete Angriffe (false positives)</p></li>
<li><p>nicht gemeldete Angriffe (false negatives) (insb. bei neuartigen Angriffen)</p></li>
<li><p>Echtzeitanforderung, insb. bei Hochgeschwindigkeitsnetzen</p></li>
<li><p>Aufzeichnung bei Netzwerken mit Switches ( ⇒ spez. SPAN Port)</p></li>
<li><p>Sensoren sollen unbeobachtbar sein (stealth)</p></li>
</ul>
</aside>
</div><div class="integrated-exercise transition-move-left ld-slide" id="ubung-4">
<h2>Übung</h2>
<div class="ld-exercise" data-exercise-id="5" data-exercise-title="5 - Firewalls" id="ld-exercise-5">
<p class="rubric">Firewalls</p>
<ol class="arabic simple">
<li><p>Was sind Vorteile eines Dual Homed Host gegenüber einem Paketfilter? Was sind die Nachteile?</p></li>
<li><p>Benennen Sie zwei konzeptionelle Grenzen von Firewalls. D. h. zwei Szenarien gegen die Firewalls nicht schützen können.</p></li>
<li><p>Für welche der folgenden Cybersicherheitsstrategien können Firewalls eingesetzt werden:</p>
<ol class="arabic simple">
<li><p>Angriffe vermeiden</p></li>
<li><p>Angriffe erkennen</p></li>
<li><p>Angriffe abwehren/Angriffen entgegenwirken</p></li>
<li><p>Reaktion auf Angriffe</p></li>
</ol>
</li>
<li><p>Sie werden beauftragt die Firewall so einzurichten, dass Mails mit Schadsoftware nicht durchgelassen werden. Wie reagieren Sie?</p></li>
</ol>
<div class="ld-exercise-solution" data-encrypted="true">
MTAwMDAw:Kh7lNq7EFVTrowf7br86PbqT2MJ9/qa5WW1Lhm2UU48=:8gc5/QkFVMjZIkKw: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</div>
</div>
</div>
</template>
</body>
</html>
