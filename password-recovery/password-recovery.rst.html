<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="LD2 0.1" />
<meta content="Michael Eichberg" name="author" />
<meta content="&quot;IT Sicherheit&quot;, Passwortwiederherstellung" name="keywords" />
<meta content="Fortgeschrittene Angewandte IT Sicherheit" lang="de" name="description" xml:lang="de" />
<meta content="2023_11-w3wi_se403_passwort_wiederherstellung" name="id" />
<meta content="last-viewed" name="first-slide" />
<title>Passwortwiederherstellung</title>
<script type="text/javascript" src="../LectureDoc2/ext/mathjax/es5/tex-chtml.js?config=TeX-AMS_CHTML"></script>
<link rel="stylesheet" href="../LectureDoc2/normalize.css" type="text/css" />
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: G√ºnter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 9079 2022-06-19 14:00:56Z milde $                                                               */
/* :Copyright: ¬© 2015, 2021 G√ºnter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.2em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* ‚Ä¶, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
/* inline images */
p img, p video, figure img, figure video {
  display: inline;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: G√ºnter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 9338 2023-04-08 21:08:47Z milde $                                                               */
/* :Copyright: ¬© 2015 G√ºnter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
  --field-indent: 9em; /* default indent of fields in field lists */
}
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45‚Ä¶75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
div.line-block,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes and Topics */
bockquote { margin: 1em 2em; }
blockquote p.attribution,
.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
.footnote-list {
  border-left: solid thin;
  padding-left: 0.25em;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
video.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
video.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
  margin-left: 1em;
  margin-right: -1%;
  background-color: #fffffa;
}


/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* https://docutils.sourceforge.io/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math */
/* for math-output=MathML (for math-output=HTML, see math.css) */
math .boldsymbol {
  font-weight: bold;
}
mstyle.mathscr, mi.mathscr {
  font-family: STIX, XITSMathJax_Script, rsfs10,
               "Asana Math", Garamond, cursive;
}

/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal {¬†white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a[role="doc-noteref"] */
/* Citation References    */
/*   a.citation-reference */

</style>
    <script src="../LectureDoc2/ld-animations.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-help.js" type="text/javascript"></script>
    <script src="../LectureDoc2/ld-core.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../LectureDoc2/ld.css" type="text/css" />
    <link rel="stylesheet" href="../LectureDoc2/themes/DHBW/theme.css" type="text/css" />
</head>
<body>
<div class="ld-slide" id="slide0">
<h1 class="title">Passwortwiederherstellung</h1>

<div class="line-below docutils container">
<p>a.k.a. Password-Cracking</p>
</div>
<dl class="footnotesize margin-above field-list simple">
<dt>Dozent<span class="colon">:</span></dt>
<dd><p><strong>Prof. Dr. Michael Eichberg</strong></p>
</dd>
<dt>Kontakt<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="mailto:michael.eichberg&#64;dhbw-mannheim.de">michael.eichberg&#64;dhbw-mannheim.de</a></p>
</dd>
<dt>Version<span class="colon">:</span></dt>
<dd><p>2023-12-11</p>
</dd>
</dl>
</div>
<div class="ld-slide" id="vorerfahrungen">
<h2>Vorerfahrungen?</h2>
<ul class="incremental more-space-between-list-items simple">
<li><p>Wer hat schon einmal Passworte wiederhergestellt?</p></li>
<li><p>Wer hat Erfahrung mit Linux?</p></li>
<li><p>Wer hat Erfahrung mit Linux Kommandozeilenwerkzeugen f√ºr die Textverarbeitung?</p></li>
<li><p>Wer hat Erfahrung mit regul√§ren Ausdr√ºcken?</p></li>
<li><p>Wer hat Erfahrung mit Python?</p></li>
<li><p>Wer hat Erfahrung mit Java (Reverse Engineering)?</p></li>
</ul>
</div><div class="ld-slide" id="was-ist-passwortwiederherstellung">
<h2>Was ist Passwortwiederherstellung?</h2>
<p>Passwortwiederherstellung ist der Prozess, der dazu dient ein nicht (mehr) vorhandenes Passwort wiederzuerlangen.</p>
<aside class="topic line-above red incremental">
<p class="topic-title">Haftungsausschluss</p>
<blockquote class="epigraph">
<p>Wer unbefugt sich oder einem anderen Zugang zu Daten, die nicht f√ºr ihn bestimmt und die gegen unberechtigten Zugang besonders gesichert sind, unter √úberwindung der Zugangssicherung verschafft, wird mit Freiheitsstrafe bis zu drei Jahren oder mit Geldstrafe bestraft.</p>
<p class="attribution">‚Äî¬ß 202 a Abs. 1 StGB</p>
</blockquote>
</aside>
</div><div class="ld-slide" id="ist-passwortwiederherstellung-noch-relevant">
<h2>Ist Passwortwiederherstellung noch relevant?</h2>
<div class="three-columns docutils container">
<div class="column no-separator docutils container">
<img alt="Android Smartphone" class="incremental align-center" src="logos/android.webp" style="height: 575px;" />
</div>
<div class="column no-separator docutils container">
<img alt="Cryptostick" class="incremental align-center" src="logos/cryptostick.jpg" style="height: 400px;" />
<p class="center-text-in-div incremental"><span class="xxl">üõú</span></p>
</div>
<div class="column docutils container">
<img alt="Filevault Logo" class="incremental align-center" src="logos/filevault.webp" style="height: 300px;" />
<img alt="Veracrypt Logo" class="incremental align-center" src="logos/veracrypt.webp" style="height: 200px;" />
</div>
</div>
<div class="incremental margin-above line-above docutils container">
<p>Klassische Passw√∂rter werden (noch immer) in zahlreichen Bereichen verwendet. Beispiele sind Smartphones, Cryptosticks, Logins f√ºr Computer und Serversysteme, verschl√ºsselte Dateien und Datentr√§ger.</p>
</div>
<div class="supplemental docutils container">
<p><strong>Hintergrund</strong></p>
<p>Obwohl an vielen Stellen versucht wird Passw√∂rter aus vielen Gr√ºnden zur√ºck zu dr√§ngen, so ist die Verwendung noch allgegenw√§rtig und in machen Bereichen ist auch nicht unmittelbar eine Abl√∂sung zu erkennen.</p>
<p>Biometrie ist zum Beispiel in machen Bereichen kein Ersatz f√ºr Passw√∂rter und wird - wenn √ºberhaupt - nur erg√§nzend genommen. So ist es zum Beispiel im deutschen Recht erlaubt/m√∂glich einem Beschuldigten sein Smartphone bei Bedarf vor das Gesicht zu halten, um es zu entsperren. Je nach Qualit√§t des Fingerabdrucksensors k√∂nnen ggf. auch genommene Fingerabdr√ºcke verwendet werden. M√∂chte der Beschuldigte jedoch das Passwort nicht freiwillige nennen, dann besteht keine direkte weitere Handhabe.</p>
</div>
</div><div class="ld-slide" id="ist-passwortwiederherstellung-nicht-trivial">
<h2>Ist Passwortwiederherstellung nicht <span class="ger-quote">trivial</span>?</h2>
<img alt="An AI just cracked your password." class="shadow align-center" src="logos/home_security_heroes.webp" style="height: 800px;" />
<p><span class="line-above">An AI just cracked your password.</span></p>
<p><a class="reference external" href="https://www.homesecurityheroes.com/ai-password-cracking/assets/pdf/hsh-an-ai-just-cracked-your-password-infographic.pdf">Home Security Heroes</a></p>
</div><div class="ld-slide" id="wiederherstellung-von-passwortern-mit-unterschiedlicher-komplexitat">
<h2>Wiederherstellung von Passw√∂rtern mit unterschiedlicher Komplexit√§t</h2>
<p>Beurteilen Sie die Qualit√§t der folgenden Passw√∂rter in Hinblick darauf wie aufw√§ndig es ist das Passwort wiederherzustellen:</p>
<ol class="arabic simple incremental smaller">
<li><p>Donaudampfschifffahrt</p></li>
<li><p>Passwort</p></li>
<li><p>ME01703138541</p></li>
<li><p>2wsx3edc4rfv</p></li>
<li><p>Haus Maus</p></li>
<li><p>iluvu</p></li>
<li><p>Emily18</p></li>
<li><p>MuenchenHamburg2023!!!!</p></li>
<li><p>hjA223dn4fw&quot;√º√§K√ü√ü k`‚â§-~ajsdk</p></li>
<li><p>Baum Lampe Haus Steak Eis Berg</p></li>
<li><p>password123</p></li>
</ol>
</div><div class="center-elements-on-slide ld-slide" id="section-1">
<h2></h2>
<aside class="admonition incremental warning">
<p class="admonition-title">Warnung</p>
<p>Es ist nie eine Option Passw√∂rter im Klartext zu speichern.</p>
</aside>
</div><div class="new-section transition-fade ld-slide" id="kryptografische-hashfunktionen-und-passworter">
<h2>Kryptografische Hashfunktionen und Passw√∂rter</h2>
</div><div class="ld-slide" id="hashfunktionen-wiederholung">
<h2>Hashfunktionen (Wiederholung)</h2>
<ul class="incremental simple">
<li><p>Eine Hashfunktion <span class="math">\(H\)</span> akzeptiert eine beliebig lange Nachricht <span class="math">\(M\)</span> als Eingabe und gibt einen Wert fixer Gr√∂√üe zur√ºck: <span class="math">\(h = H(M)\)</span>.</p></li>
<li><p>Wird oft zur Gew√§hrleistung der Datenintegrit√§t verwendet. Eine √Ñnderung eines beliebigen Bits in <span class="math">\(M\)</span> sollte mit hoher Wahrscheinlichkeit zu einer √Ñnderung des Hashwerts <span class="math">\(h\)</span> f√ºhren.</p></li>
<li><p>Kryptographische Hashfunktionen werden f√ºr Sicherheitsanwendungen ben√∂tigt. M√∂gliche Anwendungen:</p>
<ul>
<li><p><span class="not-important">Authentifizierung von Nachrichten</span></p></li>
<li><p><span class="not-important">Digitale Signaturen</span></p></li>
<li><p>Speicherung von Passw√∂rtern</p></li>
</ul>
</li>
</ul>
</div><div class="ld-slide" id="beispiel-berechnung-von-md5-hashwerten">
<h2>Beispiel: Berechnung von MD5 Hashwerten</h2>
<pre class="monospaced literal-block">md5(&quot;Hello&quot;) = 8b1a9953c4611296a827abf8c47804d7
md5(&quot;hello&quot;) = 5d41402abc4b2a76b9719d911017c592
md5(&quot;Dieses Passwort ist wirklich total sicher
      und falls Du es mir nicht glaubst, dann
      tippe es zweimal hintereinander blind
      fehlerfrei ein.&quot;)
             = 8fcf22b1f8327e3a005f0cba48dd44c8</pre>
<aside class="admonition warning incremental margin-above">
<p class="admonition-title">Warnung</p>
<p>Die Verwendung von MD5 dient hier lediglich der Illustration. In realen Anwendung sollte MD5 auf keinen Fall mehr verwendet werden.</p>
</aside>
<div class="supplemental docutils container">
<p><strong>Kollisionen bei Hashes</strong></p>
<p>Wenn ein Passwort <span class="ger-quote">nur</span> als Hash gespeichert wird, dann gibt es zwangsl√§ufig Kollisionen und es k√∂nnte dann theoretisch passieren, dass ein Angreifer (zuf√§llig) ein v√∂llig anderes Passwort findet, dass bei der √úberpr√ºfung des Passworts akzeptiert wird. Die Konstruktion kryptografischer Hashfunktionen stellt jedoch sicher, dass dies in der Praxis nicht auftritt.</p>
</div>
</div><div class="ld-slide" id="sicherheitsanforderungen-an-kryptografische-hashfunktion-i">
<h2>Sicherheitsanforderungen an kryptografische Hashfunktion I</h2>
<dl class="field-list simple">
<dt>Pseudozuf√§lligkeit<span class="colon">:</span></dt>
<dd><p>Die Ausgabe von <span class="math">\(H\)</span> erf√ºllt die Standardtests f√ºr Pseudozuf√§lligkeit.</p>
</dd>
</dl>
<dl class="incremental field-list">
<dt>Einweg Eigenschaft<span class="colon">:</span></dt>
<dd><p>Es ist rechnerisch/praktisch nicht machbar f√ºr einen gegeben Hashwert <span class="math">\(h\)</span> ein <span class="math">\(N\)</span> zu finden so dass gilt: <span class="math">\(H(N) = h\)</span></p>
<p>(<span class="eng">Preimage resistant; one-way property</span>)</p>
</dd>
</dl>
</div><div class="ld-slide" id="sicherheitsanforderungen-an-kryptografische-hashfunktion-ii">
<h2>Sicherheitsanforderungen an kryptografische Hashfunktion II</h2>
<dl class="field-list">
<dt>Schwache Kollisionsresistenz<span class="colon">:</span></dt>
<dd><p>Es ist rechnerisch nicht machbar f√ºr eine gegebene Nachricht M eine Nachricht N zu finden so dass gilt: <span class="math">\(M \neq N\)</span> mit <span class="math">\(H(M) = H(N)\)</span></p>
<p>(<span class="eng">Second preimage resistant; weak collision resistant</span>)</p>
</dd>
</dl>
<dl class="incremental field-list">
<dt>Starke Kollisionsresistenz<span class="colon">:</span></dt>
<dd><p>Es ist rechnerisch unm√∂glich ein paar <span class="math">\((N,M)\)</span> zu finden so dass gilt: <span class="math">\(H(M) = H(N)\)</span>.</p>
<p>(<span class="eng">Collision resistant; strong collision resistant</span>)</p>
</dd>
</dl>
<div class="supplemental docutils container">
<p><strong>Hintergrund</strong></p>
<p>Im Deutschen wird auch von Urbild-Angriffen gesprochen. In dem Fall ist <em>preimage resistance</em> (d.h. die Einweg Eigenschaft) gleichbedeutend damit, dass man nicht effektiv einen <span class="ger-quote">Erstes-Urbild-Angriff</span> durchf√ºhren kann. Hierbei ist das Urbild die urspr√ºngliche Nachricht <span class="math">\(M\)</span>, die <em>gehasht</em> wurde.</p>
<p><em>Second preimage resistance</em> ist dann gleichbedeutend damit, dass man nicht effektiv einen <span class="ger-quote">Zweites-Urbild-Angriff</span> durchf√ºhren kann. Es ist nicht m√∂glich zu einer Nachricht M eine zweite Nachricht N (d.h. ein zweites Urbild) zu finden, die f√ºr eine gegebene Hashfunktion den gleich Hash aufweist.</p>
</div>
</div><div class="ld-slide" id="beziehung-zwischen-den-sicherheitsanforderungen-an-hashfunktionen">
<h2>Beziehung zwischen den Sicherheitsanforderungen an Hashfunktionen</h2>
<img alt="Beziehung zwischen den Eigenschaften von Hashfunktionen" class="align-center" src="graffles/beziehung_zwischen_eigenschaften_von_hashfunktionen.svg" style="width: 1200px;" />
</div><div class="ld-slide" id="anforderungen-an-die-resistenz-von-hashfunktionen">
<h2>Anforderungen an die Resistenz von Hashfunktionen</h2>
<table class="smaller highlight-line-on-hover incremental">
<thead>
<tr><th class="head"></th>
<th class="head"><p>Preimage Resistant</p></th>
<th class="head"><p>Second Preimage Resistant</p></th>
<th class="head"><p>Collision Resistant</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Hash + Digitale Signaturen</p></td>
<td><p>‚úì</p></td>
<td><p>‚úì</p></td>
<td><p>‚úì</p></td>
</tr>
<tr><td><p>Einbruchserkennung und Viruserkennung</p></td>
<td></td>
<td><p>‚úì</p></td>
<td></td>
</tr>
<tr><td><p>Hash + Symmetrische Verschl√ºsselung</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Passwortspeicherung</p></td>
<td><p>‚úì</p></td>
<td></td>
<td></td>
</tr>
<tr><td><p>MAC</p></td>
<td><p>‚úì</p></td>
<td><p>‚úì</p></td>
<td><p>‚úì</p></td>
</tr>
</tbody>
</table>
<div class="supplemental docutils container">
<p><strong>Hintergrund</strong></p>
<p>Ein Kollisionsangriff erfordert weniger Aufwand als ein <em>preimage</em> oder ein <em>second preimage</em> Angriff.</p>
<p>Dies wird durch das Geburtstagsparadoxon erkl√§rt. W√§hlt man Zufallsvariablen aus einer Gleichverteilung im Bereich von <span class="math">\(0\)</span> bis <span class="math">\(N-1\)</span>, so √ºbersteigt die Wahrscheinlichkeit, dass ein sich wiederholendes Element gefunden wird, nach <span class="math">\(\sqrt{N}\)</span> Auswahlen <span class="math">\(0,5\)</span>. Wenn wir also f√ºr einen m-Bit-Hashwert Datenbl√∂cke zuf√§llig ausw√§hlen, k√∂nnen wir erwarten, zwei Datenbl√∂cke innerhalb von <span class="math">\(\sqrt{2^m} = 2^{m/2}\)</span> Versuchen zu finden.</p>
<aside class="admonition smaller">
<p class="admonition-title">Beispiel</p>
<p>Es ist relativ einfach, √§hnliche Meldungen zu erstellen. Wenn ein Text 8 Stellen hat, an denen ein Wort mit einem anderen ausgetauscht werden kann, dann hat man bereits <span class="math">\(2^{8}\)</span> verschiedene Texte.</p>
<p>Es ist relativ trivial(1), vergleichbare(2) Nachrichten(3) zu schreiben(4). Wenn ein Text 8 Stellen hat, an denen ein Ausdruck(5) mit einem vergleichbaren (6) ausgetauscht werden kann, dann erh√§lt(7) man bereits <span class="math">\(2^{8}\)</span> verschiedene Dokumente(8).</p>
</aside>
</div>
</div><div class="ld-slide" id="effizienzanforderungen-an-kryptografische-hashfunktionen">
<h2>Effizienzanforderungen an kryptografische Hashfunktionen</h2>
<dl class="field-list simple">
<dt>Effizienz bei der Verwendung f√ºr Signaturen und zur Authentifizierung<span class="colon">:</span></dt>
<dd><p>Bei der Verwendung zur Nachrichtenauthentifizierung und f√ºr digitale Signaturen ist <span class="math">\(H(N)\)</span> f√ºr jedes beliebige <span class="math">\(N\)</span> relativ einfach zu berechnen. Dies soll sowohl Hardware- als auch Softwareimplementierungen erm√∂glichen.</p>
</dd>
</dl>
<div class="incremental docutils container">
<div class="center-text-in-div bold huge docutils container">
<p>vs.</p>
</div>
<dl class="field-list simple">
<dt>Brute-Force-Angriffe auf Passw√∂rter erschweren<span class="colon">:</span></dt>
<dd><p>Bei der Verwendung f√ºr das Hashing von Passw√∂rtern soll es schwierig sein den Hash effizient zu berechnen, selbst auf spezialisierter Hardware (GPUs, ASICs).</p>
</dd>
</dl>
</div>
</div><div class="ld-slide" id="kryptografische-hashfunktionen-fur-passworte">
<h2>Kryptografische Hashfunktionen f√ºr Passworte</h2>
<ul class="incremental smaller more-space-between-list-items simple">
<li><p>Bekannte kryptografische Hash-Funktionen: <span class="obsolete">MD4</span>, <span class="obsolete">MD5</span>, SHA-256, SHA-512, RIPE-MD, ...</p></li>
<li><p>Bekannte Funktion zur Schl√ºsselableitung: PBKDF2, ...</p></li>
<li><p>Beim Hashing von Passw√∂rtern werden die Basisalgorithmen in der Regel mehrfach (ggf. viele hunderttausend Male) angewendet, um die Laufzeit zu verl√§ngern und es f√ºr Angreifer schwieriger zu machen.</p></li>
<li><p>Mehrere Hash-Algorithmen/Schl√ºsselableitungsfunktionen wurden ausdr√ºcklich f√ºr das Hashing von Passw√∂rtern entwickelt, um g√§ngigen Angriffen zu widerstehen. Z.B. bcrypt, scrypt, Argon2.</p></li>
<li><p>Einige dieser Algorithmen sind so rechenintensiv, dass sie nicht f√ºr Webanwendungen/Situationen geeignet sind, in denen viele Benutzer gleichzeitig autorisiert werden m√ºssen. Diese Algorithmen werden in der Regel zum Schutz von Dateien, Containern oder lokaler Festplatten verwendet.</p></li>
</ul>
</div><div class="ld-slide" id="vom-salzen-salt">
<h2>Vom Salzen (<span class="eng">Salt</span>) ...</h2>
<div class="small docutils container">
<p><strong>Beobachtung/Problem</strong></p>
<p>Werden Passw√∂rter direkt mit Hilfe einer kryptografischen Hashfunktion gehasht, dann haben zwei Nutzer, die das gleiche Passwort verwenden, den gleichen Hash.</p>
<table class="tiny">
<thead>
<tr><th class="head"><p>User</p></th>
<th class="head"><p>Hash</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Alice</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',salt='',rounds=1000) =
<span class="docutils literal"><span class="pre">$5$rounds=1000$$lb/CwYgN/xR9dqYuYxYVtWkxMEh.VK.QOC9IKmy9DP/</span></span></p></td>
</tr>
<tr><td><p>Bob</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',salt='',rounds=1000) =
<span class="docutils literal"><span class="pre">$5$rounds=1000$$lb/CwYgN/xR9dqYuYxYVtWkxMEh.VK.QOC9IKmy9DP/</span></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="incremental small docutils container">
<p><strong>L√∂sung</strong></p>
<p>Passw√∂rter sollten immer mit einem einzigartigen und zuf√§lligen <span class="ger-quote">Salt</span> gespeichert werden, um Angriffe mittels Regenbogentabellen zu verhindern.</p>
<table class="tiny">
<thead>
<tr><th class="head"><p>User</p></th>
<th class="head"><p>Hash</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Alice</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',<span class="red">salt='0123456'</span>,rounds=1000)
<span class="docutils literal">$5$rounds=1000$0123456$66x8MB.qev25coq9OVrD1lr1ZGJJelAzOVlCDZykrY0</span></p></td>
</tr>
<tr><td></td>
<td></td>
</tr>
<tr><td><p>Bob</p></td>
<td><p>sha256_crypt.hash('<strong>DHBWMannheim</strong>',<span class="red">salt='1234567'</span>,rounds=1000)
<span class="docutils literal">$5$rounds=1000$1234567$LxD/hg29N9KYpNdFMW69Kk65BLkVLlzlSEJvqhCmFU9</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="supplemental docutils container">
<p><strong>Regenbogentabellen</strong></p>
<p>Eine Regenbogentabelle (<span class="eng">rainbow table</span>) bezeichnet eine vorberechnete Tabelle die konzeptionell zum einem Hash ein jeweilig dazugeh√∂rendes  Passwort speichert und einen effizienten Lookup erm√∂glicht. Dies kann ggf. die Angriffsgeschwindigkeit sehr signifikant beschleunigen.</p>
<p>Aufgrund der allgemeinen Verwendung von Salts sind Angriffe mit Hilfe von Regenbogentabellen heute nur noch von historischer Bedeutung.</p>
</div>
</div><div class="ld-slide" id="vom-salzen-salt-1">
<h2>Vom Salzen (<span class="eng">Salt</span>)...</h2>
<ul class="incremental more-space-between-list-items simple">
<li><p>Ein <em>Salt</em> sollte ausreichend lang sein (zum Beispiel 16 Zeichen oder 16 Byte).</p></li>
<li><p>Ein <em>Salt</em> darf nicht wiederverwendet werden.</p></li>
<li><p>Ein <em>Salt</em> kann zum Beispiel (am Anfang oder) am Ende an das Passwort angeh√§ngt werden bevor selbiges gehasht wird.</p></li>
<li><p>Ein <em>Salt</em> unterliegt (eigentlich) keinen Geheimhaltungsanforderungen.</p></li>
</ul>
<aside class="admonition incremental small">
<p class="admonition-title">Problem</p>
<p>Sollte es einem Angreifer gelingen in eine Datenbank einzubrechen und die Tabellen mit den Nutzerdaten abzufragen (zum Beispiel aufgrund einer erfolgreichen SQL Injection), dann ist es Ihm danach direkt m√∂glich zu versuchen Passworte wiederherzustellen.</p>
</aside>
<div class="supplemental docutils container">
<p><strong>Speicherung von Salts</strong></p>
<p>In Webanwendungen bzw. allgemein datenbankgest√ºtzten Anwendungen wird der <em>Salt</em> h√§ufig in der selben Tabelle gespeichert in der auch der Hash des Passworts gespeichert wird. Im Falle von verschl√ºsselten Dateien, wird der Salt (unverschl√ºsselt) mit in der Datei gespeichert.</p>
</div>
</div><div class="ld-slide" id="und-pfeffern-pepper-von-passwortern">
<h2>... und Pfeffern (<span class="eng">Pepper</span>) von Passw√∂rtern</h2>
<div class="small docutils container">
<p>(In Normen/Teilen der Literatur wird statt <em>Pepper</em> auch <em>Secret Key</em>s verwendet.)</p>
</div>
<ul class="incremental more-space-between-list-items simple">
<li><p>Wie ein <em>Salt</em> geht auch der <em>Secret Key</em> in den Hashvorgang des Passworts ein.</p></li>
<li><p>Der <em>Secret Key</em> wird jedoch <strong>nicht</strong> mit den Hashwerten der Passworte gespeichert.</p></li>
<li><p>Ein <em>Secret key</em> kann zum Beispiel in einem Hardwaresicherheitsmodul (z.B. Secure Element oder TPM Chip) gespeichert werden. Gel. wird der <em>Secret Key</em> bzw. ein Teil davon auch im Code gespeichert.</p></li>
<li><p>Wie ein Salt sollte auch auch <em>Secret Key</em> mind. 16 Byte lang sein, um ggf. ein Brute-Force Angriff auf den <em>Secret Key</em> zu verhindern sollte dem Angreifer zu einem Hash und Salt auch noch das Klartext Passwort bekannt sein.</p></li>
<li><p>Der <em>Secret Key</em> sollte zuf√§llig sein.</p></li>
<li><p>Der <em>Secret Key</em> sollte pro Instanziierung einer Anwendung einmalig sein.</p></li>
</ul>
</div><div class="ld-slide" id="pbkdf2-password-based-key-derivation-function-2">
<h2><a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc2898.html#section-5.2">PBKDF2</a> (Password-Based Key Derivation Function 2)</h2>
<ul class="incremental more-space-between-list-items">
<li><p>Dient der Ableitung eines Schl√ºssels aus einem Passwort.</p></li>
<li><p>Das Ergebnis der Anwendung der PBKDF2 wird zusammen mit dem <em>Salt</em> und dem Iterationsz√§hler f√ºr die anschlie√üende Passwortverifizierung gespeichert.</p></li>
<li><p>die <span class="math">\(PBKDF2\)</span> Schl√ºsselableitungsfunktion hat 5 Parameter <span class="math">\(DK = PBKDF2(\)</span>PRF, Password, Salt, c, dkLen<span class="math">\()\)</span>:</p>
<blockquote>
<dl class="field-list simple">
<dt>PRF<span class="colon">:</span></dt>
<dd><p>Eine Pseudozufallsfunktion; typischer Weise ein HMAC.</p>
</dd>
<dt>Password<span class="colon">:</span></dt>
<dd><p>Das Masterpasswort.</p>
</dd>
<dt>Salt<span class="colon">:</span></dt>
<dd><p>der zu verwendende Salt.</p>
</dd>
<dt>c<span class="colon">:</span></dt>
<dd><p>Z√§hler f√ºr die Anzahl an Runden.</p>
</dd>
<dt>dkLen<span class="colon">:</span></dt>
<dd><p>Die Bitl√§nge des abgeleiteten Schl√ºssels.</p>
</dd>
</dl>
</blockquote>
</li>
</ul>
<div class="supplemental docutils container">
<p>Die PBKDF2 ist nicht f√ºr das eigentliche Hashen zust√§ndig sondern <span class="ger-quote">nur</span> f√ºr das Iterieren der Hashfuntion und das eigentliche Key-stretching.</p>
<p>Laut OWASP sollten zum Beispiel f√ºr PBKDF2-HMAC-SHA512 600.000 Iterationen verwendet werden.</p>
</div>
</div><div class="ld-slide" id="hmac-hash-based-message-authentication-code">
<h2>HMAC (Hash-based Message Authentication Code)</h2>
<div class="small docutils container">
<p>Auch als <em>keyed-hash message authentication code</em> bezeichnet.</p>
<div class="math">
\begin{align*}
\begin{array}{rcl}
HMAC(K,m) &amp; = &amp; H( (K' \oplus opad) || H( ( K' \oplus ipad) || m) ) \\
K' &amp; = &amp;\begin{cases}
        H(K) &amp; \text{falls K gr√∂√üer als die Blockgr√∂√üe ist}\\
        K &amp; \text{andernfalls}
        \end{cases}
\end{array}
\end{align*}
</div>
<p><span class="math">\(H\)</span> is eine kryptografische Hashfunktion.</p>
<p><span class="math">\(m\)</span> ist die Nachricht.</p>
<p><span class="math">\(K\)</span> ist der geheime Schl√ºssel (<em>Secret Key</em>).</p>
<p><span class="math">\(K'\)</span> ist vom Schl√ºssel K abgeleiteter Schl√ºssel mit Blockgr√∂√üe (ggf. <em>padded</em> oder <em>gehasht</em>).</p>
<p><span class="math">\(||\)</span> ist die Konkatenation.</p>
<p><span class="math">\(\oplus\)</span> ist die XOR Operation.</p>
<p><span class="math">\(opad\)</span> ist das √§u√üere Padding bestehend aus Wiederholungen von 0x5c in Blockgr√∂√üe.</p>
<p><span class="math">\(ipad\)</span> ist das innere Padding bestehend aus Wiederholungen von 0x36 in Blockgr√∂√üe.</p>
</div>
</div><div class="ld-slide" id="section-2">
<h2></h2>
<img alt="Schl√ºsselableitung f√ºr den inneren und √§u√üeren Schl√ºssel K'" class="align-left" src="graffles/hmac_i_o_key_derivation.svg" style="width: 1400px;" />
<img alt="Schl√ºsselableitung f√ºr den inneren und √§u√üeren Schl√ºssel K'" class="incremental margin-above align-right" src="graffles/hmac_message_hashing.svg" style="width: 1300px;" />
<div class="supplemental docutils container">
<p><strong>Padding und Hashing</strong></p>
<p>Im Rahmen der Speicherung von Passw√∂rtern und <em>Secret Keys</em> ist die Verwendung von Padding Operationen bzw. das Hashing von Passw√∂rtern, um Eingaben in einer wohl-definierten L√§nge zu bekommen, √ºblich. Neben dem hier gesehenen Padding, bei dem 0x00 Werte angef√ºgt werden, ist zum Beispiel auch das einfache Wiederholen des urspr√ºnglichen Wertes, bis man auf die notwendige L√§nge kommt, ein Ansatz.</p>
<p>Diese Art Padding darf jedoch nicht verwechselt werden mit dem Padding, dass ggf. im Rahmen der Verschl√ºsselung von Nachrichten notwendig ist, um diese ggf. auf eine bestimmte Blockgr√∂√üe zu bringen (zum Beispiel bei ECB bzw. CBC Block Mode Operations.)</p>
</div>
</div><div class="ld-slide" id="hmac-computation-in-python">
<h2>HMAC Computation in Python</h2>
<p><strong>Implementierung</strong></p>
<pre class="code python small literal-block"><code><span class="keyword namespace">import</span> <span class="name namespace">hashlib</span><span class="whitespace">
</span><span class="name">pwd</span> <span class="operator">=</span> <span class="literal string affix">b</span><span class="literal string double">&quot;MyPassword&quot;</span><span class="whitespace">
</span><span class="name">stretched_pwd</span> <span class="operator">=</span> <span class="name">pwd</span> <span class="operator">+</span> <span class="punctuation">(</span><span class="literal number integer">64</span><span class="operator">-</span><span class="name builtin">len</span><span class="punctuation">(</span><span class="name">pwd</span><span class="punctuation">))</span> <span class="operator">*</span> <span class="literal string affix">b</span><span class="literal string double">&quot;</span><span class="literal string escape">\x00</span><span class="literal string double">&quot;</span><span class="whitespace">
</span><span class="name">ikeypad</span> <span class="operator">=</span> <span class="name builtin">bytes</span><span class="punctuation">(</span><span class="name builtin">map</span><span class="punctuation">(</span><span class="keyword">lambda</span> <span class="name">x</span> <span class="punctuation">:</span> <span class="name">x</span> <span class="operator">^</span> <span class="literal number hex">0x36</span> <span class="punctuation">,</span> <span class="name">stretched_pwd</span><span class="punctuation">))</span> <span class="comment single"># xor with ipad</span><span class="whitespace">
</span><span class="name">okeypad</span> <span class="operator">=</span> <span class="name builtin">bytes</span><span class="punctuation">(</span><span class="name builtin">map</span><span class="punctuation">(</span><span class="keyword">lambda</span> <span class="name">x</span> <span class="punctuation">:</span> <span class="name">x</span> <span class="operator">^</span> <span class="literal number hex">0x5c</span> <span class="punctuation">,</span> <span class="name">stretched_pwd</span><span class="punctuation">))</span> <span class="comment single"># xor with opad</span><span class="whitespace">
</span><span class="name">hash1</span> <span class="operator">=</span> <span class="name">hashlib</span><span class="operator">.</span><span class="name">sha256</span><span class="punctuation">(</span><span class="name">ikeypad</span><span class="operator">+</span><span class="literal string affix">b</span><span class="literal string double">&quot;JustASalt&quot;</span><span class="operator">+</span><span class="literal string affix">b</span><span class="literal string double">&quot;</span><span class="literal string escape">\x00\x00\x00\x01</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">digest</span><span class="punctuation">()</span><span class="whitespace">
</span><span class="name">hmac</span>  <span class="operator">=</span> <span class="name">hashlib</span><span class="operator">.</span><span class="name">sha256</span><span class="punctuation">(</span><span class="name">okeypad</span><span class="operator">+</span><span class="name">hash1</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">digest</span><span class="punctuation">()</span></code></pre>
<div class="incremental small docutils container">
<p><strong>Ausf√ºhrung</strong></p>
<pre class="code python literal-block"><code><span class="name">hmac</span> <span class="operator">=</span><span class="whitespace">
</span><span class="literal string affix">b</span><span class="literal string single">'h</span><span class="literal string escape">\x88\xc2\xb6</span><span class="literal string single">X</span><span class="literal string escape">\xb7\xcb\x9c\x90\xc2</span><span class="literal string single">R...</span><span class="whitespace">
</span>  \<span class="name">x16</span>\<span class="name">x87</span>\<span class="name">x87</span>\<span class="name">x0e</span>\<span class="name">xad</span>\<span class="name">xa1</span>\<span class="name">xe1</span><span class="punctuation">:</span><span class="literal number integer">9</span>\<span class="name">xca</span><span class="literal string single">'</span></code></pre>
</div>
<div class="supplemental docutils container">
<p>HMAC ist auch direkt als Bibliotheksfunktion verf√ºgbar.</p>
<pre class="code python black literal-block"><code><span class="keyword namespace">import</span> <span class="name namespace">hashlib</span><span class="whitespace">
</span><span class="keyword namespace">import</span> <span class="name namespace">hmac</span><span class="whitespace">

</span><span class="name">hash_hmac</span> <span class="operator">=</span> <span class="name">hmac</span><span class="operator">.</span><span class="name">new</span><span class="punctuation">(</span><span class="whitespace">
</span>    <span class="literal string affix">b</span><span class="literal string double">&quot;MyPassword&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="literal string affix">b</span><span class="literal string double">&quot;JustASalt&quot;</span><span class="operator">+</span><span class="literal string affix">b</span><span class="literal string double">&quot;</span><span class="literal string escape">\x00\x00\x00\x01</span><span class="literal string double">&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">hashlib</span><span class="operator">.</span><span class="name">sha256</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">digest</span><span class="punctuation">()</span><span class="whitespace">

</span><span class="name">hash_hmac</span> <span class="operator">=</span><span class="whitespace">
</span>    <span class="literal string affix">b</span><span class="literal string single">'h</span><span class="literal string escape">\x88\xc2\xb6</span><span class="literal string single">X</span><span class="literal string escape">\xb7\xcb\x9c\x90\xc2</span><span class="literal string single">R...</span><span class="whitespace">
</span>      \<span class="name">x16</span>\<span class="name">x87</span>\<span class="name">x87</span>\<span class="name">x0e</span>\<span class="name">xad</span>\<span class="name">xa1</span>\<span class="name">xe1</span><span class="punctuation">:</span><span class="literal number integer">9</span>\<span class="name">xca</span><span class="literal string single">'</span></code></pre>
</div>
</div><div class="ld-slide" id="pbkdf2-hmac-hash-based-message-authentication-code">
<h2>PBKDF2-HMAC (Hash-based Message Authentication Code)</h2>
<p>Im Fall von PBKDF2 ist der Schl√ºssel <span class="math">\(K\)</span> also das Passwort und die Nachricht <span class="math">\(M\)</span> das Salz.</p>
<p><strong>Beispielcode</strong></p>
<pre class="code python black smaller literal-block"><code><span class="keyword namespace">from</span> <span class="name namespace">passlib.crypto.digest</span> <span class="keyword namespace">import</span> <span class="name">pbkdf2_hmac</span><span class="whitespace">
</span><span class="name">pbkdf2_hmac</span><span class="punctuation">(</span> <span class="literal string double">&quot;sha256&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">secret</span><span class="operator">=</span><span class="literal string affix">b</span><span class="literal string double">&quot;MyPassword&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">salt</span><span class="operator">=</span><span class="literal string affix">b</span><span class="literal string double">&quot;JustASalt&quot;</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="name">rounds</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">,</span>   <span class="comment single"># a real value should be &gt;&gt; 500.000</span><span class="whitespace">
</span>    <span class="name">keylen</span><span class="operator">=</span><span class="literal number integer">32</span> <span class="punctuation">)</span></code></pre>
<p class="incremental footnotesize">Bei einer Runde und passenden Blockgr√∂√üen ist das Ergebnis der PBKDF2 somit gleich mit der Berechnung des HMACs wenn der Salt um die Nummer des Blocks <span class="docutils literal">\x00\x00\x00\x01</span> erg√§nzt wurde.</p>
<div class="supplemental docutils container">
<p>In der konkreten Anwendung ist es ggf. m√∂glich das <em>Secret</em> auch zu Salzen und den <em>Salt</em> aus einer anderen Quellen abzuleiten.</p>
</div>
</div><div class="transition-move-left integrated-exercise ld-slide" id="nachgehakt">
<h2>Nachgehakt</h2>
<div class="conditions docutils container">
<p>Ihnen liegt eine externer Festplatte/SSD mit USB Anschluss vor, die die folgenden Eigenschaften hat:</p>
<ul class="simple">
<li><p>Die Daten auf der SSD/FP sind hardwareverschl√ºsselte Festplatte</p></li>
<li><p>Die Verschl√ºsselung erfolgt mit XTS-AES 256</p></li>
<li><p>Es gibt eine spezielle Software, die der Kunde installieren muss, um das Passwort zu setzen. Erst danach wird die Festplatte <span class="ger-quote">freigeschaltet</span> und kann in das Betriebssystem eingebunden werden. Davor erscheint die SSD/FP wie ein CD Laufwerk auf dem die Software liegt.</p></li>
<li><p>Die SSD/FP ist FIPS zertifiziert und gegen Hardwaremanipulation gesch√ºtzt; zum Beispiel eingegossen mit Epox.</p></li>
<li><p>Das Passwort wird von der Software gehasht und dann als Hash an den Controller der externen FP/SSD √ºbertragen.</p></li>
<li><p>Im Controller wird der √ºbermittelte Hash direkt zur Autorisierung des Nutzers verwendet. Dazu wird der Hash mit dem im EPROM hinterlegten verglichen.</p></li>
</ul>
</div>
<div class="task docutils container">
<p>Wie bewerten Sie die Sicherheit des Produkts?</p>
</div>
<div class="supplemental excersise-solution docutils container">
<p><strong>L√∂sung</strong></p>
<p>Wie in (A) dargestellt, ist die Sicherheit hier ausschlie√ülich durch den Hardwareschutz gegeben. Sobald der Hash aus dem EPROM ausgelesen werden konnte, ist keine Sicherheit mehr gegeben. In (B) wird der Hash erst auf dem Ger√§t berechnet. Die gleiche Attacke w√ºrde hier nicht mehr funktionieren, da ein √úbertagen des Hashes zu einem Hashen des Hashes f√ºhren w√ºrde und danach der Test fehlschlagen w√ºrde.</p>
<img alt="Unsichere Passwortvalidierung" class="align-center" src="graffles/unsichere_passwort_validierung.svg" style="width: 800px;" />
</div>
</div><div class="new-section transition-fade ld-slide" id="passwortwiederherstellung-101">
<h2>Passwortwiederherstellung 101</h2>
</div><div class="ld-slide" id="passwortwiederherstellung-1">
<h2>Passwortwiederherstellung</h2>
<ol class="arabic simple incremental impressive">
<li><p>Wissen wo/in welcher Form der Passworthash zu finden ist.</p></li>
<li><p>Extraktion des Hashes</p></li>
<li><p>Wiederherstellung des Passwortes durch das systematische Durchprobieren aller Kandidaten.</p></li>
</ol>
</div><div class="ld-slide" id="beispiel-wiederherstellung-eines-linux-login-passwortes">
<h2>Beispiel - Wiederherstellung eines Linux Login Passwortes</h2>
<pre class="code bash incremental literal-block"><code>~%<span class="whitespace"> </span>sudo<span class="whitespace"> </span>cat<span class="whitespace"> </span>/etc/shadow<span class="whitespace">
</span><span class="operator">[</span>...<span class="operator">]</span><span class="whitespace">
</span>john:<span class="name variable">$6$zElzjLsMqi36JXWG$FX2Br1</span>/<span class="operator">[</span>...<span class="operator">]</span>.<span class="whitespace"> </span>‚Ü©Ô∏é<span class="whitespace">
</span>RxAHnNCBsqiouWUz751crHodXxs0iqZfBt9j40l3G0:19425:0:99999:7:::<span class="whitespace">
</span><span class="operator">[</span>...<span class="operator">]</span></code></pre>
<pre class="code bash incremental line-above literal-block"><code>%<span class="whitespace"> </span><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string single">'$6$zElzjLsMqi36JXWG$FX2Br1/[...]. ‚Ü©Ô∏é
RxAHnNCBsqiouWUz751crHodXxs0iqZfBt9j40l3G0'</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>hash.txt</code></pre>
<pre class="code bash incremental line-above literal-block"><code>%<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1800</span><span class="whitespace"> </span>hash.txt<span class="whitespace"> </span>-a<span class="whitespace"> </span><span class="literal number">3</span><span class="whitespace"> </span><span class="literal string single">'?d?d?d?d?d?d'</span></code></pre>
<div class="supplemental docutils container">
<p><strong>Finden eines Hashes</strong></p>
<p>Im Falle von Linux Login Passworten ist genau spezifiziert wo die Passworte (<span class="docutils literal">/etc/shadow</span>) und in welcher Form die Passworte gespeichert werden. Nach dem Namen des Nutzers (im Beispiel <span class="docutils literal">john</span>) ist der verwendete Hashingalgorithmus vermerkt. Dieser unterscheidet sich zwischen den Distributionen. Aktuell setzen die meisten Distributionen jedoch auf yescrypt. Danach folgen die Parameter. Insbesondere der Salt.</p>
<table>
<thead>
<tr><th class="head"><p>ID</p></th>
<th class="head"><p>Mode</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>$5$</p></td>
<td><p>Sha256crypt (veraltet)</p></td>
</tr>
<tr><td><p>$6$</p></td>
<td><p>SHA512crypt (in Abl√∂sung)</p></td>
</tr>
<tr><td><p>$y$ (or $7$)</p></td>
<td><p>yescrypt</p></td>
</tr>
</tbody>
</table>
</div>
</div><div class="ld-slide" id="systematisches-testen-aller-kandidaten">
<h2>Systematisches Testen aller Kandidaten</h2>
<p>konzeptionell f√ºhrt die Software Hashcat die folgenden Schritte durch:</p>
<div class="monospaced small docutils container">
<p>&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000000&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000001&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000002&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000003&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000004&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000005&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000006&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000007&quot;) ‚úò</p>
<p class="incremental">&lt;extracted_hash&gt; =? SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;000008&quot;) ‚úò</p>
<p class="incremental">...</p>
<p class="incremental">&lt;extracted_hash&gt; == SHA512crypt(&quot;zElzjLsMqi36JXWG&quot;,&quot;123456&quot;) ‚úîÔ∏é</p>
</div>
<div class="supplemental docutils container">
<p>Der folgende Code k√∂nnte als Grundlage genutzt werden, um das Passwort wiederherzustellen.
(Linux nutzt standardm√§√üig 5000 Runden.)</p>
<pre class="code python literal-block"><code><span class="keyword namespace">from</span> <span class="name namespace">passlib.hash</span> <span class="keyword namespace">import</span> <span class="name">sha512_crypt</span><span class="whitespace">

</span><span class="name">sha512_crypt</span><span class="operator">.</span><span class="name">hash</span><span class="punctuation">(</span><span class="literal string double">&quot;123456&quot;</span><span class="punctuation">,</span><span class="name">salt</span><span class="operator">=</span><span class="literal string double">&quot;zElzjLsMqi36JXWG&quot;</span><span class="punctuation">,</span><span class="name">rounds</span><span class="operator">=</span><span class="literal number integer">5000</span><span class="punctuation">)</span></code></pre>
</div>
</div><div class="new-section transition-scale ld-slide" id="passworte-verstehen">
<h2>Passworte Verstehen</h2>
</div><div class="ld-slide" id="aufbau-von-passworten">
<h2>Aufbau von Passworten</h2>
<p>Von Menschen vergebene Passw√∂rter basieren h√§ufig auf Kombinationen von W√∂rtern aus den folgenden Kategorien:</p>
<ul class="incremental more-space-between-list-items simple">
<li><p>Pins: 1111, 1234, 123456, ‚Ä¶</p></li>
<li><p>Tastaturwanderungen (<span class="eng">keyboard walks</span>): <span class="docutils literal">asdfg</span>, <span class="docutils literal">q2w3e4r5t</span>, ‚Ä¶</p></li>
<li><p>Patterns: aaaaa, ababab, abcabcabc, ‚Ä¶</p></li>
<li><p>Regul√§re W√∂rter aus W√∂rterb√ºchern: Duden, Webster, ‚Ä¶</p></li>
<li><p>Kontextinformationen:</p>
<ul>
<li><p>Szenespezifisch: <span class="docutils literal">acab</span>, ‚Ä¶</p></li>
<li><p>Privates Umfeld: Namen von Kindern, Eltern, Hunden, Geburtsort, Adresse, ‚Ä¶</p></li>
</ul>
</li>
</ul>
</div><div class="ld-slide" id="haufige-passworte">
<h2>H√§ufige Passworte</h2>
<p>Eine gute Quelle f√ºr das Studium von Passw√∂rtern sind sogenannte <em>Leaks</em> oder auch Listen mit g√§ngigen Passw√∂rtern. Zum Beispiel <a class="reference external" href="https://www.beckershospitalreview.com/cybersecurity/30-most-common-passwords-of-2023.html">Becker's Health IT 2023</a>:</p>
<div class="three-columns small docutils container">
<div class="compact-ps docutils container">
<p>123456</p>
<p>password</p>
<p>123456789</p>
<p>12345</p>
<p>12345678</p>
<p>qwerty</p>
<p>1234567</p>
<p>111111</p>
<p>1234567890</p>
<p>123123</p>
</div>
<div class="compact-ps docutils container">
<p>abc123</p>
<p>1234</p>
<p>password1</p>
<p>iloveyou</p>
<p>1q2w3e4r</p>
<p>000000</p>
<p>qwerty123</p>
<p>zaq12wsx</p>
<p>dragon</p>
<p>sunshine</p>
</div>
<div class="compact-ps docutils container">
<p>princess</p>
<p>letmein</p>
<p>654321</p>
<p>monkey</p>
<p>27653</p>
<p>1qaz2wsx</p>
<p>123321</p>
<p>qwertyuiop</p>
<p>superman</p>
<p>asdfghjkl</p>
</div>
</div>
<div class="supplemental docutils container">
<p><strong>Hinweise</strong></p>
<ul class="simple">
<li><p>Die Listen √§ndern sich in der Regel von Jahr zu Jahr nicht wesentlich.</p></li>
<li><p>Die Methodik ist oft fragw√ºrdig.</p></li>
</ul>
</div>
</div><div class="ld-slide" id="herausforderung-hashraten-auf-aktueller-hardware">
<h2>Herausforderung: Hashraten auf aktueller Hardware</h2>
<table class="incremental scriptsize no-table-borders">
<tbody>
<tr><td><p><strong>Hashcat Mode (Hashcat 6.2.6)</strong></p></td>
<td><p><strong>Hash</strong></p></td>
<td><p><strong>RTX 1080Ti
250 W</strong></p></td>
<td><p><strong>RTX 2080TI
260 W</strong></p></td>
<td><p><strong>RTX 3090
350 W</strong></p></td>
<td><p><strong>RTX 4090
450 W</strong></p></td>
</tr>
<tr><td><p>25700</p></td>
<td><p>Murmur</p></td>
<td></td>
<td></td>
<td></td>
<td><p>643700.0 (643 GH/s)</p></td>
</tr>
<tr><td><p>23</p></td>
<td><p>Skype</p></td>
<td><p>21330.1</p></td>
<td><p>27843.1</p></td>
<td><p>37300.7</p></td>
<td><p>84654.8</p></td>
</tr>
<tr><td><p>1400</p></td>
<td><p>SHA2-256</p></td>
<td><p>4459.7</p></td>
<td><p>7154.8</p></td>
<td><p>9713.2</p></td>
<td><p>21975.5</p></td>
</tr>
<tr><td><p>10500</p></td>
<td><p>PDF1.4-1.6</p></td>
<td><p>24.9</p></td>
<td><p>29.8</p></td>
<td><p>76.8</p></td>
<td><p>122.0</p></td>
</tr>
<tr><td><p>1800</p></td>
<td><p>SHA 512 Unix (5000 Iterations)</p></td>
<td><p>0.2</p></td>
<td><p>0.3</p></td>
<td><p>0.5</p></td>
<td><p>1.2</p></td>
</tr>
<tr><td><p>13723</p></td>
<td><p>Veracrypt SHA2- 512 + XTX 1536Bit</p></td>
<td><p>0.0004</p></td>
<td><p>0.0006</p></td>
<td><p>0.0009</p></td>
<td><p>0.002
(2000 H/s)</p></td>
</tr>
</tbody>
</table>
<div class="tiny docutils container">
<p><strong>Quellen:</strong></p>
<dl class="field-list simple">
<dt>4090<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://gist.github.com/Chick3nman/e4fcee00cb6d82874dace72106d73fef">https://gist.github.com/Chick3nman/e4fcee00cb6d82874dace72106d73fef</a></p>
</dd>
<dt>3090<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://gist.github.com/Chick3nman/e4fcee00cb6d82874dace72106d73fef">https://gist.github.com/Chick3nman/e4fcee00cb6d82874dace72106d73fef</a></p>
</dd>
<dt>1080Ti<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://www.onlinehashcrack.com/tools-benchmark-hashcat-nvidia-gtx-1080-ti.php">https://www.onlinehashcrack.com/tools-benchmark-hashcat-nvidia-gtx-1080-ti.php</a></p>
</dd>
<dt>2080Ti<span class="colon">:</span></dt>
<dd><p><a class="reference external" href="https://gist.github.com/binary1985/c8153c8ec44595fdabbf03157562763e">https://gist.github.com/binary1985/c8153c8ec44595fdabbf03157562763e</a></p>
</dd>
</dl>
</div>
</div><div class="ld-slide" id="herausforderung-unmoglichkeit-eines-brute-force-angriffs-auf-luks2">
<h2>Herausforderung: Unm√∂glichkeit eines Brute-Force Angriffs auf Luks2</h2>
<img alt="Zeit die f√ºr einen Angriff auf LUKS2 ben√∂tigt wird." class="align-center" src="dgraphs/brute_force-luks2.svg" style="width: 900px;" />
</div><div class="ld-slide" id="herausforderung-unmoglichkeit-eines-brute-force-angriffs-auf-lange-passworte">
<h2>Herausforderung: Unm√∂glichkeit eines Brute-Force Angriffs auf lange Passworte</h2>
<img alt="Zeit f√ºr f√ºr Angriffe auf lange Passw√∂rter ben√∂tigt wird." class="align-center" src="dgraphs/brute_force.svg" style="width: 1820px;" />
</div><div class="ld-slide" id="herausforderung-stets-neue-algorithmen">
<h2>Herausforderung: stets neue Algorithmen</h2>
<blockquote class="epigraph">
<p>Angriff auf LUKS2 mit Argon2</p>
<p>[‚Ä¶] The choice of Argon2 as a KDF makes GPU acceleration impossible. As a result, you‚Äôll be restricted to CPU-only attacks, which may be very slow or extremely slow depending on your CPU. To give an idea, you can try 2 (that‚Äôs right, two) passwords per second on a single Intel(R) Core(TM) i7-9700K CPU &#64; 3.60GHz. Modern CPUs will deliver a slightly better performance, but don‚Äôt expect a miracle: LUKS2 default KDF is deliberately made to resist attacks. [‚Ä¶]</p>
<p class="attribution">‚ÄîElcomsoft <a class="reference external" href="https://blog.elcomsoft.com/2022/08/probing-linux-disk-encryption-luks2-argon-2-and-gpu-acceleration">Luks2 with Argon2</a></p>
</blockquote>
</div><div class="transition-move-left integrated-exercise ld-slide" id="gedankenexperiment">
<h2>Gedankenexperiment</h2>
<div class="conditions docutils container">
<p>Sie wollen einen SHA 256 angreifen und sie haben 100 Nvidia 4090 GPUs. Jede GPU hat eine Hash-Rate von ~22GH/s (mit Hashcat 6.2.6) und ben√∂tigt ~500 Watt. Der verwendete Zeichensatz besteht aus 84 verschiedenen Zeichen (z.B. a-z, A-Z, 0-9, &lt;einige Sonderzeichen&gt;).</p>
</div>
<div class="task docutils container">
<p>Wie lange dauert es, ein 10-stelliges Passwort zu ermitteln (Worst Case)?</p>
</div>
<div class="task docutils container">
<p>Wie viel Geld wird es Sie kosten, ein 10-stelliges Passwort zu knacken (worst case) (1kW ~ 0,25ct)?</p>
</div>
<div class="task docutils container">
<p>Werden Sie im Laufe Ihres Lebens in der Lage sein, ein Passwort mit 12 Zeichen zu ermitteln?</p>
</div>
<div class="supplemental excersise-solution docutils container">
<p>Es dauert ca. 3 Monate (~2200 Stunden), um ein Passwort mit 10 Ziffern zu ermitteln!</p>
<p>Es wird im schlimmsten Fall 27.000‚Ç¨ Stromkosten verursachen.</p>
<p>Um ein Passwort mit 11 Ziffern zu finden, brauchen Sie 21 Jahre (worst-case).</p>
<p>Um ein Passwort mit 12 Ziffern zu finden, brauchen Sie 21*84 Jahre (worst case).</p>
</div>
</div><div class="transition-move-left integrated-exercise ld-slide" id="gedankenexperiment-1">
<h2>Gedankenexperiment</h2>
<div class="transition-move-left conditions docutils container">
<p>Sie haben ganz viele Grafikkarten und einen sehr schnellen Hash. Sie kommen auf eine Hashrate von 1THash/Sekunde (<span class="math">\(1 \times 10^{12}\)</span>). Sie haben einen Monat Zeit f√ºr das Knacken des Passworts.
Gehen Sie davon aus, dass Ihr Zeichensatz 100 Zeichen umfasst.</p>
</div>
<div class="task docutils container">
<p>Berechnen Sie den Anteil des Suchraums, den Sie abgesucht haben, wenn das Passwort 32 Zeichen lang sein sollte. Dr√ºcken Sie den Anteil des abgesuchten Raums in Relation der Sandk√∂rner der Sahara aus. Gehen Sie davon aus, dass die Sahara ca. 70 Trilliarden (<span class="math">\(70 \times 10^{21}\)</span>) Sank√∂rner hat.</p>
</div>
<aside class="admonition supplemental excersise-solution">
<p class="admonition-title">L√∂sung</p>
<p>Suchraum: <span class="math">\(100^{32} = 10^{64}\)</span></p>
<p>Passworte in einem Monat:</p>
<div class="math">
\begin{equation*}
(1 \times 10^{12} {H \over s}) \times 60sec \times 60min \times 24h \times 30d = \
\end{equation*}
</div>
<div class="math">
\begin{equation*}
2.592.000.000.000.000.000 = \
\end{equation*}
</div>
<div class="math">
\begin{equation*}
2,592 \times 10^{18} \
\end{equation*}
</div>
<p>da:</p>
<div class="math">
\begin{equation*}
2.592.000.000.000.000.000 \times (4 \times 10^{45}) \approx 10^{64}
\end{equation*}
</div>
<p>haben wir somit ca.</p>
<div class="math">
\begin{equation*}
1 \over 4 \times 10^{45}
\end{equation*}
</div>
<p>des Suchraums berechnet. Da die Sahara wohl nur ca. <span class="math">\(7 \times 10^{22}\)</span> Sandk√∂rner hat, haben wir somit nicht mal ansatzweise ein Sandkorn berechnet. Sondern lediglich: <span class="math">\(1,75 \times 10^{-23}\)</span>.</p>
<p>Oder ganz praktisch ausgedr√ºckt: wir sind - je nach Theroie - fr√ºhestens <strong>nach dem Ende des Universums</strong> fertig - <a class="reference external" href="https://www.welt.de/kmpkt/article177740494/Weltall-Wie-das-Ende-des-Universums-aussehen-koennte.html#:~:text=Das%20All%20dehnt%20sich%20immer,Gut%20zu%20wissen!">Ende des Universums</a>.</p>
</aside>
</div><div class="ld-slide" id="herausforderung-passwortrichtlinien">
<h2>Herausforderung: Passwortrichtlinien</h2>
<p>Moderne Passwortrichtlinien (<span class="eng">Password Policies</span>) machen es unm√∂glich, √§ltere Leaks <em>direkt</em> zu nutzen.</p>
<p><em>Beispiele:</em></p>
<ul class="incremental more-space-between-list-items simple">
<li><p>Mindestanzahl von Zeichen (maximale Anzahl von Zeichen)</p></li>
<li><p>Anforderungen an die Anzahl der Ziffern, Sonderzeichen, Gro√ü- und Kleinbuchstaben</p></li>
<li><p>Anforderungen an die Vielfalt der verwendeten Zeichen</p></li>
<li><p>einige Passw√∂rter (z. B. aus bekannten Leaks und W√∂rterb√ºchern) sind verboten</p></li>
<li><p>...</p></li>
</ul>
<div class="supplemental docutils container">
<p>Passwortrichtlinien extrem: <a class="reference external" href="https://neal.fun/password-game/">Password Game</a></p>
<p>Die wichtigsten <a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf">NIST-Richtlinien</a> f√ºr Passw√∂rter:</p>
<ul class="simple">
<li><p>Mindestl√§nge von 8 Zeichen.</p></li>
<li><p>Keine Komplexit√§tsanforderung. Benutzer sollten auch die M√∂glichkeit haben, Leerzeichen einzuf√ºgen, um die Verwendung von Phrasen zu erm√∂glichen. F√ºr die Benutzerfreundlichkeit [...] kann es von Vorteil sein, wiederholte Leerzeichen in getippten Passw√∂rtern vor der √úberpr√ºfung zu entfernen.</p></li>
</ul>
</div>
</div><div class="ld-slide" id="die-struktur-von-passwortern-verstehen">
<h2>Die Struktur von Passw√∂rtern verstehen</h2>
<div class="scriptsize docutils container">
<p>Analyse auf Grundlage des <span class="ger-quote">ber√ºhmten</span> Rockyou-Lecks.</p>
<p>Hier haben wir alle Kleinbuchstaben auf l, Gro√übuchstaben auf u, Ziffern auf d und Sonderzeichen auf s abgebildet.</p>
</div>
<table class="align-left compact-cells tiny no-inner-borders" style="width: 100%;">
<tbody>
<tr><td><p>llllllll</p></td>
<td><p>4,8037%</p></td>
<td><p>lllllllldd</p></td>
<td><p>1,4869%</p></td>
<td><p>dddddddddddd</p></td>
<td><p>0,2683%</p></td>
<td><p>ddddddll</p></td>
<td><p>0,1631%</p></td>
</tr>
<tr><td><p>llllll</p></td>
<td><p>4,1978%</p></td>
<td><p>lllllld</p></td>
<td><p>1,3474%</p></td>
<td><p>lllddddd</p></td>
<td><p>0,2625%</p></td>
<td><p>lllllls</p></td>
<td><p>0,1615%</p></td>
</tr>
<tr><td><p>lllllll</p></td>
<td><p>4,0849%</p></td>
<td><p>llllllld</p></td>
<td><p>1,3246%</p></td>
<td><p>lllllllllldd</p></td>
<td><p>0,2511%</p></td>
<td><p>ddddlll</p></td>
<td><p>0,1613%</p></td>
</tr>
<tr><td><p>lllllllll</p></td>
<td><p>3,6086%</p></td>
<td><p>llllllllllll</p></td>
<td><p>1,3223%</p></td>
<td><p>llllllllllllllll</p></td>
<td><p>0,2340%</p></td>
<td><p>dlllllll</p></td>
<td><p>0,1583%</p></td>
</tr>
<tr><td><p>ddddddd</p></td>
<td><p>3,4003%</p></td>
<td><p>llldddd</p></td>
<td><p>1,2439%</p></td>
<td><p>lllldddddd</p></td>
<td><p>0,2322%</p></td>
<td><p>dllllll</p></td>
<td><p>0,1575%</p></td>
</tr>
<tr><td><p>dddddddddd</p></td>
<td><p>3,3359%</p></td>
<td><p>llllldddd</p></td>
<td><p>1,2109%</p></td>
<td><p>llddddd</p></td>
<td><p>0,2270%</p></td>
<td><p>llllddddd</p></td>
<td><p>0,1560%</p></td>
</tr>
<tr><td><p>dddddddd</p></td>
<td><p>2,9878%</p></td>
<td><p>lllllldddd</p></td>
<td><p>1,1204%</p></td>
<td><p>uuuuuudd</p></td>
<td><p>0,2189%</p></td>
<td><p>dddddddl</p></td>
<td><p>0,1557%</p></td>
</tr>
<tr><td><p>lllllldd</p></td>
<td><p>2,9326%</p></td>
<td><p>lllllllld</p></td>
<td><p>1,1168%</p></td>
<td><p>ddddll</p></td>
<td><p>0,2169%</p></td>
<td><p>uuuudd</p></td>
<td><p>0,1551%</p></td>
</tr>
<tr><td><p>llllllllll</p></td>
<td><p>2,9110%</p></td>
<td><p>lllllddd</p></td>
<td><p>1,0633%</p></td>
<td><p>lddddddd</p></td>
<td><p>0,2064%</p></td>
<td><p>lllllddddd</p></td>
<td><p>0,1395%</p></td>
</tr>
<tr><td><p>dddddd</p></td>
<td><p>2,7243%</p></td>
<td><p>llllllddd</p></td>
<td><p>0,9225%</p></td>
<td><p>ddddddddddddd</p></td>
<td><p>0,2017%</p></td>
<td><p>ddllllll</p></td>
<td><p>0,1391%</p></td>
</tr>
<tr><td><p>ddddddddd</p></td>
<td><p>2,1453%</p></td>
<td><p>llllllllld</p></td>
<td><p>0,9059%</p></td>
<td><p>ullllldd</p></td>
<td><p>0,1930%</p></td>
<td><p>ulllll</p></td>
<td><p>0,1379%</p></td>
</tr>
<tr><td><p>llllldd</p></td>
<td><p>2,0395%</p></td>
<td><p>lllll</p></td>
<td><p>0,8793%</p></td>
<td><p>ddddllll</p></td>
<td><p>0,1905%</p></td>
<td><p>uuuuuuuuuu</p></td>
<td><p>0,1378%</p></td>
</tr>
<tr><td><p>llllllldd</p></td>
<td><p>1,9092%</p></td>
<td><p>lllllllllllll</p></td>
<td><p>0,8334%</p></td>
<td><p>uuuuuuuuu</p></td>
<td><p>0,1886%</p></td>
<td><p>llllllls</p></td>
<td><p>0,1374%</p></td>
</tr>
<tr><td><p>lllllllllll</p></td>
<td><p>1,8697%</p></td>
<td><p>llllld</p></td>
<td><p>0,8005%</p></td>
<td><p>uuuuudd</p></td>
<td><p>0,1815%</p></td>
<td><p>lllllllllld</p></td>
<td><p>0,1345%</p></td>
</tr>
<tr><td><p>lllldddd</p></td>
<td><p>1,6420%</p></td>
<td><p>llllddd</p></td>
<td><p>0,7759%</p></td>
<td><p>lllllllllddd</p></td>
<td><p>0,1808%</p></td>
<td><p>llllllllllldd</p></td>
<td><p>0,1344%</p></td>
</tr>
<tr><td><p>lllldd</p></td>
<td><p>1,5009%</p></td>
<td><p>ddddddddddd</p></td>
<td><p>0,7524%</p></td>
<td><p>llllllllldddd</p></td>
<td><p>0,1725%</p></td>
<td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
</tr>
</tbody>
</table>
</div><div class="ld-slide" id="die-zusammensetzung-von-passwortern-verstehen">
<h2>Die Zusammensetzung von Passw√∂rtern verstehen</h2>
<div class="small docutils container">
<p>Analyse des <em>rockyou</em> Leaks.</p>
<table class="tiny no-table-borders no-inner-borders incremental">
<thead>
<tr><th class="head"><p>‚àë Passworte</p></th>
<th class="head"><p>14.334.851</p></th>
<th class="head"><p>100%</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Pins</p></td>
<td><p>2.346.591</p></td>
<td><p>16,37%</p></td>
</tr>
<tr><td><p>Passworte mit Buchstaben</p></td>
<td><p>11.905.977</p></td>
<td><p>83,34%</p></td>
</tr>
</tbody>
</table>
<div class="incremental docutils container">
<p>Analyse der Passworte mit Buchstaben:</p>
<table class="tiny no-table-borders no-inner-borders incremental">
<thead>
<tr><th class="head"><p>Kategorie</p></th>
<th class="head"><p>Absolut</p></th>
<th class="head"><p>Prozentual</p></th>
<th class="head"><p>Beispiele</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr><td><p>Emails</p></td>
<td><p>26.749</p></td>
<td><p>0,22%</p></td>
<td><p>me&#64;me.com</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Zahlen gerahmt von Buchstaben</p></td>
<td><p>35696</p></td>
<td><p>0,30%</p></td>
<td><p>a123456a</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Leetspeak</p></td>
<td><p>64.672</p></td>
<td><p>0,54%</p></td>
<td><p>G3tm0n3y</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Patterns</p></td>
<td><p>124.347</p></td>
<td><p>1,04%</p></td>
<td><p>lalala</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Regul√§re oder Popul√§re W√∂rter</p></td>
<td><p>4.911.647</p></td>
<td><p><strong>41,25%</strong></p></td>
<td><p>princess</p></td>
<td><p>iloveu</p></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Sequenzen</p></td>
<td><p>5.290</p></td>
<td><p>0,04%</p></td>
<td><p>abcdefghij</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>keyboard walks (de/en)</p></td>
<td><p>14.662</p></td>
<td><p>0,12%</p></td>
<td><p>q2w3e4r</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr><td><p>Einfache Wortkombinationen</p></td>
<td><p>535.037</p></td>
<td><p>4,49%</p></td>
<td><p>pinkpink</p></td>
<td><p>sexy4u</p></td>
<td><p>te amo</p></td>
<td></td>
</tr>
<tr><td><p>Komplexe Wortkombinationen</p></td>
<td><p>5.983.259</p></td>
<td><p><strong>50,25%</strong></p></td>
<td><p>Inparadise</p></td>
<td><p>kelseylovesbarry</p></td>
<td></td>
<td></td>
</tr>
<tr><td><p><em>&lt;Rest&gt;</em></p></td>
<td><p>204.618</p></td>
<td><p>1,72%</p></td>
<td><p>j4**9c+p</p></td>
<td><p>i(L)you</p></td>
<td><p>p&#64;55w0rd</p></td>
<td><p>sk8er4life</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<aside class="admonition supplemental">
<p class="admonition-title">Hinweis</p>
<p>Die Sprachen, die bei der Identifizierung der W√∂rter ber√ºcksichtigt wurden, waren: &quot;de, en, fr, es, pt, nl&quot;.</p>
<p><em>Popul√§re W√∂rter</em> sind W√∂rter, die auf Twitter oder Facebook verwendet wurden, z. B. &quot;iloveu&quot;, &quot;iluvu&quot;, ....</p>
</aside>
</div><div class="ld-slide" id="der-effekt-von-passwortrichtlinien-auf-passworter">
<h2>Der Effekt von Passwortrichtlinien auf Passw√∂rter</h2>
<p>Reale Passwortrichtlinie:</p>
<blockquote>
<p>Nutze 1 Gro√übuchstabe, 1 Kleinbuchstabe, 2 Symbole, 2 Ziffern, 4 Buchstaben, 4 Nicht-Buchstaben</p>
</blockquote>
<div class="incremental docutils container">
<p>Exemplarisch beobachteter Effekt wenn die Passw√∂rter vorher einfacher waren und der Benutzer gezwungen wurde diese zu erweitern:</p>
<blockquote>
<p>Password11##</p>
<p>Password12!!</p>
</blockquote>
<p>D.h. die Passworte werden mit m√∂glichst geringem Aufwand erweitert.</p>
</div>
</div><div class="ld-slide" id="aufbau-von-passwortern-zusammenfassung">
<h2>Aufbau von Passw√∂rtern - Zusammenfassung</h2>
<ul class="more-space-between-list-items simple">
<li><p>Passw√∂rter, die h√§ufig eingegeben werden m√ºssen, basieren in den allermeisten F√§llen auf <span class="ger-quote">echten</span> W√∂rtern.</p></li>
<li><p>Echte W√∂rter werden oft nicht unver√§ndert verwendet, sondern nach einfachen Regeln umgewandelt, z. B. durch Anh√§ngen einer Zahl oder eines Sonderzeichens, Ver√§nderung der Gro√ü-/Kleinschreibung, etc.</p></li>
</ul>
<aside class="admonition incremental small">
<p class="admonition-title">Frage</p>
<p>Wie k√∂nnen wir gute Passwortkandidaten identifizieren/generieren, wenn ein <em>Leak</em> nicht ausreicht oder nur eine kleine Anzahl von Passw√∂rtern getestet werden kann?</p>
<div class="incremental docutils container">
<p>Zum Beispiel dauert das Testen aller Passw√∂rter von Rockyou...:</p>
<p>~13.000.000 Passworte / 5 Hashes/Sekunde ‚âà 1 Monat</p>
<p>~13.000.000 Passworte / 5 Hashes/Stunde ‚âà ~297 Jahre</p>
</div>
</aside>
</div><div class="ld-slide" id="herausforderungen-beim-testen-generieren-von-passwortern">
<h2>Herausforderungen beim Testen/Generieren von Passw√∂rtern</h2>
<p>Aufgrund der <span class="ger-quote">Unm√∂glichkeit</span> eines Brute-Force-Angriffs stellen sich folgende Herausforderungen:</p>
<ul class="incremental simple">
<li><p>Verf√ºgbare <em>Kontextinformationen sollten in die Auswahl/Generierung einflie√üen</em>.</p></li>
<li><p>Es sollten nur <em>technisch sinnvolle</em> Passw√∂rter getestet/generiert werden.</p></li>
<li><p>Es sollten <em>keine Duplikate</em> getestet werden.</p></li>
<li><p>Auswahl/Generierung von <em>Passw√∂rten in absteigender Wahrscheinlichkeit</em>.</p></li>
<li><p><span class="not-important">Die Auswahl/Generierung sollte effizient sein.</span></p></li>
</ul>
<div class="supplemental docutils container">
<p>Technisch sinnvolle Passw√∂rter sind solche, die die zu Grunde liegenden Passwortrichtlinien und auch weiteren technischen Anforderungen erf√ºllen. Zum Beispiel den von der Software verwendeten Zeichensatz (UTF-8, ASCII, ...) oder im Falle eines Smartphones/Krytosticks die eingebbaren Zeichen.</p>
<p>Sollte der Algorithmus zum Generieren der Passw√∂rter langsamer sein als die Zeit, die ben√∂tigt wird, um ein Passwort zu falsifizieren, dann beschr√§nkt nicht mehr l√§nger nur die Hashrate den Suchraum.</p>
</div>
</div><div class="ld-slide" id="ansatze-und-werkzeuge-zum-generieren-von-passwortlisten">
<h2>Ans√§tze und Werkzeuge zum Generieren von Passwortlisten</h2>
<ul class="simple">
<li><dl class="simple">
<dt>Grundlegende Werkzeuge zum <span class="ger-quote">vermischen von W√∂rtern</span> (<span class="eng">Word-mangling</span>)</dt>
<dd><ul>
<li><p>Prince</p></li>
<li><p>Markov-Modelle (OMEN)</p></li>
<li><p>Hashcat</p></li>
<li><p>...</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="incremental docutils container">
<p>Um vorhandene Kontextinformationen zu erweitern, k√∂nnen ggf. (frei) verf√ºgbare Wordembeddings verwendet werden.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://relatedwords.org/relatedto/Ferrari">RelatedWords.org</a> setzt (unter anderem) auf ConceptNet und WordEmbeddings.</p></li>
<li><p><a class="reference external" href="https://reversedictionary.org/wordsfor/Manhattan">Reversedictionary.org</a> setzt auf WordNet und liefert erg√§nzende Ergebnisse.</p></li>
</ul>
</div>
</div><div class="ld-slide" id="markov-ketten">
<h2>Markov-Ketten</h2>
<aside class="admonition note smaller incremental">
<p class="admonition-title">Hintergrund</p>
<p>Eine Markov-Kette beschreibt eine Sequenz m√∂glicher Ereignisse in welcher die Wahrscheinlichkeit des N√§chsten nur vom Zustand des vorherigen abh√§ngt.</p>
</aside>
<p>OMEN lernt - zum Beispiel basierend auf Leaks - die Wahrscheinlichkeiten f√ºr das Aufeinanderfolgen von Bigrammen und Trigrammen und nutzt diese, um neue Passwortkandidaten zu generieren.</p>
<aside class="admonition small incremental">
<p class="admonition-title">Grundlegende Idee</p>
<p>Gegeben: <span class="docutils literal">lachen, Sachen, Last, Muster</span></p>
<p>Bigramme: <span class="docutils literal">2*la, 2*ch, 2*en, sa, 2*st, mu, er</span></p>
<p>Auf ein <span class="docutils literal">st</span> folgt entweder ein <span class="docutils literal">er</span> oder <span class="docutils literal">&lt;Wortende&gt;</span>; demzufolge ist <span class="docutils literal">laster</span> ein Kandidat, aber auch <span class="docutils literal">must</span>.</p>
</aside>
</div><div class="ld-slide" id="password-cracking-using-probabilistic-context-free-grammars-pcfg">
<h2>Password Cracking Using Probabilistic Context-Free Grammars <a class="citation-reference" href="#pcfg-1" id="citation-reference-1" role="doc-biblioref">[PCFG]</a></h2>
<ul class="incremental smaller">
<li><p>Lernt die Muster, Worte, Ziffern und verwendeten Sonderzeichen basierend auf der Auswertung von realen Leaks. Die gelernte Grammatik wird als Schablone verwendet und aus <span class="ger-quote">W√∂rterb√ºchern</span> bef√ºllt. (Zum Beispiel: <span class="docutils literal">S ‚Üí D1L3S2 ‚Üí 1L3!! ‚Üí 1luv!!</span> )</p></li>
<li><p>Generiert Passwortkandidaten mit absteigender Wahrscheinlichkeit.</p></li>
<li><dl>
<dt>Proze√ü:</dt>
<dd><ol class="arabic">
<li><p>Vorverarbeitung, um die Basisstrukturen und deren Wahrscheinlichkeiten zu identifizieren (z.B. zwei Ziffern gefolgt von einem Sonderzeichen und 8 Buchstaben.)</p></li>
<li><p>Passwortkandidatengenerierung unter Beachtung der Wahrscheinlichkeiten der Basisstrukturen und der Wahrscheinlichkeiten der Worte, Ziffern und Sonderzeichen.</p>
<p><span class="not-important">(In der Originalversion wurden die Wahrscheinlichkeiten von Worten nicht beachtet; die auf GitHub verf√ºgbare Version enth√§lt jedoch zahlreiche Verbesserungen.)`</span></p>
</li>
</ol>
</dd>
</dl>
</li>
</ul>
</div><div class="ld-slide" id="pcfg-analyse-beispiel">
<h2>PCFG - Analyse - Beispiel</h2>
<div class="small docutils container">
<p>Im ersten Schritt werden die Produktionswahrscheinlichkeiten von Basisstrukturen, Ziffernfolgen, Sonderzeichenfolgen und Alpha-Zeichenfolgen ermittelt. (Z. Bsp.:
<span class="docutils literal">!cat123</span> <span class="math">\(\Rightarrow\)</span> S<sub>
1</sub>L<sub>
3</sub>D<sub>
3</sub>)</p>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>Basis Struktur</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>L3S1D3</p></td>
<td><p>12788</p></td>
<td><p>0.75</p></td>
</tr>
<tr><td><p>S1L3D3</p></td>
<td><p>2789</p></td>
<td><p>0.35</p></td>
</tr>
</tbody>
</table>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>S1</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>!</p></td>
<td><p>12788</p></td>
<td><p>0.50</p></td>
</tr>
<tr><td><p>.</p></td>
<td><p>2789</p></td>
<td><p>0.30</p></td>
</tr>
<tr><td><p>&#64;</p></td>
<td><p>1708</p></td>
<td><p>0.20</p></td>
</tr>
</tbody>
</table>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>L3</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>cat</p></td>
<td><p>12298</p></td>
<td><p>0.85</p></td>
</tr>
<tr><td><p>dog</p></td>
<td><p>2890</p></td>
<td><p>0.15</p></td>
</tr>
</tbody>
</table>
<table class="smaller highlight-line-on-hover">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr><th class="head"><p>D3</p></th>
<th class="head"><p>H√§ufigkeit</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>123</p></td>
<td><p>10788</p></td>
<td><p>0.60</p></td>
</tr>
<tr><td><p>321</p></td>
<td><p>5789</p></td>
<td><p>0.35</p></td>
</tr>
<tr><td><p>654</p></td>
<td><p>4708</p></td>
<td><p>0.25</p></td>
</tr>
</tbody>
</table>
</div>
</div><div class="ld-slide" id="pcfg-generierung-beispiel">
<h2>PCFG - Generierung - Beispiel</h2>
<div class="small margin-above docutils container">
<p><strong>Ergebnis der Analyse</strong>:</p>
<aside class="admonition note small">
<p class="admonition-title">Hinweis</p>
<p>Nicht-Terminale = <span class="docutils literal">[S,T]</span></p>
<p>Terminale = <span class="docutils literal">[a, b, c, d, e, ‚Ä¶, z, 0, ‚Ä¶, 9]</span></p>
</aside>
<table class="small highlight-line-on-hover">
<thead>
<tr><th class="head"><p>Nich-Terminale</p></th>
<th class="head"><p>Produktion</p></th>
<th class="head"><p>Wahrscheinlichkeit der Produktion</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>S</p></td>
<td><p><span class="docutils literal">password</span>T</p></td>
<td><p>0.7</p></td>
</tr>
<tr><td><p>S</p></td>
<td><p><span class="docutils literal">secure</span>T</p></td>
<td><p>0.3</p></td>
</tr>
<tr><td><p>T</p></td>
<td><p><span class="docutils literal">123</span></p></td>
<td><p>0.6</p></td>
</tr>
<tr><td><p>T</p></td>
<td><p><span class="docutils literal">111</span></p></td>
<td><p>0.4</p></td>
</tr>
</tbody>
</table>
<div class="incremental docutils container">
<p><strong>Ableitung</strong>:</p>
<ol class="arabic simple">
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password123</span></p></li>
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">password111</span></p></li>
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure123</span></p></li>
<li><p>S <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure</span>T <span class="math">\(\Rightarrow\)</span> <span class="docutils literal">secure111</span></p></li>
</ol>
</div>
</div>
</div><div class="ld-slide" id="pcfg">
<h2>PCFG+</h2>
<dl class="field-list simple">
<dt>Next Gen PCFG Password Cracking <a class="citation-reference" href="#ngpcfg" id="citation-reference-2" role="doc-biblioref">[NGPCFG]</a><span class="colon">:</span></dt>
<dd><p>Unterst√ºtzt Tastaturwanderungen (zum Beispiel asdf oder qwerty12345), Passworte bestehend aus mehrerern Worten und wiederholten Worten (zum Beispiel qpqpqpq).</p>
</dd>
</dl>
<dl class="incremental line-above margin-above field-list simple">
<dt>On Practical Aspects of PCFG Password Cracking <a class="citation-reference" href="#paofpcfg" id="citation-reference-3" role="doc-biblioref">[PAofPCFG]</a><span class="colon">:</span></dt>
<dd><p>Im Wesentlichen Performanceoptimierungen, um PCFG schneller zu machen.</p>
</dd>
</dl>
<dl class="incremental line-above margin-above field-list simple">
<dt>Using personal information in targeted grammar-based probabilistic password attacks <a class="citation-reference" href="#piandpcfg" id="citation-reference-4" role="doc-biblioref">[PIandPCFG]</a><span class="colon">:</span></dt>
<dd><p>Im Wesentlichen werden zwei PCFGs gewichtet zusammengef√ºhrt (0 &lt; alpha &lt; 1).</p>
</dd>
</dl>
</div><div class="ld-slide" id="sepass-semantic-password-guessing-using-k-nn-similarity-search-in-word-embeddings-sepass">
<h2>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings <a class="citation-reference" href="#sepass" id="citation-reference-5" role="doc-biblioref">[SePass]</a></h2>
<p>Zus√§tzliche Wortkandidaten werden mithilfe von <em>Worteinbettungen</em> identifiziert. Erm√∂glicht es, automatisch verwandte W√∂rter zu finden.</p>
<p><strong>Example</strong></p>
<div class="two-columns smaller docutils container">
<div class="column docutils container">
<p>Gegeben:</p>
<blockquote>
<p><span class="green">Ferrari</span>01</p>
<p>!<span class="green">Audi</span>!</p>
<p><span class="green">Mercedes</span>88</p>
<p><span class="green">Bugatti</span> 666</p>
</blockquote>
</div>
<div class="column docutils container">
<p>&quot;Offensichtliche&quot; Kandidaten f√ºr Basisw√∂rter:</p>
<blockquote>
<div class="incremental docutils container">
<p>Porsche</p>
<p>Mclaren</p>
<p>Lamborghini</p>
<p>Aston Martin</p>
</div>
</blockquote>
</div>
</div>
</div><div class="ld-slide" id="sepass-semantic-password-guessing-using-k-nn-similarity-search-in-word-embeddings">
<h2>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings</h2>
<p>Vermeidet menschliche Voreingenommenheit.</p>
<p><strong>Example</strong></p>
<div class="two-columns smaller docutils container">
<div class="column docutils container">
<p>Gegeben:</p>
<blockquote>
<p><span class="green">Luke</span>2017</p>
<p><span class="green">John</span>1976</p>
<p>01<span class="green">Mark</span>!</p>
</blockquote>
</div>
<div class="column docutils container">
<p>&quot;Offensichtliche&quot; Kandidaten f√ºr Basisw√∂rter:</p>
<blockquote>
<div class="incremental docutils container">
<p>Matthew</p>
<p>Bible</p>
<p>Gospel</p>
</div>
</blockquote>
</div>
</div>
</div><div class="ld-slide" id="sepass-semantic-password-guessing-using-k-nn-similarity-search-in-word-embeddings-1">
<h2>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings</h2>
<p>Vermeidet menschliche Voreingenommenheit.</p>
<p><strong>Example</strong></p>
<div class="two-columns smaller docutils container">
<div class="column docutils container">
<p>Gegeben:</p>
<blockquote>
<p><span class="green">Luke</span>2017</p>
<p><span class="green">John</span>1976</p>
<p>01<span class="green">Mark</span>!</p>
</blockquote>
</div>
<div class="column docutils container">
<p>&quot;Offensichtliche&quot; Kandidaten f√ºr Basisw√∂rter:</p>
<blockquote>
<div class="incremental docutils container">
<p>Leia</p>
<p>Darth Vader</p>
<p>Palpatine</p>
</div>
</blockquote>
</div>
</div>
</div><div class="ld-slide" id="bewertung-von-passworten">
<h2>Bewertung von Passworten</h2>
<div class="tiny docutils container">
<dl class="field-list simple">
<dt>Donaudampfschifffahrt<span class="colon">:</span></dt>
<dd><p>Ist weder in Rockyou noch im Duden und auch nicht in den Corpora von Twitter und Facebook von 2022 zu finden.</p>
</dd>
<dt>Passwort<span class="colon">:</span></dt>
<dd><p>Nr. 93968 in Rockyou.</p>
</dd>
<dt>password123<span class="colon">:</span></dt>
<dd><p>Nr. 1348 in Rockyou.</p>
</dd>
<dt>2wsx3edc4rfv<span class="colon">:</span></dt>
<dd><p>So nicht in Rockyou, aber 1qaz2wsx3edc4rfv ist Nr. 143611 in Rockyou.</p>
</dd>
<dt>Haus Maus<span class="colon">:</span></dt>
<dd><p>In Rockyou ist lediglich hausmaus zu finden.</p>
</dd>
<dt>iluvu<span class="colon">:</span></dt>
<dd><p>Nr. 1472 in Rockyou.</p>
</dd>
<dt>Emily060218<span class="colon">:</span></dt>
<dd><p>Emily ist Nr. 35567 in Rockyou. Die Zahl ist ganz offensichtlich ein Datum: 6. Feb. 2018 und k√∂nnte ein Geburtsdatum, Hochzeitsdatum, oder ein f√ºr die Person vergleichbar bedeutends Datum sein.</p>
</dd>
<dt>MuenchenHamburg2023!!!!<span class="colon">:</span></dt>
<dd><p>Das Passwort ist zwar sehr lang aber es handelt sich vermutlich um zwei - f√ºr die entsprechende Person - bedeutende Orte. Die Zahl und die Sonderzeichen sind vermutlich auf eine Passwortrichtlinie zur√ºckzuf√ºhren.</p>
</dd>
<dt>hjA223dn4fw&quot;√º√§K√ü√ü k`‚â§-~ajsdk<span class="colon">:</span></dt>
<dd><p>28 Stellen basierend auf einem Zeichensatz, der vermutlich ca. 192 Zeichen pro Stelle umfasst.</p>
</dd>
<dt>Baum Lampe Haus Steak Eis Berg<span class="colon">:</span></dt>
<dd><p>Es handelt sich um ein Passwort mit 30 Stellen, dass vermutlich mit Hilfe von Diceware generiert wurde und 6 Worte umfasst.</p>
</dd>
<dt>ME01703138541<span class="colon">:</span></dt>
<dd><p>Namensk√ºrzel und Telefonnummer.</p>
</dd>
</dl>
</div>
<div class="supplemental docutils container">
<div class="foundations blue-background docutils container">
<p><strong>Diceware</strong></p>
<p>Auch wenn dem Angreifer
(a) bekannt ist, dass das Passwort mit Hilfe von Diceware generiert wurde,
(b) die zugrundeliegende Wortliste vorliegt und
(c) auch die L√§nge (hier 6 Worte) bekannt sein sollte, dann umfasst der Suchraum: <span class="math">\((6^5)^6 \approx 2,21\times 10^{23}\)</span> Passwortkandidaten. Sollte man also mit einer Geschwindigkeit von 1 Billion Hashes pro Sekunde angreifen k√∂nnen, dann brauch man noch immer √ºber 7000  Jahre f√ºr das Absuchen des vollst√§ndigen Suchraums.</p>
<p>Beim klassischen Dicewareansatz umfasst das W√∂rterbuch <span class="math">\(6^5\)</span> Worte, da man mit einem normalen W√ºrfel f√ºnfmal W√ºrfelt und dann das entsprechende Wort nachschl√§gt. W√ºrde man zum Beispiel die folgenden Zahlen w√ºrfeln: 1,4,2,5,2. Dann w√ºrde man das Wort zur Zahl: 14252 nachschlagen.</p>
</div>
<div class="foundations blue-background docutils container">
<p><strong>Zeichensatz</strong></p>
<p>Auf einer deutschen Standardtastatur f√ºr Macs k√∂nnen in Kombination mit <span class="ger-quote">Shift</span>, <span class="ger-quote">Alt</span> und <span class="ger-quote">Alt+Shift</span> zum Beispiel 192 verschiedene Zeichen eingegeben werden ohne auf Unicode oder Zeichentabellen zur√ºckgreifen zu m√ºssen.</p>
</div>
</div>
</div><div class="ld-slide" id="worterbuchgenerierung-evaluation-von-werkzeugen">
<h2>W√∂rterbuchgenerierung - Evaluation von Werkzeugen</h2>
<img alt="Evaluation verschiedener Ans√§tze f√ºr die Passwortevaluation" class="align-center" src="passwortwiederherstellung-evaluation.png" style="width: 1200px;" />
</div><div class="new-section transition-scale ld-slide" id="werkzeuge-und-methoden-zur-wiederherstellung-von-passwortern">
<h2>Werkzeuge und Methoden zur Wiederherstellung von Passw√∂rtern</h2>
</div><div class="new-subsection ld-slide" id="grundlegende-werkzeuge">
<h2>Grundlegende Werkzeuge</h2>
<ul class="simple">
<li><p><a class="reference external" href="../shell/shell.rst.html">Linux Shell</a></p></li>
<li><p><a class="reference external" href="../regexp/regexp.rst.html">Regul√§re Ausdr√ºcke</a></p></li>
</ul>
</div><div class="new-subsection transition-fade ld-slide" id="extraktion-von-hashes">
<h2>Extraktion von Hashes</h2>
<div class="supplemental docutils container">
<p><strong>Hinweis</strong></p>
<p>Im Folgenden diskutieren wir nur exemplarisch die Extraktion einiger Hashes, um das grundlegende Vorgehen zu besprechen. Im Allgemeinen gibt es f√ºr weit(er) verbreitete Software h√§ufig bereits L√∂sungen zur Hashextraktion. Falls nicht, dann muss man Googeln und/oder Reverse Engineering betreiben.</p>
</div>
</div><div class="ld-slide" id="quellen-fur-werkzeuge-anleitungen">
<h2>Quellen f√ºr Werkzeuge &amp; Anleitungen</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hashcat/hashcat/tree/master/tools">Hashcat Tools</a></p></li>
<li><p><a class="reference external" href="https://github.com/openwall/john">John (the Ripper)</a></p></li>
<li><p>Googeln</p></li>
</ul>
</div><div class="ld-slide" id="relevante-linux-kommandozeilenwerkzeuge">
<h2>Relevante Linux Kommandozeilenwerkzeuge</h2>
<ul class="incremental">
<li><p><span class="docutils literal">file</span> dient der Ermittlung des Typs einer Datei.</p></li>
<li><p><span class="docutils literal">binwalk</span> durchsucht Bin√§rdateien in Hinblick auf das Vorkommen bekannter Muster (insbsondere Dateiheader, aber auch Kryptokonstanten etc.)</p>
<p><span class="docutils literal"><span class="pre">-E</span></span> kann zur Visualisierung der Entropie verwendet werden.</p>
</li>
<li><p><span class="docutils literal">dd</span> kopiert Daten blockweise von einem Startpunkt in einer Datei in eine andere Datei. Wird ggf. zum Extrahieren von Hashes ben√∂tigt.</p></li>
<li><p><span class="docutils literal">xxd</span> und <span class="docutils literal">hexdump</span> erstellen beide einen Hexdump einer Datei.</p></li>
</ul>
</div><div class="ld-slide" id="verschlusselte-pdf-dateien">
<h2>Verschl√ºsselte PDF Dateien</h2>
<p>Extraktion erfolgt (zum Beispiel) mit den John Tools:</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>pdf2john<span class="whitespace"> </span>Document.pdf<span class="whitespace"> </span>&gt;<span class="whitespace"> </span>Document.pdf.john<span class="whitespace">
</span>$<span class="whitespace"> </span>cat<span class="whitespace"> </span>Document.pdf.john<span class="whitespace">
</span>Document.pdf:<span class="name variable">$pdf$4</span>*4*128*-3392*1*16*861da8b9c1672ddc3953dee025<span class="whitespace">
</span>5d622d*32*301d0810078c5698ab17b286e2123070000000000000000000000<span class="whitespace">
</span><span class="literal number">00000000000</span>*32*c038ddb8fbdaeb67b6e80e2d936108fc851ff40c5b652c71<span class="whitespace">
</span>97bda4f797939532</code></pre>
<p>Danach kann der Hash entweder direkt mit John angegriffen werden, oder nach dem Entfernen des Headers mit Hashcat.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>pdf2john<span class="whitespace"> </span>Document.pdf<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;s/^[^:]+://&quot;</span><span class="whitespace">        </span><span class="comment single"># Dateiname entfernen
</span><span class="whitespace">  </span>&gt;<span class="whitespace"> </span>Document.pdf.hashcat</code></pre>
</div><div class="ld-slide" id="libreoffice-dateien">
<h2>Libreoffice Dateien</h2>
<p>Extraktion des Basishashes erfolgt auch hier (zum Beispiel) mit den John Tools. Danach muss sowohl der Prefix als auch der Suffix, der f√ºr die Entschl√ºsselung nicht relevant ist, abgeschnitten werden, wenn im Folgenden Hashcat verwendet werden soll.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>libreoffice2john<span class="whitespace"> </span>Document.odt<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span>-e<span class="whitespace"> </span><span class="literal string single">'s/[^:]+://'</span><span class="whitespace"> </span>-e<span class="whitespace"> </span><span class="literal string single">'s/:::::[^:]+$//'</span><span class="whitespace">
  </span>&gt;<span class="whitespace"> </span>Document.odt.hashcat</code></pre>
<div class="incremental docutils container">
<p>Um zu verstehen, wie der Hash genau auszusehen hat, ist es im Allgemeinen hilfreich sich die erwartete Struktur f√ºr einen Hash anzusehen: <a class="reference external" href="https://hashcat.net/wiki/doku.php?id=example_hashes">Hashcat - Example Hashes</a></p>
</div>
</div><div class="ld-slide" id="verschlusselte-mac-disk-images-dmg">
<h2>Verschl√ºsselte Mac Disk Images (.dmg)</h2>
<p>In diesem Fall hat nur John (the Ripper) Unterst√ºtzung f√ºr den konkreten Hash.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>dmg2john<span class="whitespace"> </span>Container.dmg<span class="whitespace"> </span>&gt;<span class="whitespace"> </span>Container.dmg.john<span class="whitespace">   </span><span class="comment single"># Extraktion</span></code></pre>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span>john<span class="whitespace"> </span>Container.dmg.john<span class="whitespace"> </span><span class="literal string escape">\ </span><span class="whitespace">                    </span><span class="comment single"># Angriff
</span><span class="whitespace">  </span>--wordlist<span class="operator">=</span>/usr/share/wordlists/rockyou.txt</code></pre>
</div><div class="ld-slide" id="verschlusselter-usb-stick-apfs-volume">
<h2>Verschl√ºsselter USB Stick (APFS Volume)</h2>
<p>Es liegt ein normaler USB Stick vor auf dem eine Partition vom Typ <span class="docutils literal">Apple APFS</span> ist.</p>
<pre class="smaller literal-block">Disk /dev/sda: 14.45 GiB, 15518924800 bytes, 30310400 sectors
Disk model: Flash Disk
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: 1D63D8AE-7CBC-47BE-9093-8469B0786EAF

Device      Start      End  Sectors  Size Type
/dev/sda1      40   409639   409600  200M EFI System
/dev/sda2  409640 30310359 29900720 14.3G Apple APFS</pre>
</div><div class="ld-slide" id="verschlusselter-usb-stick-apfs-volume-1">
<h2>Verschl√ºsselter USB Stick (APFS Volume)</h2>
<ol class="arabic">
<li><p>Installation von <a class="reference external" href="https://github.com/Banaanhangwagen/apfs2hashcat">apfs2hashcat</a> (umfasst das Kompilieren der Sourcen)</p></li>
<li><p>Hash extrahieren durch &quot;Copy-and-Paste&quot; aus dem Logfile/der Konsole.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>sudo<span class="whitespace"> </span>./apfs-dump-quick<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span>/dev/sda2<span class="whitespace"> </span><span class="literal string escape">\ </span><span class="whitespace">  </span><span class="comment single"># /dev/sda2 ist die Ziel APFS Partition
</span><span class="whitespace">  </span>/tmp/log.txt</code></pre>
</li>
<li><p>Hash angreifen</p>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">18300</span><span class="whitespace"> </span>fv2.hashcat<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span>/usr/share/wordlists/rockyou.txt</code></pre>
</li>
</ol>
</div><div class="new-subsection transition-fade ld-slide" id="passwortwiederherstellung-mit-hashcat">
<h2>Passwortwiederherstellung mit Hashcat</h2>
</div><div class="ld-slide" id="hashcat-einfuhrung">
<h2>Hashcat - Einf√ºhrung</h2>
<p>Hashcat ist - Stand 2023 - das Tool zum Wiederherstellen von Passw√∂rtern.</p>
<p>Liest ein(e Liste von) Hash(es) ein und pr√ºft, ob einer der angegebenen Passwortkandidaten nach dem Hashen mit einem gegeben Hash √ºbereinstimmt.</p>
<ul class="incremental simple">
<li><p>unterst√ºtzt √ºber 350 Hash-Typen (mit einigen automatischen Erkennungen)</p></li>
<li><dl class="simple">
<dt>unterst√ºtzt mehrere Angriffsmodi, z.B.,</dt>
<dd><ul>
<li><p>W√∂rterbuch (ggf. mit Regeln)</p></li>
<li><p>Masken</p></li>
<li><p>Kombinationen aus W√∂rterb√ºchern und Masken</p></li>
<li><p>&lt;Lesen von Passwortkandidaten aus stdin&gt;</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Open-Source</p></li>
<li><p>Kann zum Generieren von neuen Kandidaten verwendet werden.</p></li>
<li><p>ist CUDA/OpenCL basiert und <strong>auf entsprechenden Grafikkarten extrem schnell</strong>.</p></li>
</ul>
</div><div class="ld-slide" id="hashcat-relevante-parameter">
<h2>Hashcat - relevante Parameter</h2>
<div class="two-columns smaller docutils container">
<div class="column docutils container">
<p>Angriffsmodi:</p>
<pre class="code bash literal-block"><code>-a0<span class="whitespace"> </span>Angriff<span class="whitespace"> </span>mit<span class="whitespace"> </span>W√∂rterbuch<span class="whitespace">
    </span><span class="operator">(</span>ggf.<span class="whitespace"> </span>mit<span class="whitespace"> </span>Regeln<span class="whitespace"> </span>-r<span class="operator">)</span><span class="whitespace">

</span>-a1<span class="whitespace"> </span>Kombinationsangriff<span class="whitespace">
    </span>Angriff<span class="whitespace"> </span>mit<span class="whitespace"> </span>dem<span class="whitespace"> </span>Kreuzprodukt<span class="whitespace">
    </span>zweier<span class="whitespace"> </span>W√∂rterb√ºcher.<span class="whitespace">

</span>-a3<span class="whitespace"> </span>Brute-force<span class="whitespace"> </span>Angriff<span class="whitespace">

</span>-a6<span class="whitespace"> </span>Hybridangriff<span class="whitespace">
    </span>W√∂rterbuch<span class="whitespace"> </span>und<span class="whitespace"> </span>Maske</code></pre>
</div>
<div class="column docutils container">
<p>Brute-force - Eingebaute Zeichens√§tze:</p>
<p class="monospaced">?l = abcdefghijklmnopqrstuvxyz</p>
<p class="monospaced">?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ</p>
<p class="monospaced">?d = 0123456789</p>
<p class="monospaced">?s = !&quot;$%&amp;'()*+,-./:;&lt;=&gt;?&#64;[]^_{|}~</p>
<p class="monospaced">?a = ?l?u?d?s</p>
<p>Definition von bis zu 4 eigenen Zeichens√§tzen ist m√∂glich.</p>
</div>
</div>
</div><div class="ld-slide" id="hashcat-ausgewahlte-regeln">
<h2><a class="reference external" href="https://hashcat.net/wiki/doku.php?id=rule_based_attack">Hashcat - Ausgew√§hlte Regeln</a></h2>
<table class="small incremental">
<thead>
<tr><th class="head"><p>Name</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Input</p></th>
<th class="head"><p>Output</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Nothing</p></td>
<td><p>:</p></td>
<td><p>Do nothing (passthrough)</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
</tr>
<tr><td><p>Lowercase</p></td>
<td><p>l</p></td>
<td><p>Lowercase all letters</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssw0rd</span></p></td>
</tr>
<tr><td><p>Uppercase</p></td>
<td><p>u</p></td>
<td><p>Uppercase all letters</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">P&#64;SSW0RD</span></p></td>
</tr>
<tr><td><p>Capitalize</p></td>
<td><p>c</p></td>
<td><p>Capitalize the first letter and lower the rest</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">P&#64;ssw0rd</span></p></td>
</tr>
<tr><td><p>Toggle Case</p></td>
<td><p>t</p></td>
<td><p>Toggle the case of all characters in word.</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">P&#64;SSw0RD</span></p></td>
</tr>
<tr><td><p>Reverse</p></td>
<td><p>r</p></td>
<td><p>Reverse the entire word</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">dr0Wss&#64;p</span></p></td>
</tr>
<tr><td><p>Duplicate</p></td>
<td><p>d</p></td>
<td><p>Duplicate entire word</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssW0rdp&#64;ssW0rd</span></p></td>
</tr>
<tr><td><p>Append</p></td>
<td><p>$X</p></td>
<td><p>Append X to the end</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">p&#64;ssW0rdX</span></p></td>
</tr>
<tr><td><p>Prepend</p></td>
<td><p>^X</p></td>
<td><p>Prepend X at the beginning</p></td>
<td><p><span class="docutils literal">p&#64;ssW0rd</span></p></td>
<td><p><span class="docutils literal">Xp&#64;ssW0rd</span></p></td>
</tr>
<tr><td><p>...</p></td>
<td><p>...</p></td>
<td><p>...</p></td>
<td><p>...</p></td>
<td><p>...</p></td>
</tr>
</tbody>
</table>
</div><div class="small ld-slide" id="szenario-1-eine-pin-angreifen">
<h2>Szenario 1: eine Pin Angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Gegeben sein ein mit SHA256 gehashter 5-stelliger Pin in der Datei: <span class="docutils literal">5_digits_pin.sha256</span>.</p>
<p>Hashwert:</p>
<div class="monospaced docutils container">
<p><span class="docutils literal">79737ac46dad121166483e084a0727e5d6769fb47fa9b0b627eba4107e696078</span></p>
</div>
<p><strong>Angriff mit Maske</strong></p>
<pre class="code bash incremental literal-block"><code>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>5_digits_pin.sha256<span class="whitespace"> </span>-a3<span class="whitespace"> </span><span class="literal string double">&quot;?d?d?d?d?d&quot;</span></code></pre>
<div class="incremental docutils container">
<dl class="field-list simple">
<dt>-m 1400<span class="colon">:</span></dt>
<dd><p>Modus f√ºr einen einfachen SHA256 Hash.</p>
</dd>
<dt>-a3<span class="colon">:</span></dt>
<dd><p>bezeichnet einen Maskenangriffe</p>
</dd>
<dt>&quot;?d?d?d?d?d&quot;<span class="colon">:</span></dt>
<dd><p>Beschreibt die Maske. Hier 5 Ziffern (<span class="eng">digits</span>).</p>
</dd>
</dl>
</div>
</div><div class="small ld-slide" id="szenario-2-ein-hoffentlich-einfaches-loginpasswort-angreifen">
<h2>Szenario 2: Ein (hoffentlich) einfaches Loginpasswort angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Ein mit SHA512crypt gehashtes Passwort in der Datei: <span class="docutils literal">password.sha512crypt</span>.</p>
<p><strong>Angriff mit W√∂rterbuch</strong></p>
<pre class="code bash literal-block"><code>hashcat<span class="whitespace"> </span>password.sha512crypt<span class="whitespace"> </span>-a0<span class="whitespace"> </span>/usr/share/wordlists/rockyou.txt</code></pre>
<div class="incremental docutils container">
<dl class="field-list simple">
<dt>-a0<span class="colon">:</span></dt>
<dd><p>bezeichnet einen W√∂rterbuchangriff.</p>
</dd>
<dt>/usr/share/wordlists/rockyou.txt<span class="colon">:</span></dt>
<dd><p>Das zum Angriff verwendete W√∂rterbuch; der Pfad ist der Standardpfad zum Rockyou W√∂rterbuch in Kali Linux.</p>
</dd>
</dl>
</div>
</div><div class="small ld-slide" id="szenario-3-ein-komplexeres-passwort-angreifen">
<h2>Szenario 3: ein komplexeres Passwort angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Ein mit MD5 gehashtes Passwort in der Datei: <span class="docutils literal">password.md5</span>. Ein erster Angriff mit Rockyou war nicht erfolgreich.</p>
<p><strong>Angriff mit W√∂rterbuch und Regelsatz</strong></p>
<pre class="code bash incremental literal-block"><code>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">0</span><span class="whitespace"> </span>password.md5<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">            </span>-a0<span class="whitespace"> </span>/usr/share/wordlists/rockyou.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">            </span>-r<span class="whitespace"> </span>/usr/share/hashcat/rules/best64.rule</code></pre>
<div class="incremental docutils container">
<dl class="field-list">
<dt>-a0<span class="colon">:</span></dt>
<dd><p>bezeichnet einen W√∂rterbuchangriff.</p>
</dd>
<dt>/usr/share/wordlists/rockyou.txt<span class="colon">:</span></dt>
<dd><p>Das zum Angriff verwendete W√∂rterbuch.</p>
</dd>
<dt>-r /usr/share/hashcat/rules/best64.rule<span class="colon">:</span></dt>
<dd><p>Der zum Beugen der Passwortkandidaten verwendete Regelsatz.</p>
<p>Der Regelsatz best64 hat sich in einem Wettbewerb als <span class="ger-quote">bester</span> Regelsatz erwiesen.</p>
</dd>
</dl>
</div>
</div><div class="small ld-slide" id="szenario-4-ein-passwort-mit-salt-angreifen">
<h2>Szenario 4: ein Passwort mit Salt angreifen</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Ein MD5 Hash ist gegeben: <span class="docutils literal">c84b5c34c9ff7d3431018d795b5975e5</span>. Weiterhin ist bekannt, dass der verwendete <em>Salt</em> <span class="docutils literal">SALT</span> ist.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic incremental">
<li><p>Modus f√ºr MD5+Salt heraussuchen (<span class="docutils literal"><span class="pre">-m10</span></span>); ggf. Beispielhash ansehen, um zu verstehen, wie der Hash aufgebaut ist.</p></li>
<li><p>Erzeugen des Hashes f√ºr Hashcat:</p>
<pre class="code bash literal-block"><code><span class="name builtin">echo</span><span class="whitespace"> </span>-n<span class="whitespace"> </span><span class="literal string double">&quot;c84b5c34c9ff7d3431018d795b5975e5:SALT&quot;</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>salted.m5.hash</code></pre>
</li>
<li><p>Mit Hashcat angreifen:</p>
<pre class="code bash literal-block"><code>hashcat<span class="whitespace"> </span>-m10<span class="whitespace"> </span>salted.md5.hash<span class="whitespace">  </span>-a3<span class="whitespace"> </span><span class="literal string single">'?a?a?a?a'</span></code></pre>
</li>
</ol>
<aside class="admonition supplemental">
<p class="admonition-title">L√∂sung</p>
<p>Das Passwort ist <span class="docutils literal">Test</span>. In diesem Fall w√§re es auch m√∂glich gewesen direkt zu Pr√ºfen ob das Passwort <span class="docutils literal">Test</span> ist, indem man Hashcat im Modus -m0 (f√ºr reinen MD5) startet und als Kandidaten <span class="docutils literal">TestSALT</span> vorgibt.</p>
</aside>
</div><div class="small ld-slide" id="szenario-5-kombination-von-worterbuch-mit-eigenem-regelsatz">
<h2>Szenario 5: Kombination von W√∂rterbuch mit eigenem Regelsatz</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Wir greifen einen sogennanten langsamen Hash an und k√∂nnen deswegen nur wenige Passworte gezielt testen.</p>
<p>Aufgrund von Social Engineering/Ermittlungen wissen wir, dass die Person h√§ufig kurze Worte (max 4 Buchstaben nimmt) diese aber oft verdoppelt und h√§ufig die Worte mit einem Gro√übuchstaben anfangen l√§sst.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic simple incremental">
<li><p>Erstellen eines fokussierten W√∂rterbuchs: <span class="docutils literal">candidates.txt</span>.</p></li>
<li><p>Erstellen des Regelsatzes: <span class="docutils literal">case.rule</span>.</p></li>
<li><p>Angriff mit den erstellten W√∂rterbuch und dem Regelsatz.</p></li>
</ol>
</div><div class="small ld-slide" id="szenario-5-kombination-von-worterbuch-mit-eigenem-regelsatz-1">
<h2>Szenario 5: Kombination von W√∂rterbuch mit eigenem Regelsatz</h2>
<p><strong>Angriff</strong></p>
<ol class="arabic">
<li><p>Generierung von <span class="docutils literal">candidates.txt</span></p>
<p>Um sicherzustellen, dass wir keine Duplikate testen, wandeln wir alle Worte in Kleinschreibung um und filtern entsprechende Duplikate. Die Beachtung aller Varianten in Hinblick auf die Gro√ü- und Kleinschreibung wird durch die Regeln sichergestellt.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string double">&quot;^[a-zA-Z]{3,4}(?=[^a-zA-Z])&quot;</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">       </span>/usr/share/wordlists/rockyou.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>tr<span class="whitespace"> </span><span class="operator">[</span>:upper:<span class="operator">]</span><span class="whitespace"> </span><span class="operator">[</span>:lower:<span class="operator">]</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-u<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span>&gt;<span class="whitespace"> </span>candidates.txt</code></pre>
</li>
</ol>
<div class="supplemental docutils container">
<p><strong>Zu Bedenken</strong></p>
<p>Die gezeigte Operation l√∂st die Ordnung in der Datei auf und sortiert diese alphabetisch. Dies ist aber h√§ufig nicht gew√ºnscht - insbesondere wenn der Leak nach Verwendungsh√§ufigkeit sortiert ist!</p>
</div>
</div><div class="small ld-slide" id="szenario-5-kombination-von-worterbuch-mit-eigenem-regelsatz-2">
<h2>Szenario 5: Kombination von W√∂rterbuch mit eigenem Regelsatz</h2>
<p><strong>Angriff</strong></p>
<ol class="arabic">
<li><p>Erstellen des Regelsatzes: <span class="docutils literal">case.rule</span></p>
<p>Um sicherzugehen, dass wir alle Varianten abdecken, brauchen wir drei Regeln.</p>
<table class="incremental no-table-borders" style="width: 100%;">
<tbody>
<tr><td><p>cd</p></td>
<td><p><span class="not-important">Erst Gro√ü-Kleinschreibung anpassen und dann duplizieren.</span></p></td>
</tr>
<tr><td><p>dc</p></td>
<td><p><span class="not-important">Erst duplizieren und dann Gro√ü-Kleinschreibung anpassen.</span></p></td>
</tr>
<tr><td><p>d</p></td>
<td><p><span class="not-important">Einfach nur duplizieren.</span></p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<ol class="arabic incremental" start="2">
<li><p>Angriff mittels Hahcat</p>
<pre class="code bash literal-block"><code>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1700</span><span class="whitespace"> </span>hash.sha125<span class="whitespace"> </span>candidates.txt<span class="whitespace"> </span>-r<span class="whitespace"> </span><span class="keyword">case</span>.rule</code></pre>
</li>
</ol>
<div class="supplemental docutils container">
<p><strong>Tips</strong></p>
<p>Das beherrschen von regul√§ren Ausdr√ºcken ist bei der Passwortrekonstruktion sehr hilfreich.</p>
<p>Der folgende Ausdruck liefert zum Beispiel alle 4stelligen Worte aus Rockyou mit Hilfe eines Lookheads, dass l√§ngere Worte filtert.</p>
<pre class="code bash black literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-Po<span class="whitespace"> </span><span class="literal string double">&quot;^[a-zA-Z]{3,4}(?=[^a-zA-Z])&quot;</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">     </span>/usr/share/wordlists/rockyou.txt</code></pre>
<p>Das Passwort <span class="docutils literal">TreeTree</span> w√ºrde sich damit erfolgreich wiederherstellen lassen.</p>
</div>
</div><div class="small ld-slide" id="szenario-6-kartesiche-produkt-von-zwei-worterbuchern">
<h2>Szenario 6: Kartesiche Produkt von zwei W√∂rterb√ºchern</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Aufgrund von Social Engineering/Ermittlungen wissen wir, dass die Person sehr gerne zwischen deutschen Gro√üst√§dten pendelt. Nachdem andere Versuche nicht zum Erfolge gef√ºhrt habe, wollen wir jetzt Passworte der Art: &quot;BerlinHamburg&quot; testen.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic incremental">
<li><p>Erstellen eines fokussierten W√∂rterbuchs durch &quot;Googeln&quot; von gro√üen St√§dten.</p></li>
<li><p>Angriff durch Kombination des W√∂rterbuchs mit sich selbst.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>hash.sha256<span class="whitespace"> </span>-a<span class="whitespace"> </span><span class="literal number">1</span><span class="whitespace"> </span>big_cities2.txt<span class="whitespace"> </span>big_cities2.txt</code></pre>
</li>
</ol>
</div><div class="small ld-slide" id="szenario-7-worterbuch-mit-maske">
<h2>Szenario 7: W√∂rterbuch mit Maske</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Es ist bekannt, dass die Passw√∂rter der Gruppierung h√§ufig mit vier Zahlen und zwei Sonderzeichen aus einer sehr kleinen Mengen von Sonderzeichen (<span class="docutils literal">$!.</span>) enden. Davor kommt ein Wort mit ca. 4-8 Stellen in den typischerweiser &quot;liebe/love/luv&quot; vorkommt.</p>
<p><strong>Angriff</strong></p>
<ol class="arabic simple incremental">
<li><p>Erstellen eines fokussierten W√∂rterbuchs: <span class="docutils literal">candidates.txt</span></p></li>
<li><p>Angriff mit passendem Maskenangriff</p></li>
</ol>
</div><div class="small ld-slide" id="szenario-7-worterbuch-mit-maske-1">
<h2>Szenario 7: W√∂rterbuch mit Maske</h2>
<p><strong>Angriff mit Hybridangriff</strong></p>
<p><span class="docutils literal">candidates.txt</span> enth√§lt alle Begriffe aus rockyou, die die Anforderung erf√ºllen:</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-oE<span class="whitespace"> </span><span class="literal string double">&quot;[a-zA-Z]*[Ll]((uv)|(ove)|(iebe))[a-zA-Z]*&quot;</span><span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">      </span>/usr/share/wordlists/rockyou.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace"> </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-u<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>candidates.txt</code></pre>
<p class="incremental">Angriff mit Hashcat:</p>
<pre class="code bash incremental literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>hash.sha256<span class="whitespace"> </span>candidates.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">    </span>-a<span class="whitespace"> </span><span class="literal number">6</span><span class="whitespace"> </span>-1<span class="whitespace"> </span><span class="literal string single">'$.!'</span><span class="whitespace"> </span><span class="literal string single">'?d?d?d?d?1?1'</span></code></pre>
<div class="supplemental docutils container">
<p><strong>Beispiel</strong></p>
<p>In diesem Falle verwenden wir einen Hybridangriff, der eine Wordliste mit einer Maske kombiniert. Hier definieren wir unseren eigenen <span class="ger-quote">Zeichensatz</span> mit dem Parameter <span class="docutils literal"><span class="pre">-1</span> <span class="pre">'$.!'</span></span> und referenzieren diesen in unserer Maske sp√§ter mit <span class="docutils literal"><span class="pre">?1</span></span>.</p>
<p>Ein Beispielpasswort, dass wir mit dem Ansatz ermitteln k√∂nnten, w√§re:</p>
<table class="monospaced">
<thead>
<tr><th class="head"><p>SHA256</p></th>
<th class="head"><p>Passwort</p></th>
</tr>
</thead>
<tbody>
<tr><td><dl class="simple">
<dt>b9cace43df57bc694498bf4d7434f45a</dt>
<dd><p>8466c4a924f608d54fd279d24b3dc937</p>
</dd>
</dl>
</td>
<td><p>ILuvU2023!!</p></td>
</tr>
</tbody>
</table>
</div>
</div><div class="small ld-slide" id="szenario-8-passworter-mit-muster">
<h2>Szenario 8: Passw√∂rter mit Muster</h2>
<p><strong>Ausgangssituation</strong></p>
<p>Wir m√∂chten ein W√∂rterbuch erstellen mit <span class="ger-quote">W√∂rtern</span>, die Buchstabenvervielf√§ltigungen enthalten, aber nicht l√§nger als 16 Zeichen sind. Zum Beispiel: &quot;aaaaBBBBcccc&quot; oder auch &quot;AFFFFFE&quot;.
Weiterhin soll die Liste nach der L√§nge der gefundenen Eintr√§ge aufsteigend sortiert sein und Zeichen, die keine Buchstaben sind, einfach gel√∂scht werden.</p>
<p><strong>L√∂sung</strong></p>
<div class="incremental docutils container">
<p>Heraussuchen entsprechender W√∂rter aus rockyou mittels Linux Kommandozeilenwerkzeugen.</p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;([a-zA-Z])\1{3,}&quot;</span><span class="whitespace"> </span>/usr/share/wordlists/rockyou.txt<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>grep<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string double">&quot;^.{4,16}</span>$<span class="literal string double">&quot;</span><span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string single">'s/[^a-zAZ]//g'</span><span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-u<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>awk<span class="whitespace"> </span><span class="literal string single">'{print length &quot; &quot; $1}'</span><span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sort<span class="whitespace"> </span>-n<span class="whitespace">
  </span><span class="punctuation">|</span><span class="whitespace"> </span>sed<span class="whitespace"> </span>-E<span class="whitespace"> </span><span class="literal string single">'s/^[0-9]+ //'</span></code></pre>
</div>
<div class="supplemental docutils container">
<p><em>Alternative Aufgabenstellung</em></p>
<p>Sortierung der finalen Liste nach nach der H√§ufigkeit der Muster, angefangen mit dem h√§ufigsten Mustern.</p>
</div>
</div><div class="small ld-slide" id="szenario-9-passworter-bestehend-aus-fragmenten">
<h2>Szenario 9: Passw√∂rter bestehend aus Fragmenten</h2>
<p><strong>Ausgangssituation</strong></p>
<ul class="simple">
<li><p>Einer gegebenen Liste k√∂nnen wir nur entnehmen, dass alle Passw√∂rter zusammengesetzt sind aus den Fragmenten: <span class="docutils literal">ab</span>, <span class="docutils literal">mem</span>, <span class="docutils literal">li</span> und <span class="docutils literal">xy</span>.</p></li>
<li><p>Dar√ºber hinaus ist immer eine Zahl vorangestellt und am Ende kommt ein Punkt (<span class="docutils literal">.</span>) oder ein Ausrufezeichen (<span class="docutils literal">!</span>).</p></li>
<li><p>Die L√§nge scheint zwischen 6 und 16 Zeichen zu sein und Fragmente k√∂nnen sich wiederholen.</p></li>
</ul>
<p>Beispiel: <span class="docutils literal">1ablixyxy.</span></p>
<p><strong>Vorgehen</strong></p>
<ol class="arabic simple incremental">
<li><p>Erstellen eines Basisw√∂rterbuchs (<span class="docutils literal">base.txt</span>) mit den Fragmenten als Eintr√§ge.</p></li>
<li><p>Erstellen von Regeln f√ºr das Voranstellen und Anh√§ngen der entsprechenden (Sonder)zeichen.</p></li>
<li><p>Aus Basisw√∂rterbuch das finale W√∂rterbuch f√ºr den Angriff generieren.</p></li>
<li><p>Mit dem finalen W√∂rterbuch und entsprechenden Regeln angreifen.</p></li>
</ol>
</div><div class="small ld-slide" id="szenario-9-generierung-von-worterbuchern-aus-fragmenten">
<h2>Szenario 9: Generierung von W√∂rterb√ºchern aus Fragmenten</h2>
<p><strong>L√∂sung</strong></p>
<p>Zu Generierung aller Kombinationen aus den Fragmenten verwenden wir den Princeprocessor.  Der Princeprocessor ist sehr schnell und erm√∂glicht es in F√§llen die Ausgabe direkt an Hashcat durchzureichen und das Zwischenw√∂rterbuch nicht explizit speichern zu m√ºssen.</p>
<p><strong>Angriff</strong></p>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>princeprocessor<span class="whitespace"> </span>--pw-min<span class="operator">=</span><span class="literal number">6</span><span class="whitespace"> </span>--pw-max<span class="operator">=</span><span class="literal number">16</span><span class="whitespace"> </span>base.txt<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">  </span><span class="punctuation">|</span><span class="whitespace"> </span>hashcat<span class="whitespace"> </span>-m<span class="whitespace"> </span><span class="literal number">1400</span><span class="whitespace"> </span>hash.sha256<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">     </span>-r<span class="whitespace"> </span>number_prepend.rule<span class="whitespace"> </span><span class="literal string escape">\
</span><span class="whitespace">     </span>-r<span class="whitespace"> </span>sc_append.rule</code></pre>
<div class="supplemental docutils container">
<p><em>Aufbau von</em> <span class="docutils literal">number_prepend.rule</span>:</p>
<pre class="code bash black literal-block"><code>^0<span class="whitespace">
</span>^1<span class="whitespace">
</span>...<span class="whitespace">
</span>^9</code></pre>
<p><em>Aufbau von</em> <span class="docutils literal">sc_append.rule</span>:</p>
<pre class="code bash black literal-block"><code>$.<span class="whitespace">
</span><span class="name variable">$!</span></code></pre>
<p>Mit dem obigen Ansatz k√∂nnte zum Beispiel das folgende Passwort ermittelt werden:</p>
<table>
<thead>
<tr><th class="head"><p>SHA256</p></th>
<th class="head"><p>Passwort</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>8b11f8e8d487266a791d6d723a3e380c
38f49679735a7f3395ace4302e83dd0e</p></td>
<td><p>8abxylixy.</p></td>
</tr>
</tbody>
</table>
<p>In diesem Falle w√§re es auch m√∂glich gewesen nur einen Regelsatz zu erstellen mit den passenden Regeln (zum Beispiel: <span class="docutils literal">^1$.</span>, <span class="docutils literal">^1$!</span>, ...) der Aufwand w√§re hier jedoch h√∂her gewesen und h√§tte keinen Nutzen gehabt.</p>
<p>Im Allgemeinen ist jedoch bei der Verwendung des Kreuzproduktes von Regeln immer darauf zu achten, dass keine (oder zumindest keine relevante Anzahl von) Regeln dupliziert werden. Ein Beispiel w√§re das Kreuprodukt aus einem Regelnsatz f√ºr das optionale Anh√§ngen einer Ziffer mit sich selbst. Sei der Regelsatz:</p>
<pre class="code black literal-block"><code>:
$1
$2</code></pre>
<p>und w√ºrde man diesen mit sich selber kombinieren, um alle F√§lle des Anh√§ngens von keiner, einer bzw. zwei Zahlen abzudecken, dann w√ºrden folgende Regeln entstehen:</p>
<pre class="code black literal-block"><code>::
:$1
:$2
$1$1
$1$2
$2$1
$2$2
$1:
$2:</code></pre>
<p>Wie zu erkennen ist, f√ºhren zum Beispiel die Regeln <span class="docutils literal">$1:</span> und <span class="docutils literal">:$1</span> jeweils zum gleichen Ergebnis und w√§ren deswegen nicht effektiv.</p>
</div>
</div><div class="small ld-slide" id="szenario-10-hashcat-als-werkzeug-zur-worterbuchgenerierung">
<h2>Szenario 10: Hashcat als Werkzeug zur W√∂rterbuchgenerierung</h2>
<p><strong>Ausgangssituation</strong>
Gegeben sein 3 W√∂rterb√ºcher <a class="footnote-reference brackets" href="#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>: <span class="docutils literal">base1.txt</span>, <span class="docutils literal">base2.txt</span> und <span class="docutils literal">base3.txt</span>. Gesucht ist ein W√∂rterbuch, dass alle Kombinationen aus den drei W√∂rterb√ºchern enth√§lt und bei dem alle Teilworte immer mit Sonderzeichen (-) voneinander getrennt sind.</p>
<div class="incremental docutils container">
<p><strong>Beispiel</strong>
Sei <span class="docutils literal">base1.txt</span>: &quot;Kuh&quot;, &quot;Schwein&quot;; <span class="docutils literal">base2.txt</span>: &quot;Haus&quot;, &quot;Villa&quot; und <span class="docutils literal">base3.txt</span>: &quot;Baum&quot;, &quot;Busch&quot;. Dann w√§re das gesuchte W√∂rterbuch: &quot;Kuh-Haus-Baum&quot;, &quot;Kuh-Haus-Busch&quot;, ..., &quot;Schwein-Villa-Busch&quot;.</p>
</div>
<div class="incremental docutils container">
<p><strong>Vorgehen</strong></p>
<div class="incremental docutils container">
<ol class="arabic simple">
<li><p>Erzeugen des Kreuzprodukts der ersten beiden W√∂rterb√ºcher.</p></li>
</ol>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>--stdout<span class="whitespace"> </span>base1.txt<span class="whitespace"> </span>base2.txt<span class="whitespace"> </span>-j<span class="whitespace"> </span><span class="literal string single">'$-'</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>base1-base2.txt</code></pre>
</div>
<div class="incremental docutils container">
<ol class="arabic simple">
<li><p>Erzeugen des finalen W√∂rterbuchs durch Bildung des Kreugprodukts der Ergebnisse aus Schritt 1 mit dem dritten W√∂rterbuch.</p></li>
</ol>
<pre class="code bash literal-block"><code>$<span class="whitespace"> </span>hashcat<span class="whitespace"> </span>--stdout<span class="whitespace"> </span>base1-base2.txt<span class="whitespace"> </span>base3.txt<span class="whitespace"> </span>-j<span class="whitespace"> </span><span class="literal string single">'$-'</span><span class="whitespace"> </span>&gt;<span class="whitespace"> </span>final.txt</code></pre>
</div>
</div>
<div class="supplemental docutils container">
<p>Die Hashcat Utilities Bibliothek hat auch noch weitere Werkzeug zum Kombinieren von W√∂rterb√ºchern, die viele F√§lle sehr effizient abdecken (auch den besprochenen). Jedoch ist es gerade in F√§llen, in denen komplexere Regeln zur Anwendung kommen sollen, h√§ufiger sinnvoller/nowendig direkt Hashcat im &quot;stdout&quot; Modus zu verwenden, um die Zwischenw√∂rterb√ºcher zu generieren.</p>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p>Die selbe Vorgehensweise l√§sst sich auch anwenden, wenn man ein W√∂rterbuch mit sich selber kombinieren m√∂chte.</p>
</aside>
</aside>
</div><div class="ld-slide" id="passworter-angreifen-zusammenfassung">
<h2>Passw√∂rter angreifen - Zusammenfassung</h2>
<ul class="incremental more-space-between-list-items simple">
<li><p>Passw√∂rter k√∂nnen vielfach effizient angegriffen werden.</p></li>
<li><p>(gute bis exzellente) Kenntnisse √ºber die Zielpersonen sind h√§ufig notwendig.</p></li>
<li><p>Viele Werkzeuge sind verf√ºgbar (siehe auch Hashcat Werkzeuge, Princeprocessor, John the Ripper, etc.)</p></li>
<li><p>Kleine etablierte Kommandozeilenwerkzeuge (tr, greb, sed, awk, ...) oder selbstentwickelte Werkzeuge (zum Beispiel in Python) sind h√§ufig erg√§nzend notwendig und f√ºhren oft  schneller zum Ziel als die Suche nach <strong>dem</strong> Tool.</p></li>
<li><p>Insbesondere wenn es um die semantische Anreicherung von W√∂rterb√ºchern geht, dann sind (bisher) keine etablierten Werkzeuge vorhanden.</p></li>
<li><p>H√§ufig f√ºhren nur Kombinationen von etablierten und eigenen Werkzeugen zum gew√ºnschten Ziel.</p></li>
</ul>
</div><div class="ld-slide" id="literaturverzeichnis">
<h2>Literaturverzeichnis</h2>
<div class="tiny docutils container">
<div role="list" class="citation-list">
<div class="citation" id="sepass" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-5">SePass</a><span class="fn-bracket">]</span></span>
<p>SePass: Semantic Password Guessing Using k-nn Similarity Search in Word Embeddings; Maximilian H√ºnem√∂rder, Levin Sch√§fer, Nadine-Sarah Sch√ºler, Michael Eichberg &amp; Peer Kr√∂ger, ADMA 2022: Advanced Data Mining and ApplicationsSpringer LNAI, volume 13726</p>
</div>
<div class="citation" id="pcfg-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-1">PCFG</a><span class="fn-bracket">]</span></span>
<p>S. Aggarwal, M. Weir, B. Glodek and B. Medeiros, &quot;Password Cracking Using Probabilistic Context-Free Grammars,&quot; in 2009 30th IEEE Symposium on Security and Privacy (SP); doi: <a class="reference external" href="https://doi.ieeecomputersociety.org/10.1109/SP.2009.8">10.1109/SP.2009.8</a></p>
</div>
<div class="citation" id="ngpcfg" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-2">NGPCFG</a><span class="fn-bracket">]</span></span>
<p>S.Houshmand, S. Aggarwal and R. Flood, &quot;Next Gen PCFG Password Cracking,&quot; in IEEE Transactions on Information Forensics and Security, vol. 10, no. 8, pp. 1776-1791, Aug. 2015, doi: 10.1109/TIFS.2015.2428671.</p>
</div>
<div class="citation" id="paofpcfg" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-3">PAofPCFG</a><span class="fn-bracket">]</span></span>
<p>Hranick√Ω, R., Li≈°tiak, F., Miku≈°, D., Ry≈°av√Ω, O. (2019). On Practical Aspects of PCFG Password Cracking. In: Foley, S. (eds) Data and Applications Security and Privacy XXXIII. DBSec 2019. Lecture Notes in Computer Science(), vol 11559. Springer, Cham. <a class="reference external" href="https://doi.org/10.1007/978-3-030-22479-0_3">https://doi.org/10.1007/978-3-030-22479-0_3</a></p>
</div>
<div class="citation" id="piandpcfg" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#citation-reference-4">PIandPCFG</a><span class="fn-bracket">]</span></span>
<p>Houshmand, S., Aggarwal, S. (2017). Using Personal Information in Targeted Grammar-Based Probabilistic Password Attacks. In: Peterson, G., Shenoi, S. (eds) Advances in Digital Forensics XIII. DigitalForensics 2017. IFIP Advances in Information and Communication Technology, vol 511. Springer, Cham. <a class="reference external" href="https://doi.org/10.1007/978-3-319-67208-3_16">https://doi.org/10.1007/978-3-319-67208-3_16</a></p>
</div>
</div>
</div>
</div>
</body>
</html>
